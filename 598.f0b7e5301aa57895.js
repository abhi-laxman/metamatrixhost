"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[598,9557],{33087:(de,K,m)=>{m.d(K,{q:()=>s});var v=m(60611);class s{constructor(f,a){this._storage=new v.F,this.id="",this.name="",this.size=0,this._storage.maxSize=f,this._storage.register(this),a&&this._storage.registerRemoveFunc("",a)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(f,a,D=1){this._storage.put(this,f,a,D,1)}pop(f){return this._storage.pop(this,f)}get(f){return this._storage.get(this,f)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(f){this._storage.maxSize=f}resetHitRate(){}}},60611:(de,K,m)=>{m.d(K,{F:()=>D,Ti:()=>s});var v=m(12438);const s=-3,j=s-1;var f,S;(S=f||(f={}))[S.ALL=0]="ALL",S[S.SOME=1]="SOME";class D{get size(){return this._size}constructor(c=10485760){this._maxSize=c,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new v.A,this._users=new v.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear()}register(c){this._users.push(c)}deregister(c){this._users.removeUnordered(c)}registerRemoveFunc(c,d){this._removeFuncs.push([c,d])}deregisterRemoveFunc(c){this._removeFuncs.filterInPlace(d=>d[0]!==c)}get maxSize(){return this._maxSize}set maxSize(c){this._maxSize=Math.max(c,-1),this._checkSize()}getSize(c,d){return this._db.get(c.id+d)?.size??0}put(c,d,y,h,F){const A=this._db.get(d=c.id+d);if(A&&(this._size-=A.size,c.size-=A.size,this._db.delete(d),A.entry!==y&&this._notifyRemove(d,A.entry,A.size,f.ALL)),h>this._maxSize)return void this._notifyRemove(d,y,h,f.ALL);if(void 0===y)return void console.warn("Refusing to cache undefined entry ");if(!h||h<0)return console.warn(`Refusing to cache entry with size ${h} for key ${d}`),void this._notifyRemove(d,y,0,f.ALL);const b=1+Math.max(F,j)-s;this._db.set(d,new o(y,h,b)),this._size+=h,c.size+=h,this._checkSize()}updateSize(c,d,y,h){const F=this._db.get(d=c.id+d);if(F&&F.entry===y){for(this._size-=F.size,c.size-=F.size;h>this._maxSize;){const A=this._notifyRemove(d,y,h,f.SOME);if(!(null!=A&&A>0))return void this._db.delete(d);h=A}F.size=h,this._size+=h,c.size+=h,this._checkSize()}}pop(c,d){const y=this._db.get(d=c.id+d);if(y)return this._size-=y.size,c.size-=y.size,this._db.delete(d),++this._hit,y.entry;++this._miss}get(c,d){const y=this._db.get(d=c.id+d);if(void 0!==y)return this._db.delete(d),y.lives=y.lifetime,this._db.set(d,y),++this._hit,y.entry;++this._miss}peek(c,d){const y=this._db.get(c.id+d);return y?++this._hit:++this._miss,y?.entry}get performanceInfo(){const c={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},d={},y=new Array;this._db.forEach((A,b)=>{const V=A.lifetime;y[V]=(y[V]||0)+A.size,this._users.forAll(pe=>{const{id:W,name:_}=pe;b.startsWith(W)&&(d[_]=(d[_]||0)+A.size)})});const h={};this._users.forAll(A=>{const b=A.name;"hitRate"in A&&"number"==typeof A.hitRate&&!isNaN(A.hitRate)&&A.hitRate>0?(d[b]=d[b]||0,h[b]=Math.round(100*A.hitRate)+"%"):h[b]="0%"});const F=Object.keys(d);F.sort((A,b)=>d[b]-d[A]),F.forEach(A=>c[A]=Math.round(d[A]/2**20)+"MB / "+h[A]);for(let A=y.length-1;A>=0;--A){const b=y[A];b&&(c["Priority "+(A+s-1)]=Math.round(b/this._size*100)+"%")}return c}resetStats(){this._hit=this._miss=0,this._users.forAll(c=>c.resetHitRate())}clear(c){const d=c.id;this._db.forEach((y,h)=>{h.startsWith(d)&&(this._size-=y.size,this._db.delete(h),this._notifyRemove(h,y.entry,y.size,f.ALL))}),c.size=0}clearAll(){this._db.forEach((c,d)=>this._notifyRemove(d,c.entry,c.size,f.ALL)),this._users.forAll(c=>c.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(c,d,y,h){let F;return this._removeFuncs.some(A=>{if(c.startsWith(A[0])){const b=A[1](d,h,y);return"number"==typeof b&&(F=b),!0}return!1}),F}_checkSize(){this._users.forAll(c=>this._checkSizeLimits(c)),this._checkSizeLimits()}_checkSizeLimits(c){const d=c??this;if(d.maxSize<0||d.size<=d.maxSize)return;const y=c?.id;let h=!0;for(;h;){h=!1;for(const[F,A]of this._db)if(0===A.lifetime&&(!y||F.startsWith(y))){if(this._purgeItem(F,A,c),d.size<=.9*d.maxSize)return;h||=this._db.has(F)}}for(const[F,A]of this._db)if((!y||F.startsWith(y))&&(this._purgeItem(F,A,c),d.size<=.9*d.maxSize))return}_purgeItem(c,d,y=this._users.find(h=>c.startsWith(h.id))){if(this._db.delete(c),d.lives<=1){this._size-=d.size,y&&(y.size-=d.size);const h=this._notifyRemove(c,d.entry,d.size,f.SOME);null!=h&&h>0&&(this._size+=h,y&&(y.size+=h),d.lives=d.lifetime,d.size=h,this._db.set(c,d))}else--d.lives,this._db.set(c,d)}}class o{constructor(c,d,y){this.entry=c,this.size=d,this.lifetime=y,this.lives=y}}},11445:(de,K,m)=>{m.d(K,{Qf:()=>o,Qh:()=>a,RS:()=>j,ez:()=>d,i5:()=>y,lM:()=>f,qK:()=>c});var v=m(79139);const j=16;function f(h){if(!h)return 0;let F=c;for(const A in h)h.hasOwnProperty(A)&&(F+=N(h[A],!1));return F}function a(h){if(!h)return 0;if("number"==typeof h[0])return o(h);if(Array.isArray(h))return function D(h){const F=h.length;if(0===F||"number"==typeof h[0])return S(h,8);let A=d;for(let b=0;b<F;b++)A+=N(h[b]);return A}(h);let F=c;for(const A in h)h.hasOwnProperty(A)&&(F+=N(h[A]));return F}function N(h,F=!0){switch(typeof h){case"object":return F?a(h):c;case"string":return function s(h){return 32+h.length}(h);case"number":return j;case"boolean":return 4;default:return 8}}function o(...h){return h.reduce((F,A)=>F+(A?(0,v.iu)(A)?A.byteLength+y:Array.isArray(A)?S(A,j):0:0),0)}function S(h,F){return d+h.length*F}const c=32,d=16,y=145},23006:(de,K,m)=>{m.r(K),m.d(K,{default:()=>Is});var v=m(10467),s=m(8189),j=m(92165),f=m(90660),a=m(5922),D=m(39693),N=m(56492),o=m(85211),c=(m(3248),m(35150)),y=(m(40707),m(76576)),h=m(50305),F=m(95478),A=m(81098),b=m(89563),V=m(77806),pe=m(48900),W=m(45272),_=m(55739),C=m(17221),G=m(28067),B=m(55861),q=m(32034),Z=m(58701),P=m(22329),U=m(52593),I=m(71065),M=m(49343),X=m(96115);const me={StretchFunction:{arguments:{ComputeGamma:{isDataset:!1,isPublic:!1,name:"ComputeGamma",type:"RasterFunctionVariable",value:!1},DRA:{isDataset:!1,isPublic:!1,name:"DRA",type:"RasterFunctionVariable",value:!1},EstimateStatsHistogram:{isDataset:!1,isPublic:!1,name:"EstimateStatsHistogram",type:"RasterFunctionVariable",value:!1},Gamma:{displayName:"Gamma",isDataset:!1,isPublic:!1,name:"Gamma",type:"RasterFunctionVariable"},Histograms:{isDataset:!1,isPublic:!1,name:"Histograms",type:"RasterFunctionVariable"},Max:{isDataset:!1,isPublic:!1,name:"Max",type:"RasterFunctionVariable",value:255},MaxPercent:{isDataset:!1,isPublic:!1,name:"MaxPercent",type:"RasterFunctionVariable",value:.5},Min:{isDataset:!1,isPublic:!1,name:"Min",type:"RasterFunctionVariable",value:0},MinPercent:{isDataset:!1,isPublic:!1,name:"MinPercent",type:"RasterFunctionVariable",value:.25},NumberOfStandardDeviations:{isDataset:!1,isPublic:!1,name:"NumberOfStandardDeviation",type:"RasterFunctionVariable",value:2},Raster:{isDataset:!0,isPublic:!1,name:"Raster",type:"RasterFunctionVariable"},SigmoidStrengthLevel:{isDataset:!1,isPublic:!1,name:"SigmoidStrengthLevel",type:"RasterFunctionVariable",value:2},Statistics:{isDataset:!1,isPublic:!1,name:"Statistics",type:"RasterFunctionVariable"},StretchType:{isDataset:!1,isPublic:!1,name:"StretchType",type:"RasterFunctionVariable",value:0},type:"StretchFunctionArguments",UseGamma:{isDataset:!1,isPublic:!1,name:"UseGamma",type:"RasterFunctionVariable",value:!1}},description:"Enhances an image by adjusting the range of values displayed. This does not alter the underlying pixel values. If a pixel has a value outside of the specified range, it will appear as either the minimum or maximum value.",function:{description:"Enhances an image by adjusting the range of values displayed. This does not alter the underlying pixel values. If a pixel has a value outside of the specified range, it will appear as either the minimum or maximum value.",name:"Stretch",pixelType:"UNKNOWN",type:"StretchFunction"},functionType:0,name:"Stretch",thumbnail:""},RemapFunction:{name:"Remap",description:"Changes pixel values by assigning new values to ranges of pixel values or using an external table.",function:{type:"RemapFunction",pixelType:"UNKNOWN",name:"Remap",description:"Changes pixel values by assigning new values to ranges of pixel values or using an external table."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},UseTable:{name:"UseTable",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},InputRanges:{name:"InputRanges",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"Input Ranges"},OutputValues:{name:"OutputValues",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"Output Values"},NoDataRanges:{name:"NoDataRanges",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"NoData Ranges"},Table:{name:"Table",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},InputField:{name:"InputField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},OutputField:{name:"OutputField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},InputMaxField:{name:"InputMaxField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},RemapTableType:{name:"RemapTableType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},AllowUnmatched:{name:"AllowUnmatched",isPublic:!1,isDataset:!1,value:!0,type:"RasterFunctionVariable"},type:"RemapFunctionArguments"},functionType:0,thumbnail:""},ColormapFunction:{name:"Colormap",description:"Changes pixel values to display the raster data as either a grayscale or a red, green, blue (RGB) image, based on a colormap or a color ramp.",function:{type:"ColormapFunction",pixelType:"UNKNOWN",name:"Colormap",description:"Changes pixel values to display the raster data as either a grayscale or a red, green, blue (RGB) image, based on a colormap or a color ramp."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ColorSchemeType:{name:"ColorSchemeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},Colormap:{name:"Colormap",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},ColormapName:{name:"ColormapName",isPublic:!1,isDataset:!1,value:"Gray",type:"RasterFunctionVariable"},ColorRamp:{name:"ColorRamp",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},type:"ColormapFunctionArguments"},functionType:0,thumbnail:""},ShadedReliefFunction:{name:"Shaded Relief",description:"Creates a multiband, color coded, 3D representation of the surface, with the sun's relative position taken into account for shading the image.",function:{type:"ShadedReliefFunction",pixelType:"UNKNOWN",name:"Shaded Relief",description:"Creates a multiband, color coded, 3D representation of the surface, with the sun's relative position taken into account for shading the image."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ColorSchemeType:{name:"ColorSchemeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ColorRamp:{name:"ColorRamp",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},HillshadeType:{name:"HillshadeType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},Colormap:{name:"Colormap",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},Azimuth:{name:"Azimuth",isPublic:!1,isDataset:!1,value:315,type:"RasterFunctionVariable"},Altitude:{name:"Altitude",isPublic:!1,isDataset:!1,value:45,type:"RasterFunctionVariable"},SlopeType:{name:"SlopeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ZFactor:{name:"ZFactor",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},PSPower:{name:"PSPower",isPublic:!1,isDataset:!1,value:.664,type:"RasterFunctionVariable"},PSZFactor:{name:"PSZFactor",isPublic:!1,isDataset:!1,value:.024,type:"RasterFunctionVariable"},RemoveEdgeEffect:{name:"RemoveEdgeEffect",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},type:"ShadedReliefFunctionArguments"},functionType:0,thumbnail:""},HillshadeFunction:{name:"Hillshade",description:"Creates a 3D representation of the surface, with the sun's relative position taken into account for shading the image",function:{type:"HillshadeFunction",pixelType:"UNKNOWN",name:"Hillshade",description:"Creates a 3D representation of the surface, with the sun's relative position taken into account for shading the image"},arguments:{DEM:{name:"DEM",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},HillshadeType:{name:"HillshadeType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},Azimuth:{name:"Azimuth",isPublic:!1,isDataset:!1,value:315,type:"RasterFunctionVariable"},Altitude:{name:"Altitude",isPublic:!1,isDataset:!1,value:45,type:"RasterFunctionVariable"},SlopeType:{name:"SlopeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ZFactor:{name:"ZFactor",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},PSPower:{name:"PSPower",isPublic:!1,isDataset:!1,value:.664,type:"RasterFunctionVariable"},PSZFactor:{name:"PSZFactor",isPublic:!1,isDataset:!1,value:.024,type:"RasterFunctionVariable"},RemoveEdgeEffect:{name:"RemoveEdgeEffect",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},type:"HillshadeFunctionArguments"},functionType:0,thumbnail:""},ResampleFunction:{name:"Resample",description:"Changes the cell size of a raster.",function:{type:"ResampleFunction",pixelType:"UNKNOWN",name:"Resample",description:"Changes the cell size of a raster."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ResamplingType:{name:"ResamplingType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},InputCellSize:{name:"InputCellsize",isPublic:!1,isDataset:!1,value:{x:0,y:0},type:"RasterFunctionVariable"},OutputCellSize:{name:"OutputCellsize",isPublic:!1,isDataset:!1,value:{x:0,y:0},type:"RasterFunctionVariable"},type:"ResampleFunctionArguments"},functionType:0,thumbnail:""}};var oe=m(32681),Ke=m(97890),Ce=m(84495);const it=new Set(["u1","u2","u4","u8","s8","u16","s16"]),jr={simple_scalar:"Simple Scalar",wind_barb:"Wind Barb",single_arrow:"Single Arrow",beaufort_kn:"Beaufort Wind (Knots)",beaufort_m:"Beaufort Wind (MetersPerSecond)",ocean_current_m:"Ocean Current (MetersPerSecond)",ocean_current_kn:"Ocean Current (Knots)"},Nr=new Set(["raster-stretch","unique-value","class-breaks","raster-shaded-relief","vector-field","raster-colormap"]);function vr(n){return Nr.has(n.type)}function Ot(n,r){if(!n||!r)return(0,V.o8)(n||r);const l=(0,V.o8)(n);if(l.functionDefinition&&r.rasterFunctionDefinition){const e=r.rasterFunctionDefinition;(e.thumbnail||e.thumbnailEx)&&(e.thumbnail=e.thumbnailEx=void 0),Rr(l.functionDefinition.arguments,r),l.rasterFunctionDefinition=l.functionDefinition.toJSON()}else"none"!==r.functionName?.toLowerCase()&&(Sr(l.functionArguments).Raster=r);return l}function Rr(n,r){for(const l in n)"raster"===l.toLowerCase()&&("RasterFunctionVariable"===n[l].type?(n[l]=r.rasterFunctionDefinition,n[l].type="RasterFunctionTemplate"):"RasterFunctionTemplate"===n[l].type&&Rr(n[l].arguments,r))}function Ae(n){const r=(0,V.o8)(me[n.functionName+"Function"]),l=n.functionArguments;for(const e in l)"raster"===e.toLowerCase()?(r.arguments[e]=Ae(l[e]),r.arguments[e].type="RasterFunctionTemplate"):"colormap"===e.toLowerCase()?(r.arguments[e].value=Jr(l[e]),r.arguments.ColorSchemeType.value=0):r.arguments[e].value=l[e];return r}function Sr(n){const r=n?.Raster??n?.raster;return r&&"esri.layers.support.RasterFunction"===r.declaredClass?Sr(r.functionArguments):n}const st={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};function ht(n,r){const l=it.has(r)?(0,X.hP)(r):null;return l&&n.push([Math.floor(l[0]-1),0,0,0],[Math.ceil(l[1]+1),0,0,0]),n}function Ir(n){if(null==n)return;const{fields:r}=n;return r?.find(e=>e?.name&&"value"===e.name.toLowerCase())?.name}function xr(n){return"polygon-3d"===n.symbol?.type?n.symbol.symbolLayers?.find(r=>"fill"===r.type)?.material?.color:n.symbol?.color}function Jr(n){const r=[],l=[];return n.forEach(e=>{r.push(e[0]),l.push((0,oe.vL)([...e.slice(1),255]))}),{type:"RasterColormap",values:r,colors:l}}var _e=m(3147),ae=m(9932);let ie=class extends I.A{constructor(){super(...arguments),this.layer=null,this.compression=void 0,this.lercVersion=2}get adjustAspectRatio(){return this.layer.adjustAspectRatio}writeAdjustAspectRatio(n,r,l){this.layer.version<10.3||(r[l]=n)}get bandIds(){return this.layer.bandIds}get compressionQuality(){return this.layer.compressionQuality}writeCompressionQuality(n,r,l){this.format&&this.format.toLowerCase().includes("jpg")&&null!=n&&(r[l]=n)}get compressionTolerance(){return this.layer.compressionTolerance}writeCompressionTolerance(n,r,l){"lerc"===this.format&&null!=n&&(r[l]=n)}get format(){return"vector-field"===this.layer.renderer?.type?"lerc":this.layer.format}get interpolation(){return this.layer.interpolation}get noData(){return this.layer.noData}get noDataInterpretation(){return this.layer.noDataInterpretation}get pixelType(){const{layer:n}=this;return n.pixelType!==n.serviceRasterInfo.pixelType?n.pixelType:void 0}writeLercVersion(n,r,l){"lerc"===this.format&&this.layer.version>=10.5&&(r[l]=n)}get version(){const n=this.layer;return n.commitProperty("bandIds"),n.commitProperty("format"),n.commitProperty("compressionQuality"),n.commitProperty("compressionTolerance"),n.commitProperty("interpolation"),n.commitProperty("noData"),n.commitProperty("noDataInterpretation"),n.commitProperty("mosaicRule"),n.commitProperty("rasterFunction"),n.commitProperty("adjustAspectRatio"),n.commitProperty("pixelFilter"),n.commitProperty("pixelType"),n.commitProperty("definitionExpression"),n.commitProperty("multidimensionalSubset"),(this._get("version")||0)+1}set version(n){this._set("version",n)}get mosaicRule(){const n=this.layer;let r=n.mosaicRule;const l=n.definitionExpression;return r?l&&l!==r.where&&(r=r.clone(),r.where=l):l&&(r=new _e.A({where:l})),r}get rasterFunction(){const n=this.layer;let{rasterFunction:r}=n;const l=n.pixelFilter,e=!n.format||n.format.includes("jpg")||n.format.includes("png");r=this._addResampleRasterFunction(r);const t=n.multidimensionalSubset?.areaOfInterest;return t&&(r=function Br(n,r){return Ot(new M.A({functionName:"Clip",functionArguments:{ClippingGeometry:r.toJSON(),ClippingType:1}}),n)}(r,t)),e&&!l&&"vector-field"!==n.renderer?.type&&(r=this.combineRendererWithRenderingRule(r)),r}combineRendererWithRenderingRule(n){const r=this.layer,{rasterInfo:l,renderer:e}=r;return n=n||r.rasterFunction,e&&vr(e)?Ot(function Cr(n,r){switch(r=r||{},n.type){case"raster-stretch":return function Vr(n,r){const l=r.convertToRFT,e=new M.A;e.functionName="Stretch";const t=st[Ke.u.toJSON(n.stretchType)],i="u8",u=n.customStatistics?.map(g=>[g.min,g.max,g.avg??0,g.stddev??1]),p={StretchType:t,Statistics:u,DRA:n.dynamicRangeAdjustment,UseGamma:n.useGamma,Gamma:n.gamma,ComputeGamma:n.computeGamma};if(null!=n.outputMin&&(p.Min=n.outputMin),null!=n.outputMax&&(p.Max=n.outputMax),t===st.standardDeviation?(p.NumberOfStandardDeviations=n.numberOfStandardDeviations,e.outputPixelType=i):t===st.percentClip?(p.MinPercent=n.minPercent,p.MaxPercent=n.maxPercent,e.outputPixelType=i):t===st.minMax?e.outputPixelType=i:t===st.sigmoid&&(p.SigmoidStrengthLevel=n.sigmoidStrengthLevel),e.functionArguments=p,e.variableName="Raster",n.colorRamp){const g=n.colorRamp,R=new M.A;if(l)R.functionArguments={ColorRamp:(0,oe.hf)(g)};else{const x=(0,oe.hs)(g,!0);if(x)R.functionArguments={colorRampName:x};else if(!r.convertColorRampToColormap||"algorithmic"!==g.type&&"multipart"!==g.type){const w=n.colorRamp.toJSON();"algorithmic"===w.type?w.algorithm=w.algorithm||"esriCIELabAlgorithm":"multipart"===w.type&&w.colorRamps?.length&&w.colorRamps.forEach(O=>O.algorithm=O.algorithm||"esriCIELabAlgorithm"),R.functionArguments={colorRamp:w}}else R.functionArguments={Colormap:(0,oe.R8)(g)}}return R.variableName="Raster",R.functionName="Colormap",R.functionArguments.Raster=e,l?new M.A({rasterFunctionDefinition:Ae(R)}):R}return l?new M.A({rasterFunctionDefinition:Ae(e)}):e}(n,r);case"class-breaks":return function zr(n,r){const l=[],e=[],t=[],i=[],{pixelType:p,rasterAttributeTable:g}=r,R=null==g?null:g.features,x=Ir(g);if(x&&R&&Array.isArray(R)&&n.classBreakInfos){n.classBreakInfos.forEach((L,$)=>{const H=L.symbol?.color;let k;H?.a&&null!=L.minValue&&null!=L.maxValue&&R.forEach(ee=>{null!=L.minValue&&null!=L.maxValue&&(k=ee.attributes[n.field],(k>=L.minValue&&k<L.maxValue||$===n.classBreakInfos.length-1&&k>=L.minValue)&&i.push([ee.attributes[x],H.r,H.g,H.b]))})});const J=p?ht(i,p):i,E=new M.A;return E.functionName="Colormap",E.functionArguments={},E.functionArguments.Colormap=J,E.variableName="Raster",r.convertToRFT?new M.A({rasterFunctionDefinition:Ae(E)}):E}n.classBreakInfos.forEach((J,E)=>{if(null==J.minValue||null==J.maxValue)return;const L=J.symbol&&J.symbol.color;L?.a?(l.push(0===E?J.minValue:J.minValue+1e-4,J.maxValue+1e-4),e.push(E),i.push([E,L.r,L.g,L.b])):t.push(J.minValue,J.maxValue)});const w=p?ht(i,p):i,O=new M.A;O.functionName="Remap",O.functionArguments={InputRanges:l,OutputValues:e,NoDataRanges:t},O.variableName="Raster";const T=new M.A;return T.functionName="Colormap",T.functionArguments={Colormap:w,Raster:O},r.convertToRFT?new M.A({rasterFunctionDefinition:Ae(T)}):T}(n,r);case"unique-value":return function Lr(n,r){const l=[],{pixelType:e,rasterAttributeTable:t}=r,i=null==t?null:t.features,u=Ir(t),p=n.defaultSymbol?.color?.toRgb(),g=n.uniqueValueInfos;if(g)if(i){if(u){const w=new Map;g.forEach(T=>{const J=T.value,E=xr(T);null!=J&&E?.a&&w.set(String(J),E.toRgb())});const O=n.field;O&&i.forEach(({attributes:T})=>{const J=String(T[O]),E=T[u],L=w.get(J);L?l.push([E,...L]):p&&l.push([E,...p])})}}else for(let w=0;w<g.length;w++){const O=g[w],T=xr(O),J=+O.value;if(T?.a){if(isNaN(J))return null;l.push([J,T.r,T.g,T.b])}}const R=e?ht(l,e):l,x=new M.A;return x.functionName="Colormap",x.functionArguments={},x.functionArguments.Colormap=R,x.variableName="Raster",r.convertToRFT?new M.A({rasterFunctionDefinition:Ae(x)}):x}(n,r);case"raster-colormap":return function Ur(n,r){const l=n.extractColormap();if(!l||0===l.length)return null;const{pixelType:e}=r,t=e?ht(l,e):l,i=new M.A;return i.functionName="Colormap",i.functionArguments={},i.functionArguments.Colormap=t,r.convertToRFT?new M.A({rasterFunctionDefinition:Ae(i)}):i}(n,r);case"vector-field":return function Er(n,r){const l=new M.A;l.functionName="VectorFieldRenderer";const{dataType:e,bandNames:t}=r,i="vector-uv"===e;let u,p;if(t&&2===t.length){const T=t.map(J=>J.toLowerCase());u=T.indexOf("magnitude"),p=T.indexOf("direction")}-1!==u&&null!==u||(u=0,p=1);const g="arithmetic"===n.rotationType?1:2,R="flow-from"===n.flowRepresentation?0:1,x=n.visualVariables?n.visualVariables.find(T=>"Magnitude"===T.field):new Ce.A,w={magnitudeBandID:u,directionBandID:p,isUVComponents:i,referenceSystem:g,massFlowAngleRepresentation:R,symbolTileSize:50,symbolTileSizeUnits:100,calculationMethod:"Vector Average",symbologyName:jr[n.style.toLowerCase().replace("-","_")],minimumMagnitude:x.minDataValue,maximumMagnitude:x.maxDataValue,minimumSymbolSize:x.minSize,maximumSymbolSize:x.maxSize};l.functionArguments=w;const O=Ae(l);return r.convertToRFT?M.A.fromJSON({rasterFunctionDefinition:O}):l}(n,r);case"raster-shaded-relief":return function Zr(n,r){const l=r.convertToRFT;if("elevation"!==r.dataType&&("generic"!==r.dataType||1!==r.bandCount||"s16"!==r.pixelType&&"s32"!==r.pixelType&&"f32"!==r.pixelType&&"f64"!==r.pixelType))return new M.A;const e=new M.A;e.functionName="Hillshade";const t="traditional"===n.hillshadeType?0:1,i="none"===n.scalingType?1:3,u={HillshadeType:t,SlopeType:i,ZFactor:n.zFactor};return 0===t&&(u.Azimuth=n.azimuth,u.Altitude=n.altitude),3===i&&(u.PSPower=n.pixelSizePower,u.PSZFactor=n.pixelSizeFactor),e.functionArguments=u,e.variableName="Raster",n.colorRamp&&(e.functionName="ShadedRelief",l?u.ColorRamp=(0,oe.hf)(n.colorRamp):u.Colormap=(0,oe.R8)(n.colorRamp)),l?new M.A({rasterFunctionDefinition:Ae(e)}):e}(n,r);case"flow":throw new Error("Unsupported rendering rule.")}}(e,{rasterAttributeTable:l.attributeTable,pixelType:l.pixelType,dataType:l.dataType,bandNames:l.bandInfos.map(({name:t})=>t),convertColorRampToColormap:r.version<10.6,convertToRFT:!!n?.rasterFunctionDefinition,bandCount:l.bandCount}),n):n}_addResampleRasterFunction(n){if("vector-field"!==this.layer.renderer?.type||"Resample"===n?.functionName)return n;let e=new M.A({functionName:"Resample",functionArguments:{ResamplingType:"esriImageServiceDataTypeVector-UV"===this.layer.serviceDataType?7:10,InputCellSize:this.layer.serviceRasterInfo.pixelSize}});return e=n?.rasterFunctionDefinition?new M.A({rasterFunctionDefinition:Ae(e)}):e,Ot(e,n)}};(0,s._)([(0,o.MZ)()],ie.prototype,"layer",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],ie.prototype,"adjustAspectRatio",null),(0,s._)([(0,h.K)("adjustAspectRatio")],ie.prototype,"writeAdjustAspectRatio",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],ie.prototype,"bandIds",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],ie.prototype,"compression",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],ie.prototype,"compressionQuality",null),(0,s._)([(0,h.K)("compressionQuality")],ie.prototype,"writeCompressionQuality",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],ie.prototype,"compressionTolerance",null),(0,s._)([(0,h.K)("compressionTolerance")],ie.prototype,"writeCompressionTolerance",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],ie.prototype,"format",null),(0,s._)([(0,o.MZ)({type:String,json:{read:{reader:ae.SZ.read},write:{writer:ae.SZ.write}}})],ie.prototype,"interpolation",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],ie.prototype,"noData",null),(0,s._)([(0,o.MZ)({type:String,json:{read:{reader:ae.hm.read},write:{writer:ae.hm.write}}})],ie.prototype,"noDataInterpretation",null),(0,s._)([(0,o.MZ)({type:ae.e8.apiValues,json:{read:ae.e8.read,write:ae.e8.write}})],ie.prototype,"pixelType",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],ie.prototype,"lercVersion",void 0),(0,s._)([(0,h.K)("lercVersion")],ie.prototype,"writeLercVersion",null),(0,s._)([(0,o.MZ)({type:Number})],ie.prototype,"version",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],ie.prototype,"mosaicRule",null),(0,s._)([(0,o.MZ)({json:{write:!0,name:"renderingRule"}})],ie.prototype,"rasterFunction",null),ie=(0,s._)([(0,y.$)("esri.layers.support.ExportImageServiceParameters")],ie);var Gr=m(29141),$r=m(73258),Ar=m(63014),Wr=m(92870),jt=m(21980),ue=m(95373),Mr=m(83179),Hr=m(85889),Qe=m(20053),Nt=m(99263),Kr=m(50444),nt=m(22151),Qr=m(54636),Ct=m(28919),te=m(61320),Ue=m(77098),z=m(68800),se=m(1749);let Ee=class extends(f.A.ClonableMixin(I.A)){constructor(){super(...arguments),this.fromGeometry=null,this.toGeometry=null,this.objectIds=null,this.where=null,this.maxCount=null}};(0,s._)([(0,o.MZ)({type:se.A,json:{read:!0}})],Ee.prototype,"fromGeometry",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{read:!0,write:!0}})],Ee.prototype,"toGeometry",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Ee.prototype,"objectIds",void 0),(0,s._)([(0,o.MZ)({type:String,json:{write:!0}})],Ee.prototype,"where",void 0),(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],Ee.prototype,"maxCount",void 0),Ee=(0,s._)([(0,y.$)("esri.rest.support.FindImagesParameters")],Ee);const qr=Ee,br=n=>{let r=class extends n{constructor(){super(...arguments),this.make=null,this.model=null,this.focalLength=null,this.pixelSize=null,this.rows=null,this.cols=null}};return(0,s._)([(0,o.MZ)({json:{write:!0}})],r.prototype,"make",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],r.prototype,"model",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],r.prototype,"focalLength",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],r.prototype,"pixelSize",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],r.prototype,"rows",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],r.prototype,"cols",void 0),r=(0,s._)([(0,y.$)("esri.rest.support.CameraInfoMixin")],r),r};let Re=class extends(br(I.A)){constructor(){super(...arguments),this.id=null,this.referenceUri=null,this.acquisitionDate=null,this.cameraID=null,this.center=null,this.perspectiveCenter=null,this.orientation=null}writeAcquisitionDate(n,r){r.acquisitionDate=n?.getTime()}};(0,s._)([(0,o.MZ)({json:{write:!0}})],Re.prototype,"id",void 0),(0,s._)([(0,o.MZ)({json:{name:"uri",write:!0}})],Re.prototype,"referenceUri",void 0),(0,s._)([(0,o.MZ)({type:Date,json:{write:!0}})],Re.prototype,"acquisitionDate",void 0),(0,s._)([(0,h.K)("acquisitionDate")],Re.prototype,"writeAcquisitionDate",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],Re.prototype,"cameraID",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],Re.prototype,"center",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],Re.prototype,"perspectiveCenter",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Re.prototype,"orientation",void 0),Re=(0,s._)([(0,y.$)("esri.rest.support.ImageInspectionInfo")],Re);const Xr=Re;let gt=class extends I.A{constructor(){super(...arguments),this.images=null}};(0,s._)([(0,o.MZ)({type:[Xr],json:{write:!0}})],gt.prototype,"images",void 0),gt=(0,s._)([(0,y.$)("esri.rest.support.FindImagesResult")],gt);const Yr=gt;var Et;let Je=Et=class extends I.A{constructor(n){super(n),this.angleNames=null,this.point=null,this.spatialReference=null,this.rasterId=null}clone(){return new Et((0,V.o8)({angleNames:this.angleNames,point:this.point,spatialReference:this.spatialReference,rasterId:this.rasterId}))}};(0,s._)([(0,o.MZ)({type:[String],json:{name:"angleName",write:!0}})],Je.prototype,"angleNames",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],Je.prototype,"point",void 0),(0,s._)([(0,o.MZ)({type:q.A,json:{write:!0}})],Je.prototype,"spatialReference",void 0),(0,s._)([(0,o.MZ)({type:_.jz,json:{write:!0}})],Je.prototype,"rasterId",void 0),Je=Et=(0,s._)([(0,y.$)("esri.rest.support.ImageAngleParameters")],Je);const kr=Je;let qe=class extends I.A{constructor(n){super(n),this.north=null,this.up=null,this.spatialReference=null}};(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],qe.prototype,"north",void 0),(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],qe.prototype,"up",void 0),(0,s._)([(0,o.MZ)({type:q.A,json:{write:!0}})],qe.prototype,"spatialReference",void 0),qe=(0,s._)([(0,y.$)("esri.rest.support.ImageAngleResult")],qe);const ei=qe;var ye=m(82663),ge=m(6434),wr=m(49976);const ve=new wr.J({esriMensurationPoint:"point",esriMensurationCentroid:"centroid",esriMensurationDistanceAndAngle:"distance-and-angle",esriMensurationAreaAndPerimeter:"area-and-perimeter",esriMensurationHeightFromBaseAndTop:"base-and-top",esriMensurationHeightFromBaseAndTopShadow:"base-and-top-shadow",esriMensurationHeightFromTopAndTopShadow:"top-and-top-shadow",esriMensurationPoint3D:"point-3D",esriMensurationCentroid3D:"centroid-3D",esriMensurationDistanceAndAngle3D:"distance-and-angle-3D",esriMensurationAreaAndPerimeter3D:"area-and-perimeter-3D"});let Ze=class extends I.A{constructor(){super(...arguments),this.value=null,this.displayValue=null,this.uncertainty=null}};(0,s._)([(0,o.MZ)({type:Number,json:{read:!0,write:!0}})],Ze.prototype,"value",void 0),(0,s._)([(0,o.MZ)({type:String,json:{read:!0,write:!0}})],Ze.prototype,"displayValue",void 0),(0,s._)([(0,o.MZ)({type:Number,json:{read:!0,write:!0}})],Ze.prototype,"uncertainty",void 0),Ze=(0,s._)([(0,y.$)("esri.rest.support.imageMeasureUtils.BaseImageMeasureResultValue")],Ze);let Xe=class extends Ze{constructor(){super(...arguments),this.unit=null}};(0,s._)([(0,o.MZ)({type:String,json:{read:ye.Sk.read,write:ye.Sk.write}})],Xe.prototype,"unit",void 0),Xe=(0,s._)([(0,y.$)("esri.rest.support.imageMeasureUtils.ImageMeasureResultLengthValue")],Xe);let ft=class extends Ze{constructor(){super(...arguments),this.unit=null}};(0,s._)([(0,o.MZ)({type:String,json:{read:ye.dk.read,write:ye.dk.write}})],ft.prototype,"unit",void 0),ft=(0,s._)([(0,y.$)("esri.rest.support.imageMeasureUtils.ImageMeasureResultAreaValue")],ft);let ot=class extends Ze{constructor(){super(...arguments),this.unit=null}};(0,s._)([(0,o.MZ)({type:String,json:{read:ye.b$.read,write:ye.b$.write}})],ot.prototype,"unit",void 0),ot=(0,s._)([(0,y.$)("esri.rest.support.imageMeasureUtils.ImageMeasureResultAngleValue")],ot);let Ve=class extends I.A{constructor(n){super(n),this.type=null,this.measureOperation=null,this.mosaicRule=null,this.pixelSize=null,this.raster=void 0}};(0,s._)([(0,o.MZ)()],Ve.prototype,"type",void 0),(0,s._)([(0,o.MZ)({type:ve.apiValues,json:{read:ve.read,write:ve.write}})],Ve.prototype,"measureOperation",void 0),(0,s._)([(0,o.MZ)({type:_e.A,json:{write:!0}})],Ve.prototype,"mosaicRule",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],Ve.prototype,"pixelSize",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Ve.prototype,"raster",void 0),Ve=(0,s._)([(0,y.$)("esri.rest.support.BaseImageMeasureParameters")],Ve);const _t=Ve;var Zt;let Fe=Zt=class extends _t{constructor(){super(...arguments),this.type="area-perimeter",this.geometry=null,this.is3D=!1,this.linearUnit="meters",this.areaUnit="square-meters"}writeGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]=n.toJSON())}get measureOperation(){return this.is3D?"area-and-perimeter-3D":"area-and-perimeter"}clone(){return new Zt((0,V.o8)({geometry:this.geometry,is3D:this.is3D,linearUnit:this.linearUnit,areaUnit:this.areaUnit,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{name:"fromGeometry",read:!0,write:!0}})],Fe.prototype,"geometry",void 0),(0,s._)([(0,h.K)("geometry")],Fe.prototype,"writeGeometry",null),(0,s._)([(0,o.MZ)({type:ve.apiValues,json:{write:ve.write}})],Fe.prototype,"measureOperation",null),(0,s._)([(0,o.MZ)({json:{read:!0}})],Fe.prototype,"is3D",void 0),(0,s._)([(0,o.MZ)({type:String,json:{read:ye.Sk.read,write:ye.Sk.write}})],Fe.prototype,"linearUnit",void 0),(0,s._)([(0,o.MZ)({type:String,json:{read:ye.dk.read,write:ye.dk.write}})],Fe.prototype,"areaUnit",void 0),Fe=Zt=(0,s._)([(0,y.$)("esri.rest.support.ImageAreaParameters")],Fe);const ti=Fe;let at=class extends I.A{constructor(n){super(n),this.name=null,this.sensorName=null}};(0,s._)([(0,o.MZ)({type:String,json:{read:!0,write:!0}})],at.prototype,"name",void 0),(0,s._)([(0,o.MZ)({type:String,json:{read:!0,write:!0}})],at.prototype,"sensorName",void 0),at=(0,s._)([(0,y.$)("esri.rest.support.BaseImageMeasureResult")],at);const vt=at;let lt=class extends vt{constructor(){super(...arguments),this.area=null,this.perimeter=null}};(0,s._)([(0,o.MZ)({type:ft,json:{read:!0,write:!0}})],lt.prototype,"area",void 0),(0,s._)([(0,o.MZ)({type:Xe,json:{read:!0,write:!0}})],lt.prototype,"perimeter",void 0),lt=(0,s._)([(0,y.$)("esri.rest.support.ImageAreaResult")],lt);const ri=lt;let Rt=class extends(f.A.ClonableMixin(I.A)){constructor(){super(...arguments),this.outSpatialReference=null}};(0,s._)([(0,o.MZ)({type:q.A,json:{name:"outSR",write:!0}})],Rt.prototype,"outSpatialReference",void 0),Rt=(0,s._)([(0,y.$)("esri.rest.support.ImageBoundaryParameters")],Rt);const ii=Rt;let Ye=class extends I.A{constructor(){super(...arguments),this.area=null,this.geometry=null}readGeometry(n,r){return null==n?null:n.rings?B.A.fromJSON(n):G.A.fromJSON(n)}};(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],Ye.prototype,"area",void 0),(0,s._)([(0,o.MZ)({types:ge.yR,json:{name:"shape",write:!0}})],Ye.prototype,"geometry",void 0),(0,s._)([(0,C.w)("geometry")],Ye.prototype,"readGeometry",null),Ye=(0,s._)([(0,y.$)("esri.rest.support.ImageBoundaryResult")],Ye);const si=Ye;var Vt;let Me=Vt=class extends _t{constructor(){super(...arguments),this.type="distance-angle",this.fromGeometry=null,this.toGeometry=null,this.is3D=!1,this.linearUnit="meters",this.angularUnit="degrees"}writeFromGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]=n.toJSON())}get measureOperation(){return this.is3D?"distance-and-angle-3D":"distance-and-angle"}clone(){return new Vt((0,V.o8)({fromGeometry:this.fromGeometry,toGeometry:this.toGeometry,is3D:this.is3D,linearUnit:this.linearUnit,angularUnit:this.angularUnit,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};(0,s._)([(0,o.MZ)({type:se.A,json:{read:!0,write:!0}})],Me.prototype,"fromGeometry",void 0),(0,s._)([(0,h.K)("fromGeometry")],Me.prototype,"writeFromGeometry",null),(0,s._)([(0,o.MZ)({type:se.A,json:{read:!0,write:!0}})],Me.prototype,"toGeometry",void 0),(0,s._)([(0,o.MZ)({type:ve.apiValues,json:{write:ve.write}})],Me.prototype,"measureOperation",null),(0,s._)([(0,o.MZ)({json:{read:!0}})],Me.prototype,"is3D",void 0),(0,s._)([(0,o.MZ)({type:String,json:{read:ye.Sk.read,write:ye.Sk.write}})],Me.prototype,"linearUnit",void 0),(0,s._)([(0,o.MZ)({type:String,json:{read:ye.b$.read,write:ye.b$.write}})],Me.prototype,"angularUnit",void 0),Me=Vt=(0,s._)([(0,y.$)("esri.rest.support.ImageDistanceParameters")],Me);const ni=Me;let ke=class extends vt{constructor(){super(...arguments),this.distance=null,this.azimuthAngle=null,this.elevationAngle=null}};(0,s._)([(0,o.MZ)({type:Xe,json:{read:!0,write:!0}})],ke.prototype,"distance",void 0),(0,s._)([(0,o.MZ)({type:ot,json:{read:!0,write:!0}})],ke.prototype,"azimuthAngle",void 0),(0,s._)([(0,o.MZ)({type:ot,json:{read:!0,write:!0}})],ke.prototype,"elevationAngle",void 0),ke=(0,s._)([(0,y.$)("esri.rest.support.ImageDistanceResult")],ke);const oi=ke;var ai=m(15463),li=m(37086),zt=m(17181);let Pe=class extends(f.A.ClonableMixin(I.A)){constructor(){super(...arguments),this.geometry=null,this.objectIds=null,this.spatialRelationship="intersects",this.timeExtent=null,this.where=null}writeGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]=JSON.stringify(n.toJSON()))}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{read:te.rS,write:!0}})],Pe.prototype,"geometry",void 0),(0,s._)([(0,h.K)("geometry")],Pe.prototype,"writeGeometry",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],Pe.prototype,"objectIds",void 0),(0,s._)([(0,ai.e)(li.x,{ignoreUnknown:!1,name:"spatialRel"})],Pe.prototype,"spatialRelationship",void 0),(0,s._)([(0,o.MZ)({type:zt.A,json:{name:"time",write:!0}})],Pe.prototype,"timeExtent",void 0),(0,s._)([(0,o.MZ)({type:String,json:{write:!0}})],Pe.prototype,"where",void 0),Pe=(0,s._)([(0,y.$)("esri.rest.support.ImageGPSInfoParameters")],Pe);const ui=Pe;let St=class extends(br(I.A)){constructor(){super(...arguments),this.id=null}};(0,s._)([(0,o.MZ)({json:{write:!0}})],St.prototype,"id",void 0),St=(0,s._)([(0,y.$)("esri.rest.support.CameraInfo")],St);const pi=St;let Se=class extends I.A{constructor(){super(...arguments),this.id=null,this.name=null,this.acquisitionDate=null,this.cameraID=null,this.center=null,this.gps=null,this.orientation=null}writeAcquisitionDate(n,r){r.acquisitionDate=n?.getTime()}};(0,s._)([(0,o.MZ)({json:{write:!0}})],Se.prototype,"id",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Se.prototype,"name",void 0),(0,s._)([(0,o.MZ)({type:Date,json:{write:!0}})],Se.prototype,"acquisitionDate",void 0),(0,s._)([(0,h.K)("acquisitionDate")],Se.prototype,"writeAcquisitionDate",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],Se.prototype,"cameraID",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],Se.prototype,"center",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Se.prototype,"gps",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Se.prototype,"orientation",void 0),Se=(0,s._)([(0,y.$)("esri.rest.support.ImageGPSInfo")],Se);const mi=Se;let ut=class extends I.A{constructor(){super(...arguments),this.images=null,this.cameras=null}};(0,s._)([(0,o.MZ)({type:[mi],json:{write:!0}})],ut.prototype,"images",void 0),(0,s._)([(0,o.MZ)({type:[pi],json:{write:!0}})],ut.prototype,"cameras",void 0),ut=(0,s._)([(0,y.$)("esri.rest.support.ImageGPSInfoResult")],ut);const ci=ut;var Lt;let De=Lt=class extends _t{constructor(){super(...arguments),this.type="height",this.fromGeometry=null,this.toGeometry=null,this.operationType="base-and-top",this.linearUnit="meters"}writeFromGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]=n.toJSON())}get measureOperation(){return this.operationType}clone(){return new Lt((0,V.o8)({fromGeometry:this.fromGeometry,toGeometry:this.toGeometry,operationType:this.operationType,linearUnit:this.linearUnit,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};(0,s._)([(0,o.MZ)({type:se.A,json:{read:!0}})],De.prototype,"fromGeometry",void 0),(0,s._)([(0,h.K)("fromGeometry")],De.prototype,"writeFromGeometry",null),(0,s._)([(0,o.MZ)({type:se.A,json:{read:!0,write:!0}})],De.prototype,"toGeometry",void 0),(0,s._)([(0,o.MZ)({type:ve.apiValues,json:{write:ve.write}})],De.prototype,"measureOperation",null),(0,s._)([(0,o.MZ)({json:{read:!0}})],De.prototype,"operationType",void 0),(0,s._)([(0,o.MZ)({type:String,json:{read:ye.Sk.read,write:ye.Sk.write}})],De.prototype,"linearUnit",void 0),De=Lt=(0,s._)([(0,y.$)("esri.rest.support.ImageHeightParameters")],De);const di=De;let It=class extends vt{constructor(){super(...arguments),this.height=null}};(0,s._)([(0,o.MZ)({type:Xe,json:{read:!0,write:!0}})],It.prototype,"height",void 0),It=(0,s._)([(0,y.$)("esri.rest.support.ImageHeightResult")],It);const yi=It;var Ut,hi=m(98464);let ne=Ut=class extends I.A{constructor(){super(...arguments),this.geometry=null,this.rasterFunctions=null,this.pixelSize=null,this.returnGeometry=!0,this.returnCatalogItems=!0,this.returnPixelValues=!0,this.maxItemCount=null,this.timeExtent=null,this.raster=void 0,this.viewId=void 0,this.processAsMultidimensional=!1}writeGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]=JSON.stringify(n.toJSON()))}set mosaicRule(n){let r=n;r?.mosaicMethod&&(r=_e.A.fromJSON({...r.toJSON(),mosaicMethod:r.mosaicMethod,mosaicOperation:r.mosaicOperation})),this._set("mosaicRule",r)}writeMosaicRule(n,r,l){null!=n&&(r[l]=JSON.stringify(n.toJSON()))}set rasterFunction(n){let r=n;r?.rasterFunction&&(r=M.A.fromJSON({...r.toJSON(),rasterFunction:r.rasterFunction,rasterFunctionArguments:r.rasterFunctionArguments})),this._set("rasterFunction",r)}writeRasterFunction(n,r,l){null!=n&&(r[l]=JSON.stringify(n.toJSON())),n.rasterFunctionDefinition&&(r[l]=JSON.stringify(n.rasterFunctionDefinition))}writeRasterFunctions(n,r,l){null!=n&&(r[l]=JSON.stringify(n.map(e=>e.rasterFunctionDefinition||e.toJSON())))}writePixelSize(n,r,l){null!=n&&(r[l]=JSON.stringify(n))}writeTimeExtent(n,r,l){if(null!=n){const e=null!=n.start?n.start.getTime():null,t=null!=n.end?n.end.getTime():null;r[l]=null!=e?null!=t?`${e},${t}`:`${e}`:null}}clone(){return new Ut((0,V.o8)({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,rasterFunctions:this.rasterFunctions,pixelSize:this.pixelSize,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,returnPixelValues:this.returnPixelValues,maxItemCount:this.maxItemCount,processAsMultidimensional:this.processAsMultidimensional,raster:this.raster,viewId:this.viewId,timeExtent:this.timeExtent}))}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{write:!0}})],ne.prototype,"geometry",void 0),(0,s._)([(0,h.K)("geometry")],ne.prototype,"writeGeometry",null),(0,s._)([(0,o.MZ)({type:_e.A,json:{write:!0}})],ne.prototype,"mosaicRule",null),(0,s._)([(0,h.K)("mosaicRule")],ne.prototype,"writeMosaicRule",null),(0,s._)([(0,o.MZ)({type:M.A,json:{write:!0,name:"renderingRule"}})],ne.prototype,"rasterFunction",null),(0,s._)([(0,h.K)("rasterFunction")],ne.prototype,"writeRasterFunction",null),(0,s._)([(0,o.MZ)({type:[M.A],json:{write:!0,name:"renderingRules"}})],ne.prototype,"rasterFunctions",void 0),(0,s._)([(0,h.K)("rasterFunctions")],ne.prototype,"writeRasterFunctions",null),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],ne.prototype,"pixelSize",void 0),(0,s._)([(0,h.K)("pixelSize")],ne.prototype,"writePixelSize",null),(0,s._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],ne.prototype,"returnGeometry",void 0),(0,s._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],ne.prototype,"returnCatalogItems",void 0),(0,s._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],ne.prototype,"returnPixelValues",void 0),(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],ne.prototype,"maxItemCount",void 0),(0,s._)([(0,o.MZ)({type:zt.A,json:{write:{target:"time"}}})],ne.prototype,"timeExtent",void 0),(0,s._)([(0,h.K)("timeExtent")],ne.prototype,"writeTimeExtent",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],ne.prototype,"raster",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],ne.prototype,"viewId",void 0),(0,s._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],ne.prototype,"processAsMultidimensional",void 0),ne=Ut=(0,s._)([(0,y.$)("esri.rest.support.ImageIdentifyParameters")],ne);const Fr=ne;var Pr=m(93327);let Ie=class extends I.A{constructor(){super(...arguments),this.catalogItemVisibilities=null,this.catalogItems=null,this.location=null,this.name=null,this.objectId=null,this.processedValues=null,this.properties=null,this.value=null}};(0,s._)([(0,o.MZ)({json:{write:!0}})],Ie.prototype,"catalogItemVisibilities",void 0),(0,s._)([(0,o.MZ)({type:Pr.A,json:{write:!0}})],Ie.prototype,"catalogItems",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],Ie.prototype,"location",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Ie.prototype,"name",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Ie.prototype,"objectId",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Ie.prototype,"processedValues",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Ie.prototype,"properties",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Ie.prototype,"value",void 0),Ie=(0,s._)([(0,y.$)("esri.rest.support.ImageIdentifyResult")],Ie);const gi=Ie;var Jt;let et=Jt=class extends I.A{constructor(){super(...arguments),this.geometries=null,this.rasterId=null}writeGeometry(n,r,l){r.geometries={geometryType:"esriGeometryPoint",geometries:n.map(e=>e.toJSON())}}clone(){return new Jt({geometries:this.geometries?.map(n=>n.clone())??[],rasterId:this.rasterId})}};(0,s._)([(0,o.MZ)({type:[se.A],json:{write:!0}})],et.prototype,"geometries",void 0),(0,s._)([(0,h.K)("geometries")],et.prototype,"writeGeometry",null),(0,s._)([(0,o.MZ)({type:_.jz,json:{write:!0}})],et.prototype,"rasterId",void 0),et=Jt=(0,s._)([(0,y.$)("esri.rest.support.ImagePixelLocationParameters")],et);const fi=et;let xt=class extends I.A{constructor(){super(...arguments),this.geometries=null}};(0,s._)([(0,o.MZ)({json:{write:!0}})],xt.prototype,"geometries",void 0),xt=(0,s._)([(0,y.$)("esri.rest.support.ImagePixelLocationResult")],xt);const _i=xt;var Bt;let Be=Bt=class extends _t{constructor(){super(...arguments),this.type="point",this.geometry=null,this.is3D=!1}writeGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]=n.toJSON())}get measureOperation(){const{is3D:n,geometry:r}=this;return"point"===r.type?n?"point-3D":"point":n?"centroid-3D":"centroid"}clone(){return new Bt((0,V.o8)({geometry:this.geometry,is3D:this.is3D,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{name:"fromGeometry",read:te.rS}})],Be.prototype,"geometry",void 0),(0,s._)([(0,h.K)("geometry")],Be.prototype,"writeGeometry",null),(0,s._)([(0,o.MZ)({type:ve.apiValues,json:{read:ve.read,write:ve.write}})],Be.prototype,"measureOperation",null),(0,s._)([(0,o.MZ)({json:{read:!0}})],Be.prototype,"is3D",void 0),Be=Bt=(0,s._)([(0,y.$)("esri.rest.support.ImagePointParameters")],Be);const vi=Be;let At=class extends vt{constructor(){super(...arguments),this.point=null}};(0,s._)([(0,o.MZ)({type:se.A,json:{name:"point.value",read:!0,write:!0}})],At.prototype,"point",void 0),At=(0,s._)([(0,y.$)("esri.rest.support.ImagePointResult")],At);const Ri=At;var Gt,Si=m(21870);let he=Gt=class extends I.A{constructor(){super(...arguments),this.geometry=null,this.interpolation="nearest",this.mosaicRule=null,this.outFields=null,this.pixelSize=null,this.raster=void 0,this.returnFirstValueOnly=!0,this.sampleDistance=null,this.sampleCount=null,this.sliceId=null,this.timeExtent=null}writeGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]=n.toJSON())}set locations(n){if(n?.length){const r=new Si.A({spatialReference:n[0].spatialReference,points:n.map(({x:l,y:e})=>[l,e])});this._set("locations",n),this.geometry=r}}clone(){return new Gt((0,V.o8)({geometry:this.geometry,locations:this.locations,interpolation:this.interpolation,mosaicRule:this.mosaicRule,outFields:this.outFields,raster:this.raster,returnFirstValueOnly:this.returnFirstValueOnly,sampleDistance:this.sampleDistance,sampleCount:this.sampleCount,sliceId:this.sliceId,pixelSize:this.pixelSize,timeExtent:this.timeExtent}))}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{read:te.rS}})],he.prototype,"geometry",void 0),(0,s._)([(0,h.K)("geometry")],he.prototype,"writeGeometry",null),(0,s._)([(0,o.MZ)({type:[se.A]})],he.prototype,"locations",null),(0,s._)([(0,o.MZ)({type:String,json:{type:ae.SZ.jsonValues,read:ae.SZ.read,write:ae.SZ.write}})],he.prototype,"interpolation",void 0),(0,s._)([(0,o.MZ)({type:_e.A,json:{write:!0}})],he.prototype,"mosaicRule",void 0),(0,s._)([(0,o.MZ)({type:[String],json:{write:!0}})],he.prototype,"outFields",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],he.prototype,"pixelSize",void 0),(0,s._)([(0,o.MZ)({type:String,json:{write:!0}})],he.prototype,"raster",void 0),(0,s._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],he.prototype,"returnFirstValueOnly",void 0),(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],he.prototype,"sampleDistance",void 0),(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],he.prototype,"sampleCount",void 0),(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],he.prototype,"sliceId",void 0),(0,s._)([(0,o.MZ)({type:zt.A,json:{read:{source:"time"},write:{target:"time"}}})],he.prototype,"timeExtent",void 0),he=Gt=(0,s._)([(0,y.$)("esri.rest.support.ImageSampleParameters")],he);const Ii=he;let Te=class extends I.A{constructor(){super(...arguments),this.attributes=null,this.location=null,this.locationId=null,this.rasterId=null,this.resolution=null,this.pixelValue=null}};(0,s._)([(0,o.MZ)({json:{write:!0}})],Te.prototype,"attributes",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],Te.prototype,"location",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Te.prototype,"locationId",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Te.prototype,"rasterId",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Te.prototype,"resolution",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],Te.prototype,"pixelValue",void 0),Te=(0,s._)([(0,y.$)("esri.rest.support.ImageSample")],Te);const xi=Te;let Mt=class extends I.A{constructor(){super(...arguments),this.samples=[]}};(0,s._)([(0,o.MZ)({type:[xi],json:{write:!0}})],Mt.prototype,"samples",void 0),Mt=(0,s._)([(0,y.$)("esri.rest.support.ImageSampleResult")],Mt);const Ai=Mt;let Ge=class extends(f.A.ClonableMixin(I.A)){constructor(){super(...arguments),this.geometries=[],this.rasterIds=null,this.outSpatialReference=null}writeGeometries(n,r,l){r.geometries=n?.length?{geometryType:(0,te.$B)(n[0]),geometries:n.map(e=>({...e.toJSON(),spatialReference:void 0}))}:null}};(0,s._)([(0,o.MZ)({types:[ge.yR]})],Ge.prototype,"geometries",void 0),(0,s._)([(0,h.K)("geometries")],Ge.prototype,"writeGeometries",null),(0,s._)([(0,o.MZ)({type:[_.jz],json:{write:!0}})],Ge.prototype,"rasterIds",void 0),(0,s._)([(0,o.MZ)({type:q.A,json:{name:"outSR",write:!0}})],Ge.prototype,"outSpatialReference",void 0),Ge=(0,s._)([(0,y.$)("esri.rest.support.ImageToMapMultirayParameters")],Ge);const Mi=Ge;let Oe=class extends(f.A.ClonableMixin(I.A)){constructor(){super(...arguments),this.geometry=null,this.rasterId=null,this.outSpatialReference=null,this.depthOffset=0,this.adjust=!1}writeGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]={...n.toJSON(),spatialReference:void 0})}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{read:te.rS,write:!0}})],Oe.prototype,"geometry",void 0),(0,s._)([(0,h.K)("geometry")],Oe.prototype,"writeGeometry",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],Oe.prototype,"rasterId",void 0),(0,s._)([(0,o.MZ)({type:q.A,json:{name:"outSR",write:!0}})],Oe.prototype,"outSpatialReference",void 0),(0,s._)([(0,o.MZ)({json:{name:"options.DOff",write:!0}})],Oe.prototype,"depthOffset",void 0),(0,s._)([(0,o.MZ)({json:{name:"options.Adjust",write:!0}})],Oe.prototype,"adjust",void 0),Oe=(0,s._)([(0,y.$)("esri.rest.support.ImageToMapParameters")],Oe);const bi=Oe;let pt=class extends(f.A.ClonableMixin(I.A)){constructor(){super(...arguments),this.referenceUri=null,this.rasterId=null}};(0,s._)([(0,o.MZ)({type:String,json:{name:"uri",write:!0}})],pt.prototype,"referenceUri",void 0),(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],pt.prototype,"rasterId",void 0),pt=(0,s._)([(0,y.$)("esri.rest.support.ImageUrlParameters")],pt);const wi=pt;let bt=class extends I.A{constructor(){super(...arguments),this.url=null}};(0,s._)([(0,o.MZ)({json:{name:"imageURL",write:!0}})],bt.prototype,"url",void 0),bt=(0,s._)([(0,y.$)("esri.rest.support.ImageUrlResult")],bt);const Fi=bt,$t=new wr.J({0:"constant",1:"plane",2:"minimum",3:"maximum",4:"average"},{useNumericKeys:!0});let je=class extends(f.A.ClonableMixin(I.A)){constructor(){super(...arguments),this.geometries=[],this.mosaicRule=null,this.pixelSize=null,this.constantZ=null,this.baseType="plane"}writeGeometries(n,r,l){n?.length&&(r.geometryType=(0,te.$B)(n[0]),r.geometries=n.map(e=>e.toJSON()))}};(0,s._)([(0,o.MZ)({types:[ge.yR]})],je.prototype,"geometries",void 0),(0,s._)([(0,h.K)("geometries")],je.prototype,"writeGeometries",null),(0,s._)([(0,o.MZ)({type:_e.A,json:{write:!0}})],je.prototype,"mosaicRule",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{write:!0}})],je.prototype,"pixelSize",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],je.prototype,"constantZ",void 0),(0,s._)([(0,o.MZ)({type:$t.apiValues,json:{read:$t.read,write:$t.write}})],je.prototype,"baseType",void 0),je=(0,s._)([(0,y.$)("esri.rest.support.ImageVolumeParameters")],je);const Pi=je;let xe=class extends I.A{constructor(){super(...arguments),this.area=null,this.cut=null,this.fill=null,this.maxZ=null,this.minZ=null,this.meanZ=null,this.cutCellCount=null,this.fillCellCount=null}};(0,s._)([(0,o.MZ)({json:{write:!0}})],xe.prototype,"area",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],xe.prototype,"cut",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],xe.prototype,"fill",void 0),(0,s._)([(0,o.MZ)({json:{name:"maxz",write:!0}})],xe.prototype,"maxZ",void 0),(0,s._)([(0,o.MZ)({json:{name:"minz",write:!0}})],xe.prototype,"minZ",void 0),(0,s._)([(0,o.MZ)({json:{name:"meanz",write:!0}})],xe.prototype,"meanZ",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],xe.prototype,"cutCellCount",void 0),(0,s._)([(0,o.MZ)({json:{write:!0}})],xe.prototype,"fillCellCount",void 0),xe=(0,s._)([(0,y.$)("esri.rest.support.ImageVolume")],xe);const Di=xe;let wt=class extends I.A{constructor(){super(...arguments),this.volumes=[]}};(0,s._)([(0,o.MZ)({type:[Di],json:{write:!0}})],wt.prototype,"volumes",void 0),wt=(0,s._)([(0,y.$)("esri.rest.support.ImageVolumeResult")],wt);const Ti=wt;let $e=class extends(f.A.ClonableMixin(I.A)){constructor(){super(...arguments),this.geometry=null,this.rasterId=null,this.visibleOnly=!1}writeGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]=JSON.stringify(n))}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{read:te.rS,write:!0}})],$e.prototype,"geometry",void 0),(0,s._)([(0,h.K)("geometry")],$e.prototype,"writeGeometry",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],$e.prototype,"rasterId",void 0),(0,s._)([(0,o.MZ)({json:{name:"options.VisibleOnly",write:!0}})],$e.prototype,"visibleOnly",void 0),$e=(0,s._)([(0,y.$)("esri.rest.support.MapToImageParameters")],$e);const Oi=$e;let ze=class extends I.A{constructor(){super(...arguments),this.geometry=null,this.length=null,this.area=null,this.center=null}readCenter(n,r){return n.spatialReference||(n={...n,spatialReference:r.Shape.spatialReference}),se.A.fromJSON(n)}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{name:"Shape",read:te.rS,write:!0}})],ze.prototype,"geometry",void 0),(0,s._)([(0,o.MZ)({json:{name:"Length",write:!0}})],ze.prototype,"length",void 0),(0,s._)([(0,o.MZ)({json:{name:"Area",write:!0}})],ze.prototype,"area",void 0),(0,s._)([(0,o.MZ)({type:se.A,json:{name:"Center",write:!0}})],ze.prototype,"center",void 0),(0,s._)([(0,C.w)("center")],ze.prototype,"readCenter",null),ze=(0,s._)([(0,y.$)("esri.rest.support.MeasureAreaFromImageResult")],ze);const ji=ze;var Wt;let tt=Wt=class extends I.A{constructor(){super(...arguments),this.geometry=null,this.rasterId=void 0}writeGeometry(n,r,l){null!=n&&(r.geometryType=(0,te.$B)(n),r[l]={...n.toJSON(),spatialReference:void 0})}clone(){const n=(0,V.o8)({geometry:this.geometry,rasterId:this.rasterId});return new Wt(n)}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{name:"fromGeometry",read:te.rS,write:!0}})],tt.prototype,"geometry",void 0),(0,s._)([(0,h.K)("geometry")],tt.prototype,"writeGeometry",null),(0,s._)([(0,o.MZ)({json:{write:!0}})],tt.prototype,"rasterId",void 0),tt=Wt=(0,s._)([(0,y.$)("esri.rest.support.MeasureFromImageParameters")],tt);const Ni=tt;let mt=class extends I.A{constructor(){super(...arguments),this.geometry=null,this.length=null}};(0,s._)([(0,o.MZ)({types:ge.yR,json:{name:"Shape",read:te.rS,write:!0}})],mt.prototype,"geometry",void 0),(0,s._)([(0,o.MZ)({json:{name:"Length",write:!0}})],mt.prototype,"length",void 0),mt=(0,s._)([(0,y.$)("esri.rest.support.MeasureLengthFromImageResult")],mt);const Ci=mt;function Ht(n){const r=n?.time;if(r&&(null!=r.start||null!=r.end)){const l=[];null!=r.start&&l.push(r.start),null==r.end||l.includes(r.end)||l.push(r.end),n.time=l.join(",")}}function Dr(n,r,l){return Kt.apply(this,arguments)}function Kt(){return(Kt=(0,v.A)(function*(n,r,l){r=(0,_.PZ)(hi.A,r);const e=(0,z.Dl)(n),t=r.geometry?[r.geometry]:[],i=yield(0,Ue.el)(t),u=r.toJSON();Ht(u);const p=i?.[0];null!=p&&(u.geometry=be(p));const g=(0,z.lF)({...e.query,f:"json",...u});return(0,z.jV)(g,l)})).apply(this,arguments)}function Qt(){return(Qt=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(Pi,r)).toJSON();e.geometries=JSON.stringify(e.geometries);const t=(0,z.Dl)(n),i=(0,z.lF)({...t.query,f:"json",...e}),u=(0,z.jV)(i,l),{data:p}=yield(0,b.A)(`${t.path}/calculateVolume`,u);return Ti.fromJSON({volumes:p.results})})).apply(this,arguments)}function qt(){return(qt=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(kr,r)).toJSON();null!=e.angleName&&(e.angleName=e.angleName.join(",")),r?.point?.spatialReference?.imageCoordinateSystem&&(e.point.spatialReference=Pt(r.point.spatialReference)),r?.spatialReference?.imageCoordinateSystem&&(e.spatialReference=rt(r.spatialReference));const t=(0,z.Dl)(n),i=(0,z.lF)({...t.query,f:"json",...e}),u=(0,z.jV)(i,l),{data:p}=yield(0,b.A)(`${t.path}/computeAngles`,u);return p.spatialReference=p.spatialReference?null!=p.spatialReference.geodataXform?new q.A({wkid:0,imageCoordinateSystem:p.spatialReference}):q.A.fromJSON(p.spatialReference):null,"NaN"===p.north&&(p.north=null),"NaN"===p.up&&(p.up=null),new ei(p)})).apply(this,arguments)}function Xt(){return(Xt=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(fi,r)).toJSON(),{geometries:t}=r;if(t)for(let R=0;R<t.length;R++)t[R].spatialReference?.imageCoordinateSystem&&(e.geometries.geometries[R].spatialReference=Pt(t[R].spatialReference));const i=(0,z.Dl)(n),u=(0,z.lF)({...i.query,f:"json",...e}),p=(0,z.jV)(u,l),{data:g}=yield(0,b.A)(`${i.path}/computePixelLocation`,p);return _i.fromJSON(g)})).apply(this,arguments)}function Yt(){return(Yt=(0,v.A)(function*(n,r,l){const e=yield Dr(n,r,l),t=(0,z.Dl)(n),{data:i}=yield(0,b.A)(`${t.path}/computeStatisticsHistograms`,e),{statistics:u}=i;return u?.length&&u.forEach(p=>{p.avg=p.mean,p.stddev=p.standardDeviation}),{statistics:u,histograms:i.histograms}})).apply(this,arguments)}function kt(){return(kt=(0,v.A)(function*(n,r,l){const e=yield Dr(n,r,l),t=(0,z.Dl)(n),{data:i}=yield(0,b.A)(`${t.path}/computeHistograms`,e);return{histograms:i.histograms}})).apply(this,arguments)}function er(){return(er=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(Ii,r)).toJSON();Ht(e),e.outFields?.length&&(e.outFields=e.outFields.join(","));const t=yield(0,Ue.el)(r.geometry),i=t?.[0];null!=i&&(e.geometry=be(i));const u=(0,z.Dl)(n),p=(0,z.lF)({...u.query,f:"json",...e}),g=(0,z.jV)(p,l),{data:R}=yield(0,b.A)(`${u.path}/getSamples`,g),x=R.samples.map(w=>{const O="NaN"===w.value||""===w.value?null:w.value.split(" ").map(T=>Number(T));return{...w,pixelValue:O}});return Ai.fromJSON({samples:x})})).apply(this,arguments)}function Tr(n,r,l){return tr.apply(this,arguments)}function tr(){return(tr=(0,v.A)(function*(n,r,l){r=(0,_.PZ)(Fr,r);const e=(0,z.Dl)(n);return(0,Ue.el)(r.geometry?[r.geometry]:[]).then(i=>{const u=r.toJSON(),p=i?.[0];null!=p&&(u.geometry=JSON.stringify(be(p)));const g=(0,z.lF)({...e.query,f:"json",...u}),R=(0,z.jV)(g,l);return(0,b.A)(e.path+"/identify",R)}).then(i=>gi.fromJSON(i.data))})).apply(this,arguments)}function rr(){return(rr=(0,v.A)(function*(n,r,l){r=(0,_.PZ)(di,r);const e=yield Ft(n,r,[r.fromGeometry,r.toGeometry],l);return yi.fromJSON(e)})).apply(this,arguments)}function ir(){return(ir=(0,v.A)(function*(n,r,l){r=(0,_.PZ)(ti,r);const e=yield Ft(n,r,[r.geometry],l);return ri.fromJSON(e)})).apply(this,arguments)}function sr(){return(sr=(0,v.A)(function*(n,r,l){r=(0,_.PZ)(vi,r);const e=yield Ft(n,r,[r.geometry],l);return Ri.fromJSON(e)})).apply(this,arguments)}function nr(){return(nr=(0,v.A)(function*(n,r,l){r=(0,_.PZ)(ni,r);const e=yield Ft(n,r,[r.fromGeometry,r.toGeometry],l);return oi.fromJSON(e)})).apply(this,arguments)}function Ft(n,r,l,e){return or.apply(this,arguments)}function or(){return(or=(0,v.A)(function*(n,r,l,e){const t=(0,z.Dl)(n),i=yield(0,Ue.el)(l),u=r.toJSON();null!=i[0]&&(u.fromGeometry=JSON.stringify(be(i[0]))),null!=i[1]&&(u.toGeometry=JSON.stringify(be(i[1])));const p=(0,z.lF)({...t.query,f:"json",...u}),g=(0,z.jV)(p,e),{data:R}=yield(0,b.A)(t.path+"/measure",g);return R})).apply(this,arguments)}function ar(){return(ar=(0,v.A)(function*(n,r,l){const e=yield Or(n,r,l);return Ci.fromJSON(e)})).apply(this,arguments)}function lr(){return(lr=(0,v.A)(function*(n,r,l){const e=yield Or(n,r,l);return ji.fromJSON(e)})).apply(this,arguments)}function Or(n,r,l){return ur.apply(this,arguments)}function ur(){return(ur=(0,v.A)(function*(n,r,l){r=(0,_.PZ)(Ni,r);const e=(0,z.Dl)(n),t=r.toJSON(),i=(0,z.lF)({...e.query,f:"json",...t}),u=(0,z.jV)(i,l),{data:p}=yield(0,b.A)(e.path+"/measureFromImage",u);return p})).apply(this,arguments)}function be(n){const r=n.toJSON();return n.spatialReference?.imageCoordinateSystem&&(r.spatialReference=Pt(n.spatialReference)),r}function Pt(n){const{imageCoordinateSystem:r}=n;if(r){const{id:l,referenceServiceName:e}=r;return null!=l?e?{icsid:l,icsns:e}:{icsid:l}:{ics:r}}return n.toJSON()}function rt(n,r){if(!n.imageCoordinateSystem)return(0,Z.YX)(n);const l=Pt(n),{icsid:e,icsns:t}=l;return null==e||null!=t&&!r?.toLowerCase().includes("/"+t.toLowerCase()+"/")?JSON.stringify(l):`0:${e}`}function pr(){return(pr=(0,v.A)(function*(n,r,l){r=(0,_.PZ)(ii,r);const e=(0,z.Dl)(n),t=r.toJSON();r.outSpatialReference&&(t.outSR=rt(r.outSpatialReference));const i=(0,z.lF)({...e.query,f:"json",...t}),u=(0,z.jV)(i,l),{data:p}=yield(0,b.A)(e.path+"/queryBoundary",u);return si.fromJSON(p)})).apply(this,arguments)}function mr(){return(mr=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(ui,r)).toJSON();Ht(e),e.objectIds?.length&&(e.objectIds=e.objectIds.join(",")),e.geometry||e.objectIds||e.time||e.where||(e.where="1=1");const t=yield(0,Ue.el)(r.geometry),i=t?.[0];null!=i&&(e.geometry=be(i));const u=i?.spatialReference??r.geometry?.spatialReference;u&&(e.inSR=rt(u));const p=(0,z.Dl)(n),g=(0,z.lF)({...p.query,f:"json",...e}),R=(0,z.jV)(g,l),{data:x}=yield(0,b.A)(`${p.path}/queryGPSInfo`,R);return ci.fromJSON(x)})).apply(this,arguments)}function cr(){return(cr=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(bi,r)).toJSON();r.geometry.spatialReference.imageCoordinateSystem&&(e.geometry=be(r.geometry)),r.depthOffset&&r.adjust||delete e.options;const t=(0,z.Dl)(n),i=(0,z.lF)({...t.query,f:"json",...e}),u=(0,z.jV)(i,l),{data:p}=yield(0,b.A)(`${t.path}/imageToMap`,u);return(0,te.rS)(p)})).apply(this,arguments)}function dr(){return(dr=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(Mi,r)).toJSON();r.rasterIds?.length&&(e.rasterIds=r.rasterIds.join(","));const t=(0,z.Dl)(n),i=(0,z.lF)({...t.query,f:"json",...e}),u=(0,z.jV)(i,l),{data:p}=yield(0,b.A)(`${t.path}/imageToMapMultiray`,u);return(0,te.rS)(p)})).apply(this,arguments)}function yr(){return(yr=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(Oi,r)).toJSON(),t=yield(0,Ue.el)(r.geometry),i=t?.[0];null!=i&&(e.geometry=be(i)),r.visibleOnly||delete e.options;const u=i?.spatialReference??r.geometry?.spatialReference;u&&(e.inSR=rt(u));const p=(0,z.Dl)(n),g=(0,z.lF)({...p.query,f:"json",...e}),R=(0,z.jV)(g,l),{data:x}=yield(0,b.A)(`${p.path}/mapToImage`,R);return(0,te.rS)(x)})).apply(this,arguments)}function hr(){return(hr=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(wi,r)).toJSON(),t=(0,z.Dl)(n),i=(0,z.lF)({...t.query,f:"json",...e}),u=(0,z.jV)(i,l),{data:p}=yield(0,b.A)(`${t.path}/getImageUrl`,u);return Fi.fromJSON(p)})).apply(this,arguments)}function gr(){return(gr=(0,v.A)(function*(n,r,l){const e=(r=(0,_.PZ)(qr,r)).toJSON(),t=yield(0,Ue.el)([r.fromGeometry,r.toGeometry]);null!=t[0]&&(e.fromGeometry=be(t[0]),t[0].spatialReference&&(e.inSR=rt(t[0].spatialReference))),null!=t[1]&&(e.toGeometry=be(t[1])),r.objectIds?.length&&(e.objectIds=e.objectIds.join(","));const i=(0,z.Dl)(n),u=(0,z.lF)({...i.query,f:"json",...e}),p=(0,z.jV)(u,l),{data:g}=yield(0,b.A)(`${i.path}/find`,p);return Yr.fromJSON(g)})).apply(this,arguments)}var Dt=m(93091),ts=m(61599);function fr(){return(fr=(0,v.A)(function*(n,r,l){const e=(0,z.Dl)(n),t=(0,z.lF)({...e?.query,f:"json"}),i=(0,z.jV)(t,l),u=`${e?.path}/${r}/info`,p=(0,b.A)(`${u}`,i),g=(0,b.A)(`${u}/keyProperties`,i),R=yield Promise.allSettled([p,g]),x="fulfilled"===R[0].status?R[0].value.data:null,w="fulfilled"===R[1].status?R[1].value.data:null;let O=null;x.statistics?.length&&(O=x.statistics.map(ee=>({min:ee[0],max:ee[1],avg:ee[2],stddev:ee[3]})));const T=G.A.fromJSON(x.extent),J=Math.ceil(T.width/x.pixelSizeX-.1),E=Math.ceil(T.height/x.pixelSizeY-.1),L=T.spatialReference,$=new se.A({x:x.pixelSizeX,y:x.pixelSizeY,spatialReference:L}),H=x.histograms?.length?x.histograms:null,k=new ts.A({origin:x.origin,blockWidth:x.blockWidth,blockHeight:x.blockHeight,firstPyramidLevel:x.firstPyramidLevel,maximumPyramidLevel:x.maxPyramidLevel});return new Mr.A({width:J,height:E,bandCount:x.bandCount,extent:T,spatialReference:L,pixelSize:$,pixelType:x.pixelType.toLowerCase(),statistics:O,histograms:H,keyProperties:w,storageInfo:k})})).apply(this,arguments)}var is=m(33063),ss=m(87342),ns=m(34687),_r=m(87086),os=m(91551);const as=new Set(["png","png8","png24","png32","jpg","bmp","gif","jpgpng","lerc","tiff"]),ls=(0,_.Qp)(_.GB,{min:0,max:255}),ps=n=>{let r=class extends n{constructor(){super(...arguments),this._functionRasterInfos={},this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},this._cachedRendererJson=null,this._serviceSupportsMosaicRule=null,this.adjustAspectRatio=null,this.bandIds=void 0,this.capabilities=null,this.compressionQuality=void 0,this.compressionTolerance=.01,this.copyright=null,this.defaultMosaicRule=null,this.definitionExpression=null,this.exportImageServiceParameters=null,this.rasterInfo=null,this.fields=null,this.fullExtent=null,this.hasMultidimensions=!1,this.imageMaxHeight=4100,this.imageMaxWidth=4100,this.interpolation=void 0,this.minScale=0,this.maxScale=0,this.multidimensionalInfo=null,this.multidimensionalSubset=null,this.noData=null,this.noDataInterpretation=void 0,this.objectIdField=null,this.geometryType="polygon",this.typeIdField=null,this.types=[],this.pixelFilter=null,this.raster=void 0,this.sourceType=null,this.viewId=void 0,this.symbolizer=null,this.rasterFunctionInfos=null,this.serviceDataType=null,this.spatialReference=null,this.pixelType=null,this.serviceRasterInfo=null,this.sourceJSON=null,this.url=null,this.version=void 0}initialize(){this._set("exportImageServiceParameters",new ie({layer:this}))}readServiceSupportsMosaicRule(e,t){return this._isMosaicRuleSupported(t)}get _rasterFunctionNamesIndex(){const e=new Map;return!this.rasterFunctionInfos||null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.length<1||null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.forEach(t=>{e.set(t.name.toLowerCase().replaceAll(/ /gi,"_"),t.name)}),e}readBandIds(e,t){if(Array.isArray(e)&&e.length>0&&e.every(i=>"number"==typeof i))return e}readCapabilities(e,t){return this._readCapabilities(t)}writeCompressionQuality(e,t,i){null!=e&&"lerc"!==this.format&&(t[i]=e)}writeCompressionTolerance(e,t,i){"lerc"===this.format&&null!=e&&(t[i]=e)}readDefaultMosaicRule(e,t){return this._serviceSupportsMosaicRule?_e.A.fromJSON(t):null}get fieldsIndex(){return this.fields?new $r.A(this.fields):null}set format(e){e&&as.has(e.toLowerCase())&&this._set("format",e.toLowerCase())}readFormat(e,t){return"esriImageServiceDataTypeVector-UV"===t.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===t.serviceDataType||null!=this.pixelFilter?"lerc":"jpgpng"}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}set mosaicRule(e){let t=e;t?.mosaicMethod&&(t=_e.A.fromJSON({...t.toJSON(),mosaicMethod:t.mosaicMethod,mosaicOperation:t.mosaicOperation})),this._set("mosaicRule",t)}readMosaicRule(e,t){const i=e||t.mosaicRule;return i?_e.A.fromJSON(i):this._isMosaicRuleSupported(t)?_e.A.fromJSON(t):null}writeMosaicRule(e,t,i){const{mosaicRule:u}=this;this._isValidCustomizedMosaicRule(u)&&(t[i]=u.toJSON())}writeNoData(e,t,i){null!=e&&"number"==typeof e&&(t[i]=ls(e))}readObjectIdField(e,t){return e||(e=t.fields.find(u=>"esriFieldTypeOID"===u.type||"oid"===u.type)?.name),e}get parsedUrl(){return(0,W.An)(this.url)}readSourceType(e,t){return this._isMosaicDataset(t)?"mosaic-dataset":"raster-dataset"}get renderer(){const{activePresetRendererName:e,presetRenderers:t}=this;return e?t?.find(({name:u})=>u===e)?.renderer.clone():this.internalRenderer}set renderer(e){this.activePresetRendererName=null,this.internalRenderer=e}set internalRenderer(e){this.loaded&&(e=this._configRenderer(e)),this._set("internalRenderer",e)}readRenderer(e,t,i){const u=t?.layerDefinition?.drawingInfo?.renderer,p=(0,Ct.LF)(u,i);return null==p?null:("vector-field"===p.type&&t.symbolTileSize&&!u.symbolTileSize&&(p.symbolTileSize=t.symbolTileSize),vr(p)||c.A.getLogger(this).warn("ArcGISImageService","Imagery layer doesn't support given renderer type."),p)}writeRenderer(e,t,i){t.layerDefinition=t.layerDefinition||{},t.layerDefinition.drawingInfo=t.layerDefinition.drawingInfo||{},t.layerDefinition.drawingInfo.renderer=e.toJSON(),"vector-field"===e.type&&(t.symbolTileSize=e.symbolTileSize)}get rasterFields(){const e=this.fields?.map(u=>u.clone())??[];e.push((0,ue.rZ)()),"mosaic-dataset"===this.sourceType&&this.fields?.length&&e.push((0,ue.Nd)()),this.version>=10.4&&null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.some(({name:u})=>"none"===u.toLowerCase())&&e.push((0,ue.dy)()),null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.filter(({name:u})=>"none"!==u.toLowerCase()).forEach(({name:u})=>e.push((0,ue.nq)(u)));const{rasterInfo:t}=this;if(this._isVectorDataSet()){const u=t?.multidimensionalInfo?.variables[0].unit?.trim(),p=(0,ue.DV)(u),g=(0,ue.y6)();e.push(p,g)}if(t?.multidimensionalInfo&&"raster-dataset"===this.sourceType){const u=(0,ue.AL)(t.multidimensionalInfo);e.push(...u)}const i=t?.attributeTable;if(null!=i){const u=(0,ue.jC)(i);e.push(...u)}return e}set rasterFunction(e){let t=e;t?.rasterFunction&&(t=M.A.fromJSON({...t.toJSON(),rasterFunction:t.rasterFunction,rasterFunctionArguments:t.rasterFunctionArguments})),this._set("rasterFunction",t)}readRasterFunction(e,t){const i=t.rasterFunctionInfos;return t.renderingRule||i?.length&&"None"!==i[0].name?this._isRFTJson(t.renderingRule)?M.A.fromJSON({rasterFunctionDefinition:t.renderingRule}):M.A.fromJSON(t.renderingRule||{rasterFunctionInfos:t.rasterFunctionInfos}):null}readSpatialReference(e,t){const i=e||t.extent.spatialReference;return i?q.A.fromJSON(i):null}writePixelType(e,t,i){null!=this.serviceRasterInfo&&this.pixelType===this.serviceRasterInfo.pixelType||(t[i]=ae.e8.toJSON(e))}readVersion(e,t){let i=t.currentVersion;return i||(i=t.hasOwnProperty("fields")||t.hasOwnProperty("timeInfo")?10:9.3),i}applyFilter(e){let t=e;return this.pixelFilter&&(t=this._clonePixelData(e),this.pixelFilter(t)),t}applyRenderer(e,t){var i=this;return(0,v.A)(function*(){let u=e;const{renderer:p,symbolizer:g,pixelFilter:R,bandIds:x}=i;if(!i._isPicture()&&p&&g&&!R){const w=JSON.stringify(i._cachedRendererJson)!==JSON.stringify(p.toJSON()),O=i._rasterJobHandler.instance;if(O){w&&(g.bind(),yield O.updateSymbolizer(g,t),i._cachedRendererJson=p.toJSON());const T=yield O.symbolize({bandIds:x,...e},t);u={extent:e.extent,pixelBlock:T}}else u={extent:e.extent,pixelBlock:g.symbolize({bandIds:x,...e})}}return u})()}destroy(){this._shutdownJobHandler()}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}calculateVolume(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsCalculateVolume)throw new a.A("imagery-layer:compute-pixel-space-locations","this operation is not supported on the input image service");return e=(0,V.o8)(e),i.mosaicRule&&null==e.mosaicRule&&(e.mosaicRule=i.mosaicRule),function Ei(n,r,l){return Qt.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}computeAngles(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsComputeAngles)throw new a.A("imagery-layer:compute-angles","this operation is not supported on the input image service");return function Zi(n,r,l){return qt.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}computePixelSpaceLocations(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsComputePixelLocation)throw new a.A("imagery-layer:compute-pixel-space-locations","this operation is not supported on the input image service");return function Vi(n,r,l){return Xt.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}computeHistograms(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsComputeHistograms)throw new a.A("imagery-layer:compute-histograms","this operation is not supported on the input image service");return e=(0,V.o8)(e),i._applyMosaicAndRenderingRules(e),function Li(n,r,l){return kt.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}computeStatisticsHistograms(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsComputeStatisticsHistograms)throw new a.A("imagery-layer:compute-statistics-histograms","this operation is not supported on the input image service");return e=(0,V.o8)(e),i._applyMosaicAndRenderingRules(e),function zi(n,r,l){return Yt.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}measureHeight(e,t){var i=this;return(0,v.A)(function*(){const u=yield i._fetchCapabilities(t?.signal);if(!("base-and-top"===e.operationType?u.mensuration.supportsHeightFromBaseAndTop:"base-and-top-shadow"===e.operationType?u.mensuration.supportsHeightFromBaseAndTopShadow:u.mensuration.supportsHeightFromTopAndTopShadow))throw new a.A("imagery-layer:measure-height","this operation is not supported on the input image service");return e=(0,V.o8)(e),i._applyMosaicRule(e),function Ji(n,r,l){return rr.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}measureAreaAndPerimeter(e,t){var i=this;return(0,v.A)(function*(){const u=yield i._fetchCapabilities(t?.signal);if(!u.mensuration.supportsAreaAndPerimeter||e.is3D&&!u.mensuration.supports3D)throw new a.A("imagery-layer:measure-area-and-perimeter","this operation is not supported on the input image service");return e=(0,V.o8)(e),i._applyMosaicRule(e),function Bi(n,r,l){return ir.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}measureDistanceAndAngle(e,t){var i=this;return(0,v.A)(function*(){const u=yield i._fetchCapabilities(t?.signal);if(!u.mensuration.supportsDistanceAndAngle||e.is3D&&!u.mensuration.supports3D)throw new a.A("imagery-layer:measure-distance-and-angle","this operation is not supported on the input image service");return e=(0,V.o8)(e),i._applyMosaicRule(e),function $i(n,r,l){return nr.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}measurePointOrCentroid(e,t){var i=this;return(0,v.A)(function*(){const u=yield i._fetchCapabilities(t?.signal);if(!u.mensuration.supportsPointOrCentroid||e.is3D&&!u.mensuration.supports3D)throw new a.A("imagery-layer:measure-point-or-centroid","this operation is not supported on the input image service");return e=(0,V.o8)(e),i._applyMosaicRule(e),function Gi(n,r,l){return sr.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}measureLengthFromImage(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsMeasureFromImage)throw new a.A("imagery-layer:measure-length-from-image","this operation is not supported on the input image service");if("polyline"!==e.geometry.type)throw new a.A("imagery-layer:measure-length-from-image","this input geometry must be a polyline");return function Wi(n,r,l){return ar.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}measureAreaFromImage(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsMeasureFromImage)throw new a.A("imagery-layer:measure-area-from-image","this operation is not supported on the input image service");if("polygon"!==e.geometry.type)throw new a.A("imagery-layer:measure-area-from-image","this input geometry must be a polygon");return function Hi(n,r,l){return lr.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}getField(e){const{fieldsIndex:t}=this;return t?.get(e)}getFieldDomain(e,t){const i=this.getField(e);return i?i.domain:null}fetchImage(e,t,i,u={}){var p=this;return(0,v.A)(function*(){if(null==e||null==t||null==i)throw new a.A("imagery-layer:fetch-image","Insufficient parameters for requesting an image. A valid extent, width and height values are required.");if(p.renderer||p.symbolizer){const O=yield p._generateRasterInfo(p.rasterFunction,{signal:u.signal});O&&(p.rasterInfo=O)}const g=p.getExportImageServiceParameters(e,t,i,u.timeExtent);if(null==g){if(u.requestAsImageElement&&p._canRequestImageElement(p.format)){const H=document.createElement("canvas");return H.width=t,H.height=i,u.returnImageBitmap?{imageBitmap:yield(0,Ar.m)(H,`${l(p.parsedUrl)}/exportImage`,u.signal)}:{imageOrCanvasElement:H}}const{bandIds:O,rasterInfo:T}=p,J=(O?.length||T.bandCount)??0,E=t*i,L=T.pixelType,$=[];for(let H=0;H<J;H++)$.push(jt.A.createEmptyBand(L,E));return{pixelData:{pixelBlock:new jt.A({width:t,height:i,pixels:$,mask:new Uint8Array(E),pixelType:L}),extent:e}}}const R=!!u.requestAsImageElement&&!p.pixelFilter;return p._requestArrayBuffer({imageServiceParameters:g,imageProps:{extent:e,width:t,height:i,format:p.format},requestAsImageElement:R,returnImageBitmap:R&&!!u.returnImageBitmap,signal:u.signal})})()}fetchKeyProperties(e){return(0,b.A)(l(this.parsedUrl)+"/keyProperties",{query:this._getQueryParams({renderingRule:this.version>=10.3?e?.rasterFunction:null})}).then(t=>t.data)}fetchRasterAttributeTable(e){return this.version<10.1?Promise.reject(new a.A("#fetchRasterAttributeTable()","Failed to get rasterAttributeTable")):(0,b.A)(l(this.parsedUrl)+"/rasterAttributeTable",{query:this._getQueryParams({renderingRule:this.version>=10.3?e?.rasterFunction:null})}).then(t=>Pr.A.fromJSON(t.data))}getCatalogItemRasterInfo(e,t){const i={...t,query:this._getQueryParams()};return function rs(n,r,l){return fr.apply(this,arguments)}(l(this.parsedUrl),e,i)}getCatalogItemICSInfo(e,t){var i=this;return(0,v.A)(function*(){const{data:u}=yield(0,b.A)(l(i.parsedUrl)+"/"+e+"/info/ics",{query:i._getQueryParams(),...t}),p=u?.ics;if(!p)return;let g=null;try{g=(yield(0,b.A)(l(i.parsedUrl)+"/"+e+"/info",{query:i._getQueryParams(),...t})).data.extent}catch{}if(!g?.spatialReference)return{ics:p,icsToPixelTransform:null,icsExtent:null,northDirection:null};const R=i.version>=10.7?(0,b.A)(l(i.parsedUrl)+"/"+e+"/info/icstopixel",{query:i._getQueryParams(),...t}).then(Q=>Q.data).catch(()=>({})):{},x=g.spatialReference,w={geometries:JSON.stringify({geometryType:"esriGeometryEnvelope",geometries:[g]}),inSR:(0,Z.YX)(x),outSR:"0:"+e},O=(0,b.A)(l(i.parsedUrl)+"/project",{query:i._getQueryParams(w),...t}).then(Q=>Q.data).catch(()=>({})),J=(g.xmin+g.xmax)/2,E=(g.ymax-g.ymin)/6,L=g.ymin+E,$=[];for(let Q=0;Q<5;Q++)$.push({x:J,y:L+E*Q});const H={geometries:JSON.stringify({geometryType:"esriGeometryPoint",geometries:$}),inSR:(0,Z.YX)(x),outSR:"0:"+e},k=(0,b.A)(l(i.parsedUrl)+"/project",{query:i._getQueryParams(H),...t}).then(Q=>Q.data).catch(()=>({})),ee=yield Promise.all([R,O,k]);let ce=ee[0].ipxf;if(null==ce){const Q=p.geodataXform?.xf_0;"topup"===Q?.name?.toLowerCase()&&6===Q?.coefficients?.length&&(ce={affine:{name:"ics [sensor: Frame] to pixel (column, row) transformation",coefficients:Q.coefficients,cellsizeRatio:0,type:"GeometricXform"}})}const re=G.A.fromJSON(ee[1]?.geometries?.[0]);re&&(re.spatialReference=new q.A({wkid:0,imageCoordinateSystem:p}));const Y=ee[2].geometries?ee[2].geometries.filter(Q=>null!=Q?.x&&null!=Q.y&&"NaN"!==Q.x&&"NaN"!==Q.y):[],le=Y.length;if(le<3)return{ics:p,icsToPixelTransform:ce,icsExtent:re,northDirection:null};let Ne=0,ct=0,We=0,dt=0;for(let Q=0;Q<le;Q++)Ne+=Y[Q].x,ct+=Y[Q].y,We+=Y[Q].x*Y[Q].x,dt+=Y[Q].x*Y[Q].y;const we=(le*dt-Ne*ct)/(le*We-Ne*Ne);let He=0;const yt=Y[4].x>Y[0].x,Le=Y[4].y>Y[0].y;return we===1/0?He=Le?90:270:0===we?He=yt?0:180:we>0?He=yt?180*Math.atan(we)/Math.PI:180*Math.atan(we)/Math.PI+180:we<0&&(He=Le?180+180*Math.atan(we)/Math.PI:360+180*Math.atan(we)/Math.PI),{ics:p,icsToPixelTransform:ce,icsExtent:re,northDirection:He}})()}generateRasterInfo(e,t){var i=this;return(0,v.A)(function*(){e=(0,_.PZ)(M.A,e);const u={...t,query:i._getQueryParams()};if(!e||"none"===e.functionName?.toLowerCase()||i._isVectorFieldResampleFunction(e))return i.serviceRasterInfo??(0,Dt.Tw)(l(i.parsedUrl),i.sourceJSON,u);const p=function us(n){const r=JSON.stringify(n),l=r.includes('"rasterFunctionDefinition":{'),e=r.match(l?/"type":"(.*?FunctionArguments")/gi:/"rasterFunction":"(.*?")/gi),t=e?.map(i=>l?i.slice(8,-18):i.slice(18,-1));return t?t.join("/"):null}(e);if(!p)throw new a.A("imagery-layer:generate-raster-info","the rendering rule is not supported");if(i._functionRasterInfos[p])return i._functionRasterInfos[p];const g=(0,Dt.X6)(l(i.parsedUrl),e,u);i._functionRasterInfos[p]=g;try{return yield g}catch(R){throw i._functionRasterInfos[p]=null,R}})()}getExportImageServiceParameters(e,t,i,u){const p=rt((e=e.clone().shiftCentralMeridian()).spatialReference,l(this.parsedUrl)),g=this.exportImageServiceParameters.toJSON(),{bandIds:R,noData:x}=g;let{renderingRule:w}=g;const O=this.rasterFunction?.rasterFunctionDefinition,T=this.renderer?.type,J=!T||"raster-stretch"===T||"raster-colormap"===T||"unique-value"===T||"class-breaks"===T||"raster-shaded-relief"===T;if(R?.length&&this._hasRasterFunction(this.rasterFunction)&&!O&&J){const $={rasterFunction:"ExtractBand",rasterFunctionArguments:{BandIds:R}};if("Stretch"===w.rasterFunction)$.rasterFunctionArguments.Raster=w.rasterFunctionArguments.Raster,w.rasterFunctionArguments.Raster=$;else if("Colormap"===w.rasterFunction){const H=w.rasterFunctionArguments.Raster;"Stretch"===H?.rasterFunction?($.rasterFunctionArguments.Raster=H.rasterFunctionArguments.Raster,H.rasterFunctionArguments.Raster=$):($.rasterFunctionArguments.Raster=H,w.rasterFunctionArguments.Raster=$)}else $.rasterFunctionArguments.Raster=w,w=$;g.bandIds=void 0}else g.bandIds=R?.join(",");Array.isArray(x)&&x.length>0&&(g.noData=x.join(","));const E=this._processMultidimensionalIntersection(null,u,this.exportImageServiceParameters.mosaicRule);if(E.isOutSide)return null;g.mosaicRule=null!=E.mosaicRule?JSON.stringify(E.mosaicRule):null,u=E.timeExtent,g.renderingRule=this._getRenderingRuleString(M.A.fromJSON(w));const L={};if(null!=u){const{start:$,end:H}=u.toJSON();$&&H&&$===H?L.time=""+$:null==$&&null==H||(L.time=`${$??"null"},${H??"null"}`)}return{bbox:e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,bboxSR:p,imageSR:p,size:t+","+i,...g,...L}}getSamples(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal))?.operations.supportsGetSamples)throw new a.A("imagery-layer:get-samples","getSamples operation is not supported on the input image service");e=(0,V.o8)(e);const{raster:p}=i;return p&&null==e.raster&&(e.raster=p),function Ui(n,r,l){return er.apply(this,arguments)}(i.url,e,i._getRequestOptions(t))})()}identify(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsIdentify)throw new a.A("imagery-layer:identify","identify operation is not supported on the input image service");e=(0,V.o8)(e),i.version<10.91&&"extent"===e.geometry?.type&&(e.geometry=B.A.fromExtent(e.geometry));const u=i._processMultidimensionalIntersection(e.geometry,e.timeExtent,e.mosaicRule||i.mosaicRule);if(u.isOutSide)throw new a.A("imagery-layer:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");e.timeExtent=u.timeExtent,e.mosaicRule=u.mosaicRule;const{raster:p,rasterFunction:g}=i;return g&&null==e.rasterFunction&&(e.rasterFunction=g),p&&null==e.raster&&(e.raster=p),Tr(i.url,e,i._getRequestOptions(t))})()}imageToMap(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsImageToMap)throw new a.A("imagery-layer:image-to-map","imageToMap operation is not supported on the input image service");return function qi(n,r,l){return cr.apply(this,arguments)}(l(i.parsedUrl),e,i._getRequestOptions(t))})()}imageToMapMultiray(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsImageToMapMultiray)throw new a.A("imagery-layer:image-to-map-multiray","imageToMapMultiray operation is not supported on the input image service");return function Xi(n,r,l){return dr.apply(this,arguments)}(l(i.parsedUrl),e,i._getRequestOptions(t))})()}mapToImage(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsMapToImage)throw new a.A("imagery-layer:map-to-image","mapToImage operation is not supported on the input image service");return function Yi(n,r,l){return yr.apply(this,arguments)}(l(i.parsedUrl),e,i._getRequestOptions(t))})()}findImages(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsFindImages)throw new a.A("imagery-layer:find-images","findImages operation is not supported on the input image service");return function es(n,r,l){return gr.apply(this,arguments)}(l(i.parsedUrl),e,i._getRequestOptions(t))})()}getImageUrl(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsGetImageUrl)throw new a.A("imagery-layer:get-image-url","getImageUrl operation is not supported on the input image service");return function ki(n,r,l){return hr.apply(this,arguments)}(l(i.parsedUrl),e,i._getRequestOptions(t))})()}createQuery(){return new _r.A({outFields:["*"],returnGeometry:!0,where:this.definitionExpression||"1=1"})}queryBoundary(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsQueryBoundary)throw new a.A("imagery-layer:query-boundary","queryBoundary operation is not supported on the input image service");return e=e??{outSpatialReference:i.spatialReference},function Ki(n,r,l){return pr.apply(this,arguments)}(l(i.parsedUrl),e,i._getRequestOptions(t))})()}queryRasters(e,t){var i=this;return(0,v.A)(function*(){return({query:e,requestOptions:t}=yield i._prepareForQuery(e,t)),(0,ns.s)(i.url,e,t)})()}queryObjectIds(e,t){var i=this;return(0,v.A)(function*(){return({query:e,requestOptions:t}=yield i._prepareForQuery(e,t)),(0,ss.V)(i.url,e,t)})()}queryGPSInfo(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsQueryGPSInfo)throw new a.A("imagery-layer:query-gps-info","queryGPSInfo operation is not supported on the input image service");return e=e??{where:"1=1"},function Qi(n,r,l){return mr.apply(this,arguments)}(l(i.parsedUrl),e,i._getRequestOptions(t))})()}queryRasterCount(e,t){var i=this;return(0,v.A)(function*(){return({query:e,requestOptions:t}=yield i._prepareForQuery(e,t)),(0,is.I)(i.url,e,t)})()}queryVisibleRasters(e,t){var i=this;return(0,v.A)(function*(){if(!e)throw new a.A("imagery-layer: query-visible-rasters","missing query parameter");yield i.load();const{pixelSize:u,returnDomainValues:p,returnTopmostRaster:g,showNoDataRecords:R}=t||{pixelSize:null,returnDomainValues:!1,returnTopmostRaster:!1,showNoDataRecords:!1};let x=!1,w=null,O=null;const T=ue.F_.servicePixelValue.toLowerCase(),J=i._rasterFunctionNamesIndex;if(null!=e.outFields&&(x=e.outFields.some(re=>!re.toLowerCase().startsWith(T)),i.version>=10.4)){const re=e.outFields.filter(le=>le.toLowerCase().startsWith(T)&&le.length>T.length).map(le=>{const Ne=le.slice(T.length+1);return[i._updateRenderingRulesFunctionName(Ne,J),Ne]});w=re.map(le=>new M.A({functionName:le[0]})),O=re.map(le=>le[1]);const{rasterFunction:Y}=i;0===w.length?Y?.functionName?(w.push(Y),O.push(Y.functionName)):w=null:Y?.functionName&&!w.some(le=>le.functionName===Y.functionName)&&(w.push(Y),O.push(Y.functionName))}const E=null==e.outSpatialReference||e.outSpatialReference.equals(i.spatialReference),{multidimensionalSubset:L}=i;let $=e.timeExtent||i.timeExtent;if(L){const{isOutside:re,intersection:Y}=(0,Qe.Rp)(L,{geometry:e.geometry,timeExtent:e.timeExtent,multidimensionalDefinition:i.exportImageServiceParameters.mosaicRule?.multidimensionalDefinition});if(re)throw new a.A("imagery-layer:query-visible-rasters","the request cannot be fulfilled when falling outside of the multidimensional subset");null!=Y?.timeExtent&&($=Y.timeExtent)}const H=i._combineMosaicRuleWithTimeExtent(i.exportImageServiceParameters.mosaicRule,$);let k=e.geometry;i.version<10.91&&"extent"===k?.type&&(k=B.A.fromExtent(k));const ee=i._getQueryParams({geometry:k,timeExtent:$,mosaicRule:H,rasterFunction:i.version<10.4?i.rasterFunction:null,rasterFunctions:w,pixelSize:u,returnCatalogItems:x,returnGeometry:E,raster:i.raster,maxItemCount:g?1:null});delete ee.f;const ce=new Fr(ee);try{yield i._generateRasterInfo(i.rasterFunction);const re=yield Tr(i.url,ce,{signal:t?.signal,query:{...i.customParameters}}),Y=e.outFields,le=null!=re.value&&re.value.toLowerCase().includes("nodata"),Ne=x&&!E&&re?.catalogItems?.features.length&&(R||!le),ct=i.multidimensionalInfo&&"raster-dataset"===i.sourceType?(0,Qe.XU)({rasterInfo:i.rasterInfo,multidimensionalDefinition:H?.multidimensionalDefinition,timeExtent:$,multidimensionalSubset:i.multidimensionalSubset}):null;if(!Ne)return i._processVisibleRastersResponse(re,{returnDomainValues:p,templateRRFunctionNames:O,showNoDataRecords:R,templateFields:Y,effectiveMultidimensionalDefinition:ct});const We=i.objectIdField||"ObjectId",dt=re.catalogItems?.features??[],we=dt.map(Le=>Le.attributes?.[We]),He=new _r.A({objectIds:we,returnGeometry:!0,outSpatialReference:e.outSpatialReference,outFields:[We]}),yt=yield i.queryRasters(He);return yt?.features?.length&&yt.features.forEach(Le=>{dt.forEach(Q=>{Q.attributes[We]===Le.attributes[We]&&Le.geometry&&(Q.geometry=Le.geometry.clone(),null!=e.outSpatialReference&&(Q.geometry.spatialReference=e.outSpatialReference))})}),i._processVisibleRastersResponse(re,{returnDomainValues:p,templateRRFunctionNames:O,showNoDataRecords:R,templateFields:Y,effectiveMultidimensionalDefinition:ct})}catch{throw new a.A("imagery-layer:query-visible-rasters","encountered error when querying visible rasters")}})()}fetchVariableStatisticsHistograms(e,t){var i=this;return(0,v.A)(function*(){const u=(0,b.A)(l(i.parsedUrl)+"/statistics",{query:i._getQueryParams({variable:e}),signal:t}).then(R=>R.data?.statistics),p=(0,b.A)(l(i.parsedUrl)+"/histograms",{query:i._getQueryParams({variable:e}),signal:t}).then(R=>R.data?.histograms),g=yield Promise.all([u,p]);return g[0]&&g[0].forEach(R=>{R.avg=R.mean,R.stddev=R.standardDeviation}),{statistics:g[0]||null,histograms:g[1]||null}})()}createFlowMesh(e,t){var i=this;return(0,v.A)(function*(){const u=i._rasterJobHandler.instance;return u?u.createFlowMesh(e,t):(0,os.CW)(e.meshType,e.simulationSettings,e.flowData,null!=t.signal?t.signal:(new AbortController).signal)})()}getMultidimensionalSubsetVariables(e){return(0,Qe.z2)(this.multidimensionalSubset,e??this.serviceRasterInfo.multidimensionalInfo)}_fetchService(e){var t=this;return(0,v.A)(function*(){yield t._fetchServiceInfo(e),t.rasterInfo||(t.rasterInfo=t.serviceRasterInfo);const i=t.sourceJSON,u=null!=t.serviceRasterInfo?Promise.resolve(t.serviceRasterInfo):(0,Dt.Tw)(l(t.parsedUrl),i,{signal:e,query:t._getQueryParams()}).then(R=>(t._set("serviceRasterInfo",R),t._set("multidimensionalInfo",R.multidimensionalInfo),(0,Dt.E9)(R,i),R)),p=t._hasRasterFunction(t.rasterFunction)?t._generateRasterInfo(t.rasterFunction,{signal:e}):null,g=t._getRasterFunctionInfos();return Promise.all([u,p,g]).then(R=>{t._set("rasterInfo",R[1]?R[1]:R[0]),R[2]&&t._set("rasterFunctionInfos",R[2]),t.internalRenderer&&!t._isSupportedRenderer(t.internalRenderer)&&(t._set("internalRenderer",null),c.A.getLogger(t).warn("ArcGISImageService","Switching to the default renderer. Renderer applied is not valid for this Imagery Layer")),t._set("internalRenderer",t._configRenderer(t.renderer)),t.addHandles([(0,pe.wB)(()=>t.rasterFunction,w=>{(t.renderer||t.symbolizer||t.popupEnabled&&t.popupTemplate)&&t._generateRasterInfo(w).then(O=>{O&&(t.rasterInfo=O)})})]);const{serviceRasterInfo:x}=t;null!=x.multidimensionalInfo&&t._updateMultidimensionalDefinition(x)})})()}_combineMosaicRuleWithTimeExtent(e,t){const i=this.timeInfo,{multidimensionalInfo:u}=this.serviceRasterInfo;if(null==e||null==u||null==t||null==i?.startField)return e;const{startField:p}=i,g=u.variables.some(E=>E.dimensions.some(L=>L.name===p))?p:"StdTime";if(e=e.clone(),"mosaic-dataset"===this.sourceType)return e.multidimensionalDefinition=e.multidimensionalDefinition?.filter(E=>E.dimensionName!==g),this._cleanupMultidimensionalDefinition(e);e.multidimensionalDefinition=e.multidimensionalDefinition||[];const R=e.multidimensionalDefinition.filter(E=>E.dimensionName===g),x=null!=t.start?t.start.getTime():null,w=null!=t.end?t.end.getTime():null,O=null==x||null==w||x===w,T=O?[x||w]:[[x,w]],J=this.version>=10.8;if(R.length)R.forEach(E=>{E.dimensionName===g&&(J?(E.dimensionName=null,E.isSlice=!1,E.values=[]):(E.isSlice=O,E.values=T))});else if(!J){const E=e.multidimensionalDefinition.filter(L=>null!=L.variableName&&null==L.dimensionName);E.length?E.forEach(L=>{L.dimensionName=g,L.isSlice=O,L.values=T}):e.multidimensionalDefinition.push(new U.A({variableName:"",dimensionName:g,isSlice:O,values:T}))}return this._cleanupMultidimensionalDefinition(e)}_cleanupMultidimensionalDefinition(e){return null==e?null:(e.multidimensionalDefinition&&(e.multidimensionalDefinition=e.multidimensionalDefinition.filter(t=>!(!t.variableName&&!t.dimensionName)),0===e.multidimensionalDefinition.length&&(e.multidimensionalDefinition=null)),"mosaic-dataset"!==this.sourceType&&null==e.multidimensionalDefinition?null:e)}_prepareForQuery(e,t){var i=this;return(0,v.A)(function*(){if(!(yield i._fetchCapabilities(t?.signal)).operations.supportsQuery)throw new a.A("imagery-layer:query-rasters","query operation is not supported on the input image service");return e=null!=e?(0,_.PZ)(_r.A,e):i.createQuery(),t=i._getRequestOptions(t),i.raster&&(t.query={...t.query,raster:i.raster}),{query:e,requestOptions:t}})()}_initJobHandler(){var e=this;return(0,v.A)(function*(){if(null!=e._rasterJobHandler.connectionPromise)return e._rasterJobHandler.connectionPromise;const t=new Hr.A;e._rasterJobHandler.connectionPromise=t.initialize().then(()=>{e._rasterJobHandler.instance=t},()=>{}),yield e._rasterJobHandler.connectionPromise})()}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this._cachedRendererJson=null}_isSupportedRenderer(e){const{rasterInfo:t,rasterFunction:i}=this;return"unique-value"===e.type&&this._hasRasterFunction(i)&&1===t?.bandCount&&["u8","s8"].includes(t.pixelType)||null!=t&&null!=e&&(0,nt.fp)(t).includes(e.type)}_fetchCapabilities(e){var t=this;return(0,v.A)(function*(){return t.capabilities||(yield t._fetchServiceInfo(e)),t.capabilities})()}_fetchServiceInfo(e){var t=this;return(0,v.A)(function*(){let i=t.sourceJSON;if(!i){const{data:u,ssl:p}=yield(0,b.A)(l(t.parsedUrl),{query:t._getQueryParams(),signal:e});i=u,t.sourceJSON=i,p&&(t.url=t.url.replace(/^http:/i,"https:"))}if(i.capabilities?.toLowerCase().split(",").map(u=>u.trim()).indexOf("tilesonly")>-1)throw new a.A("imagery-layer:fetch-service-info","use ImageryTileLayer to open tiles-only image services");t.read(i,{origin:"service",url:t.parsedUrl})})()}_isMosaicDataset(e){return e.serviceSourceType?"esriImageServiceSourceTypeMosaicDataset"===e.serviceSourceType:e.fields?.length>0}_isMosaicRuleSupported(e){return!!e&&(this._isMosaicDataset(e)||e.currentVersion>=10.71&&e.hasMultidimensions&&!(e.fields?.length>1))}_isVectorFieldResampleFunction(e){if(null==e)return!1;const{functionName:t,functionArguments:i}=e,u="resample"===t?.toLowerCase(),p=i?.ResampleType||i?.resampleType;return u&&(7===p||10===p)}_isPicture(){return!this.format||this.format.includes("jpg")||this.format.includes("png")}_configRenderer(e){const t=this._isPicture(),{rasterInfo:i}=this;if(!t&&!this.pixelFilter||this._isVectorDataSet()){const u=this.mosaicRule?.multidimensionalDefinition?.[0].variableName,p=(0,nt.I8)({variableName:u,rasterFunctionName:this.rasterFunction?.functionName,presetRenderers:this.presetRenderers});if(!this.bandIds&&i.bandCount>=3){const R=p?.bandIds??(0,nt.ci)(i);!R||3===i.bandCount&&0===R[0]&&1===R[1]&&2===R[2]||(this.bandIds=R)}e||(e=p?.renderer??(0,nt.PD)(i,{bandIds:this.bandIds,variableName:this.rasterFunction?null:u}));const g=(0,nt.$P)(e.toJSON());this.symbolizer?(this.symbolizer.rendererJSON=g,this.symbolizer.rasterInfo=i):this.symbolizer=new Qr.A({rendererJSON:g,rasterInfo:i}),this.symbolizer.bind().success||(this.symbolizer=null)}return e}_clonePixelData(e){return null==e?e:{extent:e.extent&&e.extent.clone(),pixelBlock:null!=e.pixelBlock?e.pixelBlock.clone():null}}_getQueryParams(e){null!=e?.renderingRule&&"string"!=typeof e.renderingRule&&(e.renderingRule=this._getRenderingRuleString(e.renderingRule));const{raster:t,viewId:i}=this;return{raster:t,viewId:i,f:"json",...e,...this.customParameters}}_getRequestOptions(e){return{...e,query:{...e?.query,...this.customParameters}}}_decodePixelBlock(e,t,i){return this._rasterJobHandler.instance?this._rasterJobHandler.instance.decode({data:e,options:t}):(0,Nt.D)(e,t,i)}_getRasterFunctionInfos(e){var t=this;return(0,v.A)(function*(){const i=t.sourceJSON.rasterFunctionInfos;return t.loaded?i:i&&t.version>=10.3?1===i.length&&"none"===i[0].name.toLowerCase()?i:(yield(0,b.A)(l(t.parsedUrl)+"/rasterFunctionInfos",{query:t._getQueryParams(),signal:e})).data?.rasterFunctionInfos:null})()}_canRequestImageElement(e){return!this.pixelFilter&&(!e||e.includes("png"))}_requestArrayBuffer(e){var t=this;return(0,v.A)(function*(){const{imageProps:i,requestAsImageElement:u,returnImageBitmap:p,signal:g}=e;if(u&&t._canRequestImageElement(i.format)){const L=`${l(t.parsedUrl)}/exportImage`,{data:$}=yield(0,b.A)(L,{responseType:p?"blob":"image",query:t._getQueryParams({f:"image",...t.refreshParameters,...e.imageServiceParameters}),signal:g});return $ instanceof Blob?{imageBitmap:yield(0,Ar.m)($,L,g),params:i}:{imageOrCanvasElement:$,params:i}}const R=t._initJobHandler(),x=(0,b.A)(l(t.parsedUrl)+"/exportImage",{responseType:"array-buffer",query:t._getQueryParams({f:"image",...e.imageServiceParameters}),signal:g}),w=(yield Promise.all([x,R]))[0].data,O=i.format||"jpgpng";let T=O;if("bsq"!==T&&"bip"!==T&&(T=(0,Nt.g)(w)),!T)throw new a.A("imagery-layer:fetch-image","unsupported format signature "+String.fromCharCode.apply(null,new Uint8Array(w)));const J={signal:g};return{pixelData:{pixelBlock:yield"gif"===O||"bmp"===O||O.includes("png")&&("png"===T||"jpg"===T)?(0,Nt.D)(w,{useCanvas:!0,...i},J):t._decodePixelBlock(w,{width:i.width,height:i.height,planes:null,pixelType:null,noDataValue:null,format:O},J),extent:i.extent},params:i}})()}_generateRasterInfo(e,t){return this.generateRasterInfo(e,t).catch(()=>null)}_isValidCustomizedMosaicRule(e){return e&&JSON.stringify(e.toJSON())!==JSON.stringify(this.defaultMosaicRule?.toJSON())}_updateMultidimensionalDefinition(e){if(this._isValidCustomizedMosaicRule(this.mosaicRule))return;let t=(0,Qe.fy)(e,{multidimensionalSubset:this.multidimensionalSubset});if(null!=t&&t.length>0){this.mosaicRule=this.mosaicRule||new _e.A;const i=this.mosaicRule.multidimensionalDefinition;!this.sourceJSON.defaultVariableName&&this.rasterFunction&&"none"!==this.rasterFunction.functionName?.toLowerCase()&&t.forEach(u=>u.variableName=""),t=t.filter(({variableName:u,dimensionName:p})=>u&&"*"!==u||p),!i?.length&&t.length&&(this.mosaicRule.multidimensionalDefinition=t)}}_processVisibleRastersResponse(e,t){t=t||{};const i=e.value,{templateRRFunctionNames:u,showNoDataRecords:p,returnDomainValues:g,templateFields:R}=t,x=e.processedValues;let w=e.catalogItems?.features,O=e.properties?.Values?.map(k=>k.replaceAll(/ /gi,", "))||[];const T=this.objectIdField||"ObjectId",J="string"==typeof i&&i.toLowerCase().includes("nodata"),E=[];if(i&&!w&&!J){const k={};k[T]=0,O=[i],w=[new A.A({geometry:this.fullExtent,attributes:k})],this.multidimensionalInfo&&"raster-dataset"===this.sourceType&&(0,ue.eS)(this.rasterFields,k,t.effectiveMultidimensionalDefinition)}if(!w)return[];this._updateResponseFieldNames(w,R),J&&!p&&(w=[]);const{itemPixelValue:L,servicePixelValue:$}=ue.F_,H=this.rasterFields.some(k=>k.name===L);for(let k=0;k<w.length;k++){const ee=w[k];if(null!=i){const ce=O[k],re=this.rasterFunction&&x&&x.length>0&&u&&u.length>0&&u.includes(this.rasterFunction.functionName)?x[u.indexOf(this.rasterFunction.functionName)]:i;if("nodata"===ce.toLowerCase()&&!p)continue;H&&(ee.attributes[L]=ce),ee.attributes[$]=re,this._updateFeatureWithMagDirValues(ee,ce);const Y=this.fields&&this.fields.length>0;let le=this.rasterFunction&&null!=this.serviceRasterInfo.attributeTable?Y?ce:i:re;this.rasterFunction||(le=Y?ce:i),this._updateFeatureWithRasterAttributeTableValues(ee,le)}if(ee.sourceLayer=ee.layer=this,g&&this._updateFeatureWithDomainValues(ee),u&&x&&u.length===x.length)for(let ce=0;ce<u.length;ce++)ee.attributes[`${ue.F_.servicePixelValue}.${u[ce]}`]=x[ce];E.push(w[k])}return E}_processMultidimensionalIntersection(e,t,i){const{multidimensionalSubset:u}=this;if(!u)return{isOutSide:!1,timeExtent:t,mosaicRule:i=this._combineMosaicRuleWithTimeExtent(i,t)};if(u){const{isOutside:p,intersection:g}=(0,Qe.Rp)(u,{geometry:e,timeExtent:t});if(p)return{isOutSide:!0,timeExtent:null,mosaicRule:null};null!=g?.timeExtent&&(t=g.timeExtent)}if(i=this._combineMosaicRuleWithTimeExtent(i,t),i?.multidimensionalDefinition){const{isOutside:p}=(0,Qe.Rp)(u,{multidimensionalDefinition:i.multidimensionalDefinition});if(p)return{isOutSide:!0,timeExtent:null,mosaicRule:null}}return{isOutSide:!1,timeExtent:t,mosaicRule:i}}_updateFeatureWithRasterAttributeTableValues(e,t){const i=this.rasterInfo.attributeTable||this.serviceRasterInfo.attributeTable;if(null==i)return;const{features:u,fields:p}=i,g=p.map(x=>x.name).find(x=>"value"===x.toLowerCase());if(!g)return;const R=u.filter(x=>x.attributes[g]===(null!=t?parseInt(t,10):null));R&&R[0]&&p.forEach(x=>{e.attributes[ue.ER+x.name]=R[0].attributes[x.name]})}_updateFeatureWithMagDirValues(e,t){if(!this._isVectorDataSet())return;const i=t.split(/,\s*/).map(x=>parseFloat(x)),u=i.map(x=>[x]),p=i.map(x=>({minValue:x,maxValue:x,noDataValue:null})),g=new jt.A({height:1,width:1,pixelType:"f32",pixels:u,statistics:p});null!=this.pixelFilter&&this.pixelFilter({pixelBlock:g,extent:new G.A(0,0,0,0,this.spatialReference)});const R="esriImageServiceDataTypeVector-MagDir"===this.serviceDataType?[g.pixels[0][0],g.pixels[1][0]]:(0,Kr.Lu)([g.pixels[0][0],g.pixels[1][0]]);e.attributes[ue.F_.magnitude]=R[0],e.attributes[ue.F_.direction]=R[1]}_updateFeatureWithDomainValues(e){const t=this.fields&&this.fields.filter(i=>i.domain&&"coded-value"===i.domain.type);t?.forEach(i=>{const u=e.attributes[i.name];if(null!=u){const p=i.domain.codedValues.find(g=>g.code===u);p&&(e.attributes[i.name]=p.name)}})}_updateResponseFieldNames(e,t){if(!t||t.length<1)return;const i=this.fieldsIndex;null!=i&&e.forEach(u=>{if(u?.attributes)for(const p of t){const g=i.get(p)?.name;g&&g!==p&&(u.attributes[p]=u.attributes[g],delete u.attributes[g])}})}_getRenderingRuleString(e){if(e){let t=e.toJSON();return t=t.rasterFunctionDefinition??t,(t.thumbnail||t.thumbnailEx)&&(t.thumbnail=t.thumbnailEx=null),JSON.stringify(t)}return null}_hasRasterFunction(e){return null!=e?.functionName&&"none"!==e.functionName.toLowerCase()}_updateRenderingRulesFunctionName(e,t){if(!e||e.length<1)return;if("Raw"===e)return e.replace("Raw","None");const i=e.toLowerCase().replaceAll(/ /gi,"_");return t.has(i)?t.get(i):e}_isRFTJson(e){return e?.name&&e.arguments&&e.function&&e.hasOwnProperty("functionType")}_isVectorDataSet(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType}_applyMosaicAndRenderingRules(e){const{raster:t,mosaicRule:i,rasterFunction:u}=this;u&&null==e.rasterFunction&&(e.rasterFunction=u),i&&null==e.mosaicRule&&(e.mosaicRule=i),t&&null==e.raster&&(e.raster=t)}_applyMosaicRule(e){const{raster:t,mosaicRule:i}=this;i&&null==e.mosaicRule&&(e.mosaicRule=i),t&&null==e.raster&&(e.raster=t)}_readCapabilities(e){const t=e.capabilities?e.capabilities.toLowerCase().split(",").map(H=>H.trim()):["image","catalog"],{currentVersion:i,advancedQueryCapabilities:u,maxRecordCount:p}=e,g=t.includes("image"),R="esriImageServiceDataTypeElevation"===e.serviceDataType,x=!(!e.spatialReference&&!e.extent?.spatialReference),w=t.includes("edit"),O=t.includes("mensuration")&&x,T=null==e.mensurationCapabilities?[]:e.mensurationCapabilities.toLowerCase().split(",").map(H=>H.trim()),J=O&&T.includes("basic"),E=this._isMosaicDataset(e)&&t.includes("catalog"),L=t.includes("download"),$=i>=10.7&&R||i>=11.4&&(R||O&&T.includes("3d"));return{data:{supportsAttachment:!1},operations:{supportsComputeHistograms:g,supportsExportImage:g,supportsIdentify:g,supportsImageToMap:i>=11.2&&E,supportsImageToMapMultiray:i>=11.2&&E,supportsMapToImage:i>=11.2&&E,supportsFindImages:i>=11.2&&E,supportsGetImageUrl:i>=11.3&&L,supportsMeasure:O,supportsMeasureFromImage:i>=11.2,supportsDownload:L,supportsQuery:E&&e.fields&&e.fields.length>0,supportsGetSamples:i>=10.2&&g,supportsProject:i>=10.3&&g,supportsComputeStatisticsHistograms:i>=10.4&&g,supportsQueryBoundary:i>=10.6&&g,supportsCalculateVolume:$,supportsComputePixelLocation:i>=10.7&&E,supportsComputeAngles:i>=10.91,supportsQueryGPSInfo:i>=11.2&&E,supportsAdd:w,supportsDelete:w,supportsEditing:w,supportsUpdate:w,supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsChangeTracking:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsExceedsLimitStatistics:!1,supportsQueryAnalytics:!1,supportsQueryBins:!1,supportsQueryTopFeatures:!1,supportsAsyncConvert3D:!1},query:{maxRecordCount:p,maxRecordCountFactor:void 0,supportsStatistics:!!u?.supportsStatistics,supportsOrderBy:!!u?.supportsOrderBy,supportsDistinct:!!u?.supportsDistinct,supportsPagination:!!u?.supportsPagination,supportsStandardizedQueriesOnly:!!u?.useStandardizedQueries,supportsPercentileStatistics:!!u?.supportsPercentileStatistics,supportsCentroid:!!u?.supportsReturningGeometryCentroid,supportsCurrentUser:!1,supportsDistance:!!u?.supportsQueryWithDistance,supportsExtent:!!u?.supportsReturningQueryExtent,supportsGeometryProperties:!!u?.supportsReturningGeometryProperties,supportsHavingClause:!!u?.supportsHavingClause,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsReturnMesh:!1,supportsMaxRecordCountFactor:!1,supportsSqlExpression:!1,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!1,supportsCacheHint:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!!u?.supportsDefaultSR,supportsFullTextSearch:!1,supportsCompactGeometry:!1,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0,supportsTrueCurve:!1},mensuration:{supportsDistanceAndAngle:J,supportsAreaAndPerimeter:J,supportsPointOrCentroid:J,supportsHeightFromBaseAndTop:O&&T.includes("base-top height"),supportsHeightFromBaseAndTopShadow:O&&T.includes("base-top shadow height"),supportsHeightFromTopAndTopShadow:O&&T.includes("top-top shadow height"),supports3D:O&&T.includes("3d")}}}};function l(e){return e?.path??""}return(0,s._)([(0,o.MZ)({clonable:!1})],r.prototype,"_functionRasterInfos",void 0),(0,s._)([(0,o.MZ)({clonable:!1})],r.prototype,"_rasterJobHandler",void 0),(0,s._)([(0,o.MZ)({clonable:!1})],r.prototype,"_cachedRendererJson",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"_serviceSupportsMosaicRule",void 0),(0,s._)([(0,C.w)("_serviceSupportsMosaicRule",["currentVersion","fields"])],r.prototype,"readServiceSupportsMosaicRule",null),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"_rasterFunctionNamesIndex",null),(0,s._)([(0,o.MZ)()],r.prototype,"adjustAspectRatio",void 0),(0,s._)([(0,o.MZ)({type:[_.jz],json:{write:!0}})],r.prototype,"bandIds",void 0),(0,s._)([(0,C.w)("bandIds")],r.prototype,"readBandIds",null),(0,s._)([(0,o.MZ)({readOnly:!0,json:{read:!1}})],r.prototype,"capabilities",void 0),(0,s._)([(0,C.w)("service","capabilities",["capabilities","currentVersion","serviceDataType"])],r.prototype,"readCapabilities",null),(0,s._)([(0,o.MZ)({type:Number})],r.prototype,"compressionQuality",void 0),(0,s._)([(0,h.K)("compressionQuality")],r.prototype,"writeCompressionQuality",null),(0,s._)([(0,o.MZ)({type:Number})],r.prototype,"compressionTolerance",void 0),(0,s._)([(0,h.K)("compressionTolerance")],r.prototype,"writeCompressionTolerance",null),(0,s._)([(0,o.MZ)({json:{read:{source:"copyrightText"}}})],r.prototype,"copyright",void 0),(0,s._)([(0,o.MZ)({readOnly:!0,dependsOn:["_serviceSupportsMosaicRule"]})],r.prototype,"defaultMosaicRule",void 0),(0,s._)([(0,C.w)("defaultMosaicRule",["defaultMosaicMethod"])],r.prototype,"readDefaultMosaicRule",null),(0,s._)([(0,o.MZ)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],r.prototype,"definitionExpression",void 0),(0,s._)([(0,o.MZ)({readOnly:!0,constructOnly:!0})],r.prototype,"exportImageServiceParameters",void 0),(0,s._)([(0,o.MZ)()],r.prototype,"rasterInfo",void 0),(0,s._)([(0,o.MZ)({readOnly:!0,type:[Gr.A]})],r.prototype,"fields",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"fieldsIndex",null),(0,s._)([(0,o.MZ)({type:["png","png8","png24","png32","jpg","bmp","gif","jpgpng","lerc","tiff","bip","bsq"],json:{write:!0}})],r.prototype,"format",null),(0,s._)([(0,C.w)("service","format",["serviceDataType"])],r.prototype,"readFormat",null),(0,s._)([(0,o.MZ)({type:G.A})],r.prototype,"fullExtent",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"hasMultidimensions",void 0),(0,s._)([(0,o.MZ)({json:{read:{source:"maxImageHeight"}}})],r.prototype,"imageMaxHeight",void 0),(0,s._)([(0,o.MZ)({json:{read:{source:"maxImageWidth"}}})],r.prototype,"imageMaxWidth",void 0),(0,s._)([(0,o.MZ)({type:String,json:{type:ae.SZ.jsonValues,read:ae.SZ.read,write:ae.SZ.write}})],r.prototype,"interpolation",void 0),(0,s._)([(0,o.MZ)()],r.prototype,"minScale",void 0),(0,s._)([(0,C.w)("service","minScale")],r.prototype,"readMinScale",null),(0,s._)([(0,o.MZ)()],r.prototype,"maxScale",void 0),(0,s._)([(0,C.w)("service","maxScale")],r.prototype,"readMaxScale",null),(0,s._)([(0,o.MZ)({type:_e.A})],r.prototype,"mosaicRule",null),(0,s._)([(0,C.w)("mosaicRule",["mosaicRule","defaultMosaicMethod"])],r.prototype,"readMosaicRule",null),(0,s._)([(0,h.K)("mosaicRule")],r.prototype,"writeMosaicRule",null),(0,s._)([(0,o.MZ)()],r.prototype,"multidimensionalInfo",void 0),(0,s._)([(0,o.MZ)({type:Wr.A,json:{write:!0}})],r.prototype,"multidimensionalSubset",void 0),(0,s._)([(0,o.MZ)({json:{type:_.jz}})],r.prototype,"noData",void 0),(0,s._)([(0,h.K)("noData")],r.prototype,"writeNoData",null),(0,s._)([(0,o.MZ)({type:String,json:{type:ae.hm.jsonValues,read:ae.hm.read,write:ae.hm.write}})],r.prototype,"noDataInterpretation",void 0),(0,s._)([(0,o.MZ)({type:String,readOnly:!0,json:{read:{source:["fields"]}}})],r.prototype,"objectIdField",void 0),(0,s._)([(0,C.w)("objectIdField")],r.prototype,"readObjectIdField",null),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"geometryType",void 0),(0,s._)([(0,o.MZ)({})],r.prototype,"typeIdField",void 0),(0,s._)([(0,o.MZ)({})],r.prototype,"types",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"parsedUrl",null),(0,s._)([(0,o.MZ)({type:Function})],r.prototype,"pixelFilter",void 0),(0,s._)([(0,o.MZ)()],r.prototype,"raster",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"sourceType",void 0),(0,s._)([(0,C.w)("sourceType",["serviceSourceType","fields"])],r.prototype,"readSourceType",null),(0,s._)([(0,o.MZ)()],r.prototype,"viewId",void 0),(0,s._)([(0,o.MZ)()],r.prototype,"renderer",null),(0,s._)([(0,o.MZ)({types:Ct.uy,json:{name:"layerDefinition.drawingInfo.renderer",origins:{"web-scene":{types:Ct.Gj,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:e=>({enabled:e&&"vector-field"!==e.type&&"flow"!==e.type})}}}}})],r.prototype,"internalRenderer",null),(0,s._)([(0,C.w)("internalRenderer")],r.prototype,"readRenderer",null),(0,s._)([(0,h.K)("internalRenderer")],r.prototype,"writeRenderer",null),(0,s._)([(0,o.MZ)({clonable:!1})],r.prototype,"symbolizer",void 0),(0,s._)([(0,o.MZ)(P.ke)],r.prototype,"opacity",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"rasterFields",null),(0,s._)([(0,o.MZ)({constructOnly:!0})],r.prototype,"rasterFunctionInfos",void 0),(0,s._)([(0,o.MZ)({type:M.A,json:{name:"renderingRule"}})],r.prototype,"rasterFunction",null),(0,s._)([(0,C.w)("rasterFunction",["renderingRule","rasterFunctionInfos"])],r.prototype,"readRasterFunction",null),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"serviceDataType",void 0),(0,s._)([(0,o.MZ)({readOnly:!0,type:q.A})],r.prototype,"spatialReference",void 0),(0,s._)([(0,C.w)("spatialReference",["spatialReference","extent"])],r.prototype,"readSpatialReference",null),(0,s._)([(0,o.MZ)({type:ae.e8.apiValues,json:{read:ae.e8.read,type:ae.e8.jsonValues}})],r.prototype,"pixelType",void 0),(0,s._)([(0,h.K)("pixelType")],r.prototype,"writePixelType",null),(0,s._)([(0,o.MZ)({constructOnly:!0,type:Mr.A})],r.prototype,"serviceRasterInfo",void 0),(0,s._)([(0,o.MZ)()],r.prototype,"sourceJSON",void 0),(0,s._)([(0,o.MZ)(P.OZ)],r.prototype,"url",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],r.prototype,"version",void 0),(0,s._)([(0,C.w)("version",["currentVersion","fields","timeInfo"])],r.prototype,"readVersion",null),r=(0,s._)([(0,y.$)("esri.layers.mixins.ArcGISImageService")],r),r};var ms=m(25936),cs=m(93410),ds=m(23e3),ys=m(17049),hs=m(85551),gs=m(29252),fs=m(1151),_s=m(33036),vs=m(84311),Rs=m(5540),Ss=m(41843),Tt=m(71655);let fe=class extends((0,cs.dM)((0,vs.e)((0,_s.j)((0,ys.q)((0,hs.A)((0,gs.H)(ps((0,fs.J)((0,ds.d)((0,ms.b)((0,D.P)(f.A.ClonableMixin(F.A))))))))))))){constructor(...n){var r;super(...n),r=this,this.isReference=null,this.operationalLayerType="ArcGISImageServiceLayer",this.popupEnabled=!0,this.popupTemplate=null,this.type="imagery",this._debouncedSaveOperations=(0,N.sg)(function(){var l=(0,v.A)(function*(e,t,i){const{save:u,saveAs:p}=yield m.e(3518).then(m.bind(m,23518));switch(e){case Tt.X.SAVE:return u(r,t);case Tt.X.SAVE_AS:return p(r,i,t)}});return function(e,t,i){return l.apply(this,arguments)}}())}normalizeCtorArgs(n,r){return"string"==typeof n?{url:n,...r}:n}load(n){const r=null!=n?n.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},n).catch(N.QP).then(()=>this._fetchService(r))),Promise.resolve(this)}get legendEnabled(){return!this._isPreviewLayer&&(this._get("legendEnabled")??!0)}set legendEnabled(n){this._set("legendEnabled",n)}get listMode(){return this._isPreviewLayer?"hide":this._get("listMode")}set listMode(n){this._set("listMode",n)}writeOperationalLayerType(n,r,l){r[l]="vector-field"===this.renderer?.type?"ArcGISImageServiceVectorLayer":"ArcGISImageServiceLayer"}get defaultPopupTemplate(){return this.createPopupTemplate()}get _isPreviewLayer(){return!(!this.raster||!this.url?.toLowerCase().includes("/rasterrendering/imageserver"))}createPopupTemplate(n){const{rasterFields:r}=this,l=new Set,e=ue.F_.itemPixelValue.toLowerCase(),t="raster-dataset"===this.sourceType,i=ue.Oo.toLowerCase(),u=`${ue.F_.servicePixelValue.toLowerCase()}.`;for(const R of r){const x=R.name.toLowerCase();x===e||x.startsWith(u)||t&&x.startsWith(i)||l.add(R.name)}const p=(0,Ss.tn)({fields:r,title:this.title},{...n,visibleFieldNames:l}),{rasterInfo:g}=this;return p?.fieldInfos&&g&&(0,ue.h4)(p.fieldInfos,g),p}queryFeatures(n,r){return this.queryRasters(n,r).then(l=>{if(l?.features)for(const e of l.features)e.layer=e.sourceLayer=this;return l})}queryFeatureCount(n,r){return this.queryRasterCount(n,r)}redraw(){this.emit("redraw")}save(n){var r=this;return(0,v.A)(function*(){return r._debouncedSaveOperations(Tt.X.SAVE,n)})()}saveAs(n,r){var l=this;return(0,v.A)(function*(){return l._debouncedSaveOperations(Tt.X.SAVE_AS,r,n)})()}serviceSupportsSpatialReference(n){return(0,Rs.D)(this,n)}write(n,r){return this._isPreviewLayer?(r?.messages&&r.messages.push(new a.A("layer:unsupported",`Imagery preview layer (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${r.origin}/${r.layerContainerType||"operational-layers"}'`,{layer:this})),null):super.write(n,r)}};(0,s._)([(0,o.MZ)(P.fV)],fe.prototype,"legendEnabled",null),(0,s._)([(0,o.MZ)({type:["show","hide"]})],fe.prototype,"listMode",null),(0,s._)([(0,o.MZ)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],fe.prototype,"isReference",void 0),(0,s._)([(0,o.MZ)({type:["ArcGISImageServiceLayer"],json:{origins:{"web-map":{type:["ArcGISImageServiceLayer","ArcGISImageServiceVectorLayer"],read:!1,write:{target:"layerType",ignoreOrigin:!0}}}}})],fe.prototype,"operationalLayerType",void 0),(0,s._)([(0,h.K)("web-map","operationalLayerType")],fe.prototype,"writeOperationalLayerType",null),(0,s._)([(0,o.MZ)(P.M6)],fe.prototype,"popupEnabled",void 0),(0,s._)([(0,o.MZ)({type:j.A,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],fe.prototype,"popupTemplate",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],fe.prototype,"defaultPopupTemplate",null),(0,s._)([(0,o.MZ)({readOnly:!0,json:{read:!1}})],fe.prototype,"type",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],fe.prototype,"_isPreviewLayer",null),fe=(0,s._)([(0,y.$)("esri.layers.ImageryLayer")],fe);const Is=fe},42086:(de,K,m)=>{m.d(K,{N3:()=>a,Om:()=>f});var v=m(11445),s=m(27999),j=m(13682);class f{constructor(o=null,S={},c,d,y=0){this.geometry=o,this.attributes=S,this.centroid=c,this.objectId=d,this.displayId=y}static fromJSON(o){const S=o.geometry?j.A.fromJSON(o.geometry):null,c=o.centroid?j.A.fromJSON(o.centroid):null;return new f(S,o.attributes,c,o.objectId)}weakClone(){const o=new f(this.geometry,this.attributes,this.centroid,this.objectId);return o.displayId=this.displayId,o}clone(){const o=this.geometry?.clone(),S=new f(o,{...this.attributes},this.centroid?.clone(),this.objectId);return S.displayId=this.displayId,S}ensureCentroid(o){return this.centroid??=(0,s.Q)(new j.A,this.geometry,o.hasZ,o.hasM),this.centroid}get usedMemory(){return 128+(0,v.lM)(this.attributes)+(this.geometry?.usedMemory??0)}}function a(N){return!!N.geometry?.coords?.length}},61808:(de,K,m)=>{m.d(K,{A:()=>v});class v{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const j=new v;return j.objectIdFieldName=this.objectIdFieldName,j.globalIdFieldName=this.globalIdFieldName,j.geohashFieldName=this.geohashFieldName,j.geometryProperties=this.geometryProperties,j.geometryType=this.geometryType,j.spatialReference=this.spatialReference,j.hasZ=this.hasZ,j.hasM=this.hasM,j.features=this.features,j.fields=this.fields,j.transform=this.transform,j.exceededTransferLimit=this.exceededTransferLimit,j.uniqueIdField=this.uniqueIdField,j.queryGeometry=this.queryGeometry,j.queryGeometryType=this.queryGeometryType,j}}},13682:(de,K,m)=>{m.d(K,{A:()=>j});var v=m(11445);class j{constructor(a=[],D=[]){this.lengths=a??[],this.coords=D??[]}static fromJSON(a){return new j(a.lengths,a.coords)}static fromRect(a){const[D,N,o,S]=a,c=o-D,d=S-N;return new j([5],[D,N,c,0,0,d,-c,0,0,-d])}get isPoint(){return 0===this.lengths.length&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((a,D)=>a+D)}get usedMemory(){return 64+(0,v.Qf)(this.lengths,this.coords)}area(){let a=0,D=0;if(!this.lengths.length)return 0;for(let N=0;N<this.lengths.length;N++){const o=this.lengths[N];if(o<3)continue;let S=this.coords[2*D],c=this.coords[2*D+1];for(let d=1;d<o;d+=1){const y=this.coords[2*(d+D)],h=this.coords[2*(d+D)+1];a+=-.5*(y-S)*(h+c),S=y,c=h}D+=o}return a}forEachVertex(a){let D=0;this.lengths.length||a(this.coords[0],this.coords[1]);for(let N=0;N<this.lengths.length;N++){const o=this.lengths[N];for(let S=0;S<o;S++)a(this.coords[2*(S+D)],this.coords[2*(S+D)+1]);D+=o}}deltaDecode(){const a=this.clone(),{coords:D,lengths:N}=a;let o=0;for(const S of N){for(let c=1;c<S;c++)D[2*(o+c)]+=D[2*(o+c)-2],D[2*(o+c)+1]+=D[2*(o+c)-1];o+=S}return a}clone(a){if(0===this.lengths.length)return new j([],[this.coords[0],this.coords[1]]);const D=2*(0===this.lengths.length?1:this.lengths.reduce((o,S)=>o+S)),N=this.coords.slice(0,D);return a?(a.set(N),new j(this.lengths,a)):new j(Array.from(this.lengths),Array.from(N))}}},27999:(de,K,m)=>{function v(S,c){return S?c?4:3:c?3:2}function s(S,c,d,y){if(!c?.lengths.length)return null;S.lengths.length&&(S.lengths.length=0),S.coords.length&&(S.coords.length=0);const h=S.coords,F=[],A=d?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:b,coords:V}=c,pe=v(d,y);let W=0;for(const _ of b){const C=j(A,V,W,_,d,y);C&&F.push(C),W+=_*pe}if(F.sort((_,C)=>{let G=_[2]-C[2];return 0===G&&d&&(G=_[4]-C[4]),G}),F.length){let _=6*F[0][2];h[0]=F[0][0]/_,h[1]=F[0][1]/_,d&&(_=6*F[0][4],h[2]=0!==_?F[0][3]/_:0),(h[0]<A[0]||h[0]>A[1]||h[1]<A[2]||h[1]>A[3]||d&&(h[2]<A[4]||h[2]>A[5]))&&(h.length=0)}if(!h.length){const _=c.lengths[0]?function f(S,c,d,y,h){const F=v(y,h);let A=c,b=c+F,V=0,pe=0,W=0,_=0;for(let C=0,G=d-1;C<G;C++,A+=F,b+=F){const B=S[A],q=S[A+1],Z=S[A+2],P=S[b],U=S[b+1],I=S[b+2],M=y?D(B,q,Z,P,U,I):a(B,q,P,U);if(M)if(V+=M,y){const X=o(B,q,Z,P,U,I);pe+=M*X[0],W+=M*X[1],_+=M*X[2]}else{const X=N(B,q,P,U);pe+=M*X[0],W+=M*X[1]}}return V>0?y?[pe/V,W/V,_/V]:[pe/V,W/V]:d>0?y?[S[c],S[c+1],S[c+2]]:[S[c],S[c+1]]:null}(V,0,b[0],d,y):null;if(!_)return null;h[0]=_[0],h[1]=_[1],d&&_.length>2&&(h[2]=_[2])}return S}function j(S,c,d,y,h,F){const A=v(h,F);let b=d,V=d+A,pe=0,W=0,_=0,C=0,G=0;for(let q=0,Z=y-1;q<Z;q++,b+=A,V+=A){const P=c[b],U=c[b+1],I=c[b+2],M=c[V],X=c[V+1],me=c[V+2];let oe=P*X-M*U;C+=oe,pe+=(P+M)*oe,W+=(U+X)*oe,h&&(oe=P*me-M*I,_+=(I+me)*oe,G+=oe),P<S[0]&&(S[0]=P),P>S[1]&&(S[1]=P),U<S[2]&&(S[2]=U),U>S[3]&&(S[3]=U),h&&(I<S[4]&&(S[4]=I),I>S[5]&&(S[5]=I))}if(C>0&&(C*=-1),G>0&&(G*=-1),!C)return null;const B=[pe,W,.5*C];return h&&(B[3]=_,B[4]=.5*G),B}function a(S,c,d,y){const h=d-S,F=y-c;return Math.sqrt(h*h+F*F)}function D(S,c,d,y,h,F){const A=y-S,b=h-c,V=F-d;return Math.sqrt(A*A+b*b+V*V)}function N(S,c,d,y){return[S+.5*(d-S),c+.5*(y-c)]}function o(S,c,d,y,h,F){return[S+.5*(y-S),c+.5*(h-c),d+.5*(F-d)]}m.d(K,{Q:()=>s})},73258:(de,K,m)=>{m.d(K,{A:()=>F});var v=m(5922),s=m(71065),j=m(35150),f=m(60797),a=m(24098),D=m(86300),N=m(20543),o=m(22639),S=m(44549);const h=new Map;class F{static fromJSON(_){return new F(_.fields,_.timeZoneByFieldName)}static fromLayer(_){return new F(_.fields??[],pe(_))}static fromLayerJSON(_){return new F(_.fields??[],pe(_))}constructor(_=[],C){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=_||[],this._timeZoneByFieldName=C?new Map(C):null;const G=[];for(const B of this.fields){const q=B?.name,Z=b(q);if(q&&Z){const P=A(q);this._fieldsMap.set(q,B),this._fieldsMap.set(P,B),this._normalizedFieldsMap.set(Z,B),G.push(`${P}:${B.type}:${this._timeZoneByFieldName?.get(q)}`),(0,D.vE)(B)?(this.dateFields.push(B),this._dateFieldsSet.add(B)):(0,D.WA)(B)&&(this._numericFieldsSet.add(B),this.numericFields.push(B)),(0,D.te)(B)||(0,D.Xz)(B)||(B.editable=null==B.editable||!!B.editable,B.nullable=null==B.nullable||!!B.nullable)}}G.sort(),this.uid=G.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const _ of this.fields)(0,D.te)(_)||(0,D.Xz)(_)||_.nullable||void 0!==(0,D.lD)(_)||this._requiredFields.push(_)}return this._requiredFields}equals(_){return this.uid===_?.uid}has(_){return null!=this.get(_)}get(_){if(!_)return;let C=this._fieldsMap.get(_);return C||(C=this._fieldsMap.get(A(_))??this._normalizedFieldsMap.get(b(_)),C&&this._fieldsMap.set(_,C),C)}getTimeZone(_){const C=this.get(_&&"string"!=typeof _?_.name:_);return C?this._timeZoneByFieldName?this._timeZoneByFieldName.get(C.name):"date"===C.type||"esriFieldTypeDate"===C.type?(j.A.getLogger("esri.layers.support.FieldsIndex").errorOnce(new v.A("getTimeZone:no-timezone-information",`no time zone information for field '${C.name}'`)),N.n$):V.has(C.type)?N.L5:null:null}getLuxonTimeZone(_){const C=this.getTimeZone(_);return C?C===N.L5?a.GB.instance:C===N.n$?S.mQ.utcInstance:(0,f.tE)(h,C,()=>S.oh.create(C)):null}isDateField(_){return this._dateFieldsSet.has(this.get(_))}isTimeOnlyField(_){return(0,D.OH)(this.get(_))}isNumericField(_){return this._numericFieldsSet.has(this.get(_))}normalizeFieldName(_){return this.get(_)?.name??void 0}toJSON(){return{fields:this.fields.map(_=>s.A.isSerializable(_)?_.toJSON():_),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function A(W){return W.trim().toLowerCase()}function b(W){return(0,D.rS)(W)?.toLowerCase()??""}const V=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function pe(W){const _=new Map;if(!W.fields)return _;const C=!0===W.datesInUnknownTimezone,{timeInfo:G,editFieldsInfo:B}=W,q=(G?"startField"in G?G.startField:G.startTimeField:"")??"",Z=(G?"endField"in G?G.endField:G.endTimeField:"")??"",P=function y(W){return"dateFieldsTimeZone"in W}(W)?W.dateFieldsTimeZone??null:W.dateFieldsTimeReference?(0,o.ZS)(W.dateFieldsTimeReference):null,U=B?function c(W){return"timeZone"in W}(B)?B.timeZone??P:B.dateFieldsTimeReference?(0,o.ZS)(B.dateFieldsTimeReference):P??N.n$:null,I=G?function d(W){return"timeZone"in W}(G)?G.timeZone??P:G.timeReference?(0,o.ZS)(G.timeReference):P:null,M=new Map([[A(B?.creationDateField??""),U],[A(B?.editDateField??""),U],[A(q),I],[A(Z),I]]);for(const{name:X,type:me}of W.fields)if(V.has(me))_.set(X,N.L5);else if("date"!==me&&"esriFieldTypeDate"!==me)_.set(X,null);else if(C)_.set(X,N.L5);else{const oe=M.get(A(X??""))??P;_.set(X,oe)}return _}},63014:(de,K,m)=>{m.d(K,{C:()=>D,m:()=>f});var v=m(10467),s=m(5922),j=m(56492);function f(o,S,c){return a.apply(this,arguments)}function a(){return(a=(0,v.A)(function*(o,S,c){let d;try{d=yield createImageBitmap(o)}catch(y){throw new s.A("request:server",`Unable to load ${S}`,{url:S,error:y})}return(0,j.Te)(c),d})).apply(this,arguments)}function D(o,S,c,d,y){return N.apply(this,arguments)}function N(){return(N=(0,v.A)(function*(o,S,c,d,y){let h;try{h=yield createImageBitmap(o)}catch(F){throw new s.A("request:server",`Unable to load tile ${S}/${c}/${d}`,{error:F,level:S,row:c,col:d})}return(0,j.Te)(y),h})).apply(this,arguments)}},5540:(de,K,m)=>{m.d(K,{D:()=>j});var v=m(68438);const s=[];function j(f,a){if((0,v.Wo)(f.url??""))return!0;const{wkid:D}=a;for(const N of s){if((f.version??0)>=N[0])return!0;if("function"==typeof N[1]&&(N[1]=N[1]()),N[1].has(D))return!1}return!0}s.push([10.91,()=>{const f=new Set([9709,9716,9741,9761,9766]);for(let a=9712;a<=9713;a++)f.add(a);for(let a=9748;a<=9749;a++)f.add(a);for(let a=20904;a<=20932;a++)f.add(a);for(let a=21004;a<=21032;a++)f.add(a);for(let a=21207;a<=21264;a++)f.add(a);for(let a=21307;a<=21364;a++)f.add(a);for(let a=23301;a<=23333;a++)f.add(a);for(let a=102759;a<=102760;a++)f.add(a);for(let a=102934;a<=102955;a++)f.add(a);return f}]),s.push([10.9,()=>{const f=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let a=9356;a<=9360;a++)f.add(a);for(let a=9404;a<=9407;a++)f.add(a);for(let a=9476;a<=9482;a++)f.add(a);for(let a=9487;a<=9494;a++)f.add(a);for(let a=9697;a<=9699;a++)f.add(a);return f}]),s.push([10.81,()=>{const f=new Set([9265,9333,103598,103699]);for(let a=9248;a<=9254;a++)f.add(a);for(let a=9271;a<=9273;a++)f.add(a);for(let a=9284;a<=9285;a++)f.add(a);for(let a=21453;a<=21463;a++)f.add(a);return f}]),s.push([10.8,()=>{const f=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let a=8035;a<=8036;a++)f.add(a);for(let a=8455;a<=8456;a++)f.add(a);for(let a=8518;a<=8529;a++)f.add(a);for(let a=8533;a<=8536;a++)f.add(a);for(let a=8538;a<=8540;a++)f.add(a);for(let a=8677;a<=8679;a++)f.add(a);for(let a=8902;a<=8903;a++)f.add(a);for(let a=8907;a<=8910;a++)f.add(a);for(let a=8949;a<=8951;a++)f.add(a);for(let a=8972;a<=8987;a++)f.add(a);for(let a=9039;a<=9040;a++)f.add(a);for(let a=9068;a<=9069;a++)f.add(a);for(let a=9140;a<=9141;a++)f.add(a);for(let a=9148;a<=9150;a++)f.add(a);for(let a=9153;a<=9159;a++)f.add(a);for(let a=9205;a<=9218;a++)f.add(a);for(let a=9221;a<=9222;a++)f.add(a);for(let a=54098;a<=54101;a++)f.add(a);return f}]),s.push([10.71,()=>{const f=new Set([6316]);for(let a=8351;a<=8353;a++)f.add(a);for(let a=9294;a<=9297;a++)f.add(a);for(let a=22619;a<=22621;a++)f.add(a);for(let a=103586;a<=103594;a++)f.add(a);return f}])},1832:(de,K,m)=>{function v(s){const j={};for(const f in s){if("declaredClass"===f)continue;const a=s[f];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){j[f]=[];for(let D=0;D<a.length;D++)j[f][D]=v(a[D])}else"object"==typeof a?a.toJSON&&(j[f]=JSON.stringify(a)):j[f]=a}return j}m.d(K,{z:()=>v})},33063:(de,K,m)=>{m.d(K,{I:()=>a});var v=m(10467),s=m(68800),j=m(1277),f=m(87086);function a(N,o,S){return D.apply(this,arguments)}function D(){return(D=(0,v.A)(function*(N,o,S){const c=(0,s.Dl)(N),{data:d}=yield(0,j.gW)(c,f.A.from(o),S);return d.count})).apply(this,arguments)}},87342:(de,K,m)=>{m.d(K,{V:()=>a});var v=m(10467),s=m(68800),j=m(1277),f=m(87086);function a(N,o,S){return D.apply(this,arguments)}function D(){return(D=(0,v.A)(function*(N,o,S){const c=(0,s.Dl)(N),{data:d}=yield(0,j.Pk)(c,f.A.from(o),S);return d.objectIds??[]})).apply(this,arguments)}},34687:(de,K,m)=>{m.d(K,{e:()=>o,s:()=>D});var v=m(10467),s=m(68800),j=m(1277),f=m(93327),a=m(87086);function D(c,d,y){return N.apply(this,arguments)}function N(){return(N=(0,v.A)(function*(c,d,y){const h=yield o(c,d,y);return f.A.fromJSON(h)})).apply(this,arguments)}function o(c,d,y){return S.apply(this,arguments)}function S(){return(S=(0,v.A)(function*(c,d,y){const h=(0,s.Dl)(c),F={...y},A=a.A.from(d),{data:b}=yield(0,j.eW)(h,A,A.sourceSpatialReference,F);return b})).apply(this,arguments)}},1277:(de,K,m)=>{m.d(K,{IJ:()=>A,Jf:()=>_,Pk:()=>pe,eW:()=>h,gW:()=>W,kS:()=>V});var v=m(10467),s=m(89563),j=m(45272),f=m(61320),a=m(77098),D=m(58701),N=m(1832),o=m(78304),S=m(98789);const c="Layer does not support extent calculation.";function y(Z,P){const U=Z.geometry,I=Z.toJSON();delete I.compactGeometryEnabled,delete I.defaultSpatialReferenceEnabled;const M=I;let X,me,oe;if(null!=U&&(me=U.spatialReference,oe=(0,D.YX)(me),M.geometryType=(0,f.$B)(U),M.geometry=function d(Z,P){if(P&&"extent"===Z.type)return`${Z.xmin},${Z.ymin},${Z.xmax},${Z.ymax}`;if(P&&"point"===Z.type)return`${Z.x},${Z.y}`;const U=Z.toJSON();return delete U.spatialReference,JSON.stringify(U)}(U,Z.compactGeometryEnabled),M.inSR=oe),I.groupByFieldsForStatistics&&(M.groupByFieldsForStatistics=I.groupByFieldsForStatistics.join(",")),I.objectIds&&(M.objectIds=I.objectIds.join(",")),I.orderByFields&&(M.orderByFields=I.orderByFields.join(",")),!I.outFields||!I.returnDistinctValues&&(P?.returnCountOnly||P?.returnExtentOnly||P?.returnIdsOnly)?delete M.outFields:M.outFields=I.outFields.includes("*")?"*":I.outFields.join(","),I.outSR?(M.outSR=(0,D.YX)(I.outSR),X=Z.outSpatialReference):U&&(I.returnGeometry||I.returnCentroid)&&(M.outSR=M.inSR,X=me),I.returnGeometry&&delete I.returnGeometry,I.outStatistics&&(M.outStatistics=JSON.stringify(I.outStatistics)),I.fullText&&(M.fullText=JSON.stringify(I.fullText)),I.pixelSize&&(M.pixelSize=JSON.stringify(I.pixelSize)),I.quantizationParameters&&(Z.defaultSpatialReferenceEnabled&&null!=me&&null!=Z.quantizationParameters?.extent&&me.equals(Z.quantizationParameters.extent.spatialReference)&&delete I.quantizationParameters.extent.spatialReference,M.quantizationParameters=JSON.stringify(I.quantizationParameters)),I.parameterValues&&(M.parameterValues=JSON.stringify(I.parameterValues)),I.rangeValues&&(M.rangeValues=JSON.stringify(I.rangeValues)),I.dynamicDataSource&&(M.layer=JSON.stringify({source:I.dynamicDataSource}),delete I.dynamicDataSource),I.timeExtent){const Ke=I.timeExtent,{start:Ce,end:it}=Ke;null==Ce&&null==it||(M.time=Ce===it?Ce:`${Ce??"null"},${it??"null"}`),delete I.timeExtent}return Z.defaultSpatialReferenceEnabled&&null!=me&&null!=X&&me.equals(X)&&(M.defaultSR=M.inSR,delete M.inSR,delete M.outSR),M}function h(Z,P,U,I){return F.apply(this,arguments)}function F(){return(F=(0,v.A)(function*(Z,P,U,I){const M=null!=P.timeExtent&&P.timeExtent.isEmpty?{data:{features:[]}}:yield G(Z,P,"json",I);return(0,S.q)(P,U,M.data),M})).apply(this,arguments)}function A(Z,P,U,I){return b.apply(this,arguments)}function b(){return(b=(0,v.A)(function*(Z,P,U,I){if(null!=P.timeExtent&&P.timeExtent.isEmpty)return{data:U.createFeatureResult()};const M=yield V(Z,P,I),X=M;return X.data=(0,o.m)(M.data,U),X})).apply(this,arguments)}function V(Z,P,U){return G(Z,P,"pbf",U)}function pe(Z,P,U){return null!=P.timeExtent&&P.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):G(Z,P,"json",U,{returnIdsOnly:!0})}function W(Z,P,U){return null!=P.timeExtent&&P.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):G(Z,P,"json",U,{returnIdsOnly:!0,returnCountOnly:!0})}function _(Z,P,U){return C.apply(this,arguments)}function C(){return(C=(0,v.A)(function*(Z,P,U){if(null!=P.timeExtent&&P.timeExtent.isEmpty)return{data:{count:0,extent:null}};const I=yield G(Z,P,"json",U,{returnExtentOnly:!0,returnCountOnly:!0}),M=I.data;if(M.hasOwnProperty("extent"))return I;if(M.features)throw new Error(c);if(M.hasOwnProperty("count"))throw new Error(c);return I})).apply(this,arguments)}function G(Z,P,U){return B.apply(this,arguments)}function B(){return(B=(0,v.A)(function*(Z,P,U,I={},M={}){const X="string"==typeof Z?(0,j.An)(Z):Z,me=P.geometry?[P.geometry]:[],oe=yield(0,a.el)(me,null,{signal:I.signal}),Ke=oe?.[0];null!=Ke&&((P=P.clone()).geometry=Ke);const Ce=(0,N.z)({...X.query,f:U,...M,...y(P,M)});return(0,s.A)((0,j.fj)(X.path,function q(Z,P){return null!=Z.formatOf3DObjects&&!(P.returnCountOnly||P.returnExtentOnly||P.returnIdsOnly)}(P,M)?"query3d":"query"),{...I,responseType:"pbf"===U?"array-buffer":"json",query:{...Ce,...I.query}})})).apply(this,arguments)}},98789:(de,K,m)=>{m.d(K,{q:()=>s});var v=m(23743);function s(j,f,a){if(!a?.features||!a.hasZ)return;const D=(0,v.N)(a.geometryType,f,j.outSpatialReference);if(null!=D)for(const N of a.features)D(N.geometry)}}}]);