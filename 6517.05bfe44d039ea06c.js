"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[6517],{29430:(Ct,pt,O)=>{O.d(pt,{$:()=>Y,IB:()=>h,Iy:()=>Qt,N2:()=>H,QP:()=>Ot,RH:()=>vt,Vl:()=>Zt,Ws:()=>Ft,ZD:()=>rt,_L:()=>Ut,bJ:()=>Tt,e$:()=>St,f6:()=>Xt,pW:()=>st,pf:()=>At});var S=O(68677),B=O(89952),N=O(77806),y=(O(69287),O(53781),O(89141));function h(s){return"r"in s&&"g"in s&&"b"in s}function _(s){return"h"in s&&"s"in s&&"v"in s}function D(s){return"l"in s&&"a"in s&&"b"in s}function R(s){return"l"in s&&"c"in s&&"h"in s}const k=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],G=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function K(s,g){const m=[];let E,w;if(s[0].length!==g.length)throw new Error("dimensions do not match");const L=s.length,P=s[0].length;let z=0;for(E=0;E<L;E++){for(z=0,w=0;w<P;w++)z+=s[E][w]*g[w];m.push(z)}return m}function W(s){const g=[s.r/255,s.g/255,s.b/255].map(E=>E<=.04045?E/12.92:((E+.055)/1.055)**2.4),m=K(k,g);return{x:100*m[0],y:100*m[1],z:100*m[2]}}function q(s){const g=K(G,[s.x/100,s.y/100,s.z/100]).map(m=>Math.min(1,Math.max(m<=.0031308?12.92*m:1.055*m**.4166666666666667-.055,0)));return{r:Math.round(255*g[0]),g:Math.round(255*g[1]),b:Math.round(255*g[2])}}function Nt(s){const g=[s.x/95.047,s.y/100,s.z/108.883].map(m=>m>.008856451679035631?m**.3333333333333333:7.787037037037035*m+.13793103448275862);return{l:116*g[1]-16,a:500*(g[0]-g[1]),b:200*(g[1]-g[2])}}function Pt(s){const g=s.l,m=[(g+16)/116+s.a/500,(g+16)/116,(g+16)/116-s.b/200].map(E=>E>6/29?E**3:3*(6/29)**2*(E-4/29));return{x:95.047*m[0],y:100*m[1],z:108.883*m[2]}}function Y(s){return h(s)?s:R(s)?function Kt(s){return q(Pt(function lt(s){const m=s.c,E=s.h;return{l:s.l,a:m*Math.cos(E),b:m*Math.sin(E)}}(s)))}(s):D(s)?function _t(s){return q(Pt(s))}(s):function U(s){return"x"in s&&"y"in s&&"z"in s}(s)?q(s):_(s)?function M(s){const g=(s.h+360)%360/60,E=s.v/100*255,w=E*(s.s/100),L=w*(1-Math.abs(g%2-1));let P;switch(Math.floor(g)){case 0:P={r:w,g:L,b:0};break;case 1:P={r:L,g:w,b:0};break;case 2:P={r:0,g:w,b:L};break;case 3:P={r:0,g:L,b:w};break;case 4:P={r:L,g:0,b:w};break;case 5:case 6:P={r:w,g:0,b:L};break;default:P={r:0,g:0,b:0}}return P.r=Math.round(P.r+E-w),P.g=Math.round(P.g+E-w),P.b=Math.round(P.b+E-w),P}(s):s}function H(s){return _(s)?s:function Vt(s){const g=s.r,m=s.g,E=s.b,w=Math.max(g,m,E),L=w-Math.min(g,m,E);let P=w,z=0===L?0:w===g?(m-E)/L%6:w===m?(E-g)/L+2:(g-m)/L+4,ct=0===L?0:L/P;return z<0&&(z+=6),z*=60,ct*=100,P*=100/255,{h:z,s:ct,v:P}}(Y(s))}function rt(s){return D(s)?s:function F(s){return Nt(W(s))}(Y(s))}function vt(s){return R(s)?s:function xt(s){return function ot(s){const g=s.l,m=s.a,E=s.b,w=Math.sqrt(m*m+E*E);let L=Math.atan2(E,m);return L=L>0?L:L+2*Math.PI,{l:g,c:w,h:L}}(Nt(W(s)))}(Y(s))}function Ft(s,g){const{r:m,g:E,b:w}=g?.ignoreAlpha?s:function dt(s){let{r:g,g:m,b:E,a:w}=s;return w<1&&(g=Math.round(w*g+255*(1-w)),m=Math.round(w*m+255*(1-w)),E=Math.round(w*E+255*(1-w))),new S.A({r:g,g:m,b:E})}(s);return.2126*m+.7152*E+.0722*w}var st,s;function Tt(s,g=st.High){return Ft(s,{ignoreAlpha:!0})>g?new S.A([0,0,0,s.a]):new S.A([255,255,255,s.a])}function St(s,g){const m=rt(s);m.l*=1-g;const E=Y(m),w=s.clone();return w.setColor(E),w.a=s.a,w}function Ut(s,g){const m=s.clone();return m.a*=g,m}function Zt(s,g){const m=H(s);m.s*=g;const E=Y(m),w=s.clone();return w.setColor(E),w.a=s.a,w}function Ot(s){return S.A.toUnitRGBA(s)}function At(s){return(0,y.fA)(s[0],s[1],s[2],s.length>3?s[3]:1)}function Xt(s,g){const m=S.A.toUnitRGBA(s);return m[3]*=g,m}function Qt(s,g,m={}){if(0===s.length||g<=0)return[];if(1===(s=s.map(E=>"string"==typeof E?new S.A(E):E)).length||1===g){const E=[],w=s[0];for(let L=0;L<g;L++)E.push(w.clone());return E}if(m.shuffle&&(s=(0,B.k4)((0,N.o8)(s),m.seed)),s.length>=g){const E=[],w=(s.length-1)/(g-1);for(let L=0;L<g;L++){const P=Math.round(L*w);E.push(s[P].clone())}return E}return function Jt(s,g,m={}){const E=[],w=s.length-1,L=Math.ceil((g-s.length)/w);t:for(let P=0;P<w;P++){const z=s[P],ct=s[P+1];for(let yt=1;yt<=L;yt++)if(E.push(qt(z,ct,yt/(L+1),m)),E.length+s.length===g)break t}return[...s.map(P=>P.clone()),...(0,B.k4)(E,m.seed??1)]}(s,g,m)}(s=st||(st={}))[s.Low=160]="Low",s[s.High=225]="High";const Bt=(s,g)=>{const m=Math.floor(10*g())-5;return Math.min(255,Math.max(0,s+m))};function qt(s,g,m,E={}){const w=s.r,L=s.g,P=s.b,ct=g.g,yt=g.b,mt=Math.round(w+(g.r-w)*m),Rt=Math.round(L+(ct-L)*m),It=Math.round(P+(yt-P)*m);if(!E.offset)return new S.A([mt,Rt,It]);const Et=(0,B.Mo)(E.seed);return new S.A([Bt(mt,Et),Bt(Rt,Et),Bt(It,Et)])}},80913:(Ct,pt,O)=>{O.d(pt,{A:()=>B}),O(3248);class B{constructor(T){this._array=[],this._stride=T}get array(){return this._array}get index(){return 4*this._array.length/this._stride}get itemSize(){return this._stride}get sizeInBytes(){return 4*this._array.length}reset(){this.array.length=0}toBuffer(){return new Uint32Array(this._array).buffer}static i1616to32(T,o){return 65535&T|o<<16}static i8888to32(T,o,y,h){return 255&T|(255&o)<<8|(255&y)<<16|h<<24}static i8816to32(T,o,y){return 255&T|(255&o)<<8|y<<16}}},20904:(Ct,pt,O)=>{var S,B,N,T;O.d(pt,{$q:()=>N,NP:()=>S,kh:()=>B}),(T=S||(S={}))[T.FILL=1]="FILL",T[T.LINE=2]="LINE",T[T.SYMBOL=3]="SYMBOL",T[T.CIRCLE=4]="CIRCLE",function(T){T[T.BACKGROUND=0]="BACKGROUND",T[T.FILL=1]="FILL",T[T.OUTLINE=2]="OUTLINE",T[T.LINE=3]="LINE",T[T.ICON=4]="ICON",T[T.CIRCLE=5]="CIRCLE",T[T.TEXT=6]="TEXT",T[T.TILEINFO=7]="TILEINFO"}(B||(B={})),function(T){T[T.PAINTER_CHANGED=0]="PAINTER_CHANGED",T[T.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",T[T.LAYER_CHANGED=2]="LAYER_CHANGED",T[T.LAYER_REMOVED=3]="LAYER_REMOVED",T[T.SPRITES_CHANGED=4]="SPRITES_CHANGED"}(N||(N={}))},53220:(Ct,pt,O)=>{O.d(pt,{lf:()=>De,L:()=>Ae,A4:()=>be,aR:()=>Re,e4:()=>Ie,tU:()=>ve,V1:()=>Te,uU:()=>Le});var o,y,l,S=O(51995),B=O(20904),N=O(4139),T=O(80913);(l=o||(o={}))[l.R8_SIGNED=0]="R8_SIGNED",l[l.R8_UNSIGNED=1]="R8_UNSIGNED",l[l.R16_SIGNED=2]="R16_SIGNED",l[l.R16_UNSIGNED=3]="R16_UNSIGNED",l[l.R8G8_SIGNED=4]="R8G8_SIGNED",l[l.R8G8_UNSIGNED=5]="R8G8_UNSIGNED",l[l.R16G16_SIGNED=6]="R16G16_SIGNED",l[l.R16G16_UNSIGNED=7]="R16G16_UNSIGNED",l[l.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED",l[l.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED",l[l.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR",l[l.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY",l[l.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN",function(l){l[l.UNIFORM=0]="UNIFORM",l[l.DATA_DRIVEN=1]="DATA_DRIVEN",l[l.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN",l[l.UNUSED=3]="UNUSED"}(y||(y={}));var h=O(50915),_=O(30454);class D{constructor(t){this._locations=new Map,this._key=t}get key(){return this._key}get type(){return 7&this._key}defines(){return[]}getStride(){return this._layout||this._buildAttributesInfo(),this._stride}getAttributeLocations(){return 0===this._locations.size&&this._buildAttributesInfo(),this._locations}getLayoutInfo(){return this._layout||this._buildAttributesInfo(),this._layout}getEncodingInfos(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}getUniforms(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}getShaderHeader(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}getShaderMain(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}setDataUniforms(t,r,n,a,i){const f=this.getUniforms();for(const c of f){const{name:p,type:d,getValue:b}=c,I=b(n,r,a,i);if(null!==I)switch(d){case"float":t.setUniform1f(p,I);break;case"vec2":t.setUniform2fv(p,I);break;case"vec4":t.setUniform4fv(p,I)}}}encodeAttributes(t,r,n,a){const i=this.attributesInfo(),f=this.getEncodingInfos(),c=[];let p=0,d=0;for(const b of Object.keys(f)){const I=f[b],{type:A,precisionFactor:x,isLayout:et}=i[b],ft=et?n.getLayoutProperty(b):n.getPaintProperty(b),ht=ft.interpolator?.getInterpolationRange(r);let gt=0;for(const Z of I){const{offset:C,bufferElementsToAdd:nt}=Z;if(nt>0){for(let wt=0;wt<nt;wt++)c.push(0);p+=d,d=Z.bufferElementsToAdd}const V=a??ft.getValue(ht?ht[gt]:r,t);switch(A){case o.R8_SIGNED:case o.R8_UNSIGNED:c[p]|=this._encodeByte(V*(x||1),8*C);break;case o.R16_SIGNED:case o.R16_UNSIGNED:c[p]|=this._encodeShort(V*(x||1),8*C);break;case o.R8G8_SIGNED:case o.R8G8_UNSIGNED:c[p]|=this._encodeByte(V*(x||1),8*C),c[p]|=this._encodeByte(V*(x||1),8*C+8);break;case o.R16G16_SIGNED:case o.R16G16_UNSIGNED:c[p]|=this._encodeShort(V*(x||1),8*C),c[p]|=this._encodeShort(V*(x||1),8*C+16);break;case o.R8G8B8A8_SIGNED:case o.R8G8B8A8_UNSIGNED:c[p]|=this._encodeByte(V*(x||1),8*C),c[p]|=this._encodeByte(V*(x||1),8*C+8),c[p]|=this._encodeByte(V*(x||1),8*C+16),c[p]|=this._encodeByte(V*(x||1),8*C+24);break;case o.R8G8B8A8_COLOR:c[p]=this._encodeColor(V);break;case o.R16G16B16A16_DASHARRAY:case o.R16G16B16A16_PATTERN:this._encodePattern(p,c,V);break;default:throw new Error("Unsupported encoding type")}gt++}}return c}getAtributeState(t){let r=0;const n=3+2*t;return r|=this._bit(n),r|=this._bit(n+1)<<1,r}_buildAttributesInfo(){const t=[],r={},n={};let a=-1;const i=this.attributesInfo(),f=this.attributes();let c=-1;for(const I of f){c++;const A=this.getAtributeState(c);if(A===y.UNIFORM||A===y.UNUSED)continue;const x=i[I],et=[];r[I]=et;const ft=x.type;for(let ht=0;ht<A;ht++){const{dataType:gt,bytesPerElement:Z,count:C,normalized:nt}=D._encodingInfo[ft],V=Z*C,wt=`${gt}-${!0===nt}`;let J=n[wt],at=0;if(!J||J.count+C>4)a++,J={dataIndex:a,count:0,offset:0},4!==C&&(n[wt]=J),t.push({location:-1,name:"a_data_"+a,count:C,type:gt,normalized:nt}),at=Math.ceil(Math.max(V/4,1));else{const it=t[J.dataIndex];it.count+=C,at=Math.ceil(Math.max(it.count*Z/4,1))-Math.ceil(Math.max(J.offset/4,1))}et.push({dataIndex:J.dataIndex,offset:J.offset,bufferElementsToAdd:at}),J.offset+=V,J.count+=C}}for(const I of t)switch(I.type){case h.pe.BYTE:case h.pe.UNSIGNED_BYTE:I.count=4;break;case h.pe.SHORT:case h.pe.UNSIGNED_SHORT:I.count+=I.count%2}this._buildVertexBufferLayout(t);let p=0;const d=this._layout.get("geometry");for(const I of d)this._locations.set(I.name,p++);const b=this._layout.get("opacity");if(b)for(const I of b)this._locations.set(I.name,p++);this._buildShaderInfo(t,r),this._propertyEncodingInfo=r}_buildVertexBufferLayout(t){const r=new Map,n=this.geometryInfo();let a=n[0].stride;if(0===t.length)r.set("geometry",n);else{const f=[];let c=a;for(const p of t)a+=R(p.type)*p.count;for(const p of n)f.push(new _._(p.name,p.count,p.type,p.offset,a,p.normalized));for(const p of t)f.push(new _._(p.name,p.count,p.type,c,a,p.normalized)),c+=R(p.type)*p.count;r.set("geometry",f)}const i=this.opacityInfo();i&&r.set("opacity",i),this._layout=r,this._stride=a}_buildShaderInfo(t,r){let n="\n",a="\n";const i=[];for(const d of t)n+=`attribute ${this._getType(d.count)} ${d.name};\n`;const f=this.attributes(),c=this.attributesInfo();let p=-1;for(const d of f){p++;const{name:b,type:I,precisionFactor:A,isLayout:x}=c[d],et=A&&1!==A?" * "+1/A:"",{bytesPerElement:ft,count:ht}=D._encodingInfo[I],gt=Z=>`a_data_${Z.dataIndex}${U(ht,Z.offset,ft)}`;switch(this.getAtributeState(p)){case y.UNIFORM:{const Z=this._getType(ht),C=`u_${b}`;i.push({name:C,type:Z,getValue:(nt,V,wt,J)=>{const at=x?nt.getLayoutValue(d,V):nt.getPaintValue(d,V);if(I===o.R16G16B16A16_DASHARRAY){const it=nt.getDashKey(at,nt.getLayoutValue("line-cap",V)),kt=J.getMosaicItemPosition(it,!1);if(null==kt)return null;const{tl:zt,br:ye}=kt;return[zt[0],ye[1],ye[0],zt[1]]}if(I===o.R16G16B16A16_PATTERN){const it=J.getMosaicItemPosition(at,!d.includes("line-"));if(null==it)return null;const{tl:kt,br:zt}=it;return[kt[0],zt[1],zt[0],kt[1]]}if(I===o.R8G8B8A8_COLOR){const it=at[3];return[it*at[0],it*at[1],it*at[2],it]}return at}}),n+=`uniform ${Z} ${C};\n`,a+=`${Z} ${b} = ${C};\n`}break;case y.DATA_DRIVEN:{const Z=gt(r[d][0]);a+=`${this._getType(ht)} ${b} = ${Z}${et};\n`}break;case y.INTERPOLATED_DATA_DRIVEN:{const Z=`u_t_${b}`;i.push({name:Z,type:"float",getValue:(V,wt,J,at)=>(x?V.getLayoutProperty(d):V.getPaintProperty(d)).interpolator.interpolationUniformValue(J,wt)}),n+=`uniform float ${Z};\n`;const C=gt(r[d][0]),nt=gt(r[d][1]);a+=`${this._getType(ht)} ${b} = mix(${C}${et}, ${nt}${et}, ${Z});\n`}}}this._shaderHeader=n,this._shaderMain=a,this._uniforms=i}_bit(t){return(this._key&1<<t)>>t}_getType(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}_encodeColor(t){const r=255*t[3];return T.A.i8888to32(t[0]*r,t[1]*r,t[2]*r,r)}_encodePattern(t,r,n){if(!n?.rect)return;const i=n.rect,f=n.width,c=n.height;r[t]=this._encodeShort(i.x+2,0),r[t]|=this._encodeShort(i.y+2+c,16),r[t+1]=this._encodeShort(i.x+2+f,0),r[t+1]|=this._encodeShort(i.y+2,16)}_encodeByte(t,r){return(255&t)<<r}_encodeShort(t,r){return(65535&t)<<r}}D._encodingInfo={[o.R8_SIGNED]:{dataType:h.pe.BYTE,bytesPerElement:1,count:1,normalized:!1},[o.R8_UNSIGNED]:{dataType:h.pe.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[o.R16_SIGNED]:{dataType:h.pe.SHORT,bytesPerElement:2,count:1,normalized:!1},[o.R16_UNSIGNED]:{dataType:h.pe.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[o.R8G8_SIGNED]:{dataType:h.pe.BYTE,bytesPerElement:1,count:2,normalized:!1},[o.R8G8_UNSIGNED]:{dataType:h.pe.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[o.R16G16_SIGNED]:{dataType:h.pe.SHORT,bytesPerElement:2,count:2,normalized:!1},[o.R16G16_UNSIGNED]:{dataType:h.pe.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[o.R8G8B8A8_SIGNED]:{dataType:h.pe.BYTE,bytesPerElement:1,count:4,normalized:!1},[o.R8G8B8A8_UNSIGNED]:{dataType:h.pe.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[o.R8G8B8A8_COLOR]:{dataType:h.pe.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[o.R16G16B16A16_DASHARRAY]:{dataType:h.pe.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[o.R16G16B16A16_PATTERN]:{dataType:h.pe.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const R=l=>{switch(l){case h.pe.FLOAT:case h.pe.INT:case h.pe.UNSIGNED_INT:return 4;case h.pe.SHORT:case h.pe.UNSIGNED_SHORT:case h.pe.HALF_FLOAT:return 2;case h.pe.BYTE:case h.pe.UNSIGNED_BYTE:return 1}},U=(l,t,r)=>{const n=t/r;if(1===l)switch(n){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===l)switch(n){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===l)switch(n){case 0:return".xyz";case 1:return".yzw"}return""};class k extends D{constructor(t){super(t)}geometryInfo(){return k.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return k.ATTRIBUTES}attributesInfo(){return k.ATTRIBUTES_INFO}}k.ATTRIBUTES=[],k.GEOMETRY_LAYOUT=[new _._("a_pos",2,h.pe.BYTE,0,2)],k.ATTRIBUTES_INFO={};class G extends D{constructor(t){super(t)}geometryInfo(){return G.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return G.ATTRIBUTES}attributesInfo(){return G.ATTRIBUTES_INFO}}G.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],G.GEOMETRY_LAYOUT=[new _._("a_pos",2,h.pe.SHORT,0,4)],G.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:o.R8_UNSIGNED},"circle-color":{name:"color",type:o.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:o.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:o.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:o.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:o.R8_UNSIGNED,precisionFactor:32}};class K extends D{constructor(t){super(t)}geometryInfo(){return K.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return K.ATTRIBUTES}attributesInfo(){return K.ATTRIBUTES_INFO}}K.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],K.GEOMETRY_LAYOUT=[new _._("a_pos",2,h.pe.SHORT,0,4)],K.ATTRIBUTES_INFO={"fill-color":{name:"color",type:o.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:o.R16G16B16A16_PATTERN,isOptional:!0}};class W extends D{constructor(t,r){super(t),this._usefillColor=r}geometryInfo(){return W.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return this._usefillColor?W.ATTRIBUTES_FILL:W.ATTRIBUTES_OUTLINE}attributesInfo(){return this._usefillColor?W.ATTRIBUTES_INFO_FILL:W.ATTRIBUTES_INFO_OUTLINE}}W.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],W.ATTRIBUTES_FILL=["fill-color","fill-opacity"],W.GEOMETRY_LAYOUT=[new _._("a_pos",2,h.pe.SHORT,0,8),new _._("a_offset",2,h.pe.BYTE,4,8),new _._("a_xnormal",2,h.pe.BYTE,6,8)],W.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:o.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100}},W.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:o.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100}};class q extends D{constructor(t){super(t)}geometryInfo(){return q.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return q.ATTRIBUTES}attributesInfo(){return q.ATTRIBUTES_INFO}}q.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],q.GEOMETRY_LAYOUT=[new _._("a_pos",2,h.pe.SHORT,0,16),new _._("a_extrude_offset",4,h.pe.BYTE,4,16),new _._("a_dir_normal",4,h.pe.BYTE,8,16),new _._("a_accumulatedDistance",2,h.pe.UNSIGNED_SHORT,12,16)],q.ATTRIBUTES_INFO={"line-width":{name:"width",type:o.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:o.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:o.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:o.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:o.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:o.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:o.R16G16B16A16_DASHARRAY,isOptional:!0}};const Nt=[new _._("a_pos",2,h.pe.SHORT,0,16),new _._("a_vertexOffset",2,h.pe.SHORT,4,16),new _._("a_texAngleRange",4,h.pe.UNSIGNED_BYTE,8,16),new _._("a_levelInfo",4,h.pe.UNSIGNED_BYTE,12,16)],Pt=[new _._("a_opacityInfo",1,h.pe.UNSIGNED_BYTE,0,1)];class ot extends D{constructor(t){super(t)}geometryInfo(){return Nt}opacityInfo(){return Pt}attributes(){return ot.ATTRIBUTES}attributesInfo(){return ot.ATTRIBUTES_INFO}}ot.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],ot.ATTRIBUTES_INFO={"icon-color":{name:"color",type:o.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:o.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:o.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:o.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:o.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};class lt extends D{constructor(t){super(t)}geometryInfo(){return Nt}opacityInfo(){return Pt}attributes(){return lt.ATTRIBUTES}attributesInfo(){return lt.ATTRIBUTES_INFO}}lt.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],lt.ATTRIBUTES_INFO={"text-color":{name:"color",type:o.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:o.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:o.R8_UNSIGNED,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:o.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:o.R8_UNSIGNED,isLayout:!0}};var F=O(68677),_t=O(29430),xt=O(91766),Kt=O(47461);const Vt={kind:"null"},M={kind:"number"},Y={kind:"string"},H={kind:"boolean"},rt={kind:"color"},vt={kind:"object"},ut={kind:"value"};function dt(l,t){return{kind:"array",itemType:l,n:t}}const Ft=[Vt,M,Y,H,rt,vt,dt(ut)];function st(l){if("array"===l.kind){const t=st(l.itemType);return"number"==typeof l.n?`array<${t}, ${l.n}>`:"value"===l.itemType.kind?"array":`array<${t}>`}return l.kind}function Tt(l){if(null===l)return Vt;if("string"==typeof l)return Y;if("boolean"==typeof l)return H;if("number"==typeof l)return M;if(l instanceof F.A)return rt;if(Array.isArray(l)){let t;for(const r of l){const n=Tt(r);if(t){if(t!==n){t=ut;break}}else t=n}return dt(t||ut,l.length)}return"object"==typeof l?vt:ut}function St(l,t){if("array"===t.kind)return"array"===l.kind&&(0===l.n&&"value"===l.itemType.kind||St(l.itemType,t.itemType))&&("number"!=typeof t.n||t.n===l.n);if("value"===t.kind)for(const r of Ft)if(St(l,r))return!0;return t.kind===l.kind}function Ut(l){if(null===l)return"";const t=typeof l;return"string"===t?l:"number"===t||"boolean"===t?String(l):l instanceof F.A?l.toString():JSON.stringify(l)}class Zt{constructor(t){this._parent=t,this._vars={}}add(t,r){this._vars[t]=r}get(t){return this._vars[t]?this._vars[t]:this._parent?this._parent.get(t):null}}class Ot{constructor(){this.type=ut}static parse(t){if(t.length>1)throw new Error('"id" does not expect arguments');return new Ot}evaluate(t,r){return t?.id}}class $t{constructor(){this.type=Y}static parse(t){if(t.length>1)throw new Error('"geometry-type" does not expect arguments');return new $t}evaluate(t,r){if(!t)return null;switch(t.type){case xt.dC.Point:return"Point";case xt.dC.LineString:return"LineString";case xt.dC.Polygon:return"Polygon";default:return null}}}class Yt{constructor(){this.type=vt}static parse(t){if(t.length>1)throw new Error('"properties" does not expect arguments');return new Yt}evaluate(t,r){return t?.values}}class At{constructor(){this.type=M}static parse(t){if(t.length>1)throw new Error('"zoom" does not expect arguments');return new At}evaluate(t,r){return r}}class X{constructor(t,r,n){this._lhs=t,this._rhs=r,this._compare=n,this.type=H}static parse(t,r,n){if(3!==t.length&&4!==t.length)throw new Error(`"${t[0]}" expects 2 or 3 arguments`);if(4===t.length)throw new Error(`"${t[0]}" collator not supported`);return new X(v(t[1],r),v(t[2],r),n)}evaluate(t,r){return this._compare(this._lhs.evaluate(t,r),this._rhs.evaluate(t,r))}}class s{constructor(t){this._arg=t,this.type=H}static parse(t,r){if(2!==t.length)throw new Error('"!" expects 1 argument');return new s(v(t[1],r))}evaluate(t,r){return!this._arg.evaluate(t,r)}}class g{constructor(t){this._args=t,this.type=H}static parse(t,r){const n=[];for(let a=1;a<t.length;a++)n.push(v(t[a],r));return new g(n)}evaluate(t,r){for(const n of this._args)if(!n.evaluate(t,r))return!1;return!0}}class m{constructor(t){this._args=t,this.type=H}static parse(t,r){const n=[];for(let a=1;a<t.length;a++)n.push(v(t[a],r));return new m(n)}evaluate(t,r){for(const n of this._args)if(n.evaluate(t,r))return!0;return!1}}class E{constructor(t){this._args=t,this.type=H}static parse(t,r){const n=[];for(let a=1;a<t.length;a++)n.push(v(t[a],r));return new E(n)}evaluate(t,r){for(const n of this._args)if(n.evaluate(t,r))return!1;return!0}}class w{constructor(t,r,n){this.type=t,this._args=r,this._fallback=n}static parse(t,r,n){if(t.length<4)throw new Error('"case" expects at least 3 arguments');if(t.length%2==1)throw new Error('"case" expects an odd number of arguments');let a;const i=[];for(let c=1;c<t.length-1;c+=2){const p=v(t[c],r),d=v(t[c+1],r,n);a||(a=d.type),i.push({condition:p,output:d})}const f=v(t[t.length-1],r,n);return a||(a=f.type),new w(a,i,f)}evaluate(t,r){for(const n of this._args)if(n.condition.evaluate(t,r))return n.output.evaluate(t,r);return this._fallback.evaluate(t,r)}}class L{constructor(t,r){this.type=t,this._args=r}static parse(t,r){if(t.length<2)throw new Error('"coalesce" expects at least 1 argument');let n;const a=[];for(let i=1;i<t.length;i++){const f=v(t[i],r);n||(n=f.type),a.push(f)}return new L(n,a)}evaluate(t,r){for(const n of this._args){const a=n.evaluate(t,r);if(null!==a)return a}return null}}class P{constructor(t,r,n,a,i){this.type=t,this._input=r,this._labels=n,this._outputs=a,this._fallback=i}static parse(t,r){if(t.length<3)throw new Error('"match" expects at least 3 arguments');if(t.length%2==0)throw new Error('"case" expects an even number of arguments');let n;const a=v(t[1],r),i=[],f={};let c;for(let p=2;p<t.length-1;p+=2){let d=t[p];Array.isArray(d)||(d=[d]);for(const I of d){const A=typeof I;if("string"!==A&&"number"!==A)throw new Error('"match" requires string or number literal as labels');if(c){if(A!==c)throw new Error('"match" requires labels to have the same type')}else c=A;f[I]=i.length}const b=v(t[p+1],r);n||(n=b.type),i.push(b)}return new P(n,a,f,i,v(t[t.length-1],r))}evaluate(t,r){const n=this._input.evaluate(t,r);return(this._outputs[this._labels[n]]||this._fallback).evaluate(t,r)}}class z{constructor(t,r,n,a,i){this._operator=t,this.type=r,this.interpolation=n,this.input=a,this._stops=i}static parse(t,r,n){const a=t[0];if(t.length<5)throw new Error(`"${a}" expects at least 4 arguments`);const i=t[1];if(!Array.isArray(i)||0===i.length)throw new Error(`"${i}" is not a valid interpolation`);switch(i[0]){case"linear":if(1!==i.length)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(2!==i.length||"number"!=typeof i[1])throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(5!==i.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(let d=1;d<5;d++){const b=i[d];if("number"!=typeof b||b<0||b>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error(`"${t[0]}" unknown interpolation type "${i[0]}"`)}if(t.length%2!=1)throw new Error(`"${a}" expects an even number of arguments`);const f=v(t[2],r,M);let c;"interpolate-hcl"===a||"interpolate-lab"===a?c=rt:n&&"value"!==n.kind&&(c=n);const p=[];for(let d=3;d<t.length;d+=2){const b=t[d];if("number"!=typeof b)throw new Error(`"${a}" requires stop inputs as literal numbers`);if(p.length&&p[p.length-1][0]>=b)throw new Error(`"${a}" requires strictly ascending stop inputs`);const I=v(t[d+1],r,c);c||(c=I.type),p.push([b,I])}if(c&&c!==rt&&c!==M&&("array"!==c.kind||c.itemType!==M))throw new Error(`"${a}" cannot interpolate type ${st(c)}`);return new z(a,c,i,f,p)}evaluate(t,r){const n=this._stops;if(1===n.length)return n[0][1].evaluate(t,r);const a=this.input.evaluate(t,r);if(a<=n[0][0])return n[0][1].evaluate(t,r);if(a>=n[n.length-1][0])return n[n.length-1][1].evaluate(t,r);let i=0;for(;++i<n.length&&!(a<n[i][0]););const p=z.interpolationRatio(this.interpolation,a,n[i-1][0],n[i][0]),d=n[i-1][1].evaluate(t,r),b=n[i][1].evaluate(t,r);if("interpolate"===this._operator){if("array"===this.type.kind&&Array.isArray(d)&&Array.isArray(b))return d.map((I,A)=>(0,N.GW)(I,b[A],p));if("color"===this.type.kind&&d instanceof F.A&&b instanceof F.A){const I=new F.A(d),A=new F.A(b);return new F.A([(0,N.GW)(I.r,A.r,p),(0,N.GW)(I.g,A.g,p),(0,N.GW)(I.b,A.b,p),(0,N.GW)(I.a,A.a,p)])}if("number"===this.type.kind&&"number"==typeof d&&"number"==typeof b)return(0,N.GW)(d,b,p);throw new Error(`"${this._operator}" cannot interpolate type ${st(this.type)}`)}if("interpolate-hcl"===this._operator){const I=(0,_t.RH)(d),A=(0,_t.RH)(b),x=A.h-I.h,et=(0,_t.$)({h:I.h+p*(x>180||x<-180?x-360*Math.round(x/360):x),c:(0,N.GW)(I.c,A.c,p),l:(0,N.GW)(I.l,A.l,p)});return new F.A({a:(0,N.GW)(d.a,b.a,p),...et})}if("interpolate-lab"===this._operator){const I=(0,_t.ZD)(d),A=(0,_t.ZD)(b),x=(0,_t.$)({l:(0,N.GW)(I.l,A.l,p),a:(0,N.GW)(I.a,A.a,p),b:(0,N.GW)(I.b,A.b,p)});return new F.A({a:(0,N.GW)(d.a,b.a,p),...x})}throw new Error(`Unexpected operator "${this._operator}"`)}interpolationUniformValue(t,r){const n=this._stops;if(1===n.length||t>=n[n.length-1][0])return 0;let a=0;for(;++a<n.length&&!(t<n[a][0]););return z.interpolationRatio(this.interpolation,r,n[a-1][0],n[a][0])}getInterpolationRange(t){const r=this._stops;if(1===r.length){const i=r[0][0];return[i,i]}const n=r[r.length-1][0];if(t>=n)return[n,n];let a=0;for(;++a<r.length&&!(t<r[a][0]););return[r[a-1][0],r[a][0]]}static interpolationRatio(t,r,n,a){let i=0;return"linear"===t[0]?i=z._exponentialInterpolationRatio(r,1,n,a):"exponential"===t[0]?i=z._exponentialInterpolationRatio(r,t[1],n,a):"cubic-bezier"===t[0]&&(i=(0,Kt.gb)(t[1],t[2],t[3],t[4])(z._exponentialInterpolationRatio(r,1,n,a),1e-5)),i<0?i=0:i>1&&(i=1),i}static _exponentialInterpolationRatio(t,r,n,a){const i=a-n;if(0===i)return 0;const f=t-n;return 1===r?f/i:(r**f-1)/(r**i-1)}}class ct{constructor(t,r,n){this.type=t,this._input=r,this._stops=n}static parse(t,r){if(t.length<5)throw new Error('"step" expects at least 4 arguments');if(t.length%2!=1)throw new Error('"step" expects an even number of arguments');const n=v(t[1],r,M);let a;const i=[];i.push([-1/0,v(t[2],r)]);for(let f=3;f<t.length;f+=2){const c=t[f];if("number"!=typeof c)throw new Error('"step" requires stop inputs as literal numbers');if(i.length&&i[i.length-1][0]>=c)throw new Error('"step" requires strictly ascending stop inputs');const p=v(t[f+1],r);a||(a=p.type),i.push([c,p])}return new ct(a,n,i)}evaluate(t,r){const n=this._stops;if(1===n.length)return n[0][1].evaluate(t,r);const a=this._input.evaluate(t,r);let i=0;for(;++i<n.length&&!(a<n[i][0]););return this._stops[i-1][1].evaluate(t,r)}}class yt{constructor(t,r){this.type=t,this._output=r}static parse(t,r,n){if(t.length<4)throw new Error('"let" expects at least 3 arguments');if(t.length%2==1)throw new Error('"let" expects an odd number of arguments');const a=new Zt(r);for(let f=1;f<t.length-1;f+=2){const c=t[f];if("string"!=typeof c)throw new Error(`"let" requires a string to define variable names - found ${c}`);a.add(c,v(t[f+1],r))}const i=v(t[t.length-1],a,n);return new yt(i.type,i)}evaluate(t,r){return this._output.evaluate(t,r)}}class mt{constructor(t,r){this.type=t,this.output=r}static parse(t,r,n){if(2!==t.length||"string"!=typeof t[1])throw new Error('"var" requires just one literal string argument');const a=r.get(t[1]);if(!a)throw new Error(`${t[1]} must be defined before being used in a "var" expression`);return new mt(n||ut,a)}evaluate(t,r){return this.output.evaluate(t,r)}}class Rt{constructor(t,r,n){this.type=t,this._index=r,this._array=n}static parse(t,r){if(3!==t.length)throw new Error('"at" expects 2 arguments');const n=v(t[1],r,M),a=v(t[2],r);return new Rt(a.type.itemType,n,a)}evaluate(t,r){const n=this._index.evaluate(t,r),a=this._array.evaluate(t,r);if(n<0||n>=a.length)throw new Error('"at" index out of bounds');if(n!==Math.floor(n))throw new Error('"at" index must be an integer');return a[n]}}class It{constructor(t,r){this._key=t,this._obj=r,this.type=ut}static parse(t,r){let n,a;switch(t.length){case 2:return n=v(t[1],r),new It(n);case 3:return n=v(t[1],r),a=v(t[2],r),new It(n,a);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(t,r){const n=this._key.evaluate(t,r);return this._obj?this._obj.evaluate(t,r)[n]:t?.values[n]}}class Et{constructor(t,r){this._key=t,this._obj=r,this.type=H}static parse(t,r){let n,a;switch(t.length){case 2:return n=v(t[1],r),new Et(n);case 3:return n=v(t[1],r),a=v(t[2],r),new Et(n,a);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(t,r){const n=this._key.evaluate(t,r);return this._obj?n in this._obj.evaluate(t,r):!!t?.values[n]}}class te{constructor(t,r){this._key=t,this._vals=r,this.type=H}static parse(t,r){if(3!==t.length)throw new Error('"in" expects 2 arguments');return new te(v(t[1],r),v(t[2],r))}evaluate(t,r){const n=this._key.evaluate(t,r);return this._vals.evaluate(t,r).includes(n)}}class Ht{constructor(t,r,n){this._item=t,this._array=r,this._from=n,this.type=M}static parse(t,r){if(t.length<3||t.length>4)throw new Error('"index-of" expects 3 or 4 arguments');const n=v(t[1],r),a=v(t[2],r);if(4===t.length){const i=v(t[3],r,M);return new Ht(n,a,i)}return new Ht(n,a)}evaluate(t,r){const n=this._item.evaluate(t,r),a=this._array.evaluate(t,r);if(this._from){const i=this._from.evaluate(t,r);if(i!==Math.floor(i))throw new Error('"index-of" index must be an integer');return a.indexOf(n,i)}return a.indexOf(n)}}class ee{constructor(t){this._arg=t,this.type=M}static parse(t,r){if(2!==t.length)throw new Error('"length" expects 2 arguments');const n=v(t[1],r);return new ee(n)}evaluate(t,r){const n=this._arg.evaluate(t,r);if("string"==typeof n||Array.isArray(n))return n.length;throw new Error('"length" expects string or array')}}class Wt{constructor(t,r,n,a){this.type=t,this._array=r,this._from=n,this._to=a}static parse(t,r){if(t.length<3||t.length>4)throw new Error('"slice" expects 2 or 3 arguments');const n=v(t[1],r),a=v(t[2],r,M);if(a.type!==M)throw new Error('"slice" index must return a number');if(4===t.length){const i=v(t[3],r,M);if(i.type!==M)throw new Error('"slice" index must return a number');return new Wt(n.type,n,a,i)}return new Wt(n.type,n,a)}evaluate(t,r){const n=this._array.evaluate(t,r);if(!Array.isArray(n)&&"string"!=typeof n)throw new Error('"slice" input must be an array or a string');const a=this._from.evaluate(t,r);if(a<0||a>=n.length)throw new Error('"slice" index out of bounds');if(a!==Math.floor(a))throw new Error('"slice" index must be an integer');if(this._to){const i=this._to.evaluate(t,r);if(i<0||i>=n.length)throw new Error('"slice" index out of bounds');if(i!==Math.floor(i))throw new Error('"slice" index must be an integer');return n.slice(a,i)}return n.slice(a)}}class re{constructor(){this.type=H}static parse(t){if(1!==t.length)throw new Error('"has-id" expects no arguments');return new re}evaluate(t,r){return void 0!==t?.id}}class Q{constructor(t,r){this._args=t,this._calculate=r,this.type=M}static parse(t,r,n){const a=t.slice(1).map(i=>v(i,r));return new Q(a,n)}evaluate(t,r){let n;return this._args&&(n=this._args.map(a=>a.evaluate(t,r))),this._calculate(n)}}let j=(()=>{class l{constructor(r,n){this._args=r,this._calculate=n,this.type=M}static parse(r,n){const a=r.slice(1).map(i=>v(i,n));return new l(a,l.ops[r[0]])}evaluate(r,n){let a;return this._args&&(a=this._args.map(i=>i.evaluate(r,n))),this._calculate(a)}}return l.ops={abs:t=>Math.abs(t[0]),acos:t=>Math.acos(t[0]),asin:t=>Math.asin(t[0]),atan:t=>Math.atan(t[0]),ceil:t=>Math.ceil(t[0]),cos:t=>Math.cos(t[0]),e:()=>Math.E,floor:t=>Math.floor(t[0]),ln:t=>Math.log(t[0]),ln2:()=>Math.LN2,log10:t=>Math.log(t[0])/Math.LN10,log2:t=>Math.log(t[0])/Math.LN2,max:t=>Math.max(...t),min:t=>Math.min(...t),pi:()=>Math.PI,round:t=>Math.round(t[0]),sin:t=>Math.sin(t[0]),sqrt:t=>Math.sqrt(t[0]),tan:t=>Math.tan(t[0])},l})();class ne{constructor(t){this._args=t,this.type=Y}static parse(t,r){return new ne(t.slice(1).map(n=>v(n,r)))}evaluate(t,r){return this._args.map(n=>n.evaluate(t,r)).join("")}}let he=(()=>{class l{constructor(r,n){this._arg=r,this._calculate=n,this.type=Y}static parse(r,n){if(2!==r.length)throw new Error(`${r[0]} expects 1 argument`);const a=v(r[1],n);return new l(a,l.ops[r[0]])}evaluate(r,n){return this._calculate(this._arg.evaluate(r,n))}}return l.ops={downcase:t=>t.toLowerCase(),upcase:t=>t.toUpperCase()},l})();class ae{constructor(t){this._args=t,this.type=rt}static parse(t,r){if(4!==t.length)throw new Error('"rgb" expects 3 arguments');const n=t.slice(1).map(a=>v(a,r));return new ae(n)}evaluate(t,r){const n=this._validate(this._args[0].evaluate(t,r)),a=this._validate(this._args[1].evaluate(t,r)),i=this._validate(this._args[2].evaluate(t,r));return new F.A({r:n,g:a,b:i})}_validate(t){if("number"!=typeof t||t<0||t>255)throw new Error(`${t}: invalid color component`);return Math.round(t)}}class ie{constructor(t){this._args=t,this.type=rt}static parse(t,r){if(5!==t.length)throw new Error('"rgba" expects 4 arguments');const n=t.slice(1).map(a=>v(a,r));return new ie(n)}evaluate(t,r){const n=this._validate(this._args[0].evaluate(t,r)),a=this._validate(this._args[1].evaluate(t,r)),i=this._validate(this._args[2].evaluate(t,r)),f=this._validateAlpha(this._args[3].evaluate(t,r));return new F.A({r:n,g:a,b:i,a:f})}_validate(t){if("number"!=typeof t||t<0||t>255)throw new Error(`${t}: invalid color component`);return Math.round(t)}_validateAlpha(t){if("number"!=typeof t||t<0||t>1)throw new Error(`${t}: invalid alpha color component`);return t}}class se{constructor(t){this._color=t,this.type=dt(M,4)}static parse(t,r){if(2!==t.length)throw new Error('"to-rgba" expects 1 argument');const n=v(t[1],r);return new se(n)}evaluate(t,r){return new F.A(this._color.evaluate(t,r)).toRgba()}}class Dt{constructor(t,r){this.type=t,this._args=r}static parse(t,r){const n=t[0];if(t.length<2)throw new Error(`${n} expects at least one argument`);let a,i=1;if("array"===n){if(t.length>2){switch(t[1]){case"string":a=Y;break;case"number":a=M;break;case"boolean":a=H;break;default:throw new Error('"array" type argument must be string, number or boolean')}i++}else a=ut;let c;if(t.length>3){if(c=t[2],null!==c&&("number"!=typeof c||c<0||c!==Math.floor(c)))throw new Error('"array" length argument must be a positive integer literal');i++}a=dt(a,c)}else switch(n){case"string":a=Y;break;case"number":a=M;break;case"boolean":a=H;break;case"object":a=vt}const f=[];for(;i<t.length;i++){const c=v(t[i],r);f.push(c)}return new Dt(a,f)}evaluate(t,r){let n;for(const a of this._args){const i=a.evaluate(t,r);if(n=Tt(i),St(n,this.type))return i}throw new Error(`Expected ${st(this.type)} but got ${st(n)}`)}}let bt=(()=>{class l{constructor(r,n){this.type=r,this._args=n}static parse(r,n){const a=r[0],i=l.types[a];if(i===H||i===Y){if(2!==r.length)throw new Error(`${a} expects one argument`)}else if(r.length<2)throw new Error(`${a} expects at least one argument`);const f=[];for(let c=1;c<r.length;c++){const p=v(r[c],n);f.push(p)}return new l(i,f)}evaluate(r,n){if(this.type===H)return!!this._args[0].evaluate(r,n);if(this.type===Y)return Ut(this._args[0].evaluate(r,n));if(this.type===M){for(const a of this._args){const i=Number(a.evaluate(r,n));if(!isNaN(i))return i}return null}if(this.type===rt){for(const a of this._args)try{const i=l.toColor(a.evaluate(r,n));if(i instanceof F.A)return i}catch{}return null}}static toBoolean(r){return!!r}static toString(r){return Ut(r)}static toNumber(r){const n=Number(r);if(isNaN(n))throw new Error(`"${r}" is not a number`);return n}static toColor(r){if(r instanceof F.A)return r;if("string"==typeof r){const n=F.A.fromString(r);if(n)return n;throw new Error(`"${r}" is not a color`)}if(Array.isArray(r))return F.A.fromArray(r);throw new Error(`"${r}" is not a color`)}}return l.types={"to-boolean":H,"to-color":rt,"to-number":M,"to-string":Y},l})();class oe{constructor(t){this._val=t,this.type=Tt(t)}static parse(t){if(2!==t.length)throw new Error('"literal" expects 1 argument');return new oe(t[1])}evaluate(t,r){return this._val}}class le{constructor(t){this._arg=t,this.type=Y}static parse(t,r){if(2!==t.length)throw new Error('"typeof" expects 1 argument');return new le(v(t[1],r))}evaluate(t,r){return st(Tt(this._arg.evaluate(t,r)))}}function v(l,t,r){const n=typeof l;if("string"===n||"boolean"===n||"number"===n||null===l){if(r)switch(r.kind){case"string":"string"!==n&&(l=bt.toString(l));break;case"number":"number"!==n&&(l=bt.toNumber(l));break;case"color":l=bt.toColor(l)}l=["literal",l]}if(!Array.isArray(l)||0===l.length)throw new Error("Expression must be a non empty array");const a=l[0];if("string"!=typeof a)throw new Error("First element of expression must be a string");const i=pe[a];if(void 0===i)throw new Error(`Invalid expression operator "${a}"`);if(!i)throw new Error(`Unimplemented expression operator "${a}"`);return i.parse(l,t,r)}const pe={array:Dt,boolean:Dt,collator:null,format:null,image:null,literal:oe,number:Dt,"number-format":null,object:Dt,string:Dt,"to-boolean":bt,"to-color":bt,"to-number":bt,"to-string":bt,typeof:le,accumulated:null,"feature-state":null,"geometry-type":$t,id:Ot,"line-progress":null,properties:Yt,at:Rt,get:It,has:Et,in:te,"index-of":Ht,length:ee,slice:Wt,"!":s,"!=":class Xt extends X{static parse(t,r){return X.parse(t,r,(n,a)=>n!==a)}},"<":class Qt extends X{static parse(t,r){return X.parse(t,r,(n,a)=>n<a)}},"<=":class Jt extends X{static parse(t,r){return X.parse(t,r,(n,a)=>n<=a)}},"==":class ce extends X{static parse(t,r){return X.parse(t,r,(n,a)=>n===a)}},">":class Bt extends X{static parse(t,r){return X.parse(t,r,(n,a)=>n>a)}},">=":class qt extends X{static parse(t,r){return X.parse(t,r,(n,a)=>n>=a)}},all:g,any:m,case:w,coalesce:L,match:P,within:null,interpolate:z,"interpolate-hcl":z,"interpolate-lab":z,step:ct,let:yt,var:mt,concat:ne,downcase:he,"is-supported-script":null,"resolved-locale":null,upcase:he,rgb:ae,rgba:ie,"to-rgba":se,"-":class fe extends Q{static parse(t,r){switch(t.length){case 2:return Q.parse(t,r,n=>-n[0]);case 3:return Q.parse(t,r,n=>n[0]-n[1]);default:throw new Error('"-" expects 1 or 2 arguments')}}},"*":class ge extends Q{static parse(t,r){return Q.parse(t,r,n=>{let a=1;for(const i of n)a*=i;return a})}},"/":class _e extends Q{static parse(t,r){if(3===t.length)return Q.parse(t,r,n=>n[0]/n[1]);throw new Error('"/" expects 2 arguments')}},"%":class de extends Q{static parse(t,r){if(3===t.length)return Q.parse(t,r,n=>n[0]%n[1]);throw new Error('"%" expects 2 arguments')}},"^":class me extends Q{static parse(t,r){if(3===t.length)return Q.parse(t,r,n=>n[0]**n[1]);throw new Error('"^" expects 1 or 2 arguments')}},"+":class Ee extends Q{static parse(t,r){return Q.parse(t,r,n=>{let a=0;for(const i of n)a+=i;return a})}},abs:j,acos:j,asin:j,atan:j,ceil:j,cos:j,e:j,floor:j,ln:j,ln2:j,log10:j,log2:j,max:j,min:j,pi:j,round:j,sin:j,sqrt:j,tan:j,zoom:At,"heatmap-density":null,"has-id":re,none:E};class tt{constructor(t){this._expression=t}filter(t,r){if(!this._expression)return!0;try{return this._expression.evaluate(t,r)}catch(n){return console.log(n.message),!0}}static createFilter(t){if(!t)return null;this.isLegacyFilter(t)&&(t=this.convertLegacyFilter(t));try{const r=v(t,null,H);return new tt(r)}catch(r){return console.log(r.message),null}}static isLegacyFilter(t){if(!Array.isArray(t)||0===t.length)return!0;switch(t[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===t.length&&"string"==typeof t[1]&&!Array.isArray(t[2]);case"in":return t.length>=3&&"string"==typeof t[1]&&!Array.isArray(t[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(let r=1;r<t.length;r++)if(this.isLegacyFilter(t[r]))return!0;return!1;case"has":return 2===t.length&&("$id"===t[1]||"$type"===t[1]);default:return!1}}static convertLegacyFilter(t){if(!Array.isArray(t)||0===t.length)return!0;const r=t[0];if(1===t.length)return"any"!==r;switch(r){case"==":return tt.convertComparison("==",t[1],t[2]);case"!=":return tt.negate(tt.convertComparison("==",t[1],t[2]));case">":case"<":case">=":case"<=":return tt.convertComparison(r,t[1],t[2]);case"in":return tt.convertIn(t[1],t.slice(2));case"!in":return tt.negate(tt.convertIn(t[1],t.slice(2)));case"any":case"all":case"none":return tt.convertCombining(r,t.slice(1));case"has":return tt.convertHas(t[1]);case"!has":return tt.negate(tt.convertHas(t[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(t,r,n){switch(r){case"$type":return[t,["geometry-type"],n];case"$id":return[t,["id"],n];default:return[t,["get",r],n]}}static convertIn(t,r){switch(t){case"$type":return["in",["geometry-type"],["literal",r]];case"$id":return["in",["id"],["literal",r]];default:return["in",["get",t],["literal",r]]}}static convertHas(t){switch(t){case"$type":return!0;case"$id":return["has-id"];default:return["has",t]}}static convertCombining(t,r){return[t].concat(r.map(this.convertLegacyFilter))}static negate(t){return["!",t]}}var $=O(54e3);class jt{constructor(t,r){let n;switch(this.isDataDriven=!1,this.interpolator=null,t.type){case"number":case"color":n=!0;break;case"array":n="number"===t.value;break;default:n=!1}if(null==r&&(r=t.default),Array.isArray(r)&&r.length>0&&pe[r[0]]){const i={number:M,color:rt,string:Y,boolean:H,enum:Y};try{const c=v(r,null,"array"===t.type?dt(i[t.value]||ut,t.length):i[t.type]);this.getValue=this._buildExpression(c,t),this.isDataDriven=!0,c instanceof z&&c.input instanceof At&&(this.interpolator=c)}catch(f){console.log(f.message),this.getValue=this._buildSimple(t.default)}return}n&&"interval"===r.type&&(n=!1);const a=r?.stops&&r.stops.length>0;if(a)for(const i of r.stops)i[1]=this._validate(i[1],t);if(this.isDataDriven=!!r&&!!r.property,this.isDataDriven)if(void 0!==r.default&&(r.default=this._validate(r.default,t)),a)switch(r.type){case"identity":this.getValue=this._buildIdentity(r,t);break;case"categorical":this.getValue=this._buildCategorical(r,t);break;default:this.getValue=n?this._buildInterpolate(r,t):this._buildInterval(r,t)}else this.getValue=this._buildIdentity(r,t);else a?this.getValue=n?this._buildZoomInterpolate(r):this._buildZoomInterval(r):(r=this._validate(r,t),this.getValue=this._buildSimple(r))}_validate(t,r){if("number"===r.type){if(null!=r.minimum&&t<r.minimum)return r.minimum;if(null!=r.maximum&&t>r.maximum)return r.maximum}else"color"===r.type?t=jt._parseColor(t):"enum"===r.type?"string"==typeof t&&(t=r.values.indexOf(t)):"array"===r.type&&"enum"===r.value?t=t.map(n=>"string"==typeof n?r.values.indexOf(n):n):"string"===r.type&&(t=Ut(t));return t}_buildSimple(t){return()=>t}_buildExpression(t,r){return(n,a)=>{try{const i=t.evaluate(a,n);return void 0===i?r.default:this._validate(i,r)}catch(i){return console.log(i.message),r.default}}}_buildIdentity(t,r){return(n,a)=>{let i;return a&&(i=a.values[t.property]),void 0!==i&&(i=this._validate(i,r)),i??(void 0!==t.default?t.default:r.default)}}_buildCategorical(t,r){return(n,a)=>{let i;return a&&(i=a.values[t.property]),i=this._categorical(i,t.stops),void 0!==i?i:void 0!==t.default?t.default:r.default}}_buildInterval(t,r){return(n,a)=>{let i;return a&&(i=a.values[t.property]),"number"==typeof i?this._interval(i,t.stops):void 0!==t.default?t.default:r.default}}_buildInterpolate(t,r){return(n,a)=>{let i;return a&&(i=a.values[t.property]),"number"==typeof i?this._interpolate(i,t.stops,t.base||1):void 0!==t.default?t.default:r.default}}_buildZoomInterpolate(t){return r=>this._interpolate(r,t.stops,t.base||1)}_buildZoomInterval(t){return r=>this._interval(r,t.stops)}_categorical(t,r){const n=r.length;for(let a=0;a<n;a++)if(r[a][0]===t)return r[a][1]}_interval(t,r){const n=r.length;let a=0;for(let i=0;i<n&&r[i][0]<=t;i++)a=i;return r[a][1]}_interpolate(t,r,n){let a,i;const f=r.length;for(let c=0;c<f;c++){const p=r[c];if(!(p[0]<=t)){i=p;break}a=p}if(a&&i){const c=i[0]-a[0],p=t-a[0],d=1===n?p/c:(n**p-1)/(n**c-1);if(Array.isArray(a[1])){const b=a[1],I=i[1],A=[];for(let x=0;x<b.length;x++)A.push((0,N.GW)(b[x],I[x],d));return A}return(0,N.GW)(a[1],i[1],d)}return a?a[1]:i?i[1]:void 0}static _isEmpty(t){for(const r in t)if(t.hasOwnProperty(r))return!1;return!0}static _parseColor(t){return Array.isArray(t)?t:("string"==typeof t&&(t=new F.A(t)),t instanceof F.A&&!this._isEmpty(t)?F.A.toUnitRGBA(t):void 0)}}var Gt,we=O(47669);!function(l){l[l.BUTT=0]="BUTT",l[l.ROUND=1]="ROUND",l[l.SQUARE=2]="SQUARE",l[l.UNKNOWN=4]="UNKNOWN"}(Gt||(Gt={}));class Ie{constructor(t,r,n,a,i,f){this.layer=t,this.feature=r,this.bounds=n,this.normalizationRatio=a,this.normalizationOffsetX=i,this.normalizationOffsetY=f}}class Mt{constructor(t,r,n,a){switch(this.type=t,this.typeName=r.type,this.id=r.id,this.source=r.source,this.sourceLayer=r["source-layer"],this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,this.filter=r.filter,this.layout=r.layout,this.paint=r.paint,this.z=n,this.uid=a,t){case $.Dc.BACKGROUND:this._layoutDefinition=$.$u.backgroundLayoutDefinition,this._paintDefinition=$.$u.backgroundPaintDefinition;break;case $.Dc.FILL:this._layoutDefinition=$.$u.fillLayoutDefinition,this._paintDefinition=$.$u.fillPaintDefinition;break;case $.Dc.LINE:this._layoutDefinition=$.$u.lineLayoutDefinition,this._paintDefinition=$.$u.linePaintDefinition;break;case $.Dc.SYMBOL:this._layoutDefinition=$.$u.symbolLayoutDefinition,this._paintDefinition=$.$u.symbolPaintDefinition;break;case $.Dc.CIRCLE:this._layoutDefinition=$.$u.circleLayoutDefinition,this._paintDefinition=$.$u.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}getFeatureFilter(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=tt.createFilter(this.filter)}getLayoutProperty(t){return this._layoutProperties[t]}getPaintProperty(t){return this._paintProperties[t]}getLayoutValue(t,r,n){let a;const i=this._layoutProperties[t];return i&&(a=i.getValue(r,n)),void 0===a&&(a=this._layoutDefinition[t].default),a}getPaintValue(t,r,n){let a;const i=this._paintProperties[t];return i&&(a=i.getValue(r,n)),void 0===a&&(a=this._paintDefinition[t].default),a}isPainterDataDriven(){const t=this._paintProperties;if(t)for(const r in t)if(t[r].isDataDriven)return!0;return!1}isIntersectingFeature(t,r,n,a,i,f,c){return!1}getFeatureInflatedBounds(t,r,n,a){return null}_parseLayout(t){const r={};for(const n in t){const a=this._layoutDefinition[n];a&&(r[n]=new jt(a,t[n]))}return r}_parsePaint(t){const r={};for(const n in t){const a=this._paintDefinition[n];a&&(r[n]=new jt(a,t[n]))}return r}computeAttributesKey(t,r,n,a){let i=0,f=0;for(const c of r){let p=3;if(!c||c!==a){const d=n[c],{isLayout:b,isOptional:I}=d,A=b?this.getLayoutProperty(c):this.getPaintProperty(c);p=A?.interpolator?2:A?.isDataDriven?1:I&&!A?3:0}f|=p<<i,i+=2}return f<<3|t}}class De extends Mt{constructor(t,r,n,a){super(t,r,n,a),this.backgroundMaterial=new k(this.computeAttributesKey(B.kh.BACKGROUND,k.ATTRIBUTES,k.ATTRIBUTES_INFO))}}class be extends Mt{constructor(t,r,n,a){super(t,r,n,a);const i=this.getPaintProperty("fill-color"),f=this.getPaintProperty("fill-opacity"),c=this.getPaintProperty("fill-pattern");this.hasDataDrivenColor=i?.isDataDriven,this.hasDataDrivenOpacity=f?.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity||c?.isDataDriven;const p=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!p,this.hasDataDrivenOutlineColor=p?.isDataDriven,this.hasDataDrivenOutline=p?p.isDataDriven:!!i&&i.isDataDriven,this.hasDataDrivenOutline=(p?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity,this.fillMaterial=new K(this.computeAttributesKey(B.kh.FILL,K.ATTRIBUTES,K.ATTRIBUTES_INFO)),this.outlineMaterial=new W(this.computeAttributesKey(B.kh.OUTLINE,this.outlineUsesFillColor?W.ATTRIBUTES_FILL:W.ATTRIBUTES_OUTLINE,this.outlineUsesFillColor?W.ATTRIBUTES_INFO_FILL:W.ATTRIBUTES_INFO_OUTLINE),this.outlineUsesFillColor)}getFeatureInflatedBounds(t,r,n,a){const i=ue(t);if(!i)return null;const f=this.getPaintValue("fill-translate",r,t),c=a*Math.max(f[0],f[1]);return i[0]-=c,i[2]-=c,i[1]+=c,i[3]+=c,i}isIntersectingFeature(t,r,n,a,i,f,c){const p=a.getGeometry();if(!p)return!1;const d=8/c.normalizationRatio;t=t/c.normalizationRatio+c.normalizationOffsetX,r=r/c.normalizationRatio+c.normalizationOffsetY;const b=(0,N.yM)(this.getPaintValue("fill-translate",i,a),this.getPaintValue("fill-translate-anchor",i,a),f,8);return!!(0,N.s3)(t-=d*b.x,r-=d*b.y,p)||(0,N.ru)(t,r,p,d*n)}}class ve extends Mt{constructor(t,r,n,a){super(t,r,n,a);const i=this.getPaintProperty("line-pattern");if(this.lineMaterial=new q(this.computeAttributesKey(B.kh.LINE,q.ATTRIBUTES,q.ATTRIBUTES_INFO,i?"line-dasharray":"")),this.hasDataDrivenLine=this.getPaintProperty("line-blur")?.isDataDriven||this.getPaintProperty("line-color")?.isDataDriven||this.getPaintProperty("line-gap-width")?.isDataDriven||this.getPaintProperty("line-offset")?.isDataDriven||this.getPaintProperty("line-opacity")?.isDataDriven||this.getPaintProperty("line-pattern")?.isDataDriven||this.getPaintProperty("line-dasharray")?.isDataDriven||this.getLayoutProperty("line-cap")?.isDataDriven||this.getPaintProperty("line-width")?.isDataDriven,this.canUseThinTessellation=!1,!this.hasDataDrivenLine){const f=this.getPaintProperty("line-width");if(!f||"number"==typeof f&&.5*f<we.Gh){const c=this.getPaintProperty("line-offset");(!c||"number"==typeof c&&0===c)&&(this.canUseThinTessellation=!0)}}}getDashKey(t,r){let n;switch(r){case Gt.BUTT:n="Butt";break;case Gt.ROUND:n="Round";break;case Gt.SQUARE:n="Square";break;default:n="Butt"}return`dasharray-[${t.toString()}]-${n}`}getFeatureInflatedBounds(t,r,n,a){const i=ue(t);if(!i)return null;const f=this.getPaintValue("line-translate",r,t),c=a*Math.max(f[0],f[1]);i[0]-=c,i[2]-=c,i[1]+=c,i[3]+=c;const p=a*Math.abs(this.getPaintValue("line-offset",r,t)||0),d=a*(this.getPaintValue("line-width",r,t)/2);return i[0]-=p+d,i[1]-=p+d,i[2]+=p+d,i[3]+=p+d,i}isIntersectingFeature(t,r,n,a,i,f,c){let p=a.getGeometry();if(!p)return!1;const d=8/c.normalizationRatio;t=t/c.normalizationRatio+c.normalizationOffsetX,r=r/c.normalizationRatio+c.normalizationOffsetY;const b=(0,N.yM)(this.getPaintValue("line-translate",i,a),this.getPaintValue("line-translate-anchor",i,a),f,8);t-=d*b.x,r-=d*b.y;const I=d*this.getPaintValue("line-offset",i,a)||0;0!==I&&(p=(0,N.cP)(p,-I));const A=this.getPaintValue("line-width",i,a);return(0,N.ru)(t,r,p,d*(n+A/2))}}class Te extends Mt{constructor(t,r,n,a){super(t,r,n,a),this.iconMaterial=new ot(this.computeAttributesKey(B.kh.ICON,ot.ATTRIBUTES,ot.ATTRIBUTES_INFO)),this.textMaterial=new lt(this.computeAttributesKey(B.kh.TEXT,lt.ATTRIBUTES,lt.ATTRIBUTES_INFO)),this.hasDataDrivenIcon=this.getPaintProperty("icon-color")?.isDataDriven||this.getPaintProperty("icon-halo-blur")?.isDataDriven||this.getPaintProperty("icon-halo-color")?.isDataDriven||this.getPaintProperty("icon-halo-width")?.isDataDriven||this.getPaintProperty("icon-opacity")?.isDataDriven||this.getLayoutProperty("icon-size")?.isDataDriven,this.hasDataDrivenText=this.getPaintProperty("text-color")?.isDataDriven||this.getPaintProperty("text-halo-blur")?.isDataDriven||this.getPaintProperty("text-halo-color")?.isDataDriven||this.getPaintProperty("text-halo-width")?.isDataDriven||this.getPaintProperty("text-opacity")?.isDataDriven||this.getLayoutProperty("text-size")?.isDataDriven}}class Ae extends Mt{constructor(t,r,n,a){super(t,r,n,a),this.circleMaterial=new G(this.computeAttributesKey(B.kh.CIRCLE,G.ATTRIBUTES,G.ATTRIBUTES_INFO))}getFeatureInflatedBounds(t,r,n,a){const i=ue(t);if(!i)return null;const f=this.getPaintValue("circle-translate",r,t),c=Math.max(f[0],f[1]);i[0]-=c,i[2]-=c,i[1]+=c,i[3]+=c;const p=a*(8*(this.getPaintValue("circle-radius",r,t)+this.getPaintValue("circle-stroke-width",r,t))/2);return i[0]-=p,i[1]-=p,i[2]+=p,i[3]+=p,i}isIntersectingFeature(t,r,n,a,i,f,c){const p=a.getGeometry();if(!p)return!1;const d=8/c.normalizationRatio;t=t/c.normalizationRatio+c.normalizationOffsetX,r=r/c.normalizationRatio+c.normalizationOffsetY,n*=d;const b=(0,N.yM)(this.getPaintValue("circle-translate",i,a),this.getPaintValue("circle-translate-anchor",i,a),f,d),I=d*(this.getPaintValue("circle-radius",i,a)+this.getPaintValue("circle-stroke-width",i,a));let A,x;for(const et of p)if(et)for(const ft of et)if(A=ft.x+b.x,x=ft.y+b.y,Math.sqrt((t-A)*(t-A)+(r-x)*(r-x))-n<=I)return!0;return!1}}class Re{constructor(t,r,n){let a;this.allowOverlap=t.getLayoutValue("icon-allow-overlap",r),this.ignorePlacement=t.getLayoutValue("icon-ignore-placement",r),this.keepUpright=t.getLayoutValue("icon-keep-upright",r),this.optional=t.getLayoutValue("icon-optional",r),this.rotationAlignment=t.getLayoutValue("icon-rotation-alignment",r),this.rotationAlignment===$.I5.AUTO&&(this.rotationAlignment=n?$.I5.MAP:$.I5.VIEWPORT),a=t.getLayoutProperty("icon-anchor"),a?.isDataDriven?this._anchorProp=a:this.anchor=t.getLayoutValue("icon-anchor",r),a=t.getLayoutProperty("icon-offset"),a?.isDataDriven?this._offsetProp=a:this.offset=t.getLayoutValue("icon-offset",r),a=t.getLayoutProperty("icon-padding"),a?.isDataDriven?this._paddingProp=a:this.padding=t.getLayoutValue("icon-padding",r),a=t.getLayoutProperty("icon-rotate"),a?.isDataDriven?this._rotateProp=a:this.rotate=t.getLayoutValue("icon-rotate",r),a=t.getLayoutProperty("icon-size"),a?.isDataDriven?this._sizeProp=a:this.size=t.getLayoutValue("icon-size",r)}update(t,r){this._anchorProp&&(this.anchor=this._anchorProp.getValue(t,r)),this._offsetProp&&(this.offset=this._offsetProp.getValue(t,r)),this._paddingProp&&(this.padding=this._paddingProp.getValue(t,r)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(t,r)),this._sizeProp&&(this.size=this._sizeProp.getValue(t,r))}}class Le{constructor(t,r,n){let a;this.allowOverlap=t.getLayoutValue("text-allow-overlap",r),this.ignorePlacement=t.getLayoutValue("text-ignore-placement",r),this.keepUpright=t.getLayoutValue("text-keep-upright",r),this.optional=t.getLayoutValue("text-optional",r),this.rotationAlignment=t.getLayoutValue("text-rotation-alignment",r),this.rotationAlignment===$.I5.AUTO&&(this.rotationAlignment=n?$.I5.MAP:$.I5.VIEWPORT),a=t.getLayoutProperty("text-anchor"),a?.isDataDriven?this._anchorProp=a:this.anchor=t.getLayoutValue("text-anchor",r),a=t.getLayoutProperty("text-justify"),a?.isDataDriven?this._justifyProp=a:this.justify=t.getLayoutValue("text-justify",r),a=t.getLayoutProperty("text-letter-spacing"),a?.isDataDriven?this._letterSpacingProp=a:this.letterSpacing=t.getLayoutValue("text-letter-spacing",r),a=t.getLayoutProperty("text-line-height"),a?.isDataDriven?this._lineHeightProp=a:this.lineHeight=t.getLayoutValue("text-line-height",r),a=t.getLayoutProperty("text-max-angle"),a?.isDataDriven?this._maxAngleProp=a:this.maxAngle=t.getLayoutValue("text-max-angle",r),a=t.getLayoutProperty("text-max-width"),a?.isDataDriven?this._maxWidthProp=a:this.maxWidth=t.getLayoutValue("text-max-width",r),a=t.getLayoutProperty("text-offset"),a?.isDataDriven?this._offsetProp=a:this.offset=t.getLayoutValue("text-offset",r),a=t.getLayoutProperty("text-padding"),a?.isDataDriven?this._paddingProp=a:this.padding=t.getLayoutValue("text-padding",r),a=t.getLayoutProperty("text-rotate"),a?.isDataDriven?this._rotateProp=a:this.rotate=t.getLayoutValue("text-rotate",r),a=t.getLayoutProperty("text-size"),a?.isDataDriven?this._sizeProp=a:this.size=t.getLayoutValue("text-size",r),a=t.getLayoutProperty("text-writing-mode"),a?.isDataDriven?this._writingModeProp=a:this.writingMode=t.getLayoutValue("text-writing-mode",r)}update(t,r){this._anchorProp&&(this.anchor=this._anchorProp.getValue(t,r)),this._justifyProp&&(this.justify=this._justifyProp.getValue(t,r)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(t,r)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(t,r)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(t,r)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(t,r)),this._offsetProp&&(this.offset=this._offsetProp.getValue(t,r)),this._paddingProp&&(this.padding=this._paddingProp.getValue(t,r)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(t,r)),this._sizeProp&&(this.size=this._sizeProp.getValue(t,r)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(t,r))}}function ue(l){const t=l?.getGeometry();if(null==t)return null;let r=1/0,n=1/0,a=-1/0,i=-1/0;for(const f of t)if(f)for(const c of f)r=Math.min(r,c.x),n=Math.min(n,c.y),a=Math.max(a,c.x),i=Math.max(i,c.y);return(0,S.fA)(r,n,a,i)}},6517:(Ct,pt,O)=>{O.d(pt,{A:()=>N});var S=O(54e3),B=O(53220);class N{constructor(o){if(this._style=o,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,o.layers||(o.layers=[]),this.version=parseFloat(o.version),this.layers=o.layers.map((y,h,_)=>this._create(y,h,_)).filter(y=>!!y),this.layers)for(let y=0;y<this.layers.length;y++){const h=this.layers[y];this._layerByName[h.id]=h,this._uidToLayer.set(h.uid,h),h.type===S.Dc.BACKGROUND&&this.backgroundBucketIds.push(h.id)}this._identifyRefLayers()}isPainterDataDriven(o){const y=this._layerByName[o];return!!y&&y.isPainterDataDriven()}getStyleLayerId(o){return o>=this.layers.length?null:this.layers[o].id}getStyleLayerByUID(o){return this._uidToLayer.get(o)??null}getStyleLayerIndex(o){const y=this._layerByName[o];return y?this.layers.indexOf(y):-1}setStyleLayer(o,y){if(!o?.id)return;const h=this._style;null!=y&&y>=this.layers.length&&(y=this.layers.length-1);let _,D=!0;const R=this._layerByName[o.id];if(R){const U=this.layers.indexOf(R);y||(y=U),y===U?(D=!1,_=N._recreateLayer(o,R),this.layers[y]=_,h.layers[y]=o):(this.layers.splice(U,1),h.layers.splice(U,1),_=this._create(o,y,this.layers),this.layers.splice(y,0,_),h.layers.splice(y,0,o))}else _=this._create(o,y,this.layers),!y||y>=this.layers.length?(this.layers.push(_),h.layers.push(o)):(this.layers.splice(y,0,_),h.layers.splice(y,0,o));this._layerByName[o.id]=_,this._uidToLayer.set(_.uid,_),D&&this._recomputeZValues(),this._identifyRefLayers()}getStyleLayer(o){const y=this._layerByName[o];return y?{type:y.typeName,id:y.id,source:y.source,"source-layer":y.sourceLayer,minzoom:y.minzoom,maxzoom:y.maxzoom,filter:y.filter,layout:y.layout,paint:y.paint}:null}deleteStyleLayer(o){const y=this._layerByName[o];if(y){delete this._layerByName[o],this._uidToLayer.delete(y.uid);const h=this.layers.indexOf(y);this.layers.splice(h,1),this._style.layers.splice(h,1),this._recomputeZValues(),this._identifyRefLayers()}}getLayerById(o){return this._layerByName[o]}getLayoutProperties(o){const y=this._layerByName[o];return y?y.layout:null}getPaintProperties(o){const y=this._layerByName[o];return y?y.paint:null}setPaintProperties(o,y){const h=this._layerByName[o];if(!h)return;const D=N._recreateLayer({type:h.typeName,id:h.id,source:h.source,"source-layer":h.sourceLayer,minzoom:h.minzoom,maxzoom:h.maxzoom,filter:h.filter,layout:h.layout,paint:y},h),R=this.layers.indexOf(h);this.layers[R]=D,this._style.layers[R].paint=y,this._layerByName[h.id]=D,this._uidToLayer.set(h.uid,D)}setLayoutProperties(o,y){const h=this._layerByName[o];if(!h)return;const D=N._recreateLayer({type:h.typeName,id:h.id,source:h.source,"source-layer":h.sourceLayer,minzoom:h.minzoom,maxzoom:h.maxzoom,filter:h.filter,layout:y,paint:h.paint},h),R=this.layers.indexOf(h);this.layers[R]=D,this._style.layers[R].layout=y,this._layerByName[h.id]=D,this._uidToLayer.set(h.uid,D)}setStyleLayerVisibility(o,y){const h=this._layerByName[o];if(!h)return;const _=h.layout||{};_.visibility=y;const R=N._recreateLayer({type:h.typeName,id:h.id,source:h.source,"source-layer":h.sourceLayer,minzoom:h.minzoom,maxzoom:h.maxzoom,filter:h.filter,layout:_,paint:h.paint},h),U=this.layers.indexOf(h);this.layers[U]=R,this._style.layers[U].layout=_,this._layerByName[h.id]=R,this._uidToLayer.set(h.uid,R)}getStyleLayerVisibility(o){const y=this._layerByName[o];return y?y.layout?.visibility??"visible":"none"}_recomputeZValues(){const o=this.layers,y=1/(o.length+1);for(let h=0;h<o.length;h++)o[h].z=1-(1+h)*y}_identifyRefLayers(){const o=[],y=[];let h=0;for(const _ of this.layers){const D=_.layout;if(_.type===S.Dc.FILL){const R=_;let U=_.source+"|"+_.sourceLayer;U+="|"+(D?.visibility??""),U+="|"+_.minzoom,U+="|"+_.maxzoom,U+="|"+JSON.stringify(_.filter),(R.hasDataDrivenFill||R.hasDataDrivenOutline)&&(U+="|"+h),o.push({key:U,layer:_})}else if(_.type===S.Dc.LINE){const R=_,U=_.paint,k=null!=U&&(null!=U["line-pattern"]||null!=U["line-dasharray"]);let G=_.source+"|"+_.sourceLayer;G+="|"+(D?.visibility??""),G+="|"+_.minzoom,G+="|"+_.maxzoom,G+="|"+JSON.stringify(_.filter),G+="|"+(void 0!==D?D["line-cap"]:""),G+="|"+(void 0!==D?D["line-join"]:""),(R.hasDataDrivenLine||k)&&(G+="|"+h),y.push({key:G,layer:_})}++h}this._assignRefLayers(o),this._assignRefLayers(y)}_assignRefLayers(o){let y,h;o.sort((D,R)=>D.key<R.key?-1:D.key>R.key?1:0);const _=o.length;for(let D=0;D<_;D++){const R=o[D];if(R.key===y)R.layer.refLayerId=h;else if(y=R.key,h=R.layer.id,R.layer.type===S.Dc.FILL){if(!R.layer.getPaintProperty("fill-outline-color"))for(let U=D+1;U<_;U++){const k=o[U];if(k.key!==y)break;if(k.layer.getPaintProperty("fill-outline-color")){o[D]=k,o[U]=R,h=k.layer.id;break}}}else if(R.layer.type===S.Dc.LINE){let U=R.layer;for(let k=D+1;k<_;k++){const G=o[k];if(G.key!==y)break;const K=G.layer;(U.canUseThinTessellation&&!K.canUseThinTessellation||!U.canUseThinTessellation&&(K.getPaintProperty("line-pattern")||K.getPaintProperty("line-dasharray")))&&(U=K,o[D]=G,o[k]=R,h=G.layer.id)}}}}_create(o,y,h){const _=1-(1+y)*(1/(h.length+1)),D=this._runningId++;switch(o.type){case"background":return new B.lf(S.Dc.BACKGROUND,o,_,D);case"fill":return new B.A4(S.Dc.FILL,o,_,D);case"line":return new B.tU(S.Dc.LINE,o,_,D);case"symbol":return new B.V1(S.Dc.SYMBOL,o,_,D);case"raster":return console.warn(`Unsupported vector tile raster layer ${o.id}`),null;case"circle":return new B.L(S.Dc.CIRCLE,o,_,D)}return null}static _recreateLayer(o,y){switch(o.type){case"background":return new B.lf(S.Dc.BACKGROUND,o,y.z,y.uid);case"fill":return new B.A4(S.Dc.FILL,o,y.z,y.uid);case"line":return new B.tU(S.Dc.LINE,o,y.z,y.uid);case"symbol":return new B.V1(S.Dc.SYMBOL,o,y.z,y.uid);case"raster":return console.warn(`Unsupported vector tile raster layer ${o.id}`),null;case"circle":return new B.L(S.Dc.CIRCLE,o,y.z,y.uid)}return null}}}}]);