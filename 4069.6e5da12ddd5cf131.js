"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[4069],{23506:(w,P,o)=>{o.d(P,{v:()=>a});var l=o(99305);function a(d){d?.writtenProperties&&d.writtenProperties.forEach(({target:f,propName:E,newOrigin:_})=>{(0,l.H)(f)&&_&&f.originOf(E)!==_&&f.updateOrigin(E,_)})}},99305:(w,P,o)=>{function l(a){return a&&"getAtOrigin"in a&&"originOf"in a}o.d(P,{H:()=>l})},4069:(w,P,o)=>{o.r(P),o.d(P,{save:()=>O,saveAs:()=>g});var l=o(10467),a=o(17994),d=o(69927);const f="Stream Service",E="Feed",_="stream-layer-save",u="stream-layer-save-as";function v(p){return{isValid:"stream"===p.type&&!!p.url&&!p.webSocketUrl,errorMessage:"Stream layer should be created using a url to a stream service"}}function c(p){const s=p.layerJSON;return Promise.resolve(s&&Object.keys(s).length?s:null)}function m(p,s){return y.apply(this,arguments)}function y(){return(y=(0,l.A)(function*(p,s){const{parsedUrl:U,title:C,fullExtent:b}=p;s.url=U.path,s.title||=C,s.extent=null,null!=b&&(s.extent=yield(0,d.sQ)(b)),(0,d.OM)(s,d.mm.METADATA),(0,d.LG)(s,d.mm.SINGLE_LAYER)})).apply(this,arguments)}function O(p,s){return h.apply(this,arguments)}function h(){return(h=(0,l.A)(function*(p,s){return(0,a.UN)({layer:p,itemType:f,additionalItemType:E,validateLayer:v,createItemData:c,errorNamePrefix:_},s)})).apply(this,arguments)}function g(p,s,U){return M.apply(this,arguments)}function M(){return(M=(0,l.A)(function*(p,s,U){return(0,a.Uh)({layer:p,itemType:f,validateLayer:v,createItemData:c,errorNamePrefix:u,newItem:s,setItemProperties:m},U)})).apply(this,arguments)}},17994:(w,P,o)=>{o.d(P,{B5:()=>W,CJ:()=>U,Gy:()=>O,UN:()=>N,Uh:()=>B,Y:()=>c,Y0:()=>p,Y9:()=>b,eP:()=>M});var l=o(10467),a=o(5922),d=o(23506),f=o(73874),E=o(46577),_=o(15764),u=o(69927),v=o(95945);function c(e,t,n){const r=n(e);if(!r.isValid)throw new a.A(`${t}:invalid-parameters`,r.errorMessage,{layer:e})}function m(e){return y.apply(this,arguments)}function y(){return(y=(0,l.A)(function*(e){const{layer:t,errorNamePrefix:n,validateLayer:r}=e;yield t.load(),c(t,n,r)})).apply(this,arguments)}function O(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function h(e){const{item:t,errorNamePrefix:n,layer:r,validateItem:A}=e;if(function g(e){const{item:t,itemType:n,additionalItemType:r,errorNamePrefix:A,layer:D}=e,I=[n];if(r&&I.push(r),!I.includes(t.type)){const T=I.map(i=>`'${i}'`).join(", ");throw new a.A(`${A}:portal-item-wrong-type`,`Portal item type should be one of: "${T}"`,{item:t,layer:D})}}(e),A){const D=A(t);if(!D.isValid)throw new a.A(`${n}:invalid-parameters`,D.errorMessage,{layer:r})}}function M(e){const{layer:t,errorNamePrefix:n}=e,{portalItem:r}=t;if(!r)throw new a.A(`${n}:portal-item-not-set`,O(t,"requires the portalItem property to be set"));if(!r.loaded)throw new a.A(`${n}:portal-item-not-loaded`,O(t,"cannot be saved to a portal item that does not exist or is inaccessible"));h({...e,item:r})}function p(e){const{newItem:t,itemType:n}=e;let r=E.default.from(t);return r.id&&(r=r.clone(),r.id=null),r.type??=n,r.portal??=f.A.getDefault(),h({...e,item:r}),r}function s(e){return(0,_.m)(e,"portal-item")}function U(e,t,n){return C.apply(this,arguments)}function C(){return(C=(0,l.A)(function*(e,t,n){"beforeSave"in e&&"function"==typeof e.beforeSave&&(yield e.beforeSave());const r=e.write({},t);return yield Promise.all(t.resources?.pendingOperations??[]),(0,v.c)(t,{errorName:"layer-write:unsupported"},n),r})).apply(this,arguments)}function b(e){(0,u.LG)(e,u.mm.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((t,n,r)=>r.indexOf(t)===n))}function W(e,t,n){return R.apply(this,arguments)}function R(){return(R=(0,l.A)(function*(e,t,n){const r=e.portal;yield r.signIn(),yield r.user.addItem({item:e,data:t,folder:n?.folder})})).apply(this,arguments)}function N(e,t){return S.apply(this,arguments)}function S(){return(S=(0,l.A)(function*(e,t){const{layer:n,createItemData:r,createJSONContext:A,setItemProperties:D,saveResources:I,supplementalUnsupportedErrors:T}=e;yield m(e),M(e);const i=n.portalItem,x=A?A(i):s(i),K=yield U(n,x,{...t,supplementalUnsupportedErrors:T}),L=yield r({layer:n,layerJSON:K},i);return yield D?.(n,i,L),b(i),yield i.update({data:L}),(0,d.v)(x),yield I?.(i,x),i})).apply(this,arguments)}function B(e,t){return j.apply(this,arguments)}function j(){return(j=(0,l.A)(function*(e,t){const{layer:n,createItemData:r,createJSONContext:A,setItemProperties:D,saveResources:I,supplementalUnsupportedErrors:T}=e;yield m(e);const i=p(e),x=A?A(i):s(i),K=yield U(n,x,{...t,supplementalUnsupportedErrors:T}),L=yield r({layer:n,layerJSON:K},i);return yield D(n,i,L),b(i),yield W(i,L,t),n.portalItem=i,(0,d.v)(x),yield I?.(i,x),i})).apply(this,arguments)}},15764:(w,P,o)=>{o.d(P,{m:()=>f,v:()=>d});var l=o(45272),a=o(73874);function d(_,u){return{...E(_,u),readResourcePaths:[]}}function f(_,u,v){const c=(0,l.An)(_.itemUrl);return{...E(_,u),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:c?{rootPath:c.path,writtenUrls:[]}:null,resources:v?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function E(_,u){return{origin:u,url:(0,l.An)(_.itemUrl),portal:_.portal||a.A.getDefault(),portalItem:_}}},95945:(w,P,o)=>{o.d(P,{c:()=>_,d:()=>d});var l=o(10467),a=o(5922);function d(u){return f.apply(this,arguments)}function f(){return(f=(0,l.A)(function*(u){const v=[];for(const c of u.allLayers)if("beforeSave"in c&&"function"==typeof c.beforeSave){const m=c.beforeSave();m&&v.push(m)}yield Promise.allSettled(v)})).apply(this,arguments)}const E=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function _(u,v,c){let m=(u.messages??[]).filter(({type:y})=>"error"===y).map(({name:y,message:O,details:h})=>new a.A(y,O,h));if(u.blockedRelativeUrls&&(m=m.concat(u.blockedRelativeUrls.map(y=>new a.A("url:unsupported",`Relative url '${y}' is not supported`)))),c){const{ignoreUnsupported:y,supplementalUnsupportedErrors:O=[],requiredPropertyChecksDisabled:h}=c;y&&(m=m.filter(({name:g})=>!(E.has(g)||O.includes(g)))),h&&(m=m.filter(g=>"web-document-write:property-required"!==g.name))}if(m.length>0)throw new a.A(v.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:m})}}}]);