"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[2205],{1852:(J,B,n)=>{n.r(B),n.d(B,{default:()=>fe});var E=n(10467),i=n(8189),K=n(92165),x=n(89563),j=n(5922),g=n(77806),m=n(35150),S=n(39693),v=n(89221),h=n(56492),I=n(45272),p=n(85211),Z=(n(3248),n(17221)),O=n(76576),X=n(50305),Q=n(95478),H=n(94376),C=n(25936),d=n(23e3),M=n(17049),A=n(85551),y=n(33036),W=n(46406),$=n(55739),U=n(15463),V=n(71065);n(40707);let w=class extends V.A{constructor(u){super(u),this.field=null,this.type=null}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}};(0,i._)([(0,p.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],w.prototype,"field",void 0),(0,i._)([(0,p.MZ)({readOnly:!0,nonNullable:!0,json:{read:!1,write:{isRequired:!0}}})],w.prototype,"type",void 0),w=(0,i._)([(0,O.$)("esri.layers.pointCloudFilters.PointCloudFilter")],w);const t=w;var o;let s=o=class extends t{constructor(u){super(u),this.requiredClearBits=null,this.requiredSetBits=null,this.type="bitfield"}clone(){return new o({field:this.field,requiredClearBits:(0,g.o8)(this.requiredClearBits),requiredSetBits:(0,g.o8)(this.requiredSetBits)})}};(0,i._)([(0,p.MZ)({type:[$.jz],json:{write:{enabled:!0,overridePolicy(){return{enabled:!0,isRequired:!this.requiredSetBits}}}}})],s.prototype,"requiredClearBits",void 0),(0,i._)([(0,p.MZ)({type:[$.jz],json:{write:{enabled:!0,overridePolicy(){return{enabled:!0,isRequired:!this.requiredClearBits}}}}})],s.prototype,"requiredSetBits",void 0),(0,i._)([(0,U.e)({pointCloudBitfieldFilter:"bitfield"})],s.prototype,"type",void 0),s=o=(0,i._)([(0,O.$)("esri.layers.pointCloudFilters.PointCloudBitfieldFilter")],s);const c=s;var _;let P=_=class extends t{constructor(u){super(u),this.includedReturns=[],this.type="return"}clone(){return new _({field:this.field,includedReturns:(0,g.o8)(this.includedReturns)})}};(0,i._)([(0,p.MZ)({type:[["firstOfMany","last","lastOfMany","single"]],json:{write:{enabled:!0,isRequired:!0}}})],P.prototype,"includedReturns",void 0),(0,i._)([(0,U.e)({pointCloudReturnFilter:"return"})],P.prototype,"type",void 0),P=_=(0,i._)([(0,O.$)("esri.layers.pointCloudFilters.PointCloudReturnFilter")],P);const R=P;var T;let N=T=class extends t{constructor(u){super(u),this.mode="exclude",this.type="value",this.values=[]}clone(){return new T({field:this.field,mode:this.mode,values:(0,g.o8)(this.values)})}};(0,i._)([(0,p.MZ)({type:["exclude","include"],json:{write:{enabled:!0,isRequired:!0}}})],N.prototype,"mode",void 0),(0,i._)([(0,U.e)({pointCloudValueFilter:"value"})],N.prototype,"type",void 0),(0,i._)([(0,p.MZ)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],N.prototype,"values",void 0),N=T=(0,i._)([(0,O.$)("esri.layers.pointCloudFilters.PointCloudValueFilter")],N);const ie={key:"type",base:t,typeMap:{value:N,bitfield:c,return:R}};var te,q=n(22329),ee=n(29141),le=n(3404),ne=n(26025),ae=n(49873),oe=n(63115);let Y=te=class extends oe.A{constructor(u){super(u),this.type="point-cloud-rgb",this.field=null}clone(){return new te({...this.cloneProperties(),field:(0,g.o8)(this.field)})}};(0,i._)([(0,U.e)({pointCloudRGBRenderer:"point-cloud-rgb"})],Y.prototype,"type",void 0),(0,i._)([(0,p.MZ)({type:String,json:{write:{isRequired:!0}}})],Y.prototype,"field",void 0),Y=te=(0,i._)([(0,O.$)("esri.renderers.PointCloudRGBRenderer")],Y);const de=Y;var ue=n(87862),ce=n(87701);const re={key:"type",base:oe.A,typeMap:{"point-cloud-class-breaks":ae.A,"point-cloud-rgb":de,"point-cloud-stretch":ue.A,"point-cloud-unique-value":ce.A},errorContext:"renderer"};var k=n(73812),pe=n(41843);const se=(0,le.p)();let F=class extends((0,W.w6)((0,C.b)((0,M.q)((0,A.A)((0,y.j)((0,S.P)((0,d.d)((0,H.p)(Q.A))))))))){constructor(...u){super(...u),this.operationalLayerType="PointCloudLayer",this.popupEnabled=!0,this.popupTemplate=null,this.opacity=1,this.filters=[],this.fields=null,this.fieldsIndex=null,this.outFields=null,this.path=null,this.legendEnabled=!0,this.renderer=null,this.type="point-cloud"}normalizeCtorArgs(u,f){return"string"==typeof u?{url:u,...f}:u}get defaultPopupTemplate(){return this.attributeStorageInfo?this.createPopupTemplate():null}getFieldDomain(u){const f=this.fieldsIndex.get(u);return f?.domain?f.domain:null}readServiceFields(u,f,L){return Array.isArray(u)?u.map(b=>{const G=new ee.A;return"FieldTypeInteger"===b.type&&((b=(0,g.o8)(b)).type="esriFieldTypeInteger"),G.read(b,L),G}):Array.isArray(f.attributeStorageInfo)?f.attributeStorageInfo.map(b=>new ee.A({name:b.name,type:"ELEVATION"===b.name?"double":"integer"})):null}set elevationInfo(u){null!=u&&"absolute-height"!==u.mode||this._set("elevationInfo",u),this._validateElevationInfo(u)}writeRenderer(u,f,L,b){(0,v.sM)("layerDefinition.drawingInfo.renderer",u.write({},b),f)}load(u){const f=null!=u?u.signal:null,L=this.loadFromPortal({supportedTypes:["Scene Service"]},u).catch(h.QP).then(()=>this._fetchService(f));return this.addResolvingPromise(L),Promise.resolve(this)}createPopupTemplate(u){const f=(0,pe.tn)(this,u);return f&&(this._formatPopupTemplateReturnsField(f),this._formatPopupTemplateRGBField(f)),f}_formatPopupTemplateReturnsField(u){const f=this.fieldsIndex.get("RETURNS");if(!f)return;const L=u.fieldInfos?.find(G=>G.fieldName===f.name);if(!L)return;const b=new ne.A({name:"pcl-returns-decoded",title:f.alias||f.name,expression:`\n        var returnValue = $feature.${f.name};\n        return (returnValue % 16) + " / " + Floor(returnValue / 16);\n      `});u.expressionInfos=[...u.expressionInfos||[],b],L.fieldName="expression/pcl-returns-decoded"}_formatPopupTemplateRGBField(u){const f=this.fieldsIndex.get("RGB");if(!f)return;const L=u.fieldInfos?.find(G=>G.fieldName===f.name);if(!L)return;const b=new ne.A({name:"pcl-rgb-decoded",title:f.alias||f.name,expression:`\n        var rgb = $feature.${f.name};\n        var red = Floor(rgb / 65536, 0);\n        var green = Floor((rgb - (red * 65536)) / 256,0);\n        var blue = rgb - (red * 65536) - (green * 256);\n\n        return "rgb(" + red + "," + green + "," + blue + ")";\n      `});u.expressionInfos=[...u.expressionInfos||[],b],L.fieldName="expression/pcl-rgb-decoded"}queryCachedStatistics(u,f){var L=this;return(0,E.A)(function*(){if(yield L.load(f),!L.attributeStorageInfo)throw new j.A("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");const b=L.fieldsIndex.get(u);if(!b)throw new j.A("pointcloudlayer:field-unexisting",`Field '${u}' does not exist on the layer`);for(const G of L.attributeStorageInfo)if(G.name===b.name){const _e=(0,I.fj)(L.parsedUrl?.path??"",`./statistics/${G.key}`);return(0,x.A)(_e,{query:{f:"json",...L.customParameters,token:L.apiKey},responseType:"json",signal:f?f.signal:null}).then(ve=>ve.data)}throw new j.A("pointcloudlayer:no-cached-statistics","Cached statistics for this attribute are not available")})()}saveAs(u,f){var L=this;return(0,E.A)(function*(){return L._debouncedSaveOperations(W.Xh.SAVE_AS,{...f,getTypeKeywords:()=>L._getTypeKeywords(),portalItemLayerType:"point-cloud"},u)})()}save(){var u=this;return(0,E.A)(function*(){const f={getTypeKeywords:()=>u._getTypeKeywords(),portalItemLayerType:"point-cloud"};return u._debouncedSaveOperations(W.Xh.SAVE,f)})()}validateLayer(u){if(u.layerType&&"PointCloud"!==u.layerType)throw new j.A("pointcloudlayer:layer-type-not-supported","PointCloudLayer does not support this layer type",{layerType:u.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new j.A("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x-2.x"});if(this.version.major>2)throw new j.A("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x-2.x"})}hasCachedStatistics(u){return null!=this.attributeStorageInfo&&this.attributeStorageInfo.some(f=>f.name===u)}_getTypeKeywords(){return["PointCloud"]}_validateElevationInfo(u){(0,k.XF)(m.A.getLogger(this),(0,k.B)("Point cloud layers","absolute-height",u)),(0,k.XF)(m.A.getLogger(this),(0,k.tW)("Point cloud layers",u))}};(0,i._)([(0,p.MZ)({type:["PointCloudLayer"]})],F.prototype,"operationalLayerType",void 0),(0,i._)([(0,p.MZ)(q.M6)],F.prototype,"popupEnabled",void 0),(0,i._)([(0,p.MZ)({type:K.A,json:{name:"popupInfo",write:!0}})],F.prototype,"popupTemplate",void 0),(0,i._)([(0,p.MZ)({readOnly:!0,json:{read:!1}})],F.prototype,"defaultPopupTemplate",null),(0,i._)([(0,p.MZ)({readOnly:!0,json:{write:!1,read:!1,origins:{"web-document":{write:!1,read:!1}}}})],F.prototype,"opacity",void 0),(0,i._)([(0,p.MZ)({type:["show","hide"]})],F.prototype,"listMode",void 0),(0,i._)([(0,p.MZ)({types:[ie],json:{origins:{service:{read:{source:"filters"}}},name:"layerDefinition.filters",write:!0}})],F.prototype,"filters",void 0),(0,i._)([(0,p.MZ)({type:[ee.A]})],F.prototype,"fields",void 0),(0,i._)([(0,p.MZ)(se.fieldsIndex)],F.prototype,"fieldsIndex",void 0),(0,i._)([(0,Z.w)("service","fields",["fields","attributeStorageInfo"])],F.prototype,"readServiceFields",null),(0,i._)([(0,p.MZ)(se.outFields)],F.prototype,"outFields",void 0),(0,i._)([(0,p.MZ)({readOnly:!0})],F.prototype,"attributeStorageInfo",void 0),(0,i._)([(0,p.MZ)(q.Yj)],F.prototype,"elevationInfo",null),(0,i._)([(0,p.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],F.prototype,"path",void 0),(0,i._)([(0,p.MZ)(q.fV)],F.prototype,"legendEnabled",void 0),(0,i._)([(0,p.MZ)({types:re,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:{target:{"layerDefinition.drawingInfo.renderer":{types:re},"layerDefinition.drawingInfo.transparency":{type:Number}}}}})],F.prototype,"renderer",void 0),(0,i._)([(0,X.K)("renderer")],F.prototype,"writeRenderer",null),(0,i._)([(0,p.MZ)({json:{read:!1},readOnly:!0})],F.prototype,"type",void 0),F=(0,i._)([(0,O.$)("esri.layers.PointCloudLayer")],F);const fe=F},23e3:(J,B,n)=>{n.d(B,{d:()=>m});var E=n(8189),i=n(85211),g=(n(3248),n(35150),n(40707),n(76576));const m=S=>{let v=class extends S{constructor(){super(...arguments),this.customParameters=null}};return(0,E._)([(0,i.MZ)({type:Object,json:{write:{overridePolicy:h=>({enabled:!!(h&&Object.keys(h).length>0)})}}})],v.prototype,"customParameters",void 0),v=(0,E._)([(0,g.$)("esri.layers.mixins.CustomParametersMixin")],v),v}},33036:(J,B,n)=>{n.d(B,{j:()=>m});var E=n(8189),i=n(85211),g=(n(3248),n(35150),n(40707),n(76576));const m=v=>{let h=class extends v{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const I={minScale:this.minScale,maxScale:this.maxScale},p=this.parent;p&&"effectiveScaleRange"in p&&function S(v,h){v.minScale=v.minScale>0?h.minScale>0?Math.min(v.minScale,h.minScale):v.minScale:h.minScale,v.maxScale=v.maxScale>0?h.maxScale>0?Math.max(v.maxScale,h.maxScale):v.maxScale:h.maxScale}(I,p.effectiveScaleRange);const D=this._get("effectiveScaleRange");return D&&D.minScale===I.minScale&&D.maxScale===I.maxScale?D:I}};return(0,E._)([(0,i.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],h.prototype,"minScale",void 0),(0,E._)([(0,i.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],h.prototype,"maxScale",void 0),(0,E._)([(0,i.MZ)({readOnly:!0})],h.prototype,"effectiveScaleRange",null),h=(0,E._)([(0,g.$)("esri.layers.mixins.ScaleRangeLayer")],h),h}},73258:(J,B,n)=>{n.d(B,{A:()=>Z});var E=n(5922),i=n(71065),K=n(35150),x=n(60797),j=n(24098),g=n(86300),m=n(20543),S=n(22639),v=n(44549);const D=new Map;class Z{static fromJSON(d){return new Z(d.fields,d.timeZoneByFieldName)}static fromLayer(d){return new Z(d.fields??[],H(d))}static fromLayerJSON(d){return new Z(d.fields??[],H(d))}constructor(d=[],M){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=d||[],this._timeZoneByFieldName=M?new Map(M):null;const A=[];for(const y of this.fields){const W=y?.name,$=X(W);if(W&&$){const U=O(W);this._fieldsMap.set(W,y),this._fieldsMap.set(U,y),this._normalizedFieldsMap.set($,y),A.push(`${U}:${y.type}:${this._timeZoneByFieldName?.get(W)}`),(0,g.vE)(y)?(this.dateFields.push(y),this._dateFieldsSet.add(y)):(0,g.WA)(y)&&(this._numericFieldsSet.add(y),this.numericFields.push(y)),(0,g.te)(y)||(0,g.Xz)(y)||(y.editable=null==y.editable||!!y.editable,y.nullable=null==y.nullable||!!y.nullable)}}A.sort(),this.uid=A.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const d of this.fields)(0,g.te)(d)||(0,g.Xz)(d)||d.nullable||void 0!==(0,g.lD)(d)||this._requiredFields.push(d)}return this._requiredFields}equals(d){return this.uid===d?.uid}has(d){return null!=this.get(d)}get(d){if(!d)return;let M=this._fieldsMap.get(d);return M||(M=this._fieldsMap.get(O(d))??this._normalizedFieldsMap.get(X(d)),M&&this._fieldsMap.set(d,M),M)}getTimeZone(d){const M=this.get(d&&"string"!=typeof d?d.name:d);return M?this._timeZoneByFieldName?this._timeZoneByFieldName.get(M.name):"date"===M.type||"esriFieldTypeDate"===M.type?(K.A.getLogger("esri.layers.support.FieldsIndex").errorOnce(new E.A("getTimeZone:no-timezone-information",`no time zone information for field '${M.name}'`)),m.n$):Q.has(M.type)?m.L5:null:null}getLuxonTimeZone(d){const M=this.getTimeZone(d);return M?M===m.L5?j.GB.instance:M===m.n$?v.mQ.utcInstance:(0,x.tE)(D,M,()=>v.oh.create(M)):null}isDateField(d){return this._dateFieldsSet.has(this.get(d))}isTimeOnlyField(d){return(0,g.OH)(this.get(d))}isNumericField(d){return this._numericFieldsSet.has(this.get(d))}normalizeFieldName(d){return this.get(d)?.name??void 0}toJSON(){return{fields:this.fields.map(d=>i.A.isSerializable(d)?d.toJSON():d),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function O(C){return C.trim().toLowerCase()}function X(C){return(0,g.rS)(C)?.toLowerCase()??""}const Q=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function H(C){const d=new Map;if(!C.fields)return d;const M=!0===C.datesInUnknownTimezone,{timeInfo:A,editFieldsInfo:y}=C,W=(A?"startField"in A?A.startField:A.startTimeField:"")??"",$=(A?"endField"in A?A.endField:A.endTimeField:"")??"",U=function p(C){return"dateFieldsTimeZone"in C}(C)?C.dateFieldsTimeZone??null:C.dateFieldsTimeReference?(0,S.ZS)(C.dateFieldsTimeReference):null,V=y?function h(C){return"timeZone"in C}(y)?y.timeZone??U:y.dateFieldsTimeReference?(0,S.ZS)(y.dateFieldsTimeReference):U??m.n$:null,z=A?function I(C){return"timeZone"in C}(A)?A.timeZone??U:A.timeReference?(0,S.ZS)(A.timeReference):U:null,w=new Map([[O(y?.creationDateField??""),V],[O(y?.editDateField??""),V],[O(W),z],[O($),z]]);for(const{name:t,type:o}of C.fields)if(Q.has(o))d.set(t,m.L5);else if("date"!==o&&"esriFieldTypeDate"!==o)d.set(t,null);else if(M)d.set(t,m.L5);else{const s=w.get(O(t??""))??U;d.set(t,s)}return d}},3404:(J,B,n)=>{n.d(B,{p:()=>g});var E=n(3248),i=n(35150),K=n(29141),x=n(73258),j=n(86300);function g(){return{fields:{type:[K.A],value:null,set:function(m){if(m&&(0,E.A)("big-integer-warning-enabled")){const S=m.filter(v=>"big-integer"===v.type||"oid"===v.type&&(v.length||0)>=8);if(S.length){const v=S.map(h=>`'${h.name}'`).join(", ");i.A.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${v}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",m)}},fieldsIndex:{readOnly:!0,get(){return x.A.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(m){this._userOutFields=m,this.notifyChange("outFields")},get:function(){const m=this._userOutFields;if(!m?.length)return null;if(m.includes("*"))return["*"];if(!this.fields)return m;for(const S of m)this.fieldsIndex?.has(S)||i.A.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${S} found in outFields`,{layer:this,outFields:m});return(0,j.DB)(this.fieldsIndex,m)}}}}},23005:(J,B,n)=>{n.d(B,{A:()=>Z});var I,E=n(8189),i=n(90660),K=n(49976),x=n(71065),j=n(85211),g=n(55739),v=(n(3248),n(40707),n(15463)),h=n(76576);const p=(0,K.O)()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let D=I=class extends(i.A.ClonableMixin(x.A)){static from(O){return(0,g.PZ)(I,O)}constructor(O){super(O),this.title=null,this.order=null}};(0,E._)([(0,j.MZ)({type:String,json:{write:!0}})],D.prototype,"title",void 0),(0,E._)([(0,v.e)(p)],D.prototype,"order",void 0),D=I=(0,E._)([(0,h.$)("esri.renderers.support.RendererLegendOptions")],D);const Z=D},5236:(J,B,n)=>{n.d(B,{A:()=>p});var h,E=n(8189),i=n(68677),K=n(71065),x=n(85211),j=n(55739),S=(n(3248),n(40707),n(76576)),v=n(50305);let I=h=class extends K.A{constructor(D){super(D),this.color=null,this.label=null,this.value=null}writeValue(D,Z,O){Z[O]=D??0}clone(){return new h({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};(0,E._)([(0,x.MZ)({type:i.A,json:{type:[j.jz],write:{isRequired:!0}}})],I.prototype,"color",void 0),(0,E._)([(0,x.MZ)({type:String,json:{write:!0}})],I.prototype,"label",void 0),(0,E._)([(0,x.MZ)({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],I.prototype,"value",void 0),(0,E._)([(0,v.K)("value")],I.prototype,"writeValue",null),I=h=(0,E._)([(0,S.$)("esri.renderers.visualVariables.support.ColorStop")],I);const p=I},73812:(J,B,n)=>{n.d(B,{$7:()=>W,B:()=>y,Fo:()=>C,M7:()=>V,NN:()=>h,Q5:()=>d,Tq:()=>w,Up:()=>A,XF:()=>U,Ze:()=>O,bK:()=>j,bh:()=>v,id:()=>X,ky:()=>S,qt:()=>z,tW:()=>$,v9:()=>I,w7:()=>g,wF:()=>x,wS:()=>Q,wz:()=>D,x:()=>p,xS:()=>H,ze:()=>m});var E=n(82663),i=n(82575);function K(t){return t?z:w}function x(t,o){return o?.mode?o.mode:K(t).mode}function j(t,o){return o??K(t)}function g(t,o){return x(null==t||(t.hasZ??!1),o)}function m(t,o){return j(null==t||(t.hasZ??!1),o)}function S(t){const o=Z(t);return g(t.geometry,o)}function v(t){const o=Z(t),s=g(t.geometry,o),c=null!=o&&"on-the-ground"!==s?V(o):0,_=o?.featureExpressionInfo;return{mode:s,offset:c,featureExpressionInfo:_}}function h(t){return D(v(t))}function I(t){return D(t)||p(t)}function p(t){return"0"===t?.featureExpressionInfo?.expression}function D(t){if(!t||"on-the-ground"===t.mode)return!1;const o=t?.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!o||"0"===o)}function Z(t){return t.layer&&"elevationInfo"in t.layer?t.layer.elevationInfo:null}function O(t,o){if(!t?.offset)return 0;const{offset:s,unit:c}=t;if("decimal-degrees"===c)return 0;const _="unknown"!==c&&c?c:"meters",P=(0,E.mq)(o);return P?(0,E.oU)(s,_,P):0}function X(t,o,s){if(!s?.mode)return;const c=t.hasZ?t.z:0,_=O(s,t.spatialReference);switch(s.mode){case"absolute-height":return c-_;case"on-the-ground":return 0;case"relative-to-ground":return c-((o.elevationProvider.getElevation(t.x,t.y,c,t.spatialReference,"ground")??0)+_);case"relative-to-scene":return c-((o.elevationProvider.getElevation(t.x,t.y,c,t.spatialReference,"scene")??0)+_)}}function Q(t,o,s,c=null){return C(t,o.x,o.y,o.hasZ?o.z:0,o.spatialReference,s,c)}function H(t,o,s,c,_=null){return C(t,o[0],o[1],o.length>2?o[2]:0,s,c,_)}function C(t,o,s,c,_,P,R=null){if(null==P)return;const T=null!=R?R.mode:"absolute-height";if("on-the-ground"===T)return 0;const{absoluteZ:N}=d(o,s,c,_,t,P);return function M(t,o,s,c,_,P,R,T){const N=O(R,_);switch(T){case"absolute-height":return t-N;case"relative-to-ground":return t-((P.elevationProvider.getElevation(o,s,c,_,"ground")??0)+N);case"relative-to-scene":return t-((P.elevationProvider.getElevation(o,s,c,_,"scene")??0)+N)}}(N,o,s,c,_,t,R,T)}function d(t,o,s,c,_,P){const R=O(P,c);switch(P.mode){case"absolute-height":return{absoluteZ:s+R,elevation:0};case"on-the-ground":{const T=_.elevationProvider.getElevation(t,o,0,c,"ground")??0;return{absoluteZ:T,elevation:T}}case"relative-to-ground":{const T=_.elevationProvider.getElevation(t,o,s,c,"ground")??0;return{absoluteZ:s+T+R,elevation:T}}case"relative-to-scene":{const T=_.elevationProvider.getElevation(t,o,s,c,"scene")??0;return{absoluteZ:s+T+R,elevation:T}}}}function A(t,o){if(null==o)return!1;const{mode:s}=o;return null!=s&&("scene"===t&&"relative-to-scene"===s||"ground"===t&&"absolute-height"!==s)}function y(t,o,s){return s&&s.mode!==o?`${t} only support ${o} elevation mode`:null}function W(t,o,s){return s?.mode===o?`${t} do not support ${o} elevation mode`:null}function $(t,o){return null!=o?.featureExpressionInfo&&"0"!==o.featureExpressionInfo.expression?`${t} do not support featureExpressionInfo`:null}function U(t,o){o&&t.warn(".elevationInfo=",o)}function V(t){return(t?.offset??0)*(0,i.Ao)(t?.unit)}const z={mode:"absolute-height",offset:0},w={mode:"on-the-ground",offset:null}},41843:(J,B,n)=>{n.d(B,{DQ:()=>X,tn:()=>Z});var E=n(92165),i=n(86300),K=n(54042),m=(n(75432),n(65121),n(558),n(8975)),p=(n(90792),n(83902),n(98089),n(62270),n(61099)),D=n(17580);function Z({displayField:t,editFieldsInfo:o,fields:s,objectIdField:c,title:_},P){if(!s)return null;const R=function M(t,o){const s=o?.visibleFieldNames;return function H({fields:t,ignoreFieldTypes:o,sortDisabled:s}){const c=t;return o&&(t=t.filter(_=>!o.includes(_.type))),t===c&&(t=t.slice()),!0!==s&&t.sort(C),t}({fields:t.fields??[],ignoreFieldTypes:o?.ignoreFieldTypes||w,sortDisabled:o?.sortDisabled}).map(c=>new p.A({fieldName:c.name,isEditable:(0,i.R$)(c,t),label:c.alias,format:W(c),visible:Q(c,{...t,visibleFieldNames:s})}))}({editFieldsInfo:o,fields:s,objectIdField:c},P);if(!R.length)return null;const T=function V(t){const o=(0,i.mB)(t),{titleBase:s}=t;return o?`${s}: {${o.trim()}}`:s??""}({titleBase:_,fields:s,displayField:t}),N=function $(){return[new m.A,new K.A]}();return new E.A({title:T,content:N,fieldInfos:R})}function X(t){const{title:o,graphic:s}=t??{},{attributes:c,sourceLayer:_}=s??{},P=_&&"displayField"in _?_.displayField:null,R=P?c?.[P]:null,T=null!=R?JSON.stringify(R):null,N=s?.getObjectId()?.toString();return o||T||N||""}const Q=(t,o)=>o.visibleFieldNames?o.visibleFieldNames.has(t.name):(0,i.Bz)(t,o);function C(t,o){return"oid"===t.type?-1:"oid"===o.type?1:z(t)?-1:z(o)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((o.alias||o.name).toLocaleLowerCase())}function W(t){switch(t.type){case"small-integer":case"integer":case"single":return new D.A({digitSeparator:!0,places:0});case"double":return new D.A({digitSeparator:!0,places:2});case"string":return(0,i.JL)(t.name)?new D.A({digitSeparator:!0,places:0}):void 0;default:return}}function z(t){return"name"===(t.name&&t.name.toLowerCase())||"name"===t.alias?.toLowerCase()}const w=["geometry","blob","raster","guid","xml"]}}]);