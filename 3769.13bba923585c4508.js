"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[3769],{33087:(J,N,s)=>{s.d(N,{q:()=>p});var n=s(60611);class p{constructor(x,V){this._storage=new n.F,this.id="",this.name="",this.size=0,this._storage.maxSize=x,this._storage.register(this),V&&this._storage.registerRemoveFunc("",V)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(x,V,B=1){this._storage.put(this,x,V,B,1)}pop(x){return this._storage.pop(this,x)}get(x){return this._storage.get(this,x)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(x){this._storage.maxSize=x}resetHitRate(){}}},60611:(J,N,s)=>{s.d(N,{F:()=>B,Ti:()=>p});var n=s(12438);const p=-3,w=p-1;var x,j;(j=x||(x={}))[j.ALL=0]="ALL",j[j.SOME=1]="SOME";class B{get size(){return this._size}constructor(y=10485760){this._maxSize=y,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new n.A,this._users=new n.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear()}register(y){this._users.push(y)}deregister(y){this._users.removeUnordered(y)}registerRemoveFunc(y,m){this._removeFuncs.push([y,m])}deregisterRemoveFunc(y){this._removeFuncs.filterInPlace(m=>m[0]!==y)}get maxSize(){return this._maxSize}set maxSize(y){this._maxSize=Math.max(y,-1),this._checkSize()}getSize(y,m){return this._db.get(y.id+m)?.size??0}put(y,m,f,o,_){const d=this._db.get(m=y.id+m);if(d&&(this._size-=d.size,y.size-=d.size,this._db.delete(m),d.entry!==f&&this._notifyRemove(m,d.entry,d.size,x.ALL)),o>this._maxSize)return void this._notifyRemove(m,f,o,x.ALL);if(void 0===f)return void console.warn("Refusing to cache undefined entry ");if(!o||o<0)return console.warn(`Refusing to cache entry with size ${o} for key ${m}`),void this._notifyRemove(m,f,0,x.ALL);const v=1+Math.max(_,w)-p;this._db.set(m,new z(f,o,v)),this._size+=o,y.size+=o,this._checkSize()}updateSize(y,m,f,o){const _=this._db.get(m=y.id+m);if(_&&_.entry===f){for(this._size-=_.size,y.size-=_.size;o>this._maxSize;){const d=this._notifyRemove(m,f,o,x.SOME);if(!(null!=d&&d>0))return void this._db.delete(m);o=d}_.size=o,this._size+=o,y.size+=o,this._checkSize()}}pop(y,m){const f=this._db.get(m=y.id+m);if(f)return this._size-=f.size,y.size-=f.size,this._db.delete(m),++this._hit,f.entry;++this._miss}get(y,m){const f=this._db.get(m=y.id+m);if(void 0!==f)return this._db.delete(m),f.lives=f.lifetime,this._db.set(m,f),++this._hit,f.entry;++this._miss}peek(y,m){const f=this._db.get(y.id+m);return f?++this._hit:++this._miss,f?.entry}get performanceInfo(){const y={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},m={},f=new Array;this._db.forEach((d,v)=>{const S=d.lifetime;f[S]=(f[S]||0)+d.size,this._users.forAll(C=>{const{id:U,name:E}=C;v.startsWith(U)&&(m[E]=(m[E]||0)+d.size)})});const o={};this._users.forAll(d=>{const v=d.name;"hitRate"in d&&"number"==typeof d.hitRate&&!isNaN(d.hitRate)&&d.hitRate>0?(m[v]=m[v]||0,o[v]=Math.round(100*d.hitRate)+"%"):o[v]="0%"});const _=Object.keys(m);_.sort((d,v)=>m[v]-m[d]),_.forEach(d=>y[d]=Math.round(m[d]/2**20)+"MB / "+o[d]);for(let d=f.length-1;d>=0;--d){const v=f[d];v&&(y["Priority "+(d+p-1)]=Math.round(v/this._size*100)+"%")}return y}resetStats(){this._hit=this._miss=0,this._users.forAll(y=>y.resetHitRate())}clear(y){const m=y.id;this._db.forEach((f,o)=>{o.startsWith(m)&&(this._size-=f.size,this._db.delete(o),this._notifyRemove(o,f.entry,f.size,x.ALL))}),y.size=0}clearAll(){this._db.forEach((y,m)=>this._notifyRemove(m,y.entry,y.size,x.ALL)),this._users.forAll(y=>y.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(y,m,f,o){let _;return this._removeFuncs.some(d=>{if(y.startsWith(d[0])){const v=d[1](m,o,f);return"number"==typeof v&&(_=v),!0}return!1}),_}_checkSize(){this._users.forAll(y=>this._checkSizeLimits(y)),this._checkSizeLimits()}_checkSizeLimits(y){const m=y??this;if(m.maxSize<0||m.size<=m.maxSize)return;const f=y?.id;let o=!0;for(;o;){o=!1;for(const[_,d]of this._db)if(0===d.lifetime&&(!f||_.startsWith(f))){if(this._purgeItem(_,d,y),m.size<=.9*m.maxSize)return;o||=this._db.has(_)}}for(const[_,d]of this._db)if((!f||_.startsWith(f))&&(this._purgeItem(_,d,y),m.size<=.9*m.maxSize))return}_purgeItem(y,m,f=this._users.find(o=>y.startsWith(o.id))){if(this._db.delete(y),m.lives<=1){this._size-=m.size,f&&(f.size-=m.size);const o=this._notifyRemove(y,m.entry,m.size,x.SOME);null!=o&&o>0&&(this._size+=o,f&&(f.size+=o),m.lives=m.lifetime,m.size=o,this._db.set(y,m))}else--m.lives,this._db.set(y,m)}}class z{constructor(y,m,f){this.entry=y,this.size=m,this.lifetime=f,this.lives=f}}},40856:(J,N,s)=>{s.d(N,{X_:()=>x,i1:()=>V,oW:()=>f,zx:()=>j});var n=s(69287),p=s(82663);const w=96;function x(o,_){const d=_||o.extent,v=o.width,S=(0,p.GA)(d?.spatialReference);return d&&v?d.width/v*S*p.dy*w:0}function V(o,_){return o/((0,p.GA)(_)*p.dy*w)}function j(o,_,d){return function y(o,_){return 0===_||(0,n.Sp)(o,_)||o<_}(o,_)&&function m(o,_){return 0===_||(0,n.Sp)(o,_)||o>_}(o,d)}function f(o,_){return(0,n.Sp)(o,_)?0:(o||Number.POSITIVE_INFINITY)>(_||Number.POSITIVE_INFINITY)?1:-1}},3723:(J,N,s)=>{s.r(N),s.d(N,{default:()=>F});var n=s(10467),p=s(8189),w=s(92165),x=s(39693),V=s(89221),B=s(45272),P=s(85211),z=s(55739),j=s(3248),m=(s(40707),s(76576)),f=s(50305),o=s(28067),_=s(32034),d=s(6434),v=s(95478),S=s(5922),C=s(55098),U=s(35150),E=s(56492),R=s(19284),W=s(89962),h=s(73650),g=s(70831),T=s(93327),b=s(20543);let O=class extends C.A{constructor(){var M;super(...arguments),M=this,this._connection=null,this._workerHandler=null,this.capabilities=(0,W.f)(!1,!1),this.type="wfs",this.refresh=(0,E.sg)((0,n.A)(function*(){yield M.load();const A={customParameters:M.layer.customParameters,maxRecordCount:M.layer.maxRecordCount,maxTotalRecordCount:M.layer.maxTotalRecordCount,maxPageCount:M.layer.maxPageCount},{extent:Z}=yield M._workerHandler.refresh(A);return Z&&(M.sourceJSON.extent=Z),{dataChanged:!0,updates:{extent:M.sourceJSON.extent}}}))}load(M){return this.addResolvingPromise(this._startWorker({signal:null!=M?M.signal:null})),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null,this._workerHandler=null}openPorts(){var M=this;return(0,n.A)(function*(){return yield M.load(),M._connection.openPorts()})()}queryFeatures(M,A={}){var Z=this;return(0,n.A)(function*(){const K=yield Z.queryFeaturesJSON(M,A);return T.A.fromJSON(K)})()}queryFeaturesJSON(M,A={}){var Z=this;return(0,n.A)(function*(){return yield Z.load(A),Z._workerHandler.queryFeatures(M?M.toJSON():void 0,A)})()}queryFeatureCount(M,A={}){var Z=this;return(0,n.A)(function*(){return yield Z.load(A),Z._workerHandler.queryFeatureCount(M?M.toJSON():void 0,A)})()}queryObjectIds(M,A={}){var Z=this;return(0,n.A)(function*(){return yield Z.load(A),Z._workerHandler.queryObjectIds(M?M.toJSON():void 0,A)})()}queryExtent(M,A={}){var Z=this;return(0,n.A)(function*(){yield Z.load(A);const K=yield Z._workerHandler.queryExtent(M?M.toJSON():void 0,A);return{count:K.count,extent:o.A.fromJSON(K.extent)}})()}querySnapping(M,A={}){var Z=this;return(0,n.A)(function*(){return yield Z.load(A),Z._workerHandler.querySnapping(M,A)})()}queryAttributeBins(M,A={}){var Z=this;return(0,n.A)(function*(){yield Z.load(A);const K=yield Z._workerHandler.queryAttributeBins(M?.toJSON(),A);return g.A.fromJSON(K)})()}_createLoadOptions(M){var A=this;return(0,n.A)(function*(){const{url:Z,customParameters:K,name:k,namespaceUri:Y,fields:Q,geometryType:ee,maxRecordCount:ie,maxPageCount:te,maxTotalRecordCount:se,swapXY:le}=A.layer,oe="defaults"===A.layer.originOf("spatialReference")?void 0:A.layer.spatialReference;if(!Z)throw new S.A("wfs-layer:missing-url","WFSLayer must be created with a url");A.wfsCapabilities||(A.wfsCapabilities=yield(0,h.Fu)(Z,{customParameters:K,...M}));const ne=["fields","geometryType","name","namespaceUri","swapXY"].some(ue=>null==A.layer[ue])?yield(0,h.O8)(A.wfsCapabilities,k,Y,{spatialReference:oe,customParameters:K,signal:M?.signal}):{...(0,h.YW)(Q??[]),geometryType:ee,name:k,namespaceUri:Y,spatialReference:oe,swapXY:le},_e=(0,h.mG)(A.wfsCapabilities.readFeatureTypes(),ne.name,ne.namespaceUri),he=d.gy.toJSON(ne.geometryType),{operations:ye}=A.wfsCapabilities,me=ye.GetFeature.url,Oe=ye.GetFeature.outputFormat;return{customParameters:K,featureType:_e,fields:ne.fields?.map(ue=>ue.toJSON())??[],geometryField:ne.geometryField,geometryType:he,getFeatureUrl:me,getFeatureOutputFormat:Oe,maxRecordCount:ie,maxPageCount:te,maxTotalRecordCount:se,objectIdField:ne.objectIdField,spatialReference:ne.spatialReference?.toJSON(),swapXY:!!ne.swapXY}})()}_startWorker(M){var A=this;return(0,n.A)(function*(){const[Z,K]=yield(0,E.Lx)([A._createLoadOptions(M),(0,R.ho)("WFSSourceWorker",{...M,strategy:(0,j.A)("feature-layers-workers")?"dedicated":"local",registryTarget:A})]),k=Z.error||K.error||null,Y=K.value||null;if(k)throw Y&&Y.close(),k;const Q=Z.value;A._connection=K.value,A._workerHandler=A._connection.createInvokeProxy();const ee=yield A._workerHandler.load(Q,M);for(const ie of ee.warnings)U.A.getLogger(A.layer).warn("#load()",`${ie.message} (title: '${A.layer.title||"no title"}', id: '${A.layer.id??"no id"}')`,{warning:ie});A.sourceJSON={dateFieldsTimeReference:{timeZoneIANA:b.n$},extent:ee.extent,fields:Q.fields,geometryType:Q.geometryType,objectIdField:Q.objectIdField,geometryField:Q.geometryField,drawingInfo:(0,W.F0)(Q.geometryType),name:Q.featureType.title,wfsInfo:{name:Q.featureType.name,featureUrl:Q.getFeatureUrl,maxFeatures:Q.maxRecordCount,swapXY:Q.swapXY,supportedSpatialReferences:Q.featureType.supportedSpatialReferences,version:"2.0.0",wfsNamespace:Q.featureType.namespaceUri}}})()}};(0,p._)([(0,P.MZ)()],O.prototype,"capabilities",void 0),(0,p._)([(0,P.MZ)({constructOnly:!0})],O.prototype,"layer",void 0),(0,p._)([(0,P.MZ)()],O.prototype,"sourceJSON",void 0),(0,p._)([(0,P.MZ)()],O.prototype,"type",void 0),(0,p._)([(0,P.MZ)()],O.prototype,"wfsCapabilities",void 0),O=(0,p._)([(0,m.$)("esri.layers.graphics.sources.WFSSource")],O);var ge,D=s(93410),u=s(23e3),c=s(73955),I=s(31446),L=s(25263),G=s(17049),$=s(43124),H=s(85551),q=s(1151),re=s(33036),X=s(84311),Me=s(77486),ae=s(22329),Ie=s(29141),ve=s(3404),Ee=s(86300),Pe=s(54947),Le=s(73975),Se=s(31595),de=s(87086),Ae=s(41843),Te=s(22639);const De=(0,ve.p)();let i=ge=class extends((0,$.fY)((0,c.FJ)((0,u.d)((0,L.J)((0,I.F)((0,D.dM)((0,X.e)((0,Me.d)((0,q.J)((0,re.j)((0,G.q)((0,H.A)((0,x.P)(v.A)))))))))))))){static fromWFSLayerInfo(M){const{customParameters:A,fields:Z,geometryField:K,geometryType:k,name:Y,namespaceUri:Q,objectIdField:ee,spatialReference:ie,swapXY:te,url:se,wfsCapabilities:le}=M;return new ge({customParameters:A,fields:Z,geometryField:K,geometryType:k,name:Y,namespaceUri:Q,objectIdField:ee,spatialReference:ie,swapXY:te,url:se,wfsCapabilities:le})}constructor(M){super(M),this.copyright=null,this.customParameters=null,this.dateFieldsTimeZone=null,this.definitionExpression=null,this.displayField=null,this.elevationInfo=null,this.featureUrl=void 0,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="WFS",this.maxRecordCount=3e3,this.maxPageCount=10,this.maxTotalRecordCount=2e5,this.mode=0,this.name=null,this.namespaceUri=null,this.outFields=null,this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new O({layer:this}),this.spatialReference=_.A.WGS84,this.spatialReferences=[4326],this.swapXY=void 0,this.title="WFS",this.type="wfs",this.url=null,this.version=void 0}destroy(){this.source?.destroy()}load(M){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WFS"]},M).then(()=>this.source.load(M)).then(()=>{this.read(this.source.sourceJSON,{origin:"service",url:this.parsedUrl}),this.revert(["objectIdField","fields","timeInfo","spatialReference","name","namespaceUri"],"service"),(0,Ee.yp)(this.renderer,this.fieldsIndex),(0,Ee.sv)(this.timeInfo,this.fieldsIndex)})),Promise.resolve(this)}get capabilities(){return this.source?.capabilities}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("capabilities"),(this._get("createQueryVersion")||0)+1}get defaultPopupTemplate(){return this.createPopupTemplate()}writeFields(M,A,Z){const K=M.filter(k=>k.name!==h.i5);this.geometryField&&K.unshift(new Ie.A({name:this.geometryField,alias:this.geometryField,type:"geometry"})),(0,V.sM)(Z,K.map(k=>k.toJSON()),A)}get parsedUrl(){return(0,B.An)(this.url)}set renderer(M){(0,Ee.yp)(M,this.fieldsIndex),this._set("renderer",M)}get wfsCapabilities(){return this.source?.wfsCapabilities}set wfsCapabilities(M){this.source&&(this.source.wfsCapabilities=M)}createPopupTemplate(M){return(0,Ae.tn)(this,M)}createQuery(){const M=new de.A({returnGeometry:!0,outFields:["*"],where:this.definitionExpression||"1=1"}),{timeOffset:A,timeExtent:Z}=this;return M.timeExtent=null!=A&&null!=Z?Z.offset(-A.value,A.unit):Z||null,M}getFieldDomain(M,A){return this.getField(M)?.domain}getField(M){return this.fieldsIndex?.get(M)}queryFeatures(M,A){return this.load().then(()=>this.source.queryFeatures(de.A.from(M)||this.createQuery(),A)).then(Z=>{if(Z?.features)for(const K of Z.features)K.layer=K.sourceLayer=this;return Z})}queryObjectIds(M,A){return this.load().then(()=>this.source.queryObjectIds(de.A.from(M)||this.createQuery(),A))}queryFeatureCount(M,A){return this.load().then(()=>this.source.queryFeatureCount(de.A.from(M)||this.createQuery(),A))}queryExtent(M,A){return this.load().then(()=>this.source.queryExtent(de.A.from(M)||this.createQuery(),A))}hasDataChanged(){var M=this;return(0,n.A)(function*(){try{const{dataChanged:A,updates:Z}=yield M.source.refresh();return null!=Z&&M.read(Z,{origin:"service",url:M.parsedUrl,ignoreDefaults:!0}),A}catch{}return!1})()}};(0,p._)([(0,P.MZ)({readOnly:!0})],i.prototype,"capabilities",null),(0,p._)([(0,P.MZ)({type:String})],i.prototype,"copyright",void 0),(0,p._)([(0,P.MZ)({readOnly:!0})],i.prototype,"createQueryVersion",null),(0,p._)([(0,P.MZ)({json:{name:"wfsInfo.customParameters",write:{overridePolicy:M=>({enabled:!!(M&&Object.keys(M).length>0),ignoreOrigin:!0})}}})],i.prototype,"customParameters",void 0),(0,p._)([(0,P.MZ)((0,Te.P6)("dateFieldsTimeReference"))],i.prototype,"dateFieldsTimeZone",void 0),(0,p._)([(0,P.MZ)({readOnly:!0})],i.prototype,"defaultPopupTemplate",null),(0,p._)([(0,P.MZ)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],i.prototype,"definitionExpression",void 0),(0,p._)([(0,P.MZ)({type:String})],i.prototype,"displayField",void 0),(0,p._)([(0,P.MZ)(ae.Yj)],i.prototype,"elevationInfo",void 0),(0,p._)([(0,P.MZ)({type:String,readOnly:!0,json:{name:"wfsInfo.featureUrl",write:{ignoreOrigin:!0,isRequired:!0}}})],i.prototype,"featureUrl",void 0),(0,p._)([(0,P.MZ)({type:[Ie.A],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],i.prototype,"fields",void 0),(0,p._)([(0,f.K)("fields")],i.prototype,"writeFields",null),(0,p._)([(0,P.MZ)(De.fieldsIndex)],i.prototype,"fieldsIndex",void 0),(0,p._)([(0,P.MZ)({type:o.A,json:{name:"extent"}})],i.prototype,"fullExtent",void 0),(0,p._)([(0,P.MZ)()],i.prototype,"geometryField",void 0),(0,p._)([(0,P.MZ)({type:String,json:{read:{source:"layerDefinition.geometryType",reader:d.gy.read},write:{target:"layerDefinition.geometryType",writer:d.gy.write,ignoreOrigin:!0},origins:{service:{read:d.gy.read}}}})],i.prototype,"geometryType",void 0),(0,p._)([(0,P.MZ)({type:String})],i.prototype,"id",void 0),(0,p._)([(0,P.MZ)(ae.kF)],i.prototype,"labelsVisible",void 0),(0,p._)([(0,P.MZ)({type:[Pe.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:Le.w},write:!0}})],i.prototype,"labelingInfo",void 0),(0,p._)([(0,P.MZ)(ae.fV)],i.prototype,"legendEnabled",void 0),(0,p._)([(0,P.MZ)({type:["show","hide"]})],i.prototype,"listMode",void 0),(0,p._)([(0,P.MZ)({type:String})],i.prototype,"objectIdField",void 0),(0,p._)([(0,P.MZ)({type:["WFS"]})],i.prototype,"operationalLayerType",void 0),(0,p._)([(0,P.MZ)({type:z.jz,json:{name:"wfsInfo.maxFeatures",write:{ignoreOrigin:!0,isRequired:!0}}})],i.prototype,"maxRecordCount",void 0),(0,p._)([(0,P.MZ)({type:z.jz})],i.prototype,"maxPageCount",void 0),(0,p._)([(0,P.MZ)({type:z.jz})],i.prototype,"maxTotalRecordCount",void 0),(0,p._)([(0,P.MZ)({type:[0],readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],i.prototype,"mode",void 0),(0,p._)([(0,P.MZ)({type:String,json:{name:"wfsInfo.name",write:{ignoreOrigin:!0,isRequired:!0}}})],i.prototype,"name",void 0),(0,p._)([(0,P.MZ)({type:String,json:{name:"wfsInfo.wfsNamespace",write:{ignoreOrigin:!0,isRequired:!0}}})],i.prototype,"namespaceUri",void 0),(0,p._)([(0,P.MZ)(ae.Ih)],i.prototype,"opacity",void 0),(0,p._)([(0,P.MZ)(De.outFields)],i.prototype,"outFields",void 0),(0,p._)([(0,P.MZ)({readOnly:!0})],i.prototype,"parsedUrl",null),(0,p._)([(0,P.MZ)(ae.M6)],i.prototype,"popupEnabled",void 0),(0,p._)([(0,P.MZ)({type:w.A,json:{name:"popupInfo",write:!0}})],i.prototype,"popupTemplate",void 0),(0,p._)([(0,P.MZ)({types:Se.Hg,json:{origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:Se.XJ,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:{ignoreOrigin:!0}}})],i.prototype,"renderer",null),(0,p._)([(0,P.MZ)(ae.PY)],i.prototype,"screenSizePerspectiveEnabled",void 0),(0,p._)([(0,P.MZ)({readOnly:!0})],i.prototype,"source",void 0),(0,p._)([(0,P.MZ)({type:_.A,json:{name:"layerDefinition.spatialReference",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"extent.spatialReference"}}}})],i.prototype,"spatialReference",void 0),(0,p._)([(0,P.MZ)({readOnly:!0,type:[z.jz],json:{name:"wfsInfo.supportedSpatialReferences",write:{ignoreOrigin:!0,isRequired:!0}}})],i.prototype,"spatialReferences",void 0),(0,p._)([(0,P.MZ)({type:Boolean,value:!1,json:{name:"wfsInfo.swapXY",write:{ignoreOrigin:!0,isRequired:!0}}})],i.prototype,"swapXY",void 0),(0,p._)([(0,P.MZ)({json:{write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"name"}}}})],i.prototype,"title",void 0),(0,p._)([(0,P.MZ)({json:{read:!1},readOnly:!0})],i.prototype,"type",void 0),(0,p._)([(0,P.MZ)(ae.OZ)],i.prototype,"url",void 0),(0,p._)([(0,P.MZ)({type:String,readOnly:!0,json:{name:"wfsInfo.version",write:{ignoreOrigin:!0,isRequired:!0}}})],i.prototype,"version",void 0),(0,p._)([(0,P.MZ)()],i.prototype,"wfsCapabilities",null),i=ge=(0,p._)([(0,m.$)("esri.layers.WFSLayer")],i);const F=i},72211:(J,N,s)=>{s.d(N,{LF:()=>V,M9:()=>B,zu:()=>y});var n=s(5922),p=s(89221),w=s(79845),x=s(26073);function V(o,_,d){try{return function z(o){if(!o||0===o.length)return null;if(function j(o){const _=o[0];return!!_&&"scale"in _}(o)){const _=[];for(const d of o)_.push({scale:d.scale,value:y(d.value)});return _}return y(o)}(o)}catch(v){d?.messages?.push(v)}return null}function B(o,_,d,v){try{const S=function P(o){const _=(0,w.q)(o);return _?(0,x.dw)(_)?_.map(d=>d.toJSON()):_.map(({scale:d,effects:v})=>({scale:d,value:v.map(S=>S.toJSON())})):null}(o);(0,p.sM)(d,S,_)}catch(S){v.messages&&v.messages.push(S)}}function y(o){if(!o?.length)return"";const _=[];for(const d of o){let v=[];switch(d.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":v=[m(d,"amount")];break;case"blur":v=[m(d,"radius","pt")];break;case"hue-rotate":v=[m(d,"angle","deg")];break;case"drop-shadow":v=[m(d,"xoffset","pt"),m(d,"yoffset","pt"),m(d,"blurRadius","pt"),f(d,"color")];break;case"bloom":v=[m(d,"strength"),m(d,"radius","pt"),m(d,"threshold")]}const S=`${d.type}(${v.filter(Boolean).join(" ")})`;(0,w.q)(S),_.push(S)}return _.join(" ")}function m(o,_,d){if(null==o[_])throw new n.A("effect:missing-parameter",`Missing parameter '${_}' in ${o.type} effect`,{effect:o});return d?o[_]+d:""+o[_]}function f(o,_){if(null==o[_])throw new n.A("effect:missing-parameter",`Missing parameter '${_}' in ${o.type} effect`,{effect:o});const d=o[_];return`rgba(${d[0]||0}, ${d[1]||0}, ${d[2]||0}, ${d[3]/255||0})`}},78200:(J,N,s)=>{s.d(N,{F:()=>n,P:()=>p});const n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsCurrentUser:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsReturnMesh:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0,supportsTrueCurve:!1},p={supportsDate:!0,supportsFixedInterval:!0,supportsAutoInterval:!0,supportsFixedBoundaries:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsSnapToData:!1,supportsReturnFullIntervalBin:!1,supportsFirstDayOfWeek:!1,supportsNormalization:!0,supportedStatistics:{count:!0,sum:!0,avg:!0,var:!0,stddev:!0,min:!0,max:!0,percentileContinuous:!0,percentileDiscrete:!0,envelope:!0,centroid:!0,convexHull:!0},supportedNormalizationTypes:{field:!0,log:!0,naturalLog:!0,percentOfTotal:!0,squareRoot:!0}}},89962:(J,N,s)=>{s.d(N,{F0:()=>V,Vx:()=>z,e2:()=>y,f:()=>m});var n=s(3248),p=s(77806),w=s(78200),x=s(48254);function V(f){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===f||"esriGeometryMultipoint"===f?x.Cb:"esriGeometryPolyline"===f?x.yM:x.WR}}}const B=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let P=1;function z(f,o){if((0,n.A)("esri-csp-restrictions"))return()=>({[o]:null,...f});try{let _=`this${j(o)} = null;`;for(const v in f)_+=`this${j(v)} = ${JSON.stringify(f[v])};`;const d=new Function(`\n      return class AttributesClass$${P++} {\n        constructor() {\n          ${_};\n        }\n      }\n    `)();return()=>new d}catch{return()=>({[o]:null,...f})}}function j(f){return B.test(f)?`.${f}`:`["${f}"]`}function y(f={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,p.o8)(f)}}]}function m(f,o){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:f},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:o,supportsDelete:o,supportsEditing:o,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:o,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:w.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:w.P,editing:{supportsGeometryUpdate:o,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},93410:(J,N,s)=>{s.d(N,{LF:()=>m,dM:()=>f,sU:()=>j});var n=s(8189),p=s(85211),B=(s(3248),s(35150),s(40707),s(76576)),P=s(50501),z=s(72211);const j={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:P.K}},"portal-item":{read:!0,write:{layerContainerTypes:P.K}}}}},y={read:{reader:z.LF},write:{allowNull:!0,writer:z.M9,layerContainerTypes:P.K}},m={json:{read:!1,write:!1,origins:{"web-map":y,"portal-item":y}}},f=o=>{let _=class extends o{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,n._)([(0,p.MZ)(j)],_.prototype,"blendMode",void 0),(0,n._)([(0,p.MZ)(m)],_.prototype,"effect",void 0),_=(0,n._)([(0,B.$)("esri.layers.mixins.BlendLayer")],_),_}},23e3:(J,N,s)=>{s.d(N,{d:()=>P});var n=s(8189),p=s(85211),B=(s(3248),s(35150),s(40707),s(76576));const P=z=>{let j=class extends z{constructor(){super(...arguments),this.customParameters=null}};return(0,n._)([(0,p.MZ)({type:Object,json:{write:{overridePolicy:y=>({enabled:!!(y&&Object.keys(y).length>0)})}}})],j.prototype,"customParameters",void 0),j=(0,n._)([(0,B.$)("esri.layers.mixins.CustomParametersMixin")],j),j}},73955:(J,N,s)=>{s.d(N,{FJ:()=>R,Dp:()=>W,KV:()=>h});var n=s(8189),p=s(89221),w=s(85211),P=(s(3248),s(35150),s(40707),s(76576)),z=s(50501),j=s(90660),y=s(31178),m=s(71065),f=s(50305),o=s(40856),_=s(43085);const d={write:{overridePolicy:(g,T,b)=>({enabled:!b||"scale"===b.filterMode})}};let v=class extends(j.A.ClonableMixin(m.A)){constructor(g){super(g),this.id=(0,_.lk)(),this.maxScale=0,this.minScale=0,this.title="",this.where=null}};(0,n._)([(0,w.MZ)({type:String,json:{write:!0}})],v.prototype,"id",void 0),(0,n._)([(0,w.MZ)({type:Number,json:d})],v.prototype,"maxScale",void 0),(0,n._)([(0,w.MZ)({type:Number,json:d})],v.prototype,"minScale",void 0),(0,n._)([(0,w.MZ)({type:String,json:{write:!0}})],v.prototype,"title",void 0),(0,n._)([(0,w.MZ)({type:String,json:{write:!0}})],v.prototype,"where",void 0),v=(0,n._)([(0,P.$)("esri.layers.support.DisplayFilter")],v);const S=v;var C=s(27960);let U=class extends(j.A.ClonableMixin(m.A)){constructor(g){super(g),this.activeFilterId=null,this.filters=new(y.A.ofType(S)),this.mode="manual"}writeFilters(g,T,b,O){const D=g.toArray();"scale"===this.mode&&D.sort((u,c)=>{const I=(0,o.oW)(c.minScale,u.minScale);return 0===I?u.maxScale-c.maxScale:I}),T[b]=D.map(u=>u.toJSON(O))}write(g,T){return super.write(g,(0,C.mW)(this,T))}};(0,n._)([(0,w.MZ)({type:String,json:{write:{overridePolicy:(g,T,b)=>({enabled:"manual"===b.filterMode,isRequired:!0})}}})],U.prototype,"activeFilterId",void 0),(0,n._)([(0,w.MZ)({type:y.A.ofType(S),nonNullable:!0,json:{write:!0}})],U.prototype,"filters",void 0),(0,n._)([(0,f.K)("filters")],U.prototype,"writeFilters",null),(0,n._)([(0,w.MZ)({type:["manual","scale"],nonNullable:!0,json:{name:"filterMode",write:!0}})],U.prototype,"mode",void 0),U=(0,n._)([(0,P.$)("esri.layers.support.DisplayFilterInfo")],U);const R=g=>{let T=class extends g{constructor(){super(...arguments),this.displayFilterEnabled=!0,this.displayFilterInfo=null}};return(0,n._)([(0,w.MZ)(W)],T.prototype,"displayFilterEnabled",void 0),(0,n._)([(0,w.MZ)(h)],T.prototype,"displayFilterInfo",void 0),T=(0,n._)([(0,P.$)("esri.layers.mixins.DisplayFilteredLayer")],T),T},W={type:Boolean,json:{name:"layerDefinition.disableDisplayFilter",read:{reader:g=>!g},write:{layerContainerTypes:z.K,writer(g,T,b){(0,p.sM)(b,!g,T)}},origins:{"web-scene":{write:!1,read:!1}}}},h={type:U,json:{name:"layerDefinition.displayFilterInfo",write:{enabled:!0,allowNull:!0,layerContainerTypes:z.K},origins:{"web-scene":{write:!1,read:!1}}}}},17049:(J,N,s)=>{s.d(N,{q:()=>E});var n=s(8189),p=s(5922),w=s(45272),x=s(85211),V=s(55739),z=(s(3248),s(40707),s(17221)),j=s(76576),y=s(50305),m=s(50501),f=s(34813),o=s(56558);const _={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},d={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},v={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},S={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,Object3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":_,"web-map/basemap":d,"web-map/tables":v,"link-chart/operational-layers":{..._,LinkChartLayer:!0},"link-chart/basemap":d,"link-chart/tables":v,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0,WCS:!0},"portal-item/tables":{ArcGISFeatureLayer:!0,SubtypeGroupTable:!0}};var C=s(22329),U=s(17181);const E=W=>{let h=class extends W{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(g,T,b){return"Group Layer"===b?.portalItem?.type?void 0:g}writeListMode(g,T,b,O){(O&&"ground"===O.layerContainerType||g&&(0,o.R)(this,b,{},O))&&(T[b]=g)}writeOperationalLayerType(g,T,b){g&&(T[b]=g)}writeTitle(g,T){T.title=g??"Layer"}readVisibilityTimeExtent(g){return g?U.A.fromArray(g):null}writeVisibilityTimeExtent(g,T,b,O){g&&"tables"!==O.layerContainerType&&(g.isEmpty?O?.messages&&O.messages.push(new p.A("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):T[b]=g.toArray())}read(g,T){T&&(T.layer=this),(0,f.t)(this,g,b=>super.read(g,b),T)}write(g,T){if(!this.persistenceEnabled&&!T?.ignorePersistenceEnabled)return null;if(T?.origin){const D=`${T.origin}/${T.layerContainerType||"operational-layers"}`;let c=!!S[D]?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===D&&(c=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===D&&(c=!1),!c)return T.messages?.push(new p.A("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${D}'`,{layer:this})),null}const b=super.write(g,{...T,layer:this}),O=!!T&&!!T.messages&&!!T.messages.filter(D=>D instanceof p.A&&"web-document-write:property-required"===D.name).length;return(0,w.w8)(b?.url)?(T?.messages?.push(new p.A("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&O?null:b}beforeSave(){}};return(0,n._)([(0,x.MZ)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],h.prototype,"id",void 0),(0,n._)([(0,z.w)("id",["id"])],h.prototype,"readId",null),(0,n._)([(0,x.MZ)(C.C1)],h.prototype,"listMode",void 0),(0,n._)([(0,y.K)("listMode")],h.prototype,"writeListMode",null),(0,n._)([(0,x.MZ)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:m.K,isRequired:!0}}}}})],h.prototype,"operationalLayerType",void 0),(0,n._)([(0,y.K)("operationalLayerType")],h.prototype,"writeOperationalLayerType",null),(0,n._)([(0,x.MZ)(C.ke)],h.prototype,"opacity",void 0),(0,n._)([(0,x.MZ)({type:Boolean,readOnly:!1})],h.prototype,"persistenceEnabled",void 0),(0,n._)([(0,x.MZ)({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],h.prototype,"title",void 0),(0,n._)([(0,y.K)("title"),(0,y.K)(["web-scene"],"title")],h.prototype,"writeTitle",null),(0,n._)([(0,x.MZ)({type:U.A,json:{origins:{"web-scene":{write:{layerContainerTypes:m.K}}}}})],h.prototype,"visibilityTimeExtent",void 0),(0,n._)([(0,z.w)("visibilityTimeExtent")],h.prototype,"readVisibilityTimeExtent",null),(0,n._)([(0,y.K)(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[V.jz,V.Uv]]}})],h.prototype,"writeVisibilityTimeExtent",null),(0,n._)([(0,x.MZ)({type:Boolean,json:{name:"visibility",write:{layerContainerTypes:m.K}}})],h.prototype,"visible",void 0),h=(0,n._)([(0,j.$)("esri.layers.mixins.OperationalLayer")],h),h}},43124:(J,N,s)=>{s.d(N,{Rr:()=>j,fY:()=>f,ne:()=>m});var n=s(8189),p=s(89221),w=s(85211),P=(s(3248),s(35150),s(40707),s(76576)),z=s(15848);function j(o,_,d){if(!o)return null;const v=o.find(C=>!!C.field);if(!v)return null;const S=new z.A;return S.read(v,d),[S]}const m={type:[z.A],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:j},write:{writer:function y(o,_,d,v){const S=o.find(C=>!!C.field);S&&(0,p.sM)(d,[S.toJSON()],_)}}}},f=o=>{let _=class extends o{constructor(){super(...arguments),this.orderBy=null}};return(0,n._)([(0,w.MZ)(m)],_.prototype,"orderBy",void 0),_=(0,n._)([(0,P.$)("esri.layers.mixins.OrderedLayer")],_),_}},85551:(J,N,s)=>{s.d(N,{A:()=>h});var n=s(10467),p=s(8189),w=s(23098),x=s(77469),V=s(89563),B=s(89447),P=s(5922),z=s(35150),j=s(11432),y=s(56492),m=s(45272),f=s(85211),d=(s(3248),s(40707),s(17221)),v=s(76576),S=s(50305),C=s(58443),U=s(73874),E=s(46577),R=s(52606),W=s(69927);const h=T=>{let b=class extends T{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,j.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(O){O!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",O))}readPortalItem(O,D,u){if(D.itemId)return new E.default({id:D.itemId,portal:u?.portal})}writePortalItem(O,D){O?.id&&(D.itemId=O.id)}loadFromPortal(O,D){var u=this;return(0,n.A)(function*(){if(u.portalItem?.id)try{const{load:c}=yield Promise.all([s.e(2076),s.e(6180)]).then(s.bind(s,56180));return(0,y.Te)(D),yield c({instance:u,supportedTypes:O.supportedTypes,validateItem:O.validateItem,supportsData:O.supportsData,layerModuleTypeMap:O.layerModuleTypeMap,populateGroupLayer:O.populateGroupLayer},D)}catch(c){throw(0,y.zf)(c)||z.A.getLogger(u).warn(`Failed to load layer (${u.title}, ${u.id}) portal item (${u.portalItem.id})\n  ${c}`),c}})()}finishLoadEditablePortalLayer(O){var D=this;return(0,n.A)(function*(){D._set("userHasEditingPrivileges",yield D._fetchUserHasEditingPrivileges(O).catch(u=>((0,y.QP)(u),!0)))})()}setUserPrivileges(O,D){var u=this;return(0,n.A)(function*(){if(!w.A.userPrivilegesApplied)return u.finishLoadEditablePortalLayer(D);if(u.url)try{const{features:{edit:c,fullEdit:I},content:{updateItem:L}}=yield u._fetchUserPrivileges(O,D);u._set("userHasEditingPrivileges",c),u._set("userHasFullEditingPrivileges",I),u._set("userHasUpdateItemPrivileges",L)}catch(c){(0,y.QP)(c)}})()}_fetchUserPrivileges(O,D){var u=this;return(0,n.A)(function*(){let c=u.portalItem;if(!O||!c||!c.loaded||c.sourceUrl)return u._fetchFallbackUserPrivileges(D);const I=!x.id?.findCredential(u.url),L=O===c.id;if(L&&c.portal.user)return u._getUserPrivileges(c,I);let G,$;if(L)G=c.portal.url;else try{G=yield(0,C.wI)(u.url,D)}catch(X){(0,y.QP)(X)}if(!G||!(0,m.b8)(G,c.portal.url))return u._fetchFallbackUserPrivileges(D);try{const X=null!=D?D.signal:null;$=yield x.id?.getCredential(`${G}/sharing`,{prompt:!1,signal:X})}catch(X){(0,y.QP)(X)}if(!$)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(L?yield c.reload():(c=new E.default({id:O,portal:{url:G}}),yield c.load(D)),c.portal.user)return u._getUserPrivileges(c,I)}catch(X){(0,y.QP)(X)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_getUserPrivileges(O,D){const u=(0,W.It)(O);return D&&(u.features.edit=!0),u}_fetchFallbackUserPrivileges(O){var D=this;return(0,n.A)(function*(){let u=!0;try{u=yield D._fetchUserHasEditingPrivileges(O)}catch(c){(0,y.QP)(c)}return{features:{edit:u,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(O){var D=this;return(0,n.A)(function*(){const u=D.url?x.id?.findCredential(D.url):null;if(!u)return!0;const c=g.credential===u?g.user:yield D._fetchEditingUser(O);return g.credential=u,g.user=c,null==c?.privileges||c.privileges.includes("features:user:edit")})()}_fetchEditingUser(O){var D=this;return(0,n.A)(function*(){const u=D.portalItem?.portal?.user;if(u)return u;const c=x.id?.findServerInfo(D.url??"");if(!c?.owningSystemUrl)return null;const I=`${c.owningSystemUrl}/sharing/rest`,L=U.A.getDefault();if(L&&L.loaded&&(0,m.S8)(L.restUrl)===(0,m.S8)(I))return L.user;const G=`${I}/community/self`,$=null!=O?O.signal:null,H=yield(0,B.Ke)((0,V.A)(G,{authMode:"no-prompt",query:{f:"json"},signal:$}));return H.ok?R.A.fromJSON(H.value.data):null})()}read(O,D){D&&(D.layer=this),super.read(O,D)}write(O,D){const u=D?.portal,c=this.portalItem?.id&&(this.portalItem.portal||U.A.getDefault());return u&&c&&!(0,m.ut)(c.restUrl,u.restUrl)?(D.messages&&D.messages.push(new P.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(O,{...D,layer:this})}};return(0,p._)([(0,f.MZ)({type:E.default})],b.prototype,"portalItem",null),(0,p._)([(0,d.w)("web-document","portalItem",["itemId"])],b.prototype,"readPortalItem",null),(0,p._)([(0,S.K)("web-document","portalItem",{itemId:{type:String}})],b.prototype,"writePortalItem",null),(0,p._)([(0,f.MZ)({clonable:!1})],b.prototype,"resourceReferences",void 0),(0,p._)([(0,f.MZ)({type:Boolean,readOnly:!0})],b.prototype,"userHasEditingPrivileges",void 0),(0,p._)([(0,f.MZ)({type:Boolean,readOnly:!0})],b.prototype,"userHasFullEditingPrivileges",void 0),(0,p._)([(0,f.MZ)({type:Boolean,readOnly:!0})],b.prototype,"userHasUpdateItemPrivileges",void 0),b=(0,p._)([(0,v.$)("esri.layers.mixins.PortalLayer")],b),b},g={credential:null,user:null}},1151:(J,N,s)=>{s.d(N,{J:()=>b});var n=s(10467),p=s(8189),x=(s(3248),s(35150)),V=s(56492),B=s(85211),P=s(48669),j=(s(40707),s(76576)),y=s(50501),m=s(31178),f=s(48900),o=s(34703);const _=new m.A,d=new WeakMap;function U(O,D){return Number.isFinite(O)&&Number.isFinite(D)?D<=0?O:U(D,O%D):0}let E=0,R=0;function W(){const O=Date.now();let D=!1;for(const u of _){const c=u.deref();c?c.refreshInterval&&O-(d.get(c)??0)+5>=6e4*c.refreshInterval&&(d.set(c,O),c.refresh(O)):D=!0}if(D)for(let u=_.length-1;u>=0;u--)_.at(u).deref()||_.removeAt(u)}(0,o.fm)(()=>{const O=Date.now();let D=0;for(const u of _){const c=u.deref();c&&(D=U(Math.round(6e4*c.refreshInterval),D),c.refreshInterval?d.get(c)||d.set(c,O):d.delete(c))}if(D!==R){if(R=D,clearInterval(E),0===R)return void(E=0);E=setInterval(W,R)}},f.OH);const b=O=>{let D=class extends O{constructor(...u){super(...u),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,V.sg)(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||function v(O){(function C(O){return null!=O&&"object"==typeof O&&"refreshInterval"in O&&"refresh"in O})(O)&&_.push(new WeakRef(O))}(this)},()=>{})}destroy(){!function S(O){const D=_.find(u=>u.deref()===O);D&&_.remove(D)}(this)}castRefreshInterval(u){return u>=.1?u:u<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(u=Date.now()){(0,V.QZ)(this._debounceHasDataChanged()).then(c=>{c&&this._set("refreshTimestamp",u),this.emit("refresh",{dataChanged:c})},c=>{x.A.getLogger(this).error(c),this.emit("refresh",{dataChanged:!1,error:c})})}hasDataChanged(){return(0,n.A)(function*(){return!0})()}get test(){}};return(0,p._)([(0,B.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:y.K}}}}})],D.prototype,"refreshInterval",void 0),(0,p._)([(0,P.w)("refreshInterval")],D.prototype,"castRefreshInterval",null),(0,p._)([(0,B.MZ)({readOnly:!0})],D.prototype,"refreshTimestamp",void 0),(0,p._)([(0,B.MZ)({readOnly:!0})],D.prototype,"refreshParameters",null),D=(0,p._)([(0,j.$)("esri.layers.mixins.RefreshableLayer")],D),D}},33036:(J,N,s)=>{s.d(N,{j:()=>P});var n=s(8189),p=s(85211),B=(s(3248),s(35150),s(40707),s(76576));const P=j=>{let y=class extends j{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const m={minScale:this.minScale,maxScale:this.maxScale},f=this.parent;f&&"effectiveScaleRange"in f&&function z(j,y){j.minScale=j.minScale>0?y.minScale>0?Math.min(j.minScale,y.minScale):j.minScale:y.minScale,j.maxScale=j.maxScale>0?y.maxScale>0?Math.max(j.maxScale,y.maxScale):j.maxScale:y.maxScale}(m,f.effectiveScaleRange);const o=this._get("effectiveScaleRange");return o&&o.minScale===m.minScale&&o.maxScale===m.maxScale?o:m}};return(0,n._)([(0,p.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],y.prototype,"minScale",void 0),(0,n._)([(0,p.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],y.prototype,"maxScale",void 0),(0,n._)([(0,p.MZ)({readOnly:!0})],y.prototype,"effectiveScaleRange",null),y=(0,n._)([(0,B.$)("esri.layers.mixins.ScaleRangeLayer")],y),y}},84311:(J,N,s)=>{s.d(N,{B:()=>_,e:()=>d});var n=s(8189),p=s(85211),B=(s(3248),s(35150),s(40707),s(17221)),P=s(76576),z=s(50501),j=s(86300),y=s(38488),m=s(26957),f=s(17181),o=s(89352);const _={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:z.K}}},d=v=>{let S=class extends v{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(C,U){const E=U.timeInfo.exportOptions;if(!E)return null;const R=E.timeOffset,W=m.j.fromJSON(E.timeOffsetUnits);return R&&W?new o.A({value:R,unit:W}):null}set timeInfo(C){(0,j.sv)(C,this.fieldsIndex),this._set("timeInfo",C)}};return(0,n._)([(0,p.MZ)({type:f.A,json:{write:!1}})],S.prototype,"timeExtent",void 0),(0,n._)([(0,p.MZ)({type:o.A})],S.prototype,"timeOffset",void 0),(0,n._)([(0,B.w)("service","timeOffset",["timeInfo.exportOptions"])],S.prototype,"readOffset",null),(0,n._)([(0,p.MZ)({value:null,type:y.A,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],S.prototype,"timeInfo",null),(0,n._)([(0,p.MZ)(_)],S.prototype,"useViewTime",void 0),S=(0,n._)([(0,P.$)("esri.layers.mixins.TemporalLayer")],S),S}},77486:(J,N,s)=>{s.d(N,{d:()=>h});var n=s(8189),p=s(85211),B=(s(3248),s(35150),s(40707),s(76576)),P=s(92165),z=s(90660),j=s(71065),y=s(89221),m=s(50305),f=s(2052),o=s(22329),_=s(54947),d=s(31595);let v=class extends(z.A.ClonableMixin(j.A)){constructor(g){super(g),this.labelingInfo=null,this.labelsVisible=!0,this.renderer=null,this.visible=!0}};(0,n._)([(0,p.MZ)({type:[_.A],json:{write:!0}})],v.prototype,"labelingInfo",void 0),(0,n._)([(0,p.MZ)(o.kF)],v.prototype,"labelsVisible",void 0),(0,n._)([(0,p.MZ)({types:d.Hg,json:{write:!0}})],v.prototype,"renderer",void 0),(0,n._)([(0,p.MZ)({type:Boolean,json:{write:!0}})],v.prototype,"visible",void 0),v=(0,n._)([(0,B.$)("esri.layers.support.TrackPartInfo")],v);const S=v;var C=s(73747),U=s(91644),E=s(89352);let R=class extends(z.A.ClonableMixin(j.A)){constructor(g){super(g),this.enabled=!0,this.fields=[],this.latestObservations=new S({renderer:new C.A({symbol:U.UK.clone()})}),this.maxDisplayDuration=null,this.maxDisplayObservationsPerTrack=0,this.popupEnabled=!0,this.popupTemplate=null,this.previousObservations=new S({renderer:new C.A({symbol:U.UK.clone()})}),this.trackLines=new S({renderer:new C.A({symbol:U.A7.clone()})}),this.timeField="startTimeField"}writeFields(g,T,b){const O=g.filter(D=>"avg_angle"!==D.statisticType).map(D=>D.toJSON());(0,y.sM)(b,O,T)}};(0,n._)([(0,p.MZ)({type:Boolean,json:{write:!0}})],R.prototype,"enabled",void 0),(0,n._)([(0,p.MZ)({type:[f.A],json:{write:!0}})],R.prototype,"fields",void 0),(0,n._)([(0,m.K)("fields")],R.prototype,"writeFields",null),(0,n._)([(0,p.MZ)({type:S,json:{write:!0}})],R.prototype,"latestObservations",void 0),(0,n._)([(0,p.MZ)({type:E.A,json:{write:!0}})],R.prototype,"maxDisplayDuration",void 0),(0,n._)([(0,p.MZ)({type:Number,json:{write:!0}})],R.prototype,"maxDisplayObservationsPerTrack",void 0),(0,n._)([(0,p.MZ)(o.M6)],R.prototype,"popupEnabled",void 0),(0,n._)([(0,p.MZ)({type:P.A,json:{name:"popupInfo",write:!0}})],R.prototype,"popupTemplate",void 0),(0,n._)([(0,p.MZ)({type:S,json:{write:!0}})],R.prototype,"previousObservations",void 0),(0,n._)([(0,p.MZ)({type:S,json:{write:!0}})],R.prototype,"trackLines",void 0),(0,n._)([(0,p.MZ)({type:["timeReceived","startTimeField","endTimeField"],json:{read:!0,write:!0}})],R.prototype,"timeField",void 0),R=(0,n._)([(0,B.$)("esri.layers.support.TrackInfo")],R);const W=R,h=g=>{let T=class extends g{constructor(){super(...arguments),this.trackInfo=null}};return(0,n._)([(0,p.MZ)({type:W})],T.prototype,"trackInfo",void 0),T=(0,n._)([(0,B.$)("esri.layers.mixins.TrackableLayer")],T),T}},73258:(J,N,s)=>{s.d(N,{A:()=>_});var n=s(5922),p=s(71065),w=s(35150),x=s(60797),V=s(24098),B=s(86300),P=s(20543),z=s(22639),j=s(44549);const o=new Map;class _{static fromJSON(E){return new _(E.fields,E.timeZoneByFieldName)}static fromLayer(E){return new _(E.fields??[],C(E))}static fromLayerJSON(E){return new _(E.fields??[],C(E))}constructor(E=[],R){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=E||[],this._timeZoneByFieldName=R?new Map(R):null;const W=[];for(const h of this.fields){const g=h?.name,T=v(g);if(g&&T){const b=d(g);this._fieldsMap.set(g,h),this._fieldsMap.set(b,h),this._normalizedFieldsMap.set(T,h),W.push(`${b}:${h.type}:${this._timeZoneByFieldName?.get(g)}`),(0,B.vE)(h)?(this.dateFields.push(h),this._dateFieldsSet.add(h)):(0,B.WA)(h)&&(this._numericFieldsSet.add(h),this.numericFields.push(h)),(0,B.te)(h)||(0,B.Xz)(h)||(h.editable=null==h.editable||!!h.editable,h.nullable=null==h.nullable||!!h.nullable)}}W.sort(),this.uid=W.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const E of this.fields)(0,B.te)(E)||(0,B.Xz)(E)||E.nullable||void 0!==(0,B.lD)(E)||this._requiredFields.push(E)}return this._requiredFields}equals(E){return this.uid===E?.uid}has(E){return null!=this.get(E)}get(E){if(!E)return;let R=this._fieldsMap.get(E);return R||(R=this._fieldsMap.get(d(E))??this._normalizedFieldsMap.get(v(E)),R&&this._fieldsMap.set(E,R),R)}getTimeZone(E){const R=this.get(E&&"string"!=typeof E?E.name:E);return R?this._timeZoneByFieldName?this._timeZoneByFieldName.get(R.name):"date"===R.type||"esriFieldTypeDate"===R.type?(w.A.getLogger("esri.layers.support.FieldsIndex").errorOnce(new n.A("getTimeZone:no-timezone-information",`no time zone information for field '${R.name}'`)),P.n$):S.has(R.type)?P.L5:null:null}getLuxonTimeZone(E){const R=this.getTimeZone(E);return R?R===P.L5?V.GB.instance:R===P.n$?j.mQ.utcInstance:(0,x.tE)(o,R,()=>j.oh.create(R)):null}isDateField(E){return this._dateFieldsSet.has(this.get(E))}isTimeOnlyField(E){return(0,B.OH)(this.get(E))}isNumericField(E){return this._numericFieldsSet.has(this.get(E))}normalizeFieldName(E){return this.get(E)?.name??void 0}toJSON(){return{fields:this.fields.map(E=>p.A.isSerializable(E)?E.toJSON():E),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function d(U){return U.trim().toLowerCase()}function v(U){return(0,B.rS)(U)?.toLowerCase()??""}const S=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function C(U){const E=new Map;if(!U.fields)return E;const R=!0===U.datesInUnknownTimezone,{timeInfo:W,editFieldsInfo:h}=U,g=(W?"startField"in W?W.startField:W.startTimeField:"")??"",T=(W?"endField"in W?W.endField:W.endTimeField:"")??"",b=function f(U){return"dateFieldsTimeZone"in U}(U)?U.dateFieldsTimeZone??null:U.dateFieldsTimeReference?(0,z.ZS)(U.dateFieldsTimeReference):null,O=h?function y(U){return"timeZone"in U}(h)?h.timeZone??b:h.dateFieldsTimeReference?(0,z.ZS)(h.dateFieldsTimeReference):b??P.n$:null,D=W?function m(U){return"timeZone"in U}(W)?W.timeZone??b:W.timeReference?(0,z.ZS)(W.timeReference):b:null,u=new Map([[d(h?.creationDateField??""),O],[d(h?.editDateField??""),O],[d(g),D],[d(T),D]]);for(const{name:c,type:I}of U.fields)if(S.has(I))E.set(c,P.L5);else if("date"!==I&&"esriFieldTypeDate"!==I)E.set(c,null);else if(R)E.set(c,P.L5);else{const L=u.get(d(c??""))??b;E.set(c,L)}return E}},15848:(J,N,s)=>{s.d(N,{A:()=>f});var j,n=s(8189),p=s(49976),w=s(71065),x=s(85211),z=(s(3248),s(35150),s(40707),s(76576));const y=new p.J({asc:"ascending",desc:"descending"});let m=j=class extends w.A{constructor(o){super(o),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new j({field:this.field,valueExpression:this.valueExpression,order:this.order})}};(0,n._)([(0,x.MZ)({type:String,json:{write:!0}})],m.prototype,"field",void 0),(0,n._)([(0,x.MZ)({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],m.prototype,"valueExpression",void 0),(0,n._)([(0,x.MZ)({type:y.apiValues,json:{type:y.jsonValues,read:y.read,write:y.write}})],m.prototype,"order",void 0),m=j=(0,n._)([(0,z.$)("esri.layers.support.OrderByInfo")],m);const f=m},38488:(J,N,s)=>{s.d(N,{A:()=>v});var n=s(8189),p=s(90660),w=s(71065),x=s(85211),z=(s(3248),s(35150),s(40707),s(17221)),j=s(76576),y=s(50305),m=s(17181),f=s(89352),o=s(22639);function _(S,C){return f.A.fromJSON({value:S,unit:C})}let d=class extends(p.A.ClonableMixin(w.A)){constructor(S){super(S),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(S,C){return C.timeExtent&&Array.isArray(C.timeExtent)&&2===C.timeExtent.length?m.A.fromArray(C.timeExtent):null}writeFullTimeExtent(S,C){C.timeExtent=null!=S?.start&&null!=S.end?S.toArray():null}readInterval(S,C){return C.timeInterval&&C.timeIntervalUnits?_(C.timeInterval,C.timeIntervalUnits):C.defaultTimeInterval&&C.defaultTimeIntervalUnits?_(C.defaultTimeInterval,C.defaultTimeIntervalUnits):null}writeInterval(S,C){C.timeInterval=S?.toJSON().value??null,C.timeIntervalUnits=S?.toJSON().unit??null}};(0,n._)([(0,x.MZ)({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],d.prototype,"cumulative",void 0),(0,n._)([(0,x.MZ)({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],d.prototype,"endField",void 0),(0,n._)([(0,x.MZ)({type:m.A,json:{write:{enabled:!0,allowNull:!0}}})],d.prototype,"fullTimeExtent",void 0),(0,n._)([(0,z.w)("fullTimeExtent",["timeExtent"])],d.prototype,"readFullTimeExtent",null),(0,n._)([(0,y.K)("fullTimeExtent")],d.prototype,"writeFullTimeExtent",null),(0,n._)([(0,x.MZ)({type:Boolean,json:{write:!0}})],d.prototype,"hasLiveData",void 0),(0,n._)([(0,x.MZ)({type:f.A,json:{write:{enabled:!0,allowNull:!0}}})],d.prototype,"interval",void 0),(0,n._)([(0,z.w)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],d.prototype,"readInterval",null),(0,n._)([(0,y.K)("interval")],d.prototype,"writeInterval",null),(0,n._)([(0,x.MZ)({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],d.prototype,"startField",void 0),(0,n._)([(0,x.MZ)((0,o.P6)("timeReference",!0))],d.prototype,"timeZone",void 0),(0,n._)([(0,x.MZ)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],d.prototype,"trackIdField",void 0),(0,n._)([(0,x.MZ)({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],d.prototype,"useTime",void 0),(0,n._)([(0,x.MZ)({type:[Date],json:{read:!1}})],d.prototype,"stops",void 0),d=(0,n._)([(0,j.$)("esri.layers.support.TimeInfo")],d);const v=d},27960:(J,N,s)=>{s.d(N,{Ch:()=>V,mW:()=>w,u2:()=>x});var n=s(69287),p=s(63484);function w(o,_){return{..._,filterMode:o.mode}}function x(o,_){return P(o,_).next().value??null}function V(o,_,d){const v=function B(o){if("manual"===y(o))return null;const _=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:d,maxScale:v}of o.filters)_[0]=Math.max(_[0],m(d)),_[1]=Math.min(_[1],f(v));return _}(o);if(v&&((0,n.gg)(_,v[0])||(0,n.ZH)(d,v[1])))return"";const S=Array.from(P(o,_,d)),C=function z(o,_,d){if(0===o.length)return!0;const v=m(o.at(0)?.minScale),S=f(o.at(-1)?.maxScale);if((0,n.ZH)(v,_)||(0,n.gg)(S,d))return!0;for(let C=0;C<o.length-1;C++){const U=o[C];if((0,n.ZH)(m(o[C+1].minScale),f(U.maxScale)))return!0}return!1}(S,_,d)?"1=1":S.map(U=>U.where||"1=1").reduce((U,E)=>(0,p.IW)(U,E),"");return C&&"1=1"!==C?C:""}function*P(o,_,d){if("manual"===y(o)){const v=o.filters.find(S=>S.id===o.activeFilterId);v&&(yield v)}else{"object"==typeof _&&(_=_.scale);for(const v of o.filters)j(v.minScale,v.maxScale,_,d)&&(yield v)}}function j(o,_,d,v){return o=m(o),d=m(d),_=f(_),!(!(0,n.Sp)(d,o)&&(v??d)>o||(0,n.Hx)(_,d)||void 0!==v&&(0,n.Sp)(v,o))}function y(o){return"mode"in o?o.mode:o.filterMode}function m(o){return o||Number.POSITIVE_INFINITY}function f(o){return o||0}},3404:(J,N,s)=>{s.d(N,{p:()=>B});var n=s(3248),p=s(35150),w=s(29141),x=s(73258),V=s(86300);function B(){return{fields:{type:[w.A],value:null,set:function(P){if(P&&(0,n.A)("big-integer-warning-enabled")){const z=P.filter(j=>"big-integer"===j.type||"oid"===j.type&&(j.length||0)>=8);if(z.length){const j=z.map(y=>`'${y.name}'`).join(", ");p.A.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${j}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",P)}},fieldsIndex:{readOnly:!0,get(){return x.A.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(P){this._userOutFields=P,this.notifyChange("outFields")},get:function(){const P=this._userOutFields;if(!P?.length)return null;if(P.includes("*"))return["*"];if(!this.fields)return P;for(const z of P)this.fieldsIndex?.has(z)||p.A.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${z} found in outFields`,{layer:this,outFields:P});return(0,V.DB)(this.fieldsIndex,P)}}}}},4858:(J,N,s)=>{s.d(N,{BI:()=>_,D3:()=>f,XJ:()=>o,lc:()=>m,mX:()=>v,rU:()=>d,tH:()=>W});var n=s(1119);const p="__begin__",w="__end__",x=new RegExp(p,"ig"),V=new RegExp(w,"ig"),B=new RegExp("^"+p,"i"),P=new RegExp(w+"$","i"),z='"',j=z+" + ",y=" + "+z;function m(h){return h.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function f(h){return h.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function o(h){const g={expression:"",type:"none"};return h.labelExpressionInfo?h.labelExpressionInfo.value?(g.expression=h.labelExpressionInfo.value,g.type="conventional"):h.labelExpressionInfo.expression&&(g.expression=h.labelExpressionInfo.expression,g.type="arcade"):null!=h.labelExpression&&(g.expression=m(h.labelExpression),g.type="conventional"),g}function _(h){const g=o(h);switch(g.type){case"conventional":return v(g.expression);case"arcade":return g.expression}return null}function d(h){const g=o(h);switch(g.type){case"conventional":return function C(h){return h?.match(S)?.[1].trim()||null}(g.expression);case"arcade":return W(g.expression)}return null}function v(h){let g;return h?(g=(0,n.HC)(h,T=>p+'$feature["'+T+'"]'+w),g=B.test(g)?g.replace(B,""):z+g,g=P.test(g)?g.replace(P,""):g+z,g=g.replaceAll(x,j).replaceAll(V,y)):g='""',g}const S=/^\s*\{([^}]+)\}\s*$/i,U=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,E=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,R=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function W(h){if(!h)return null;let g=U.exec(h)||E.exec(h);return g?g[1]||g[3]:(g=R.exec(h),g?g[2]:null)}},69927:(J,N,s)=>{s.d(N,{It:()=>d,LG:()=>P,OM:()=>y,Sm:()=>m,Y:()=>z,bK:()=>j,mm:()=>_,sQ:()=>f});var n=s(10467),p=s(13970),w=s(32034),x=s(55039);function B(){return(B=(0,n.A)(function*(v){const S=v.spatialReference;if(S.isWGS84)return v.clone();if(S.isWebMercator)return(0,x.ci)(v);const C=w.A.WGS84;return yield(0,p.initializeProjection)(S,C),(0,p.project)(v,C)})).apply(this,arguments)}function P(v,S){if(!z(v,S)){const C=v.typeKeywords;C?C.push(S):v.typeKeywords=[S]}}function z(v,S){return!!v.typeKeywords?.includes(S)}function j(v){return z(v,_.HOSTED_SERVICE)}function y(v,S){const C=v.typeKeywords;if(C){const U=C.indexOf(S);U>-1&&C.splice(U,1)}}function m(v,S,C){C?P(v,S):y(v,S)}function f(v){return o.apply(this,arguments)}function o(){return o=(0,n.A)(function*(v){const S=v.clone().normalize();let C;if(S.length>1)for(const U of S)C?U.width>C.width&&(C=U):C=U;else C=S[0];return function V(v){return B.apply(this,arguments)}(C)}),o.apply(this,arguments)}const _={DEVELOPER_BASEMAP:"DeveloperBasemap",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",LOCAL_SCENE:"ViewingMode-Local",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function d(v){const{portal:S,isOrgItem:C,itemControl:U}=v,E=S.user?.privileges;let R=!E||E.includes("features:user:edit"),W=!!C&&!!E?.includes("features:user:fullEdit");const h="update"===U||"admin"===U;return h?W=R=!0:W&&(R=!0),{features:{edit:R,fullEdit:W},content:{updateItem:h}}}},26957:(J,N,s)=>{s.d(N,{j:()=>p});const p=(0,s(49976).O)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},79122:(J,N,s)=>{s.d(N,{A:()=>D});var R,n=s(10467),p=s(8189),w=s(49976),x=s(77806),V=s(35150),B=s(85211),P=s(48669),z=s(15463),j=s(17221),y=s(76576),m=s(50305),f=s(55739),o=s(86300),_=s(38582),d=s(18550),v=s(19390),S=s(36345),C=s(23005),U=s(48218),E=s(94048);const h="percent-of-total",g="field",T=new w.J({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:h,esriNormalizeByField:g}),b=(0,f.dp)(v.A);let O=R=class extends((0,d.h)(_.A)){constructor(u){super(u),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(u,c,I){if(!Array.isArray(u))return;let L=c.minValue;return u.map(G=>{const $=new v.A;return $.read(G,I),null==$.minValue&&($.minValue=L),null==$.maxValue&&($.maxValue=$.minValue),L=$.maxValue,$})}writeClassBreakInfos(u,c,I,L){const G=u.map($=>$.write({},L));this._areClassBreaksConsecutive()&&G.forEach($=>delete $.classMinValue),c[I]=G}castField(u){return null==u?u:"function"==typeof u?(V.A.getLogger(this).error(".field: field must be a string value"),null):(0,f.GX)(u)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let u=this._get("normalizationType");const c=!!this.normalizationField,I=null!=this.normalizationTotal;return c||I?(u=c&&g||I&&h||null,c&&I&&V.A.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):u!==g&&u!==h||(u=null),u}set normalizationType(u){this._set("normalizationType",u)}addClassBreakInfo(u,c,I){let L=null;L="number"==typeof u?new v.A({minValue:u,maxValue:c,symbol:(0,E.dp)(I)}):b((0,x.o8)(u)),this.classBreakInfos.push(L),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(u,c){const I=this.classBreakInfos.length;for(let L=0;L<I;L++){const G=[this.classBreakInfos[L].minValue,this.classBreakInfos[L].maxValue];if(G[0]===u&&G[1]===c){this.classBreakInfos.splice(L,1);break}}}getBreakIndex(u,c){return this.valueExpression&&null==c?.arcade&&V.A.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(u,c):this._getBreakIndexForField(u)}getClassBreakInfo(u,c){var I=this;return(0,n.A)(function*(){let L=c;I.valueExpression&&null==c?.arcade&&(L={...L,arcade:yield(0,U.lw)()});const G=I.getBreakIndex(u,L);return-1!==G?I.classBreakInfos[G]:null})()}getSymbol(u,c){if(this.valueExpression&&null==c?.arcade)return void V.A.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const I=this.getBreakIndex(u,c);return I>-1?this.classBreakInfos[I].symbol:this.defaultSymbol}getSymbolAsync(u,c){var I=this;return(0,n.A)(function*(){let L=c;if(I.valueExpression&&null==c?.arcade){const $=yield(0,U.lw)(),{arcadeUtils:H}=$;H.hasGeometryOperations(I.valueExpression)&&(yield H.enableGeometryOperations()),L={...L,arcade:$}}const G=I.getBreakIndex(u,L);return G>-1?I.classBreakInfos[G].symbol:I.defaultSymbol})()}get symbols(){const u=[];return this.classBreakInfos.forEach(c=>{c.symbol&&u.push(c.symbol)}),this.defaultSymbol&&u.push(this.defaultSymbol),u}getAttributeHash(){return this.visualVariables?.reduce((u,c)=>u+c.getAttributeHash(),"")??""}getMeshHash(){const u=JSON.stringify(this.backgroundFillSymbol),c=JSON.stringify(this.defaultSymbol),I=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${u}.${c}.${this.classBreakInfos.reduce((L,G)=>L+G.getMeshHash(),"")}.${I}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new R({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:(0,x.o8)(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:(0,x.o8)(this.visualVariables),legendOptions:(0,x.o8)(this.legendOptions),authoringInfo:(0,x.o8)(this.authoringInfo)})}collectRequiredFields(u,c){var I=this;return(0,n.A)(function*(){const L=[I.collectVVRequiredFields(u,c),I.collectSymbolFields(u,c)];yield Promise.all(L)})()}collectSymbolFields(u,c){var I=this;return(0,n.A)(function*(){const L=[...I.symbols.map(G=>G.collectRequiredFields(u,c)),(0,o.Dx)(u,c,I.valueExpression)];(0,o.rq)(u,c,I.field),(0,o.rq)(u,c,I.normalizationField),yield Promise.all(L)})()}_getBreakIndexForExpression(u,c){const{viewingMode:I,scale:L,spatialReference:G,arcade:$,timeZone:H}=c??{},{valueExpression:q}=this;let re=this._compiledValueExpression.valueExpression===q?this._compiledValueExpression.compiledFunction:null;const X=$.arcadeUtils;if(!re){const ae=X.createSyntaxTree(q);re=X.createFunction(ae),this._compiledValueExpression.compiledFunction=re}this._compiledValueExpression.valueExpression=q;const Me=X.executeFunction(re,X.createExecContext(u,X.getViewInfo({viewingMode:I,scale:L,spatialReference:G}),H));return this._getBreakIndexfromInfos(Me)}_getBreakIndexForField(u){const I=u.attributes,L=this.normalizationType;let G=parseFloat(I[this.field]);if(L){const $=this.normalizationTotal,H=parseFloat(this.normalizationField?I[this.normalizationField]:void 0);if("log"===L)G=Math.log(G)*Math.LOG10E;else if(L!==h||null==$||isNaN($)){if(L===g&&!isNaN(H)){if(isNaN(G)||isNaN(H))return-1;G/=H}}else G=G/$*100}return this._getBreakIndexfromInfos(G)}_getBreakIndexfromInfos(u){const c=this.isMaxInclusive;if(null!=u&&"number"==typeof u&&!isNaN(u))for(let I=0;I<this.classBreakInfos.length;I++){const L=[this.classBreakInfos[I].minValue,this.classBreakInfos[I].maxValue];if(L[0]<=u&&(c?u<=L[1]:u<L[1]))return I}return-1}_areClassBreaksConsecutive(){const u=this.classBreakInfos,c=u.length;for(let I=1;I<c;I++)if(u[I-1].maxValue!==u[I].minValue)return!1;return!0}};(0,p._)([(0,B.MZ)(S.As)],O.prototype,"backgroundFillSymbol",void 0),(0,p._)([(0,B.MZ)({type:[v.A],json:{write:{isRequired:!0}}})],O.prototype,"classBreakInfos",void 0),(0,p._)([(0,j.w)("classBreakInfos")],O.prototype,"readClassBreakInfos",null),(0,p._)([(0,m.K)("classBreakInfos")],O.prototype,"writeClassBreakInfos",null),(0,p._)([(0,B.MZ)({type:String,json:{write:!0}})],O.prototype,"defaultLabel",void 0),(0,p._)([(0,B.MZ)(S.z4)],O.prototype,"defaultSymbol",void 0),(0,p._)([(0,B.MZ)({type:String,json:{write:!0}})],O.prototype,"field",void 0),(0,p._)([(0,P.w)("field")],O.prototype,"castField",null),(0,p._)([(0,B.MZ)({type:Boolean})],O.prototype,"isMaxInclusive",void 0),(0,p._)([(0,B.MZ)({type:C.A,json:{write:!0}})],O.prototype,"legendOptions",void 0),(0,p._)([(0,B.MZ)({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],O.prototype,"minValue",null),(0,p._)([(0,B.MZ)({type:String,json:{write:!0}})],O.prototype,"normalizationField",void 0),(0,p._)([(0,B.MZ)({type:Number,json:{write:!0}})],O.prototype,"normalizationTotal",void 0),(0,p._)([(0,B.MZ)({type:T.apiValues,value:null,json:{type:T.jsonValues,read:T.read,write:T.write}})],O.prototype,"normalizationType",null),(0,p._)([(0,z.e)({classBreaks:"class-breaks"})],O.prototype,"type",void 0),(0,p._)([(0,B.MZ)({type:String,json:{write:!0}})],O.prototype,"valueExpression",void 0),(0,p._)([(0,B.MZ)({type:String,json:{write:!0}})],O.prototype,"valueExpressionTitle",void 0),O=R=(0,p._)([(0,y.$)("esri.renderers.ClassBreaksRenderer")],O);const D=O},19390:(J,N,s)=>{s.d(N,{A:()=>m});var j,n=s(8189),p=s(71065),w=s(85211),P=(s(3248),s(35150),s(40707),s(76576)),z=s(36345);let y=j=class extends p.A{constructor(f){super(f),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new j({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const f=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${f}`}};(0,n._)([(0,w.MZ)({type:String,json:{write:!0}})],y.prototype,"description",void 0),(0,n._)([(0,w.MZ)({type:String,json:{write:!0}})],y.prototype,"label",void 0),(0,n._)([(0,w.MZ)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],y.prototype,"minValue",void 0),(0,n._)([(0,w.MZ)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],y.prototype,"maxValue",void 0),(0,n._)([(0,w.MZ)(z.Wp)],y.prototype,"symbol",void 0),y=j=(0,n._)([(0,P.$)("esri.renderers.support.ClassBreakInfo")],y);const m=y},78592:(J,N,s)=>{s.d(N,{O3:()=>j,PU:()=>P,YW:()=>m,ex:()=>V,hv:()=>y,zp:()=>B});var n=s(69287),p=s(67685),w=s(53781),x=s(89141);const V=2.4;function B(f){return(0,p.PN)(f*V)}function P(f){return(0,p.Lz)(f)/V}function z(f,o,_,d){let{color:v,ratio:S}=o,{color:C,ratio:U}=_;U===S&&(1===U?S-=1e-6:U+=1e-6);const E=(0,n.qE)((d-S)/(U-S),0,1);(0,w.l)(f,v.toArray(),C.toArray(),E)}function j(f){const _=new Uint8ClampedArray(2048);if((f=f.filter(({ratio:U})=>U>=0&&U<=1).sort((U,E)=>U.ratio-E.ratio).map(({color:U,ratio:E})=>({color:U,ratio:Math.max(E,.001)}))).length<1)return _;let d=f[0],v=f[0],S=1;const C=(0,x.vt)();for(let U=0;U<512;U++){const E=(U+.5)/512;for(;E>v.ratio&&S<f.length;)d=v,v=f[S++];z(C,d,v,E),_.set(C,4*U)}return _}function y(f,o,_){const d=Math.sqrt(f**2+o**2)/_;return d>1?0:3/(Math.PI*_**2)*(1-d**2)**2}function m(f){return"function"==typeof f?f:f?o=>+o[f]:()=>1}},70831:(J,N,s)=>{s.d(N,{A:()=>v});var j,n=s(8189),p=s(81098),w=s(90660),x=s(77806),V=s(85211),z=(s(3248),s(35150),s(76576));let y=j=class extends(w.A.ClonableMixin(p.A)){constructor(S){super(S),this.stackedAttributes=null}cloneShallow(){return new j({...super.cloneShallow(),stackedAttributes:this.stackedAttributes})}toJSON(){return{...super.toJSON(),stackedAttributes:(0,x.o8)(this.stackedAttributes)}}};(0,n._)([(0,V.MZ)()],y.prototype,"stackedAttributes",void 0),y=j=(0,n._)([(0,z.$)("esri.AttributeBinsGraphic")],y);const m=y;s(40707);var o=s(17221),_=s(93327);let d=class extends(w.A.ClonableMixin(_.A)){constructor(){super(...arguments),this.features=[]}readFeatures(S,C){return this.readFeaturesWithClass(S,C,m)}};(0,n._)([(0,V.MZ)({type:[m],json:{write:!0}})],d.prototype,"features",void 0),(0,n._)([(0,o.w)("features")],d.prototype,"readFeatures",null),d=(0,n._)([(0,z.$)("esri.rest.support.AttributeBinsFeatureSet")],d);const v=d},93327:(J,N,s)=>{s.d(N,{A:()=>U});var v,n=s(8189),p=s(81098),w=s(49976),x=s(71065),V=s(77806),B=s(85211),j=(s(3248),s(35150),s(17221)),y=s(76576),m=s(50305),f=s(32034),o=s(61320),_=s(6434),d=s(29141);const S=new w.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let C=v=class extends x.A{constructor(E){super(E),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(E,R){return this.readFeaturesWithClass(E,R,p.A)}writeGeometryType(E,R,W,h){if(E)return void S.write(E,R,W,h);const{features:g}=this;if(g)for(const T of g)if(null!=T?.geometry)return void S.write(T.geometry.type,R,W,h)}readQueryGeometry(E,R){if(!E)return null;const W=!!E.spatialReference,h=(0,o.rS)(E);return h&&!W&&R.spatialReference&&(h.spatialReference=f.A.fromJSON(R.spatialReference)),h}writeSpatialReference(E,R){if(E)return void(R.spatialReference=E.toJSON());const{features:W}=this;if(W)for(const h of W)if(h&&null!=h.geometry&&h.geometry.spatialReference)return void(R.spatialReference=h.geometry.spatialReference.toJSON())}clone(){return new v(this.cloneProperties())}cloneProperties(){return(0,V.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(E){const R=this.write();if(R.features&&Array.isArray(E)&&E.length>0)for(let W=0;W<R.features.length;W++){const h=R.features[W];if(h.geometry){const g=E?.[W];h.geometry=g?.toJSON()||h.geometry}}return R}quantize(E){const{scale:[R,W],translate:[h,g]}=E,O=this.features,D=this._getQuantizationFunction(this.geometryType,u=>Math.round((u-h)/R),u=>Math.round((g-u)/W));for(let u=0,c=O.length;u<c;u++)D?.(O[u].geometry)||(O.splice(u,1),u--,c--);return this.transform=E,this}unquantize(){const{geometryType:E,features:R,transform:W}=this;if(!W)return this;const{translate:[h,g],scale:[T,b]}=W;let u=null,c=null;if(this.hasZ&&null!=W?.scale?.[2]){const{translate:[,,L],scale:[,,G]}=W;u=$=>$*G+L}if(this.hasM&&null!=W?.scale?.[3]){const{translate:[,,,L],scale:[,,,G]}=W;c=$=>null==$?$:$*G+L}const I=this._getHydrationFunction(E,L=>L*T+h,L=>g-L*b,u,c);for(const{geometry:L}of R)null!=L&&I&&I(L);return this.transform=null,this}readFeaturesWithClass(E,R,W){const h=f.A.fromJSON(R.spatialReference),g=[];for(let T=0;T<E.length;T++){const b=E[T],O=W.fromJSON(b),D=b.geometry?.spatialReference;null==O.geometry||D||(O.geometry.spatialReference=h);const u=b.aggregateGeometries,c=O.aggregateGeometries;if(u&&null!=c)for(const I in c){const L=c[I],G=u[I],$=G?.spatialReference;null==L||$||(L.spatialReference=h)}g.push(O)}return g}_quantizePoints(E,R,W){let h,g;const T=[];for(let b=0,O=E.length;b<O;b++){const D=E[b];if(b>0){const u=R(D[0]),c=W(D[1]);u===h&&c===g||(T.push([u-h,c-g]),h=u,g=c)}else h=R(D[0]),g=W(D[1]),T.push([h,g])}return T.length>0?T:null}_getQuantizationFunction(E,R,W){return"point"===E?h=>(h.x=R(h.x),h.y=W(h.y),h):"polyline"===E||"polygon"===E?h=>{const g=(0,o.Bi)(h)?h.rings:h.paths,T=[];for(let b=0,O=g.length;b<O;b++){const u=this._quantizePoints(g[b],R,W);u&&T.push(u)}return T.length>0?((0,o.Bi)(h)?h.rings=T:h.paths=T,h):null}:"multipoint"===E?h=>{const g=this._quantizePoints(h.points,R,W);return g&&g.length>0?(h.points=g,h):null}:"extent"===E?h=>h:null}_getHydrationFunction(E,R,W,h,g){return"point"===E?T=>{T.x=R(T.x),T.y=W(T.y),h&&(T.z=h(T.z))}:"polyline"===E||"polygon"===E?T=>{const b=(0,o.Bi)(T)?T.rings:T.paths;let O,D;for(let u=0,c=b.length;u<c;u++){const I=b[u];for(let L=0,G=I.length;L<G;L++){const $=I[L];L>0?(O+=$[0],D+=$[1]):(O=$[0],D=$[1]),$[0]=R(O),$[1]=W(D)}}if(h&&g)for(let u=0,c=b.length;u<c;u++){const I=b[u];for(let L=0,G=I.length;L<G;L++){const $=I[L];$[2]=h($[2]),$[3]=g($[3])}}else if(h)for(let u=0,c=b.length;u<c;u++){const I=b[u];for(let L=0,G=I.length;L<G;L++){const $=I[L];$[2]=h($[2])}}else if(g)for(let u=0,c=b.length;u<c;u++){const I=b[u];for(let L=0,G=I.length;L<G;L++){const $=I[L];$[2]=g($[2])}}}:"extent"===E?T=>{T.xmin=R(T.xmin),T.ymin=W(T.ymin),T.xmax=R(T.xmax),T.ymax=W(T.ymax),h&&null!=T.zmax&&null!=T.zmin&&(T.zmax=h(T.zmax),T.zmin=h(T.zmin)),g&&null!=T.mmax&&null!=T.mmin&&(T.mmax=g(T.mmax),T.mmin=g(T.mmin))}:"multipoint"===E?T=>{const b=T.points;let O,D;for(let u=0,c=b.length;u<c;u++){const I=b[u];u>0?(O+=I[0],D+=I[1]):(O=I[0],D=I[1]),I[0]=R(O),I[1]=W(D)}if(h&&g)for(let u=0,c=b.length;u<c;u++){const I=b[u];I[2]=h(I[2]),I[3]=g(I[3])}else if(h)for(let u=0,c=b.length;u<c;u++){const I=b[u];I[2]=h(I[2])}else if(g)for(let u=0,c=b.length;u<c;u++){const I=b[u];I[2]=g(I[2])}}:null}};(0,n._)([(0,B.MZ)({type:String,json:{write:!0}})],C.prototype,"displayFieldName",void 0),(0,n._)([(0,B.MZ)({type:Boolean,json:{write:{overridePolicy:E=>({enabled:E})}}})],C.prototype,"exceededTransferLimit",void 0),(0,n._)([(0,B.MZ)({type:[p.A],json:{write:!0}})],C.prototype,"features",void 0),(0,n._)([(0,j.w)("features")],C.prototype,"readFeatures",null),(0,n._)([(0,B.MZ)({type:[d.A],json:{write:!0}})],C.prototype,"fields",void 0),(0,n._)([(0,B.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:S.read}}})],C.prototype,"geometryType",void 0),(0,n._)([(0,m.K)("geometryType")],C.prototype,"writeGeometryType",null),(0,n._)([(0,B.MZ)({type:Boolean,json:{write:{overridePolicy:E=>({enabled:E})}}})],C.prototype,"hasM",void 0),(0,n._)([(0,B.MZ)({type:Boolean,json:{write:{overridePolicy:E=>({enabled:E})}}})],C.prototype,"hasZ",void 0),(0,n._)([(0,B.MZ)({types:_.yR,json:{write:!0}})],C.prototype,"queryGeometry",void 0),(0,n._)([(0,j.w)("queryGeometry")],C.prototype,"readQueryGeometry",null),(0,n._)([(0,B.MZ)({type:f.A,json:{write:!0}})],C.prototype,"spatialReference",void 0),(0,n._)([(0,m.K)("spatialReference")],C.prototype,"writeSpatialReference",null),(0,n._)([(0,B.MZ)({json:{write:!0}})],C.prototype,"transform",void 0),C=v=(0,n._)([(0,y.$)("esri.rest.support.FeatureSet")],C),C.prototype.toJSON.isDefaultToJSON=!0;const U=C},68470:(J,N,s)=>{s.d(N,{K:()=>f,Q:()=>j});var n=s(8189),p=s(49976),w=s(35150),x=s(85211),P=(s(3248),s(40707),s(15463)),z=s(76576);const j=(0,p.O)()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),y="percent-of-total",m="field",f=o=>{let _=class extends o{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let d=this._get("normalizationType");const v=!!this.normalizationField,S=null!=this.normalizationTotal;return v||S?(d=v&&m||S&&y||null,v&&S&&w.A.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):d!==m&&d!==y||(d=null),d}set normalizationType(d){this._set("normalizationType",d)}};return(0,n._)([(0,x.MZ)({type:String,json:{name:"parameters.normalizationField",write:!0}})],_.prototype,"normalizationField",void 0),(0,n._)([(0,x.MZ)({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],_.prototype,"normalizationMaxValue",void 0),(0,n._)([(0,x.MZ)({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],_.prototype,"normalizationMinValue",void 0),(0,n._)([(0,x.MZ)({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],_.prototype,"normalizationTotal",void 0),(0,n._)([(0,P.e)(j,{name:"parameters.normalizationType"})],_.prototype,"normalizationType",null),_=(0,n._)([(0,z.$)("esri.rest.support.NormalizationBinParametersMixin")],_),_}},41843:(J,N,s)=>{s.d(N,{DQ:()=>v,tn:()=>_});var n=s(92165),p=s(86300),w=s(54042),P=(s(75432),s(65121),s(558),s(8975)),f=(s(90792),s(83902),s(98089),s(62270),s(61099)),o=s(17580);function _({displayField:c,editFieldsInfo:I,fields:L,objectIdField:G,title:$},H){if(!L)return null;const q=function R(c,I){const L=I?.visibleFieldNames;return function C({fields:c,ignoreFieldTypes:I,sortDisabled:L}){const G=c;return I&&(c=c.filter($=>!I.includes($.type))),c===G&&(c=c.slice()),!0!==L&&c.sort(U),c}({fields:c.fields??[],ignoreFieldTypes:I?.ignoreFieldTypes||u,sortDisabled:I?.sortDisabled}).map(G=>new f.A({fieldName:G.name,isEditable:(0,p.R$)(G,c),label:G.alias,format:g(G),visible:S(G,{...c,visibleFieldNames:L})}))}({editFieldsInfo:I,fields:L,objectIdField:G},H);if(!q.length)return null;const re=function O(c){const I=(0,p.mB)(c),{titleBase:L}=c;return I?`${L}: {${I.trim()}}`:L??""}({titleBase:$,fields:L,displayField:c}),X=function T(){return[new P.A,new w.A]}();return new n.A({title:re,content:X,fieldInfos:q})}function v(c){const{title:I,graphic:L}=c??{},{attributes:G,sourceLayer:$}=L??{},H=$&&"displayField"in $?$.displayField:null,q=H?G?.[H]:null,re=null!=q?JSON.stringify(q):null,X=L?.getObjectId()?.toString();return I||re||X||""}const S=(c,I)=>I.visibleFieldNames?I.visibleFieldNames.has(c.name):(0,p.Bz)(c,I);function U(c,I){return"oid"===c.type?-1:"oid"===I.type?1:D(c)?-1:D(I)?1:(c.alias||c.name).toLocaleLowerCase().localeCompare((I.alias||I.name).toLocaleLowerCase())}function g(c){switch(c.type){case"small-integer":case"integer":case"single":return new o.A({digitSeparator:!0,places:0});case"double":return new o.A({digitSeparator:!0,places:2});case"string":return(0,p.JL)(c.name)?new o.A({digitSeparator:!0,places:0}):void 0;default:return}}function D(c){return"name"===(c.name&&c.name.toLowerCase())||"name"===c.alias?.toLowerCase()}const u=["geometry","blob","raster","guid","xml"]},32117:(J,N,s)=>{s.d(N,{$w:()=>S,Bu:()=>c,DW:()=>b,FH:()=>Ie,FM:()=>z,G9:()=>x,GV:()=>U,Go:()=>y,K3:()=>ae,Kn:()=>g,MM:()=>o,MO:()=>Pe,Nl:()=>I,Ny:()=>E,O2:()=>L,UE:()=>G,YC:()=>Ee,YF:()=>H,ZO:()=>re,_1:()=>D,_H:()=>W,_W:()=>C,_d:()=>T,bs:()=>ve,dI:()=>ge,e6:()=>m,gQ:()=>P,iA:()=>X,jn:()=>d,lW:()=>f,mA:()=>_,n5:()=>$,pM:()=>O,pV:()=>h,pk:()=>Le,rB:()=>Se,s4:()=>w,xo:()=>u,yH:()=>R,yX:()=>De,zb:()=>q,zr:()=>v});var n=s(46988);function w(i,F,M,A){return function p(i){return"function"==typeof i}(i)?i(F,M,A):i}function x(i){return[i.r,i.g,i.b,i.a]}const V=" /-,\n";function B(i){let F=i.length;for(;F--;)if(!V.includes(i.charAt(F)))return!1;return!0}function P(i,F){const M=[];let A=0,Z=-1;do{if(Z=i.indexOf("[",A),Z>=A){if(Z>A){const K=i.slice(A,Z);M.push([K,null,B(K)])}if(A=Z+1,Z=i.indexOf("]",A),Z>=A){if(Z>A){const K=F[i.slice(A,Z)];K&&M.push([null,K,!1])}A=Z+1}}}while(-1!==Z);if(A<i.length){const K=i.slice(A);M.push([K,null,B(K)])}return M}function z(i,F,M,A){let Z="",K=null;for(const k of F){const[Y,Q,ee]=k;if(Y)ee?K=Y:(K&&(Z+=K,K=null),Z+=Y);else{let ie=Q;null!=M&&(ie=Pe(Q,M));const te=i.attributes[ie];te&&(K&&(Z+=K,K=null),Z+=te)}}return function j(i,F){switch("string"!=typeof i&&(i=String(i)),F){case"LowerCase":return i.toLowerCase();case"Allcaps":return i.toUpperCase();default:return i}}(Z,A)}function y(i,F,M,A,Z,K,k=!0){const Y=F/Z,Q=M/K,ee=Math.ceil(Y/2),ie=Math.ceil(Q/2);for(let te=0;te<K;te++)for(let se=0;se<Z;se++){const le=4*(se+(k?K-te-1:te)*Z);let oe=0,pe=0,ne=0,_e=0,he=0,ye=0,me=0;const Oe=(te+.5)*Q;for(let ue=Math.floor(te*Q);ue<(te+1)*Q;ue++){const Re=Math.abs(Oe-(ue+.5))/ie,xe=(se+.5)*Y,je=Re*Re;for(let Ce=Math.floor(se*Y);Ce<(se+1)*Y;Ce++){let ce=Math.abs(xe-(Ce+.5))/ee;const fe=Math.sqrt(je+ce*ce);fe>=-1&&fe<=1&&(oe=2*fe*fe*fe-3*fe*fe+1,oe>0&&(ce=4*(Ce+ue*F),me+=oe*i[ce+3],ne+=oe,i[ce+3]<255&&(oe=oe*i[ce+3]/250),_e+=oe*i[ce],he+=oe*i[ce+1],ye+=oe*i[ce+2],pe+=oe))}}A[le]=_e/pe,A[le+1]=he/pe,A[le+2]=ye/pe,A[le+3]=me/ne}}function m(i){return i?[i[0],i[1],i[2],i[3]/255]:[0,0,0,0]}function f(i){return i.data?.symbol??null}function o(i){return"CIMVectorMarker"===i.type||"CIMPictureMarker"===i.type||"CIMBarChartMarker"===i.type||"CIMCharacterMarker"===i.type||"CIMPieChartMarker"===i.type||"CIMStackedBarChartMarker"===i.type}function _(i){return"CIMGradientStroke"===i.type||"CIMPictureStroke"===i.type||"CIMSolidStroke"===i.type}function d(i){return null!=i&&("CIMGradientFill"===i.type||"CIMHatchFill"===i.type||"CIMPictureFill"===i.type||"CIMSolidFill"===i.type||"CIMWaterFill"===i.type)}function v(i){return null!=i&&("CIMMarkerPlacementAlongLineRandomSize"===i.type||"CIMMarkerPlacementAlongLineSameSize"===i.type||"CIMMarkerPlacementAlongLineVariableSize"===i.type||"CIMMarkerPlacementAtExtremities"===i.type||"CIMMarkerPlacementAtMeasuredUnits"===i.type||"CIMMarkerPlacementAtRatioPositions"===i.type||"CIMMarkerPlacementOnLine"===i.type||"CIMMarkerPlacementOnVertices"===i.type)}const S=(i,F=0)=>null==i||isNaN(i)?F:i,C=(i,F)=>i??F,U=(i,F)=>i??F,E=i=>i.tintColor?m(i.tintColor):[255,255,255,1],R=i=>{if(!i)return!1;for(const F of i)switch(F.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function W(){return Promise.all([s.e(3930),s.e(2076),s.e(4108)]).then(s.bind(s,27815))}function h(i){if(!i)return"normal";switch(i.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function g(i){if(!i)return"normal";switch(i.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function T(i){let F="normal",M="normal";if(i){const A=i.toLowerCase();A.includes("italic")?F="italic":A.includes("oblique")&&(F="oblique"),A.includes("bold")?M="bold":A.includes("light")&&(M="lighter")}return{style:F,weight:M}}function b(i){return i.underline?"underline":i.strikethrough?"line-through":"none"}function O(i){if(!i)return null;switch(i.type){case"CIMPolygonSymbol":if(i.symbolLayers)for(const F of i.symbolLayers){const M=O(F);if(null!=M)return M}break;case"CIMTextSymbol":return O(i.symbol);case"CIMSolidFill":return i.color}return null}function D(i){if(i)switch(i.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const F=i.symbolLayers;if(F)for(const M of F){const A=D(M);if(null!=A)return A}break}case"CIMTextSymbol":return D(i.symbol);case"CIMSolidStroke":return i.color}}function u(i){if(i)switch(i.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(i.symbolLayers)for(const F of i.symbolLayers){const M=u(F);if(void 0!==M)return M}break;case"CIMTextSymbol":return u(i.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return i.width}}function c(i){switch(i){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function I(i){switch(i){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function L(i){return(i?Object.keys(i):[]).map(F=>({name:F,alias:F,type:"string"==typeof i[F]?"esriFieldTypeString":"esriFieldTypeDouble"}))}const G=i=>i.includes("data:image/svg+xml");function $(i){if(!i)return null;switch(i.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function H(i){return i&&i.charAt(0).toLowerCase()+i.slice(1)}function q(i,F,M,A,Z,K,k=!0){const{infos:Y}=K;let Q=1,ee=0,ie=0,te=0,se=1;for(const{absoluteAnchorPoint:pe,offsetX:ne,offsetY:_e,rotation:he,size:ye,frameHeight:me,rotateClockWise:Oe,scaleSymbolsProportionally:ue}of Y)se=pe?1:Q,ie=Ae(ne,_e,ee,se,ie),te=de(ne,_e,ee,se,te),me&&(ue||k)&&(Q*=ye/me),ee=Te(he,Oe,ee);const le=Ae(A,Z,ee,se,ie),oe=de(A,Z,ee,se,te);return{size:i*Q,rotation:Te(F,M,ee),offsetX:le,offsetY:oe}}function re(i){if(null==i)return!1;if(Array.isArray(i))return i.every(F=>re(F));switch(typeof i){case"string":return!!i;case"number":return!isNaN(i)}}function X(i,F){if("color"===F||"outlinecolor"===F||"backgroundcolor"===F||"borderlinecolor"===F||"tintcolor"===F)return[...n.K[F]];const M=n.D[i];if(!M)throw new Error(`InternalError: default value for type ${i}.`);return M[F]}function ae(i){return"string"==typeof i?function Me(i){return i.split(" ").map(F=>Number(F))}(i):i}function Ie(i){return i?.dashTemplate&&(i.dashTemplate=ae(i.dashTemplate)),i}function ve(i){if(null==i)return"Normal";switch(i.type){case"CIMTextSymbol":return i.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const F=i.symbolLayers;if(!F)return"Normal";for(const M of F)if("CIMVectorMarker"===M.type)return ve(M)}break;case"CIMVectorMarker":{const F=i.markerGraphics;if(!F)return"Normal";for(const M of F)if(M.symbol)return ve(M.symbol)}}return"Normal"}function Ee(i){if(i)switch(i.type){case"CIMTextSymbol":return i.height;case"CIMPointSymbol":{let F=0;if(i.symbolLayers)for(const M of i.symbolLayers)if(M)switch(M.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const A=M.size??n.D.CIMVectorMarker.size;A>F&&(F=A);break}}return F}case"CIMLineSymbol":case"CIMPolygonSymbol":{let F=0;if(i.symbolLayers)for(const M of i.symbolLayers)if(M)switch(M.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const A=M.width;null!=A&&A>F&&(F=A);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(M.markerPlacement&&v(M.markerPlacement)){const A=M.size??n.D.CIMVectorMarker.size;A>F&&(F=A)}break;case"CIMPictureFill":{const A=M.height;null!=A&&A>F&&(F=A)}}return F}}}function Pe(i,F){if(null!==F){const M=F.get(i);return M?M.name:i}return i}function Le(i){return i.map(F=>({...F,propertyName:H(F.propertyName)}))}function Se(i){const F={};for(const M in i){const A=i[M];F[H(M)]=A}return F}function de(i,F,M,A,Z){const K=M*Math.PI/180;if(K){const k=Math.cos(K);return(Math.sin(K)*i+k*F)*A+Z}return F*A+Z}function Ae(i,F,M,A,Z){const K=M*Math.PI/180;return K?(Math.cos(K)*i-Math.sin(K)*F)*A+Z:i*A+Z}function Te(i,F,M){return F?M-i:M+i}function ge(i,F,M){const A="Color"===M||"TintColor"===M||"ToColor"===M,Z="Rotation"===M||"Angle"===M||"ToRotation"===M;let K=F[H(M)];if(null!=K&&(A?K=[K[0]/255,K[1]/255,K[2]/255,K[3]/255]:Z&&(K*=Math.PI/180)),null==K&&(K=X(F.type,M.toLowerCase()),null!=K&&(A?K=[K[0]/255,K[1]/255,K[2]/255,K[3]]:Z&&(K*=Math.PI/180))),null!=F.primitiveName){const k=i[F.primitiveName];if(null!=k){const Y=k[M];null==Y||("string"==typeof Y||"number"==typeof Y||Array.isArray(Y)?(K=Y,null!=K&&(A?K=[K[0]/255,K[1]/255,K[2]/255,K[3]/255]:Z&&(K*=Math.PI/180))):(K={valueExpressionInfo:Y,defaultValue:K},null!=K&&(A?K={type:"Process",op:"ArcadeColor",value:K}:Z&&(K={type:"Process",op:"Divide",left:K,right:180/Math.PI}))))}}if(null==K)throw new Error(`Failed to derive a value or an expression for "${M}".`);return K}function De(i,F){return Math.max(Math.min((i??F)/100,1),0)}},91644:(J,N,s)=>{s.d(N,{A7:()=>z,Cx:()=>j,Hk:()=>y,JJ:()=>_,SF:()=>m,UK:()=>P,jM:()=>f,x3:()=>o}),s(3248);var p=s(88521),w=s(55417),x=s(46602),V=s(47705),B=s(48254);const P=x.A.fromJSON(B.Cb),z=w.A.fromJSON(B.yM),j=p.A.fromJSON(B.WR),y=V.A.fromJSON(B.JZ);function m(d){if(null==d)return null;switch(d.type){case"mesh":return null;case"point":case"multipoint":return P;case"polyline":return z;case"polygon":case"extent":return j}return null}const f=x.A.fromJSON(B.nC),o=w.A.fromJSON(B.HW),_=p.A.fromJSON(B.b6)},48254:(J,N,s)=>{s.d(N,{Cb:()=>w,HW:()=>z,JR:()=>p,JZ:()=>B,WR:()=>V,b6:()=>j,fT:()=>n,nC:()=>P,yM:()=>x});const n=[252,146,31,255],p=[153,153,153,255],w={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},x={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},V={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},B={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},P={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},z={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},j={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},89352:(J,N,s)=>{s.d(N,{A:()=>o});var n=s(8189),p=s(90660),w=s(71065),x=s(97442),V=s(85211),j=(s(3248),s(35150),s(40707),s(15463)),y=s(76576),m=s(26957);let f=class extends(p.A.ClonableMixin(w.A)){constructor(_){super(_),this.unit="milliseconds",this.value=0}toMilliseconds(){return(0,x.t)(this.value,this.unit,"milliseconds")}};(0,n._)([(0,j.e)(m.j,{nonNullable:!0})],f.prototype,"unit",void 0),(0,n._)([(0,V.MZ)({type:Number,json:{write:!0},nonNullable:!0})],f.prototype,"value",void 0),f=(0,n._)([(0,y.$)("esri.time.TimeInterval")],f);const o=f}}]);