"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[179],{23225:(H,C,t)=>{t.d(C,{a:()=>B,f:()=>D,n:()=>U});var A=t(79139);function U(x,h){B(x.typedBuffer,h.typedBuffer,x.typedBufferStride,h.typedBufferStride)}function B(x,h,a=2,v=a){const l=h.length/2;let o=0,i=0;if(!(0,A.iu)(h)||(0,A.dk)(h)){for(let f=0;f<l;++f)x[o]=h[i],x[o+1]=h[i+1],o+=a,i+=v;return}const c=(0,A.a3)(h);if((0,A.JI)(h))for(let f=0;f<l;++f)x[o]=Math.max(h[i]/c,-1),x[o+1]=Math.max(h[i+1]/c,-1),o+=a,i+=v;else for(let f=0;f<l;++f)x[o]=h[i]/c,x[o+1]=h[i+1]/c,o+=a,i+=v}function D(x,h,a,v){const l=x.typedBuffer,o=x.typedBufferStride,i=v?.count??x.count;let c=(v?.dstIndex??0)*o;for(let f=0;f<i;++f)l[c]=h,l[c+1]=a,c+=o}Object.freeze(Object.defineProperty({__proto__:null,fill:D,normalizeIntegerBuffer:B,normalizeIntegerBufferView:U},Symbol.toStringTag,{value:"Module"}))},7201:(H,C,t)=>{function A(a){return a=a||globalThis.location.hostname,h.some(v=>null!=a?.match(v))}function U(a,v){return a?(v=v||globalThis.location.hostname)?null!=v.match(B)||null!=v.match(R)?a.replace("static.arcgis.com","staticdev.arcgis.com"):null!=v.match(D)||null!=v.match(x)?a.replace("static.arcgis.com","staticqa.arcgis.com"):a:a:null}t.d(C,{EM:()=>U,b5:()=>A});const B=/^devext\.arcgis\.com$/,D=/^qaext\.arcgis\.com$/,R=/^[\w-]*\.mapsdevext\.arcgis\.com$/,x=/^[\w-]*\.mapsqa\.arcgis\.com$/,h=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,B,D,/^jsapps\.esri\.com$/,R,x]},85303:(H,C,t)=>{t.d(C,{R:()=>h});var A=t(10467),U=t(89563),B=t(89447),D=t(5922),R=t(56492),x=t(45272);class h{constructor(l){this._streamDataRequester=l}loadJSON(l,o){var i=this;return(0,A.A)(function*(){return i._load("json",l,o)})()}loadBinary(l,o){var i=this;return(0,A.A)(function*(){return(0,x.DB)(l)?((0,R.Te)(o),(0,x.lJ)(l)):i._load("binary",l,o)})()}loadImage(l,o){var i=this;return(0,A.A)(function*(){return i._load("image",l,o)})()}_load(l,o,i){var c=this;return(0,A.A)(function*(){if(null==c._streamDataRequester)return(yield(0,U.A)(o,{responseType:a[l]})).data;const f=yield(0,B.Ke)(c._streamDataRequester.request(o,l,i));if(!0===f.ok)return f.value;throw(0,R.QP)(f.error),new D.A("glt-loader-request-error",`Request for resource failed: ${f.error}`)})()}}const a={image:"image",binary:"array-buffer",json:"json","image+type":void 0}},68641:(H,C,t)=>{t.d(C,{G:()=>D});var A=t(32954),U=t(88532),B=t(31610);function D(R){if(null==R)return null;const x=null!=R.offset?R.offset:U.uY,h=null!=R.rotation?R.rotation:0,a=null!=R.scale?R.scale:U.Un,v=(0,A.fA)(1,0,0,0,1,0,x[0],x[1],1),l=(0,A.fA)(Math.cos(h),-Math.sin(h),0,Math.sin(h),Math.cos(h),0,0,0,1),o=(0,A.fA)(a[0],0,0,0,a[1],0,0,0,1),i=(0,A.vt)();return(0,B.lw)(i,l,o),(0,B.lw)(i,v,i),i}},61362:(H,C,t)=>{t.d(C,{x:()=>D});var A=t(79139),U=t(83034),B=t(50915);function D(a,v){switch(v){case B.WR.TRIANGLES:return function R(a){return"number"==typeof a?(0,U.tM)(a):(0,A.mg)(a)?new Uint16Array(a):a}(a);case B.WR.TRIANGLE_STRIP:return function x(a){const v="number"==typeof a?a:a.length;if(v<3)return[];const l=v-2,o=(0,U.my)(3*l);if("number"==typeof a){let i=0;for(let c=0;c<l;c+=1)c%2==0?(o[i++]=c,o[i++]=c+1,o[i++]=c+2):(o[i++]=c+1,o[i++]=c,o[i++]=c+2)}else{let i=0;for(let c=0;c<l;c+=1)c%2==0?(o[i++]=a[c],o[i++]=a[c+1],o[i++]=a[c+2]):(o[i++]=a[c+1],o[i++]=a[c],o[i++]=a[c+2])}return o}(a);case B.WR.TRIANGLE_FAN:return function h(a){const v="number"==typeof a?a:a.length;if(v<3)return new Uint16Array(0);const l=v-2,o=l<=65536?new Uint16Array(3*l):new Uint32Array(3*l);if("number"==typeof a){let w=0;for(let K=0;K<l;++K)o[w++]=0,o[w++]=K+1,o[w++]=K+2;return o}const i=a[0];let c=a[1],f=0;for(let w=0;w<l;++w){const K=a[w+2];o[f++]=i,o[f++]=c,o[f++]=K,c=K}return o}(a)}}},39690:(H,C,t)=>{t.d(C,{KB:()=>x,Xi:()=>D,pn:()=>a,x3:()=>R});var A=t(10467),U=t(3248),B=t(67496);class D{constructor(o){this.data=o,this.type="encoded-mesh-texture",this.encoding=B.JS.KTX2_ENCODING}}function R(l){return"encoded-mesh-texture"===l?.type}function x(l){return h.apply(this,arguments)}function h(){return(h=(0,A.A)(function*(l){const o=new Blob([l]),i=yield o.text();return JSON.parse(i)})).apply(this,arguments)}function a(l,o){return v.apply(this,arguments)}function v(){return(v=(0,A.A)(function*(l,o){if(o===B.JS.KTX2_ENCODING)return new D(l);const i=new Blob([l],{type:o});let c=URL.createObjectURL(i);switch(o){case"image/jpeg":c+="#.jpg";break;case"image/png":c+="#.png"}const f=new Image;if((0,U.A)("esri-iPhone"))return new Promise((w,K)=>{const ne=()=>{oe(),w(f)},se=ee=>{oe(),K(ee)},oe=()=>{URL.revokeObjectURL(c),f.removeEventListener("load",ne),f.removeEventListener("error",se)};f.addEventListener("load",ne),f.addEventListener("error",se),f.src=c});try{f.src=c,yield f.decode()}catch{console.warn("Failed decoding HTMLImageElement")}return URL.revokeObjectURL(c),f})).apply(this,arguments)}},50179:(H,C,t)=>{t.r(C),t.d(C,{fetch:()=>ze,parseUrl:()=>Re});var A=t(10467),U=t(27980),B=t(7201),D=t(69287),R=t(31610),x=t(32954),h=t(92771),a=t(62789),v=t(45475),l=t(28714),o=t(25866),i=t(2296),c=t(81596),f=t(45434),w=t(10442),K=t(17559),ne=t(23225),se=t(85303),oe=t(61362),ee=t(39690),te=t(68641);class be{constructor(){this.geometries=new Array,this.materials=new Array,this.textures=new Array}}class Be{constructor(e,u,s){this.name=e,this.lodThreshold=u,this.pivotOffset=s,this.stageResources=new be,this.numberOfVertices=0}}var Oe=t(89563),he=t(89447),Ie=t(5922),Ue=t(35150),De=t(11445),we=t(67571),ge=t(56492),ve=t(43420),Le=t(83034),Se=t(96797),Z=t(83346),j=t(67496),ye=t(36884),xe=t(20706),Q=t(40972),ae=t(3781),Te=t(50915);const V=()=>Ue.A.getLogger("esri.views.3d.layers.graphics.objectResourceUtils");class Ce{constructor(e,u,s){this.resource=e,this.textures=u,this.cachedMemory=s}}function ce(){return ce=(0,A.A)(function*(r,e){const u=yield function We(r,e){return fe.apply(this,arguments)}(r,e),s=yield function $e(r,e){return me.apply(this,arguments)}(u.textureDefinitions??{},e);let y=0;for(const g in s)if(s.hasOwnProperty(g)){const d=s[g];y+=d?.image?d.image.width*d.image.height*4:0}return new Ce(u,s,y+(0,De.Qh)(u))}),ce.apply(this,arguments)}function fe(){return fe=(0,A.A)(function*(r,e){const u=e?.streamDataRequester;if(u)return function Ke(r,e,u){return de.apply(this,arguments)}(r,u,e);const s=yield(0,he.Ke)((0,Oe.A)(r,e));if(!0===s.ok)return s.value.data;(0,ge.QP)(s.error),Ae(s.error)}),fe.apply(this,arguments)}function de(){return(de=(0,A.A)(function*(r,e,u){const s=yield(0,he.Ke)(e.request(r,"json",u));if(!0===s.ok)return s.value;(0,ge.QP)(s.error),Ae(s.error.details.url)})).apply(this,arguments)}function Ae(r){throw new Ie.A("",`Request for object resource failed: ${r}`)}function Fe(r){const e=r.params,u=e.topology;let s=!0;switch(e.vertexAttributes||(V().warn("Geometry must specify vertex attributes"),s=!1),e.topology){case"PerAttributeArray":break;case"Indexed":case null:case void 0:{const g=e.faces;if(g){if(e.vertexAttributes)for(const d in e.vertexAttributes){const T=g[d];T?.values?(null!=T.valueType&&"UInt32"!==T.valueType&&(V().warn(`Unsupported indexed geometry indices type '${T.valueType}', only UInt32 is currently supported`),s=!1),null!=T.valuesPerElement&&1!==T.valuesPerElement&&(V().warn(`Unsupported indexed geometry values per element '${T.valuesPerElement}', only 1 is currently supported`),s=!1)):(V().warn(`Indexed geometry does not specify face indices for '${d}' attribute`),s=!1)}}else V().warn("Indexed geometries must specify faces"),s=!1;break}default:V().warn(`Unsupported topology '${u}'`),s=!1}r.params.material||(V().warn("Geometry requires material"),s=!1);const y=r.params.vertexAttributes;for(const g in y)y[g].values||(V().warn("Geometries with externally defined attributes are not yet supported"),s=!1);return s}function Ne(r){const e=(0,i.Ie)();return r.forEach(u=>{const s=u.boundingInfo;null!=s&&((0,i.iT)(e,s.bbMin),(0,i.iT)(e,s.bbMax))}),e}function me(){return(me=(0,A.A)(function*(r,e){const u=new Array;for(const g in r){const d=r[g],T=d.images[0].data;if(!T){V().warn("Externally referenced texture data is not yet supported");continue}const n=d.encoding+";base64,"+T,m="/textureDefinitions/"+g,p="rgba"===d.channels?d.alphaChannelUsage||"transparency":"none",E={noUnpackFlip:!0,wrap:{s:Te.pF.REPEAT,t:Te.pF.REPEAT},preMultiplyAlpha:Ee(p)!==j.sf.Opaque},O=e?.disableTextures?Promise.resolve(null):(0,Se.D)(n,e);u.push(O.then(I=>({refId:m,image:I,parameters:E,alphaChannelUsage:p})))}const s=yield Promise.all(u),y={};for(const g of s)y[g.refId]=g;return y})).apply(this,arguments)}function Ee(r){switch(r){case"mask":return j.sf.Mask;case"maskAndTransparency":return j.sf.MaskBlend;case"none":return j.sf.Opaque;default:return j.sf.Blend}}function Ve(r){const e=r.params;return{id:1,material:e.material,texture:e.texture,region:e.texture}}const _e=new ve.R(1,2,"wosr");var Me=t(34416),ie=t(30906);function ze(r,e){return pe.apply(this,arguments)}function pe(){return pe=(0,A.A)(function*(r,e){const u=Re((0,B.EM)(r));if("wosr"===u.fileType){const E=yield e.cache?e.cache.loadWOSR(u.url,e):function je(r,e){return ce.apply(this,arguments)}(u.url,e),{engineResources:O,referenceBoundingBox:I}=function Ge(r,e){const u=new Array,s=new Array,y=new Array,g=new we.O,d=r.resource,T=ve.R.parse(d.version||"1.0","wosr");_e.validate(T);const n=d.model.name,m=d.model.geometries,p=d.materialDefinitions??{},E=r.textures;let O=0;const I=new Map;for(let P=0;P<m.length;P++){const L=m[P];if(!Fe(L))continue;const W=Ve(L),G=L.params.vertexAttributes,b=[],S=M=>{if("PerAttributeArray"===L.params.topology)return null;const N=L.params.faces;for(const F in N)if(F===M)return N[F].values;return null},re=G[Q.r.POSITION],le=re.values.length/re.valuesPerElement;for(const M in G){const N=G[M],F=N.values,$=S(M)??(0,Le.tM)(le);b.push([M,new Z.n(F,$,N.valuesPerElement,!0)])}const z=W.texture,_=E&&E[z];if(_&&!I.has(z)){const{image:M,parameters:N}=_,F=new xe.g(M,N);s.push(F),I.set(z,F)}const ue=I.get(z),q=ue?ue.id:void 0,X=W.material;let J=g.get(X,z);if(null==J){const M=p[X.slice(X.lastIndexOf("/")+1)].params;1===M.transparency&&(M.transparency=0);const N=_&&_.alphaChannelUsage,F=M.transparency>0||"transparency"===N||"maskAndTransparency"===N,$=_?Ee(_.alphaChannelUsage):void 0,Pe={ambient:(0,o.ci)(M.diffuse),diffuse:(0,o.ci)(M.diffuse),opacity:1-(M.transparency||0),transparent:F,textureAlphaMode:$,textureAlphaCutoff:.33,textureId:q,doubleSided:!0,cullFace:j.s2.None,colorMixMode:M.externalColorMixMode||"tint",textureAlphaPremultiplied:_?.parameters.preMultiplyAlpha??!1};e?.materialParameters&&Object.assign(Pe,e.materialParameters),J=new ae.$U(Pe,e),g.set(X,z,J)}y.push(J);const Y=new ye.V(J,b);O+=b.find(M=>M[0]===Q.r.POSITION)?.[1]?.indices.length??0,u.push(Y)}return{engineResources:[{name:n,stageResources:{textures:s,materials:y,geometries:u},pivotOffset:d.model.pivotOffset,numberOfVertices:O,lodThreshold:null}],referenceBoundingBox:Ne(u)}}(E,e);return{lods:O,referenceBoundingBox:I,isEsriSymbolResource:!1,isWosr:!0}}let s;if(e.cache)s=yield e.cache.loadGLTF(u.url,e,!!e.usePBR);else{const{loadGLTF:E}=yield t.e(2867).then(t.bind(t,52867));s=yield E(new se.R(e.streamDataRequester),u.url,e,e.usePBR)}const y=s.model.meta?.ESRI_proxyEllipsoid,g=s.meta.isEsriSymbolResource&&null!=y&&"EsriRealisticTreesStyle"===s.meta.ESRI_webstyle;g&&!s.customMeta.esriTreeRendering&&(s.customMeta.esriTreeRendering=!0,function He(r,e){for(let u=0;u<r.model.lods.length;++u){const s=r.model.lods[u];for(const y of s.parts){const g=y.attributes.normal;if(null==g)return;const d=y.attributes.position,T=d.count,n=(0,o.vt)(),m=(0,o.vt)(),p=(0,o.vt)(),E=new Float32Array(4*T),O=new Float32Array(3*T),I=(0,h.B8)((0,a.vt)(),y.transform);let P=0,L=0;for(let W=0;W<T;W++){d.getVec(W,m),g.getVec(W,n),(0,l.t)(m,m,y.transform),(0,l.d)(p,m,e.center),(0,l.E)(p,p,e.radius);const G=p[2],b=(0,l.l)(p),S=Math.min(.45+.55*b*b,1)**U.Tf;(0,l.E)(p,p,e.radius),null!==I&&(0,l.t)(p,p,I),(0,l.n)(p,p),u+1!==r.model.lods.length&&r.model.lods.length>1&&(0,l.m)(p,p,n,G>-1?.2:Math.min(-4*G-3.8,1)),O[P]=p[0],O[P+1]=p[1],O[P+2]=p[2],P+=3,E[L]=S,E[L+1]=S,E[L+2]=S,E[L+3]=1,L+=4}y.attributes.normal=new f.xs(O),y.attributes.color=new f.Eq(E)}}}(s,y));const d=!!e.usePBR,T=s.meta.isEsriSymbolResource?{usePBR:d,isSchematic:!1,treeRendering:g,mrrFactors:ie.SY}:{usePBR:d,isSchematic:!1,treeRendering:!1,mrrFactors:ie.mb},n={...e.materialParameters,treeRendering:g},{engineResources:m,referenceBoundingBox:p}=function Je(r,e,u,s,y){const g=r.model,d=new Array,T=new Map,n=new Map,m=g.lods.length,p=(0,i.Ie)();return g.lods.forEach((E,O)=>{const I=!0===s.skipHighLods&&(m>1&&0===O||m>3&&1===O)||!1===s.skipHighLods&&null!=y&&O!==y;if(I&&0!==O)return;const P=new Be(E.name,E.lodThreshold,[0,0,0]);E.parts.forEach(L=>{const W=I?new ae.$U({},s):function Qe(r,e,u,s,y,g,d,T){const n=r.materials.get(e.material);if(null==n)return null;const{normal:m,color:p,texCoord0:E,tangent:O}=e.attributes,I=e.material+(m?"_normal":"")+(p?"_color":"")+(E?"_texCoord0":"")+(O?"_tangent":""),P=null!=e.attributes.texCoord0,L=null!=e.attributes.normal,W=function Ye(r){switch(r){case"BLEND":return j.sf.Blend;case"MASK":return j.sf.Mask;case"OPAQUE":case null:case void 0:return j.sf.Opaque}}(n.alphaMode);if(!g.has(I)){if(P){const Y=(M,N=!1)=>{if(null!=M&&!d.has(M)){const F=r.textures.get(M);if(F){const $=F.data;d.set(M,new xe.g((0,ee.x3)($)?$.data:$,{...F.parameters,preMultiplyAlpha:!(0,ee.x3)($)&&N,encoding:(0,ee.x3)($)?$.encoding:void 0}))}}};Y(n.colorTexture,W!==j.sf.Opaque),Y(n.normalTexture),Y(n.occlusionTexture),Y(n.emissiveTexture),Y(n.metallicRoughnessTexture)}const b=1/U.Tf,S=n.color[0]**b,re=n.color[1]**b,le=n.color[2]**b,z=n.emissiveFactor[0]**b,_=n.emissiveFactor[1]**b,ue=n.emissiveFactor[2]**b,q=null!=n.colorTexture&&P?d.get(n.colorTexture):null,X=(0,ie.Jr)(n),J=null!=n.normalTextureTransform?.scale?n.normalTextureTransform?.scale:v.Un;g.set(I,new ae.$U({...s,transparent:W===j.sf.Blend,customDepthTest:j.it.Lequal,textureAlphaMode:W,textureAlphaCutoff:n.alphaCutoff,diffuse:[S,re,le],ambient:[S,re,le],opacity:n.opacity,doubleSided:n.doubleSided,doubleSidedType:"winding-order",cullFace:n.doubleSided?j.s2.None:j.s2.Back,hasVertexColors:!!e.attributes.color,hasVertexTangents:!!e.attributes.tangent,normalType:L?Me.W.Attribute:Me.W.ScreenDerivative,castShadows:!0,receiveShadows:n.receiveShadows,receiveAmbientOcclusion:n.receiveAmbientOcclustion,textureId:q?.id,colorMixMode:n.colorMixMode,normalTextureId:null!=n.normalTexture&&P?d.get(n.normalTexture).id:void 0,textureAlphaPremultiplied:null!=q&&!!q.parameters.preMultiplyAlpha,occlusionTextureId:null!=n.occlusionTexture&&P?d.get(n.occlusionTexture).id:void 0,emissiveTextureId:null!=n.emissiveTexture&&P?d.get(n.emissiveTexture).id:void 0,metallicRoughnessTextureId:null!=n.metallicRoughnessTexture&&P?d.get(n.metallicRoughnessTexture).id:void 0,emissiveFactor:[z,_,ue],mrrFactors:X?ie.Bt:[n.metallicFactor,n.roughnessFactor,s.mrrFactors[2]],isSchematic:X,colorTextureTransformMatrix:(0,te.G)(n.colorTextureTransform),normalTextureTransformMatrix:(0,te.G)(n.normalTextureTransform),scale:[J[0],J[1]],occlusionTextureTransformMatrix:(0,te.G)(n.occlusionTextureTransform),emissiveTextureTransformMatrix:(0,te.G)(n.emissiveTextureTransform),metallicRoughnessTextureTransformMatrix:(0,te.G)(n.metallicRoughnessTextureTransform),...y},T))}const G=g.get(I);if(u.stageResources.materials.push(G),P){const b=S=>{null!=S&&u.stageResources.textures.push(d.get(S))};b(n.colorTexture),b(n.normalTexture),b(n.occlusionTexture),b(n.emissiveTexture),b(n.metallicRoughnessTexture)}return G}(g,L,P,e,u,T,n,s),{geometry:G,vertexCount:b}=function Xe(r,e){const u=r.attributes.position.count,s=(0,oe.x)(r.indices||u,r.primitiveType),y=(0,c.oe)(3*u),{typedBuffer:g,typedBufferStride:d}=r.attributes.position;(0,w.t)(y,g,r.transform,3,d);const T=[[Q.r.POSITION,new Z.n(y,s,3,!0)]];if(null!=r.attributes.normal){const m=(0,c.oe)(3*u),{typedBuffer:p,typedBufferStride:E}=r.attributes.normal;(0,R.Ge)(k,r.transform),(0,w.b)(m,p,k,3,E),(0,D.or)(k)&&(0,w.n)(m,m),T.push([Q.r.NORMAL,new Z.n(m,s,3,!0)])}if(null!=r.attributes.tangent){const m=(0,c.oe)(4*u),{typedBuffer:p,typedBufferStride:E}=r.attributes.tangent;(0,R.z0)(k,r.transform),(0,K.t)(m,p,k,4,E),(0,D.or)(k)&&(0,w.n)(m,m,4),T.push([Q.r.TANGENT,new Z.n(m,s,4,!0)])}if(null!=r.attributes.texCoord0){const m=(0,c.oe)(2*u),{typedBuffer:p,typedBufferStride:E}=r.attributes.texCoord0;(0,ne.a)(m,p,2,E),T.push([Q.r.UV0,new Z.n(m,s,2,!0)])}const n=r.attributes.color;if(null!=n){const m=new Uint8Array(4*u);4===n.elementCount?n instanceof f.Eq?(0,K.b)(m,n,1,255):(n instanceof f.XP||n instanceof f.Uz)&&(0,K.b)(m,n,1/255,255):(m.fill(255),n instanceof f.xs?(0,w.f)(m,n.typedBuffer,1,255,4,n.typedBufferStride):(r.attributes.color instanceof f.eI||r.attributes.color instanceof f.nS)&&(0,w.f)(m,n.typedBuffer,1/255,255,4,r.attributes.color.typedBufferStride)),T.push([Q.r.COLOR,new Z.n(m,s,4,!0)])}return{geometry:new ye.V(e,T),vertexCount:u}}(L,W??new ae.$U({},s)),S=G.boundingInfo;null!=S&&0===O&&((0,i.iT)(p,S.bbMin),(0,i.iT)(p,S.bbMax)),null!=W&&(P.stageResources.geometries.push(G),P.numberOfVertices+=b)}),I||d.push(P)}),{engineResources:d,referenceBoundingBox:p}}(s,T,n,e,u.specifiedLodIndex);return{lods:m,referenceBoundingBox:p,isEsriSymbolResource:s.meta.isEsriSymbolResource,isWosr:!1}}),pe.apply(this,arguments)}function Re(r){const e=r.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return e?{fileType:"gltf",url:e[1],specifiedLodIndex:null!=e[4]?Number(e[4]):null}:r.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:r,specifiedLodIndex:null}:{fileType:"unknown",url:r,specifiedLodIndex:null}}const k=(0,x.vt)()}}]);