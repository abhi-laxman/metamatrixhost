"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[3518],{23506:(R,v,a)=>{a.d(v,{v:()=>i});var _=a(99305);function i(d){d?.writtenProperties&&d.writtenProperties.forEach(({target:y,propName:E,newOrigin:u})=>{(0,_.H)(y)&&u&&y.originOf(E)!==u&&y.updateOrigin(E,u)})}},99305:(R,v,a)=>{function _(i){return i&&"getAtOrigin"in i&&"originOf"in i}a.d(v,{H:()=>_})},23518:(R,v,a)=>{a.r(v),a.d(v,{save:()=>K,saveAs:()=>L});var _=a(10467),i=a(17994),d=a(69927);const y="Image Service",E="imagery-layer-save",u="imagery-layer-save-as",p="imagery-tile-layer-save",g="imagery-tile-layer-save-as",c="WCS",m="wcs-layer-save",P="wcs-layer-save-as";function h(o){if("imagery"===o.type||"wcs"===o.type)return{isValid:!0};const{raster:s}=o,f="Function"===s?.datasetFormat?s.primaryRasters?.rasters[0]:s;return{isValid:"RasterTileServer"===f?.datasetFormat&&("Raster"===f.tileType||"Map"===f.tileType),errorMessage:"imagery tile layer should be created from a tiled image service."}}function O(o){const s=o.layerJSON;return Promise.resolve(s&&Object.keys(s).length?s:null)}function I(o,s){return C.apply(this,arguments)}function C(){return(C=(0,_.A)(function*(o,s){const{parsedUrl:f,title:M,fullExtent:x}=o;s.url=f.path,s.title||=M;try{s.extent=yield(0,d.sQ)(x)}catch{s.extent=void 0}(0,d.OM)(s,d.mm.METADATA),(0,d.Sm)(s,d.mm.TILED_IMAGERY,"imagery-tile"===o.type)})).apply(this,arguments)}function K(o,s){return T.apply(this,arguments)}function T(){return(T=(0,_.A)(function*(o,s){return(0,i.UN)({layer:o,itemType:"wcs"===o.type?c:y,validateLayer:h,createItemData:O,errorNamePrefix:"imagery"===o.type?E:"imagery-tile"===o.type?p:m},s)})).apply(this,arguments)}function L(o,s,f){return U.apply(this,arguments)}function U(){return(U=(0,_.A)(function*(o,s,f){return(0,i.Uh)({layer:o,itemType:"wcs"===o.type?c:y,validateLayer:h,createItemData:O,errorNamePrefix:"imagery"===o.type?u:"imagery-tile"===o.type?g:P,newItem:s,setItemProperties:I},f)})).apply(this,arguments)}},17994:(R,v,a)=>{a.d(v,{B5:()=>s,CJ:()=>L,Gy:()=>h,UN:()=>M,Uh:()=>N,Y:()=>c,Y0:()=>K,Y9:()=>o,eP:()=>C});var _=a(10467),i=a(5922),d=a(23506),y=a(73874),E=a(46577),u=a(15764),p=a(69927),g=a(95945);function c(e,t,n){const r=n(e);if(!r.isValid)throw new i.A(`${t}:invalid-parameters`,r.errorMessage,{layer:e})}function m(e){return P.apply(this,arguments)}function P(){return(P=(0,_.A)(function*(e){const{layer:t,errorNamePrefix:n,validateLayer:r}=e;yield t.load(),c(t,n,r)})).apply(this,arguments)}function h(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function O(e){const{item:t,errorNamePrefix:n,layer:r,validateItem:A}=e;if(function I(e){const{item:t,itemType:n,additionalItemType:r,errorNamePrefix:A,layer:D}=e,w=[n];if(r&&w.push(r),!w.includes(t.type)){const j=w.map(l=>`'${l}'`).join(", ");throw new i.A(`${A}:portal-item-wrong-type`,`Portal item type should be one of: "${j}"`,{item:t,layer:D})}}(e),A){const D=A(t);if(!D.isValid)throw new i.A(`${n}:invalid-parameters`,D.errorMessage,{layer:r})}}function C(e){const{layer:t,errorNamePrefix:n}=e,{portalItem:r}=t;if(!r)throw new i.A(`${n}:portal-item-not-set`,h(t,"requires the portalItem property to be set"));if(!r.loaded)throw new i.A(`${n}:portal-item-not-loaded`,h(t,"cannot be saved to a portal item that does not exist or is inaccessible"));O({...e,item:r})}function K(e){const{newItem:t,itemType:n}=e;let r=E.default.from(t);return r.id&&(r=r.clone(),r.id=null),r.type??=n,r.portal??=y.A.getDefault(),O({...e,item:r}),r}function T(e){return(0,u.m)(e,"portal-item")}function L(e,t,n){return U.apply(this,arguments)}function U(){return(U=(0,_.A)(function*(e,t,n){"beforeSave"in e&&"function"==typeof e.beforeSave&&(yield e.beforeSave());const r=e.write({},t);return yield Promise.all(t.resources?.pendingOperations??[]),(0,g.c)(t,{errorName:"layer-write:unsupported"},n),r})).apply(this,arguments)}function o(e){(0,p.LG)(e,p.mm.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((t,n,r)=>r.indexOf(t)===n))}function s(e,t,n){return f.apply(this,arguments)}function f(){return(f=(0,_.A)(function*(e,t,n){const r=e.portal;yield r.signIn(),yield r.user.addItem({item:e,data:t,folder:n?.folder})})).apply(this,arguments)}function M(e,t){return x.apply(this,arguments)}function x(){return(x=(0,_.A)(function*(e,t){const{layer:n,createItemData:r,createJSONContext:A,setItemProperties:D,saveResources:w,supplementalUnsupportedErrors:j}=e;yield m(e),C(e);const l=n.portalItem,b=A?A(l):T(l),B=yield L(n,b,{...t,supplementalUnsupportedErrors:j}),S=yield r({layer:n,layerJSON:B},l);return yield D?.(n,l,S),o(l),yield l.update({data:S}),(0,d.v)(b),yield w?.(l,b),l})).apply(this,arguments)}function N(e,t){return W.apply(this,arguments)}function W(){return(W=(0,_.A)(function*(e,t){const{layer:n,createItemData:r,createJSONContext:A,setItemProperties:D,saveResources:w,supplementalUnsupportedErrors:j}=e;yield m(e);const l=K(e),b=A?A(l):T(l),B=yield L(n,b,{...t,supplementalUnsupportedErrors:j}),S=yield r({layer:n,layerJSON:B},l);return yield D(n,l,S),o(l),yield s(l,S,t),n.portalItem=l,(0,d.v)(b),yield w?.(l,b),l})).apply(this,arguments)}},15764:(R,v,a)=>{a.d(v,{m:()=>y,v:()=>d});var _=a(45272),i=a(73874);function d(u,p){return{...E(u,p),readResourcePaths:[]}}function y(u,p,g){const c=(0,_.An)(u.itemUrl);return{...E(u,p),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:c?{rootPath:c.path,writtenUrls:[]}:null,resources:g?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function E(u,p){return{origin:p,url:(0,_.An)(u.itemUrl),portal:u.portal||i.A.getDefault(),portalItem:u}}},95945:(R,v,a)=>{a.d(v,{c:()=>u,d:()=>d});var _=a(10467),i=a(5922);function d(p){return y.apply(this,arguments)}function y(){return(y=(0,_.A)(function*(p){const g=[];for(const c of p.allLayers)if("beforeSave"in c&&"function"==typeof c.beforeSave){const m=c.beforeSave();m&&g.push(m)}yield Promise.allSettled(g)})).apply(this,arguments)}const E=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function u(p,g,c){let m=(p.messages??[]).filter(({type:P})=>"error"===P).map(({name:P,message:h,details:O})=>new i.A(P,h,O));if(p.blockedRelativeUrls&&(m=m.concat(p.blockedRelativeUrls.map(P=>new i.A("url:unsupported",`Relative url '${P}' is not supported`)))),c){const{ignoreUnsupported:P,supplementalUnsupportedErrors:h=[],requiredPropertyChecksDisabled:O}=c;P&&(m=m.filter(({name:I})=>!(E.has(I)||h.includes(I)))),O&&(m=m.filter(I=>"web-document-write:property-required"!==I.name))}if(m.length>0)throw new i.A(g.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:m})}}}]);