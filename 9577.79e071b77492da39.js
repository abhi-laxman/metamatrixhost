"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[9577],{33087:(R,E,n)=>{n.d(E,{q:()=>u});var m=n(60611);class u{constructor(_,a){this._storage=new m.F,this.id="",this.name="",this.size=0,this._storage.maxSize=_,this._storage.register(this),a&&this._storage.registerRemoveFunc("",a)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(_,a,d=1){this._storage.put(this,_,a,d,1)}pop(_){return this._storage.pop(this,_)}get(_){return this._storage.get(this,_)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(_){this._storage.maxSize=_}resetHitRate(){}}},60611:(R,E,n)=>{n.d(E,{F:()=>d,Ti:()=>u});var m=n(12438);const u=-3,g=u-1;var _,v;(v=_||(_={}))[v.ALL=0]="ALL",v[v.SOME=1]="SOME";class d{get size(){return this._size}constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new m.A,this._users=new m.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear()}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace(e=>e[0]!==t)}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,e){return this._db.get(t.id+e)?.size??0}put(t,e,i,r,l){const s=this._db.get(e=t.id+e);if(s&&(this._size-=s.size,t.size-=s.size,this._db.delete(e),s.entry!==i&&this._notifyRemove(e,s.entry,s.size,_.ALL)),r>this._maxSize)return void this._notifyRemove(e,i,r,_.ALL);if(void 0===i)return void console.warn("Refusing to cache undefined entry ");if(!r||r<0)return console.warn(`Refusing to cache entry with size ${r} for key ${e}`),void this._notifyRemove(e,i,0,_.ALL);const c=1+Math.max(l,g)-u;this._db.set(e,new f(i,r,c)),this._size+=r,t.size+=r,this._checkSize()}updateSize(t,e,i,r){const l=this._db.get(e=t.id+e);if(l&&l.entry===i){for(this._size-=l.size,t.size-=l.size;r>this._maxSize;){const s=this._notifyRemove(e,i,r,_.SOME);if(!(null!=s&&s>0))return void this._db.delete(e);r=s}l.size=r,this._size+=r,t.size+=r,this._checkSize()}}pop(t,e){const i=this._db.get(e=t.id+e);if(i)return this._size-=i.size,t.size-=i.size,this._db.delete(e),++this._hit,i.entry;++this._miss}get(t,e){const i=this._db.get(e=t.id+e);if(void 0!==i)return this._db.delete(e),i.lives=i.lifetime,this._db.set(e,i),++this._hit,i.entry;++this._miss}peek(t,e){const i=this._db.get(t.id+e);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},i=new Array;this._db.forEach((s,c)=>{const P=s.lifetime;i[P]=(i[P]||0)+s.size,this._users.forAll(O=>{const{id:y,name:o}=O;c.startsWith(y)&&(e[o]=(e[o]||0)+s.size)})});const r={};this._users.forAll(s=>{const c=s.name;"hitRate"in s&&"number"==typeof s.hitRate&&!isNaN(s.hitRate)&&s.hitRate>0?(e[c]=e[c]||0,r[c]=Math.round(100*s.hitRate)+"%"):r[c]="0%"});const l=Object.keys(e);l.sort((s,c)=>e[c]-e[s]),l.forEach(s=>t[s]=Math.round(e[s]/2**20)+"MB / "+r[s]);for(let s=i.length-1;s>=0;--s){const c=i[s];c&&(t["Priority "+(s+u-1)]=Math.round(c/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll(t=>t.resetHitRate())}clear(t){const e=t.id;this._db.forEach((i,r)=>{r.startsWith(e)&&(this._size-=i.size,this._db.delete(r),this._notifyRemove(r,i.entry,i.size,_.ALL))}),t.size=0}clearAll(){this._db.forEach((t,e)=>this._notifyRemove(e,t.entry,t.size,_.ALL)),this._users.forAll(t=>t.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,i,r){let l;return this._removeFuncs.some(s=>{if(t.startsWith(s[0])){const c=s[1](e,r,i);return"number"==typeof c&&(l=c),!0}return!1}),l}_checkSize(){this._users.forAll(t=>this._checkSizeLimits(t)),this._checkSizeLimits()}_checkSizeLimits(t){const e=t??this;if(e.maxSize<0||e.size<=e.maxSize)return;const i=t?.id;let r=!0;for(;r;){r=!1;for(const[l,s]of this._db)if(0===s.lifetime&&(!i||l.startsWith(i))){if(this._purgeItem(l,s,t),e.size<=.9*e.maxSize)return;r||=this._db.has(l)}}for(const[l,s]of this._db)if((!i||l.startsWith(i))&&(this._purgeItem(l,s,t),e.size<=.9*e.maxSize))return}_purgeItem(t,e,i=this._users.find(r=>t.startsWith(r.id))){if(this._db.delete(t),e.lives<=1){this._size-=e.size,i&&(i.size-=e.size);const r=this._notifyRemove(t,e.entry,e.size,_.SOME);null!=r&&r>0&&(this._size+=r,i&&(i.size+=r),e.lives=e.lifetime,e.size=r,this._db.set(t,e))}else--e.lives,this._db.set(t,e)}}class f{constructor(t,e,i){this.entry=t,this.size=e,this.lifetime=i,this.lives=i}}},14784:(R,E,n)=>{function m(g){let _,a,d=[],S=!1;return function f(...v){return S&&_===this&&function u(g,_){if(g.length!==_.length)return!1;for(let a=0;a<g.length;++a)if(g[a]!==_[a])return!1;return!0}(v,d)||(a=g.apply(this,v),_=this,d=v,S=!0),a}}n.d(E,{B:()=>m})},19477:(R,E,n)=>{n.r(E),n.d(E,{FeatureCollectionSnappingSource:()=>y});var m=n(10467),u=n(8189),g=n(98877),_=n(14784),a=n(56492),d=n(48900),S=n(63484),f=n(85211),i=(n(3248),n(35150),n(40707),n(76576)),r=n(73812),l=n(3548),s=n(8763),c=n(97083),P=n(25206),O=n(16397);let y=class extends g.A{get availability(){return 1}get _snappingElevationAligner(){const{view:o}=this,{layer:h}=this.layerSource,p=null!=o&&"3d"===o.type;if(!p||"subtype-group"===h.type)return(0,c.n)();const z=function(){var M=(0,m.A)(function*(A,D){return(yield(0,a.qr)(o.whenLayerView(h),D)).elevationAlignPointsInFeatures(A,D)});return function(D,b){return M.apply(this,arguments)}}();return(0,c.n)(p,{elevationInfo:h.elevationInfo,alignPointsInFeatures:z})}get _snappingElevationFilter(){const{view:o}=this;return(0,P.z)(null!=o&&"3d"===o.type&&"subtype-group"!==this.layerSource.layer.type)}get _symbologySnappingFetcher(){const{view:o}=this,{layer:h}=this.layerSource;return null!=o&&"3d"===o.type&&"subtype-group"!==h.type?(0,O.H)(this._symbologySnappingSupported,function(){var p=(0,m.A)(function*(z,M){const A=yield o.whenLayerView(h);return(0,a.Te)(M),A.queryForSymbologySnapping({candidates:z,spatialReference:o.spatialReference},M)});return function(z,M){return p.apply(this,arguments)}}()):(0,O.H)()}get _layerView(){const{view:o}=this;if(null==o)return null;const{layer:h}=this.layerSource;return o.allLayerViews.find(p=>p.layer===h)}get _layerView3D(){const{view:o}=this;return null==o||"2d"===o.type?null:this._layerView}get _symbologySnappingSupported(){return null!=this._layerView3D&&this._layerView3D.symbologySnappingSupported}initialize(){const{view:o}=this,{layer:h}=this.layerSource;null!=o&&"3d"===o.type&&"subtype-group"!==h.type&&this.addHandles([o.elevationProvider.on("elevation-change",({context:p})=>{const{elevationInfo:z}=h;(0,r.Up)(p,z)&&this._snappingElevationAligner.notifyElevationSourceChange()}),(0,d.wB)(()=>h.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),d.Vh),(0,d.wB)(()=>null!=this._layerView3D?this._layerView3D.layer?.renderer:null,()=>this._symbologySnappingFetcher.notifySymbologyChange(),d.Vh),(0,d.on)(()=>this._layerView3D?.layer,["edits","apply-edits","graphic-update"],()=>this._symbologySnappingFetcher.notifySymbologyChange())])}constructor(o){super(o),this.view=null,this.updating=!1,this._memoizedMakeGetGroundElevation=(0,_.B)(s.p)}refresh(){}fetchCandidates(o,h){var p=this;return(0,m.A)(function*(){const{layer:z}=p.layerSource,M=z.source;if(!M?.querySnapping)return[];const A=z.createQuery();p._layerView&&"effectiveDisplayFilter"in p._layerView&&(A.where=(0,S.mA)(A.where,p._layerView.effectiveDisplayFilter?.where));const D=(0,l.nf)(o,p.view?.type??"2d",A),b=yield M.querySnapping(D,{signal:h});(0,a.Te)(h);const C=o.coordinateHelper.spatialReference,L=yield p._snappingElevationAligner.alignCandidates(b.candidates,C,h);(0,a.Te)(h);const I=yield p._symbologySnappingFetcher.fetch(L,h);(0,a.Te)(h);const w=0===I.length?L:[...L,...I],F=p._snappingElevationFilter.filter(D,w),U=p._memoizedMakeGetGroundElevation(p.view,C);return F.map(W=>(0,s.$)(W,U))})()}};(0,u._)([(0,f.MZ)({constructOnly:!0})],y.prototype,"layerSource",void 0),(0,u._)([(0,f.MZ)({constructOnly:!0})],y.prototype,"view",void 0),(0,u._)([(0,f.MZ)()],y.prototype,"_snappingElevationAligner",null),(0,u._)([(0,f.MZ)()],y.prototype,"_snappingElevationFilter",null),(0,u._)([(0,f.MZ)()],y.prototype,"_symbologySnappingFetcher",null),(0,u._)([(0,f.MZ)()],y.prototype,"_layerView",null),(0,u._)([(0,f.MZ)()],y.prototype,"_layerView3D",null),(0,u._)([(0,f.MZ)()],y.prototype,"_symbologySnappingSupported",null),y=(0,u._)([(0,i.$)("esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource")],y)},93151:(R,E,n)=>{n.d(E,{_:()=>g});var m=n(28714),u=n(77171);class g extends u.m{constructor(a,d,S){super(d,S),this.point=a}equals(a){return a instanceof g&&(0,m.p)(this.point,a.point)}}}}]);