"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[1912],{41912:(W,h,n)=>{n.r(h),n.d(h,{default:()=>b});var v=n(10467),m=n(8189),L=n(89563),j=n(5922),O=n(35150),p=n(69287),g=n(39693),A=n(56492),i=n(85211),x=(n(3248),n(40707),n(76576)),s=n(28714),d=n(25866),I=n(87477),K=n(28067),U=n(32034),T=n(23234),C=n(95478),B=n(94376),$=n(25936),z=n(23e3),G=n(17049),X=n(85551),F=n(33036),Z=n(22329),S=n(73812);let M=class extends((0,$.b)((0,G.q)((0,X.A)((0,F.j)((0,g.P)((0,z.d)((0,B.p)(C.A)))))))){constructor(e){super(e),this.operationalLayerType="IntegratedMesh3DTilesLayer",this.spatialReference=new U.A({wkid:4326,vcsWkid:115700}),this.fullExtent=new K.A(-180,-90,180,90,this.spatialReference),this.url=null,this.type="integrated-mesh-3dtiles",this.path=null,this.minScale=0,this.maxScale=0}set elevationInfo(e){null!=e&&"absolute-height"!==e.mode||this._set("elevationInfo",e),this._validateElevationInfo(e)}_verifyArray(e,t){if(!Array.isArray(e)||e.length<t)return!1;for(const a of e)if("number"!=typeof a)return!1;return!0}_initFullExtent(e){const t=e.root?.boundingVolume;if(!t)return;if(t.box){const r=t?.box;if(r[3]>7972671&&r[7]>7972671&&r[11]>7945940)return}const a=e.root?.transform,_=(0,d.vt)();if(t.region&&this._verifyArray(t.region,6)){const r=t.region,u=(0,p.KJ)(r[0]),c=(0,p.KJ)(r[1]),l=r[4],f=(0,p.KJ)(r[2]),o=(0,p.KJ)(r[3]);this.fullExtent=new K.A({xmin:u,ymin:c,zmin:l,xmax:f,ymax:o,zmax:r[5],spatialReference:this.spatialReference})}else if(t.sphere&&this._verifyArray(t.sphere,4)){const r=t.sphere,u=(0,d.fA)(r[0],r[1],r[2]),c=r[3]/Math.sqrt(3),l=(0,d.vt)();(0,s.d)(l,u,(0,d.fA)(c,c,c));const f=(0,d.vt)();if((0,s.g)(f,u,(0,d.fA)(c,c,c)),a&&this._verifyArray(a,16)){const R=a;(0,s.t)(_,l,R),(0,s.c)(l,_),(0,s.t)(_,f,R),(0,s.c)(f,_)}(0,T.projectBuffer)(l,I.Ro,0,l,U.A.WGS84,0),(0,T.projectBuffer)(f,I.Ro,0,f,U.A.WGS84,0);const o=(0,d.vt)(),P=(0,d.vt)();(0,s.A)(o,l,f),(0,s.D)(P,l,f),this.fullExtent=new K.A({xmin:o[0],ymin:o[1],zmin:o[2],xmax:P[0],ymax:P[1],zmax:P[2],spatialReference:this.spatialReference})}else if(t.box&&this._verifyArray(t.box,12)){const r=t.box,u=(0,d.fA)(r[0],r[1],r[2]),c=(0,d.fA)(r[3],r[4],r[5]),l=(0,d.fA)(r[6],r[7],r[8]),f=(0,d.fA)(r[9],r[10],r[11]),o=[];for(let y=0;y<8;++y)o.push((0,d.vt)());if((0,s.g)(o[0],u,c),(0,s.g)(o[0],o[0],l),(0,s.g)(o[0],o[0],f),(0,s.a)(o[1],u,c),(0,s.g)(o[1],o[1],l),(0,s.g)(o[1],o[1],f),(0,s.g)(o[2],u,c),(0,s.a)(o[2],o[2],l),(0,s.g)(o[2],o[2],f),(0,s.a)(o[3],u,c),(0,s.a)(o[3],o[3],l),(0,s.g)(o[3],o[3],f),(0,s.g)(o[4],u,c),(0,s.g)(o[4],o[4],l),(0,s.a)(o[4],o[4],f),(0,s.a)(o[5],u,c),(0,s.g)(o[5],o[5],l),(0,s.a)(o[5],o[5],f),(0,s.g)(o[6],u,c),(0,s.a)(o[6],o[6],l),(0,s.a)(o[6],o[6],f),(0,s.a)(o[7],u,c),(0,s.a)(o[7],o[7],l),(0,s.a)(o[7],o[7],f),a&&this._verifyArray(a,16)){const y=a;for(let N=0;N<8;++N)(0,s.t)(o[N],o[N],y)}const P=(0,d.fA)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),R=(0,d.fA)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);for(let y=0;y<8;++y)(0,T.projectBuffer)(o[y],I.Ro,0,o[y],U.A.WGS84,0),(0,s.A)(R,R,o[y]),(0,s.D)(P,P,o[y]);this.fullExtent=new K.A({xmin:R[0],ymin:R[1],zmin:R[2],xmax:P[0],ymax:P[1],zmax:P[2],spatialReference:this.spatialReference})}}load(e){var t=this;return(0,v.A)(function*(){return t.addResolvingPromise(t._doLoad(e)),t})()}_doLoad(e){var t=this;return(0,v.A)(function*(){const a=null!=e?e.signal:null;try{yield t.loadFromPortal({supportedTypes:["3DTiles Service"],validateItem:_=>{if(_.typeKeywords?.includes("IntegratedMesh"))return!0;throw new j.A("portal:invalid-layer-item-type","Invalid layer item, expected '${expectedType}' ",{expectedType:"3DTiles Service containing IntegratedMesh"})}},e)}catch(_){(0,A.QP)(_)}t.url&&(yield(0,L.A)(t.url,{query:{f:"json",...t.customParameters,token:t.apiKey},responseType:"json",signal:a}).then(r=>{t._initFullExtent(r.data)},r=>{(0,A.QP)(r)}))})()}fetchAttributionData(){var e=this;return(0,v.A)(function*(){return e.load().then(()=>({}))})()}_validateElevationInfo(e){const t="Integrated mesh 3d tiles layers";(0,S.XF)(O.A.getLogger(this),(0,S.B)(t,"absolute-height",e)),(0,S.XF)(O.A.getLogger(this),(0,S.tW)(t,e))}};(0,m._)([(0,i.MZ)({type:["IntegratedMesh3DTilesLayer"]})],M.prototype,"operationalLayerType",void 0),(0,m._)([(0,i.MZ)({type:U.A})],M.prototype,"spatialReference",void 0),(0,m._)([(0,i.MZ)({type:K.A})],M.prototype,"fullExtent",void 0),(0,m._)([(0,i.MZ)(Z.Yj)],M.prototype,"elevationInfo",null),(0,m._)([(0,i.MZ)({type:["show","hide"]})],M.prototype,"listMode",void 0),(0,m._)([(0,i.MZ)(Z.OZ)],M.prototype,"url",void 0),(0,m._)([(0,i.MZ)({readOnly:!0})],M.prototype,"type",void 0),(0,m._)([(0,i.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],M.prototype,"path",void 0),(0,m._)([(0,i.MZ)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:!1,write:!1}}}})],M.prototype,"minScale",void 0),(0,m._)([(0,i.MZ)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:!1,write:!1}}}})],M.prototype,"maxScale",void 0),M=(0,m._)([(0,x.$)("esri.layers.IntegratedMesh3DTilesLayer")],M);const b=M},94376:(W,h,n)=>{n.d(h,{p:()=>A});var v=n(8189),m=n(85211),p=(n(3248),n(35150),n(40707),n(76576));const A=i=>{let E=class extends i{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):function g(i){return"portalItem"in i}(this)?this.portalItem?.apiKey:null}set apiKey(D){null!=D?this._override("apiKey",D):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return(0,v._)([(0,m.MZ)({type:String})],E.prototype,"apiKey",null),E=(0,v._)([(0,p.$)("esri.layers.mixins.APIKeyMixin")],E),E}},23e3:(W,h,n)=>{n.d(h,{d:()=>g});var v=n(8189),m=n(85211),p=(n(3248),n(35150),n(40707),n(76576));const g=A=>{let i=class extends A{constructor(){super(...arguments),this.customParameters=null}};return(0,v._)([(0,m.MZ)({type:Object,json:{write:{overridePolicy:E=>({enabled:!!(E&&Object.keys(E).length>0)})}}})],i.prototype,"customParameters",void 0),i=(0,v._)([(0,p.$)("esri.layers.mixins.CustomParametersMixin")],i),i}},33036:(W,h,n)=>{n.d(h,{j:()=>g});var v=n(8189),m=n(85211),p=(n(3248),n(35150),n(40707),n(76576));const g=i=>{let E=class extends i{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const D={minScale:this.minScale,maxScale:this.maxScale},x=this.parent;x&&"effectiveScaleRange"in x&&function A(i,E){i.minScale=i.minScale>0?E.minScale>0?Math.min(i.minScale,E.minScale):i.minScale:E.minScale,i.maxScale=i.maxScale>0?E.maxScale>0?Math.max(i.maxScale,E.maxScale):i.maxScale:E.maxScale}(D,x.effectiveScaleRange);const s=this._get("effectiveScaleRange");return s&&s.minScale===D.minScale&&s.maxScale===D.maxScale?s:D}};return(0,v._)([(0,m.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],E.prototype,"minScale",void 0),(0,v._)([(0,m.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],E.prototype,"maxScale",void 0),(0,v._)([(0,m.MZ)({readOnly:!0})],E.prototype,"effectiveScaleRange",null),E=(0,v._)([(0,p.$)("esri.layers.mixins.ScaleRangeLayer")],E),E}},73812:(W,h,n)=>{n.d(h,{$7:()=>X,B:()=>G,Fo:()=>C,M7:()=>S,NN:()=>E,Q5:()=>B,Tq:()=>b,Up:()=>z,XF:()=>Z,Ze:()=>I,bK:()=>O,bh:()=>i,id:()=>K,ky:()=>A,qt:()=>M,tW:()=>F,v9:()=>D,w7:()=>p,wF:()=>j,wS:()=>U,wz:()=>s,x:()=>x,xS:()=>T,ze:()=>g});var v=n(82663),m=n(82575);function L(e){return e?M:b}function j(e,t){return t?.mode?t.mode:L(e).mode}function O(e,t){return t??L(e)}function p(e,t){return j(null==e||(e.hasZ??!1),t)}function g(e,t){return O(null==e||(e.hasZ??!1),t)}function A(e){const t=d(e);return p(e.geometry,t)}function i(e){const t=d(e),a=p(e.geometry,t),_=null!=t&&"on-the-ground"!==a?S(t):0,r=t?.featureExpressionInfo;return{mode:a,offset:_,featureExpressionInfo:r}}function E(e){return s(i(e))}function D(e){return s(e)||x(e)}function x(e){return"0"===e?.featureExpressionInfo?.expression}function s(e){if(!e||"on-the-ground"===e.mode)return!1;const t=e?.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||"0"===t)}function d(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function I(e,t){if(!e?.offset)return 0;const{offset:a,unit:_}=e;if("decimal-degrees"===_)return 0;const r="unknown"!==_&&_?_:"meters",u=(0,v.mq)(t);return u?(0,v.oU)(a,r,u):0}function K(e,t,a){if(!a?.mode)return;const _=e.hasZ?e.z:0,r=I(a,e.spatialReference);switch(a.mode){case"absolute-height":return _-r;case"on-the-ground":return 0;case"relative-to-ground":return _-((t.elevationProvider.getElevation(e.x,e.y,_,e.spatialReference,"ground")??0)+r);case"relative-to-scene":return _-((t.elevationProvider.getElevation(e.x,e.y,_,e.spatialReference,"scene")??0)+r)}}function U(e,t,a,_=null){return C(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,a,_)}function T(e,t,a,_,r=null){return C(e,t[0],t[1],t.length>2?t[2]:0,a,_,r)}function C(e,t,a,_,r,u,c=null){if(null==u)return;const l=null!=c?c.mode:"absolute-height";if("on-the-ground"===l)return 0;const{absoluteZ:f}=B(t,a,_,r,e,u);return function $(e,t,a,_,r,u,c,l){const f=I(c,r);switch(l){case"absolute-height":return e-f;case"relative-to-ground":return e-((u.elevationProvider.getElevation(t,a,_,r,"ground")??0)+f);case"relative-to-scene":return e-((u.elevationProvider.getElevation(t,a,_,r,"scene")??0)+f)}}(f,t,a,_,r,e,c,l)}function B(e,t,a,_,r,u){const c=I(u,_);switch(u.mode){case"absolute-height":return{absoluteZ:a+c,elevation:0};case"on-the-ground":{const l=r.elevationProvider.getElevation(e,t,0,_,"ground")??0;return{absoluteZ:l,elevation:l}}case"relative-to-ground":{const l=r.elevationProvider.getElevation(e,t,a,_,"ground")??0;return{absoluteZ:a+l+c,elevation:l}}case"relative-to-scene":{const l=r.elevationProvider.getElevation(e,t,a,_,"scene")??0;return{absoluteZ:a+l+c,elevation:l}}}}function z(e,t){if(null==t)return!1;const{mode:a}=t;return null!=a&&("scene"===e&&"relative-to-scene"===a||"ground"===e&&"absolute-height"!==a)}function G(e,t,a){return a&&a.mode!==t?`${e} only support ${t} elevation mode`:null}function X(e,t,a){return a?.mode===t?`${e} do not support ${t} elevation mode`:null}function F(e,t){return null!=t?.featureExpressionInfo&&"0"!==t.featureExpressionInfo.expression?`${e} do not support featureExpressionInfo`:null}function Z(e,t){t&&e.warn(".elevationInfo=",t)}function S(e){return(e?.offset??0)*(0,m.Ao)(e?.unit)}const M={mode:"absolute-height",offset:0},b={mode:"on-the-ground",offset:null}}}]);