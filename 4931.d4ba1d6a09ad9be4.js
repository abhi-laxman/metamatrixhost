"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[4931],{51509:(je,Ne,I)=>{I(87571),I(62257),I(95944),I(7085),I(33165);var xe=I(3037),_e=I(82663),ye=I(58701);(0,xe.j)(ue=>{let me,X;"number"==typeof ue?me=ue:X=ue;const he={wkid:me,wkt:X};let re,ge;if(X){re=(0,_e.x1)(X);const le=(0,ye.EA)(he);if(!re&&!le)throw new Error(`Unsupported WKT type: ${X}`)}else re=!(0,ye.EA)(he);return ge=me&&_e.yD.has(me)?Math.PI/200:re?(0,_e.Ao)(he):Math.PI/180,{isPCS:re,metersOrRadiansPerUnit:ge,semiMajor:0,wkidOrWkt:ue}})},27312:(je,Ne,I)=>{I.r(Ne),I.d(Ne,{fromGeometries:()=>at,fromGeometry:()=>Ee,fromGeometryToGXGeometry:()=>Oe,getSpatialReference:()=>it,toGeometry:()=>ot});var i=I(62257),O=I(33165),z=I(3037),F=I(7085),w=I(95944);function _e(){if(-1===this.m_i)return this.m_i=0,{value:{m_token:1,m_value:null},done:!1};if(this.m_i<this.m_keys.length){const t=this.m_bReturnKey,e=Math.trunc(this.m_i);return this.m_bReturnKey=!this.m_bReturnKey,this.m_i+=.5,t?{value:{m_token:5,m_value:this.m_keys[e]},done:!1}:{value:{m_token:6,m_value:this.m_o[this.m_keys[e]]},done:!1}}return{value:{m_token:3,m_value:null},done:!0}}function ye(){if(-1===this.m_i)return this.m_i=0,{value:{m_token:2,m_value:null},done:!1};if(this.m_i<this.m_a.length){const t={value:{m_token:6,m_value:this.m_a[this.m_i++]},done:!1};return this.m_strict||void 0===t.value.m_value&&(t.value.m_value=Number.NaN),t}return{value:{m_token:4,m_value:null},done:!0}}I(51509);class ue{createJSONObjectIterator(e){return{m_iteratorType:"object",m_o:e,m_keys:this.m_options.strict?Object.keys(e):Object.keys(e).filter(n=>void 0!==e[n]),m_i:-1,m_bReturnKey:!0,next:_e}}createJSONArrayIterator(e){return{m_iteratorType:"array",m_strict:this.m_options.strict,m_i:-1,m_a:e,next:ye}}constructor(e,n){this.m_currentToken=0,this.m_options=n?{...n}:{strict:!0};const r=e;this.m_iteratorStack=[r instanceof Array?this.createJSONArrayIterator(r):this.createJSONObjectIterator(r)],this.m_nextFlatToken={m_value:null,m_token:0}}nextToken(){if(0===this.m_iteratorStack.length)return this.m_currentToken=0;switch(this.m_nextFlatToken=this.m_iteratorStack.at(-1).next().value,this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_currentToken=1;case 3:return this.m_iteratorStack.pop(),this.m_currentToken=3;case 2:return this.m_currentToken=2;case 4:return this.m_iteratorStack.pop(),this.m_currentToken=4;case 5:return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=5;case 6:if(this.m_nextFlatToken.m_value instanceof Array)return this.m_iteratorStack.push(this.createJSONArrayIterator(this.m_nextFlatToken.m_value)),this.nextToken();if(this.m_nextFlatToken.m_value instanceof Object)return this.m_iteratorStack.push(this.createJSONObjectIterator(this.m_nextFlatToken.m_value)),this.nextToken();if("number"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=Number.isSafeInteger(this.m_currentValue)&&this.m_currentValue>=(0,O.ao)()&&this.m_currentValue<=(0,O.i)()?8:7;if("string"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=6;if("boolean"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=this.m_nextFlatToken.m_value?11:12;if("object"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=null,this.m_currentToken=10;(0,i.c)("unrecognized json element type")}return(0,i.c)("unrecognized json element type"),0}currentToken(){return this.m_currentToken}skipChildren(){if(0!==this.m_iteratorStack.length)switch(this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=3,void(this.m_currentToken=3);case 2:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=4,void(this.m_currentToken=4)}}currentString(){return 6!==this.m_currentToken&&5!==this.m_currentToken&&(0,i.t)("invalid token"),this.m_currentValue}currentDoubleValue(){return 7!==this.m_currentToken&&8!==this.m_currentToken&&(0,i.t)("invalid token"),this.m_currentValue}currentInt32Value(){return 8!==this.m_currentToken&&(0,i.t)("invalid token"),this.m_currentValue}currentInt64Value(){return(0,i.g)(0),0n}currentBoolValue(){return 12!==this.m_currentToken&&11!==this.m_currentToken&&(0,i.t)("invalid token"),this.m_currentValue}isError(){return 0}}class X{constructor(e){return this.m_buffer=null,this.m_view=null,this.m_sz=0,this.m_offset=0,this.m_bOwnsBuffer=!0,this.m_bLittleEndian=!0,this.m_element=new ArrayBuffer(8),this.m_elementBytes=new Uint8Array(this.m_element),this.m_elementView=new DataView(this.m_element),this.m_elementDouble=new Float64Array(this.m_element),this.m_elementFloat=new Float32Array(this.m_element),this.m_elementInt64=new BigInt64Array(this.m_element),this.m_elementInt32=new Int32Array(this.m_element),this.m_elementInt16=new Int16Array(this.m_element),void 0!==e.sz?(this.m_sz=e.sz,e.buffer?(this.m_sz<0&&(0,i.n)("size out of range"),this.m_buffer=e.buffer,this.m_offset=void 0!==e.offset?e.offset:0,this.m_view=void 0!==e.offset?new DataView(e.buffer,e.offset,e.sz):new DataView(this.m_buffer),this.m_bOwnsBuffer=!1,void(this.m_bLittleEndian=!0)):(this.m_sz<0&&(0,i.n)("size out of range"),void(this.m_sz>0&&(this.m_buffer=new ArrayBuffer(this.m_sz),this.m_view=new DataView(this.m_buffer))))):e.move?(this.m_sz=e.move.m_sz,this.m_buffer=e.move.m_buffer,this.m_view=e.move.m_view,this.m_bOwnsBuffer=e.move.m_bOwnsBuffer,this.m_bLittleEndian=e.move.m_bLittleEndian,e.move.m_buffer=null,e.move.m_view=null,e.move.m_sz=0,void(e.move.m_bOwnsBuffer=!0)):void(0,i.c)("unrecognized constructor options")}swapBytesDouble(){this.doSwap()&&(this.m_elementDouble[0]=this.m_elementBytes[0]<<56|this.m_elementBytes[1]<<48|this.m_elementBytes[2]<<40|this.m_elementBytes[3]<<32|this.m_elementBytes[4]<<24|this.m_elementBytes[5]<<16|this.m_elementBytes[6]<<8|this.m_elementBytes[7])}swapBytesInt32(){this.doSwap()&&(this.m_elementInt32[0]=this.m_elementBytes[0]<<24|this.m_elementBytes[1]<<16|this.m_elementBytes[2]<<8|this.m_elementBytes[3])}getOffset(){return this.m_offset}assignMove(e){return this===e||(this.clear(),this.m_sz=e.m_sz,this.m_buffer=e.m_buffer,this.m_view=e.m_view,this.m_bOwnsBuffer=e.m_bOwnsBuffer,this.m_bLittleEndian=e.m_bLittleEndian,e.m_buffer=null,e.m_sz=0,e.m_bOwnsBuffer=!0),this}doSwap(){return this.m_bLittleEndian!==(1===X.getNativeByteOrder())}setNativeByteOrder(){this.m_bLittleEndian=1===X.getNativeByteOrder()}setOrder(e){this.m_bLittleEndian=1===e}getOrder(){return this.m_bLittleEndian?1:0}getView(){return this.m_view||(0,i.m)("buffer not defined"),this.m_view}static getNativeByteOrder(){return 1}clear(){this.m_buffer=null,this.m_sz=0,this.m_bOwnsBuffer=!0}size(){return this.m_sz}readDouble(e){return this.doSwap()?(this.m_elementDouble[0]=this.m_view.getFloat64(e,this.m_bLittleEndian),this.swapBytesDouble(),this.m_elementDouble[0]):this.m_view.getFloat64(e,this.m_bLittleEndian)}writeDouble(e,n){this.m_elementDouble[0]=n,this.swapBytesDouble(),this.m_view.setFloat64(e,this.m_elementDouble[0],this.m_bLittleEndian)}readInt32(e){return this.doSwap()?(this.m_elementInt32[0]=this.m_view.getInt32(e,this.m_bLittleEndian),this.swapBytesInt32(),this.m_elementInt32[0]):this.m_view.getInt32(e,this.m_bLittleEndian)}writeInt32(e,n){this.m_elementInt32[0]=n,this.swapBytesInt32(),this.m_view.setInt32(e,this.m_elementInt32[0],this.m_bLittleEndian)}getPtr(){return this.m_buffer}setSizeNoRealloc(e){(0,i.g)(e>=0&&e<=this.m_sz),this.m_sz=e}}function re(t){let e=!1;for(;3!==t.nextToken();){const n=t.currentString();t.nextToken(),"uwkid"===n?e||(e=!0,8===t.currentToken()&&t.currentInt32Value()):t.skipChildren()}return null}function ge(t){let e=!1,n=!1,r=!1,a=!1,o=!1,s=!1,u=!1,c=!1,m=!1,l=!1,h=!1,_=!1,k=!1,g=!1,S=!1,N=!1,T=!1,D=-1,f=-1,v=-1,A=-1,M=0,B=0,L=0,G=0,C=0,K=0,R=0,x=0,P=0,j=0,V="",U="",$=null;for(;3!==t.nextToken();){const b=t.currentString();t.nextToken(),"wkid"===b?e||(e=!0,8===t.currentToken()&&(D=t.currentInt32Value())):"latestWkid"===b?n||(n=!0,8===t.currentToken()&&(f=t.currentInt32Value())):"wkt"===b?o||(o=!0,6===t.currentToken()&&(V=t.currentString())):"wkt2"===b?o||6===t.currentToken()&&(U=t.currentString()):"vcsWkid"===b?r||(r=!0,8===t.currentToken()&&(v=t.currentInt32Value())):"latestVcsWkid"===b?a||(a=!0,8===t.currentToken()&&(A=t.currentInt32Value())):"xyTolerance"===b?u||(u=!0,s=!0,M=t.currentDoubleValue()):"zTolerance"===b?c||(c=!0,s=!0,B=t.currentDoubleValue()):"mTolerance"===b?m||(m=!0,s=!0,L=t.currentDoubleValue()):"falseX"===b?l||(l=!0,s=!0,R=t.currentDoubleValue()):"falseY"===b?h||(h=!0,s=!0,x=t.currentDoubleValue()):"falseZ"===b?_||(_=!0,s=!0,P=t.currentDoubleValue()):"falseM"===b?k||(k=!0,s=!0,j=t.currentDoubleValue()):"xyUnits"===b?g||(g=!0,s=!0,G=t.currentDoubleValue()):"zUnits"===b?S||(S=!0,s=!0,C=t.currentDoubleValue()):"mUnits"===b?N||(N=!0,s=!0,K=t.currentDoubleValue()):"unit"===b?T||(T=!0,$=re(t)):t.skipChildren()}A<=0&&v>0&&(A=v),v<=0&&A>0&&(v=A);let E=null,Y=!0;if(0!==V.length&&(Y=!1,(0,z.aA)(V)&&(E=(0,z.b)(V))),E||0===U.length||(Y=!1,(0,z.aA)(U)&&(E=(0,z.b)(U))),!E&&f>0&&(Y=!1,(0,z.aB)(f)&&(A<=0||(0,z.aC)())&&(E=(0,z.c)(f,A))),!E&&D>0&&(Y=!1,(0,z.aB)(D)&&(v<=0||(0,z.aC)())&&(E=(0,z.c)(D,v))),Y&&(E=(0,z.z)($)),s&&E){const b=new z.aE;E.queryPrecisionDescriptorWithoutFalseXY(b),u&&b.setTolerance(0,M),c&&b.setTolerance(1,B),m&&b.setTolerance(2,L),g&&l&&h&&b.setGridParams(R,x,G),S&&_&&b.setZParams(P,C),N&&k&&b.setMParams(j,K),E=(0,z.aD)(E,b)}return E}function le(t,e,n,r){2!==r.currentToken()&&(0,i.t)("failed to parse multipath: array of array of vertices is expected");const a=t?new w.a:new w.P,o=a,s=(0,F.z)(0),u=(0,F.F)(2,0),c=(0,F.D)(0);let m=null,l=null,h=null,_=null,k=null,g=0,S=0,N=0;const T=new w.S,D=O.P.getNAN();let f=0,v=0;const A=t?1:0;for(;4!==r.nextToken();){2!==r.currentToken()&&(0,i.t)("failed to parse multipath: ring/path array is expected");let M=2,B=0,L=!0;const G=4;let C=0,K=0;const R=O.P.getNAN(),x=(0,O.d)(G,Number.NaN),P=(0,O.d)(G,Number.NaN);let j=!1;for(r.nextToken();4!==r.currentToken();){if(e&&1===r.currentToken())L&&(0,i.t)("failed to parse multipath: starting vertex array is expected"),h||(h=(0,F.D)(f-1,1),_=(0,F.z)(f-1,-1),k=(0,F.F)(0)),j=!0,M=1,({segFlag:N,toPointSz:C}=Ve(T,x,D,r));else{for(j=!1,2!==r.currentToken()&&(0,i.t)("failed to parse multipath: array is expected, rings/paths vertices consist of arrays of coordinates"),C=0;4!==r.nextToken();)C===G&&(0,i.t)("failed to parse multipath: each vertex array has to have at most 4 elements"),x[C++]=y(r);C<2&&(0,i.t)("failed to parse multipath: each vertex array has to have at least 2 elements"),(0,F.J)(x[0],x[1])||(0,i.t)("failed to parse multipath: x and y must be finite")}r.nextToken();do{if(u.size()===2*f&&u.resize(Se(f)),u.writePoint2D(2*f,R.setCoords(x[0],x[1])),m&&m.size()===f&&m.resize(se(f)),C>2?(m||(m=(0,F.F)(f+1,Number.NaN)),m.write(f,x[2])):m&&m.write(f,Number.NaN),l&&l.size()===f&&l.resize(se(f)),C>3?(l||(l=(0,F.F)(f+1,Number.NaN)),l.write(f,x[3])):l&&l.write(f,Number.NaN),L)v++,s.add(f),c.add(A),L=!1,K=C,(0,O.a)(P,x,0,0,K);else if(null!==h)if(j){const V=(0,w.H)(N),U=k.size();k.resize(U+V),h.add(N),_.add(g),T.get().writeInBufferStream(k,g),g+=V,o.incCurveType(N,1),S++}else h.add(1),_.add(-1);f++,B++,D.setCoords(x[0],x[1])}while(B<M&&4===r.currentToken())}0!==B&&(t&&B>M&&C===K&&0===(0,O.ap)(x,P,C)?(f--,B--):null!==h&&(h.add(1),_.add(-1)))}return f&&(s.resize(v),c.resize(v),f>0&&(s.add(f),c.add(0)),o.setAttributeStreamRef(0,u),o.setPathFlagsStreamRef(c),o.setPathStreamRef(s),null!==h&&(o.updateCurveCounter(S),o.setSegmentData(_,k,h,g)),o.notifyModifiedFlags(65535)),{geometry:a,as:m,bs:l}}function Pe(t,e){2!==e.currentToken()&&(0,i.t)("failed to parse multipoint: array of vertices is expected");let n=0;const r=new w.M,a=(0,F.F)(2,0);let o=0;const u=(0,O.d)(4,Number.NaN),c=new O.P;let m=null,l=null;for(;4!==e.nextToken();){for(2!==e.currentToken()&&(0,i.t)("failed to parse multipoint: array is expected, multipoint vertices consist of arrays of cooridinates"),o=0;4!==e.nextToken();)4===o&&(0,i.t)("failed to parse multipoint: each vertex array has to have at most 4 elements"),u[o++]=y(e);o<2&&(0,i.t)("failed to parse multipoint: each vertex array has to have at least 2 elements"),(0,F.J)(u[0],u[1])||(0,i.t)("failed to parse multipoint: x and y must be finite"),a.size()===2*n&&a.resize(Se(n)),a.writePoint2D(2*n,c.setCoords(u[0],u[1])),m&&m.size()===n&&m.resize(se(n)),o>2?(m||(m=(0,F.F)(n+1,Number.NaN)),m.write(n,u[2])):m&&m.write(n,Number.NaN),l&&l.size()===n&&l.resize(se(n)),o>3?(l||(l=(0,F.F)(n+1,Number.NaN)),l.write(n,u[3])):l&&l.write(n,Number.NaN),n++}if(n){const h=r.getImpl();h.setAttributeStreamRef(0,a),h.resizeNoInit(n),h.notifyModifiedFlags(65535)}return{geometry:r,as:m,bs:l}}function Ie(t,e){2!==e.currentToken()&&(0,i.t)("failed to parse array of IDs: array of array of integers is expected");const n=(0,F.K)(2,0);let r=0,a=-1;for(;4!==e.nextToken();){const o=r;n.size()===r&&n.resize(se(r)),r++;let s=0;for(-1===a?a=2===e.currentToken()?1:0:1===a&&2!==e.currentToken()&&(0,i.t)("failed to parse array of IDs: array of array of integers is expected"),0===a&&(n.size()===r&&n.resize(se(r)),n.write(r,fe(e)),s++,r++);4!==e.nextToken();)n.size()===r&&n.resize(se(r)),n.write(r,fe(e)),s++,r++;if(n.write(o,s),0===a)break}return n.resize(r),n}function y(t){const e=t.currentToken();if(10===e||6===e&&"NaN"===t.currentString())return Number.NaN;{const n=t.currentDoubleValue();return Number.isNaN(n)?Number.NaN:n}}function fe(t){return t.currentInt32Value()}function Se(t){let e=2*Math.trunc(3*(t+1)/2);return e<8?e=8:e<32&&(e=32),e}function se(t){let e=Math.trunc(3*(t+1)/2);return e<4?e=4:e<16&&(e=16),e}function Ve(t,e,n,r,a){const o={segFlag:0,toPointSz:0};let s=r.currentToken();s=r.nextToken();const u=r.currentString(),c=u[0];for((1!==u.length||"a"!==c&&"b"!==c&&"c"!==c&&"n"!==c&&"q"!==c)&&(0,i.t)('failed to parse curve: expecting "a", "b", "n", "q", or "c"'),s=r.nextToken(),2!==s&&(0,i.t)("failed to parse curve: start array is expected for curve parameters"),s=r.nextToken(),2!==s&&(0,i.t)("failed to parse curve: start array is expected for to point"),o.toPointSz=0;4!==r.nextToken();)4===o.toPointSz&&(0,i.t)("failed to parse curve: vertex array cannot have more than 4 elements"),e[o.toPointSz++]=y(r);o.toPointSz<2&&(0,i.t)("failed to parse curve: vertex array must have at least 2 elements");const m=O.P.construct(e[0],e[1]),l=O.P.getNAN();let h=-1,_=-1,k=!1,g=Number.NaN,S=Number.NaN,N=Number.NaN;const T=[O.P.getNAN(),O.P.getNAN(),O.P.getNAN()],D=O.P.getNAN();if("a"===c){s=r.nextToken(),2!==s&&(0,i.t)("failed to parse curve: start array is expected for center point"),s=r.nextToken();const f=y(r);s=r.nextToken();const v=y(r);s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for center point"),l.setCoords(f,v),s=r.nextToken(),h=r.currentInt32Value(),s=r.nextToken(),_=r.currentInt32Value(),s=r.nextToken(),4!==s?(k=!1,g=y(r),s=r.nextToken(),S=y(r),s=r.nextToken(),N=y(r),s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for curve parameters")):k=!0,o.segFlag=4}else if("b"===c){for(let f=0;f<2;f++){s=r.nextToken(),2!==s&&(0,i.t)("failed to parse curve: start array is expected for control point"),s=r.nextToken();const v=y(r);s=r.nextToken();const A=y(r);s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for control point"),T[f].setCoords(v,A)}s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=2}else if("n"===c){{s=r.nextToken(),2!==s&&(0,i.t)("failed to parse curve: start array is expected for control point"),s=r.nextToken();const M=y(r);s=r.nextToken();const B=y(r);s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for control point"),T[0].setCoords(M,B)}s=r.nextToken();const f=y(r);s=r.nextToken();const v=y(r);s=r.nextToken();const A=y(r);T[1].setCoords(f,v),T[2].setCoords(A,A),s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=8}else if("q"===c){for(let f=0;f<1;f++){s=r.nextToken(),2!==s&&(0,i.t)("failed to parse curve: start array is expected for control point"),s=r.nextToken();const v=y(r);s=r.nextToken();const A=y(r);s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for control point"),T[f].setCoords(v,A)}s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=16}else{s=r.nextToken(),2!==s&&(0,i.t)("failed to parse curve: start array is expected for interior point"),s=r.nextToken();const f=y(r);s=r.nextToken();const v=y(r);s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for interior point"),D.setCoords(f,v),s=r.nextToken(),4!==s&&(0,i.t)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=4}if(s=r.nextToken(),3!==s&&(0,i.t)("failed to parse curve: end object is expected for curve"),"a"===c)t.createEllipticArc(),k?Ce(t.get(),n,m,l,!0,h,_):function Ue(t,e,n,r,a,o,s,u,c){t.dropAllAttributes();const l=new ArrayBuffer(44),h=new X({sz:44,buffer:l});let _=0;h.writeDouble(_,r.x),_+=8,h.writeDouble(_,r.y),_+=8,h.writeDouble(_,s),_+=8,h.writeDouble(_,u),_+=8,h.writeDouble(_,c),_+=8;let k=0;o||(k|=2048),a&&(k|=4096),h.writeInt32(_,k),_+=4,function Me(t,e,n,r,a){t.m_bits=0,t.m_center.x=r.readDouble(a),t.m_center.y=r.readDouble(a+8),t.m_rotation=r.readDouble(a+16),t.m_semiMajorAxis=r.readDouble(a+24),t.m_minorMajorRatio=r.readDouble(a+32),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=n.x,t.m_YEnd=n.y;const o=r.readInt32(a+40);if(1&o)return!1;let s=!!(64&o),u=!!(128&o);const c=!!(2048&o),m=!!(4096&o);!(512&o)&&!(1024&o)||u||(s=!0),u&&!e.equals(n)?(u=!1,s=!0):s&&e.equals(n)&&(u=!0,s=!1),u?(t.m_center.assign(e),t.m_startAngle=t.m_center.x,t.m_sweepAngle=t.m_center.y,(0,w.F)(t,Number.NaN,c,m),t.m_semiMajorAxis=0,t.m_interior.setCoordsPoint2D(e)):s?(t.m_center.setNAN(),t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0,(0,w.A)(t),t.queryCoord2D(.5,t.m_interior)):t.constructEllipticArcEndPointsCenter(e,n,t.m_semiMajorAxis,t.m_minorMajorRatio,t.m_rotation,!m,c,t.m_center),t.setProjectionBehavior(1),(0,w.A)(t)}(t,e,n,h,0)}(t.get(),n,m,l,h,_,g,S,N);else if("b"===c)t.createCubicBezier(),function We(t,e,n,r){t.dropAllAttributes();const o=new ArrayBuffer(32),s=new X({sz:32,buffer:o});let u=0;s.writeDouble(u,r[0].x),u+=8,s.writeDouble(u,r[0].y),u+=8,s.writeDouble(u,r[1].x),u+=8,s.writeDouble(u,r[1].y),u+=8,function Ge(t,e,n,r,a){(0,i.g)(a+32<=r.size()),t.m_cp=(0,O.m)(O.P,2),t.m_cp[0].x=r.readDouble(a),t.m_cp[0].y=r.readDouble(a+8),t.m_cp[1].x=r.readDouble(a+16),t.m_cp[1].y=r.readDouble(a+24),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=n.x,t.m_YEnd=n.y}(t,e,n,s,0)}(t.get(),n,m,T);else if("n"===c)t.createQuadraticRationalBezier(),function Le(t,e,n,r,a,o,s){t.dropAllAttributes();const c=new ArrayBuffer(40),m=new X({sz:40,buffer:c});let l=0;m.writeDouble(l,r.x),l+=8,m.writeDouble(l,r.y),l+=8,m.writeDouble(l,a),l+=8,m.writeDouble(l,o),l+=8,m.writeDouble(l,s),l+=8,function Re(t,e,n,r,a){t.m_cp.x=r.readDouble(a),t.m_cp.y=r.readDouble(a+8),t.m_weights[0]=r.readDouble(a+16),t.m_weights[1]=r.readDouble(a+24),t.m_weights[2]=r.readDouble(a+32),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=n.x,t.m_YEnd=n.y}(t,e,n,m,0)}(t.get(),n,m,T[0],T[1].x,T[1].y,T[2].x);else if("q"===c)t.createQuadraticBezier(),t.get().construct(n,T[0],m);else{t.createEllipticArc();const f=!1;Ce(t.get(),n,m,D,f,-1,-1)}return o}function Ce(t,e,n,r,a,o,s){t.dropAllAttributes();const c=new ArrayBuffer(20),m=new X({sz:20,buffer:c});let l=0;m.writeDouble(l,r.x),l+=8,m.writeDouble(l,r.y),l+=8;let h=0;a?(s||(h|=8),o&&(h|=16)):h|=128,m.writeInt32(l,h),l+=4,function Be(t,e,n,r,a){a>=r.size()&&(0,i.n)("Byte_buffer out of range access"),t.m_bits=0,t.m_rotation=0,t.m_cosr=1,t.m_sinr=0,t.setStartXY(e),t.setEndXY(n);const o=O.P.getNAN();o.x=r.readDouble(a),o.y=r.readDouble(a+8);const s=r.readInt32(a+16);if(1&s)return t.m_semiMajorAxis=0,t.m_minorMajorRatio=1,t.m_interior.assign(o),t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0,(0,w.A)(t),!1;let u=!!(64&s);const c=!!(128&s);let m=!!(32&s);const l=!!(8&s),h=!!(16&s),_=e.equals(n);u&&!_&&(u=!1,m=!0),m&&_&&(u=!0,m=!1,o.setCoords(0,0)),u||(c?m?(t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.m_interior.assign(o),t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0):(t.constructCircularArcThreePoint(e,n,o),_&&l===t.isClockwise()&&t.reverse()):m?(t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0,(0,w.A)(t),t.queryCoord2D(.5,t.m_interior)):(0,w.B)(t,e,n,o,l,h)),u&&(t.m_center.assign(e),t.m_startAngle=o.x,t.m_sweepAngle=o.y,(0,w.F)(t,Number.NaN,l,h),t.m_semiMajorAxis=0,t.m_minorMajorRatio=1,t.m_interior.setCoordsPoint2D(e)),t.setProjectionBehavior(0),(0,w.A)(t)}(t,e,n,m,0)}function Ke(t,e,n,r,a){const o=t.getGeometryType();if(o===i.G.enumEllipticArc)return function Xe(t,e,n,r,a){(0,i.g)(!(0,w.z)(t));const o=t.getEndXY(),s=t.hasAttribute(1)&&!e,u=t.hasAttribute(2)&&!n;let c=Number.NaN,m=Number.NaN;if(s&&(c=t.getEndAttributeAsDbl(1,0)),u&&(m=t.getEndAttributeAsDbl(2,0)),t.isDegenerateToLine()||t.isDegenerate(0))return ce(s,u,o.x,o.y,c,m,r,a),!0;const l=0===t.projectionBehavior(),h=!!l&&t.isClosed();if(l&&!h)a.startObject(),a.addFieldName("c"),a.startArray(),ce(s,u,o.x,o.y,c,m,r,a),de(t.m_interior.x,t.m_interior.y,17,a),a.endArray(),a.endObject();else if(l){a.startObject(),a.addFieldName("a"),a.startArray(),ce(s,u,o.x,o.y,c,m,r,a),de(t.m_center.x+0,t.m_center.y+0,17,a);const g=!t.isMajor();a.addInt32(g?1:0);const S=t.isClockwise();a.addInt32(S?1:0),a.endArray(),a.endObject()}else{a.startObject(),a.addFieldName("a"),a.startArray(),ce(s,u,o.x,o.y,c,m,r,a);const _=t;de(_.m_center.x,_.m_center.y,17,a);const k=!_.isMajor();a.addInt32(k?1:0);const g=_.isClockwise();a.addInt32(g?1:0),a.addDouble(_.m_rotation,17),a.addDouble(_.m_semiMajorAxis,17),a.addDouble(_.m_minorMajorRatio,17),a.endArray(),a.endObject()}return!1}(t,e,n,r,a);if(o===i.G.enumBezier)return we(t,e,n,r,a);if(o===i.G.enumRationalBezier2)return function Ye(t,e,n,r,a){const o=t.getEndXY(),s=t.hasAttribute(1)&&!e,u=t.hasAttribute(2)&&!n;let c=Number.NaN,m=Number.NaN;s&&(c=t.getEndAttributeAsDbl(1,0)),u&&(m=t.getEndAttributeAsDbl(2,0)),a.startObject(),a.addFieldName("n"),a.startArray(),ce(s,u,o.x,o.y,c,m,r,a),de(t.m_cp.x,t.m_cp.y,r,a);const l=r;return a.addDouble(t.m_weights[0],l),a.addDouble(t.m_weights[1],l),a.addDouble(t.m_weights[2],l),a.endArray(),a.endObject(),!1}(t,e,n,r,a);if(o===i.G.enumBezier2){const s=new w.y;return s.constructFromQuadraticSegment(t),we(s,e,n,r,a)}(0,i.b)("")}function we(t,e,n,r,a){const o=t.getEndXY(),s=t.hasAttribute(1)&&!e,u=t.hasAttribute(2)&&!n;let c=Number.NaN,m=Number.NaN;return s&&(c=t.getEndAttributeAsDbl(1,0)),u&&(m=t.getEndAttributeAsDbl(2,0)),a.startObject(),a.addFieldName("b"),a.startArray(),ce(s,u,o.x,o.y,c,m,r,a),de(t.m_cp[0].x,t.m_cp[0].y,r,a),de(t.m_cp[1].x,t.m_cp[1].y,r,a),a.endArray(),a.endObject(),!1}function ce(t,e,n,r,a,o,s,u){u.startArray(),u.addDouble(n,s),u.addDouble(r,s),t&&u.addDouble(a,s),e&&u.addDouble(o,s),u.endArray()}function de(t,e,n,r){r.startArray(),r.addDouble(t,n),r.addDouble(e,n),r.endArray()}function De(t,e,n,r){const a=n.getImpl(),o=!!(2&e),s=!!(4&e),u=!!(8&e),c=a.hasAttribute(1)&&!o,m=a.hasAttribute(2)&&!s,l=a.hasAttribute(3)&&!u,h=a.hasNonLinearSegments();c&&(r.addFieldName("hasZ"),r.addBool(!0)),m&&(r.addFieldName("hasM"),r.addBool(!0)),r.addFieldName(t?h?"curveRings":"rings":h?"curvePaths":"paths");let _=null;const k=[];if(n.isEmpty())r.startArray(),r.endArray();else{const g=17-(31&e>>13);r.startArray();const S=n.getPathCount();let N=0;const T=a.getAttributeStreamRef(0);let D=null,f=null,v=null;const A=new w.S;let M=null,B=null,L=null;h&&(M=a.getSegmentFlagsStreamRef(),B=a.getSegmentIndexStreamRef(),L=a.getSegmentDataStreamRef()),c&&(D=a.getAttributeStreamRef(1)),m&&(f=a.getAttributeStreamRef(2)),l&&(v=a.getAttributeStreamRef(3),_=(0,F.t)(3,0));for(let G=0;G<S;G++){r.startArray(),l&&k.push(0);const C=n.getPathEnd(G);if(N===C){r.endArray();continue}const K=n.isClosedPath(G);let R=T.read(2*N),x=T.read(2*N+1),P=c?D.read(N):Number.NaN,j=m?f.read(N):Number.NaN,V=l?v.read(N):0;pe(c,m,R,x,P,j,g,r);let U=1;l&&(_.add(V),k[k.length-1]++);const $=R,E=x,Y=P,b=j,ie=V;let ke=!1,ae=0,ee=Number.NaN,te=Number.NaN,oe=0;for(let Z=N+1,ne=N,be=K?C+1:C;Z<be;Z++,ne++){const Q=null!==M?31&M.read(ne):1;let J,q;if(Z<C?(J=T.read(2*Z),q=T.read(2*Z+1),c&&(ee=D.read(Z)),m&&(te=f.read(Z)),l&&(oe=v.read(Z))):(J=$,q=E,ee=Y,te=b,oe=ie),1!==Q){ke=!0,4===Q?A.createEllipticArc():2===Q?A.createCubicBezier():16===Q?A.createQuadraticBezier():8===Q?A.createQuadraticRationalBezier():(0,i.b)("JSON export.unsupported curve");const H=A.get(),W=B.read(ne);H.setStartXYCoords(R,x),H.setEndXYCoords(J,q),c&&(H.setStartAttribute(1,0,P),H.setEndAttribute(1,0,ee)),m&&(H.setStartAttribute(2,0,j),H.setEndAttribute(2,0,te)),H.readFromBufferStream(L,W),Ke(A.get(),o,s,g,r)&&ae++}else pe(c,m,J,q,ee,te,g,r);l&&(_.add(oe),k[k.length-1]++),U++,R=J,x=q,P=ee,j=te,V=oe}ke&&0===ae||(U<2&&ae<1&&(pe(c,m,R,x,P,j,g,r),U++,l&&(_.add(V),k[k.length-1]++)),K&&U<3&&ae<2&&(pe(c,m,$,E,Y,b,g,r),U++,R=$,x=E,P=Y,j=b,V=ie,l&&(_.add(ie),k[k.length-1]++))),r.endArray(),N=C}r.endArray()}if(l){r.addFieldName("ids"),r.startArray();let g=0;for(let S=0,N=k.length;S<N;++S){const T=k[S];(0,i.g)(0===T||null!==_&&g+T<=_.size()),r.startArray();for(let D=0;D<T;++D)r.addInt32(_.read(g)),g++;r.endArray()}r.endArray()}}function pe(t,e,n,r,a,o,s,u){u.startArray(),u.addDouble(n,s),u.addDouble(r,s),t&&u.addDouble(a,s),e&&u.addDouble(o,s),u.endArray()}const d_s_a="a".charCodeAt(0),d_s_A="A".charCodeAt(0),d_s_asterisk="*".charCodeAt(0),d_s_b="b".charCodeAt(0),d_s_backslash=("\b".charCodeAt(0),"\\".charCodeAt(0)),d_s_beginArray="[".charCodeAt(0),d_s_beginObject="{".charCodeAt(0),d_s_colon=":".charCodeAt(0),d_s_period=".".charCodeAt(0),d_s_comma=",".charCodeAt(0),d_s_doubleQuote='"'.charCodeAt(0),d_s_endArray="]".charCodeAt(0),d_s_endObject="}".charCodeAt(0),d_s_e="e".charCodeAt(0),d_s_E="E".charCodeAt(0),d_s_f="f".charCodeAt(0),d_s_F=("\f".charCodeAt(0),"F".charCodeAt(0)),d_s_forwardslash="/".charCodeAt(0),d_s_minus=("<".charCodeAt(0),"-".charCodeAt(0)),d_s_plus="+".charCodeAt(0),d_s_n="n".charCodeAt(0),d_s_N="N".charCodeAt(0),d_s_r=("\n".charCodeAt(0),"r".charCodeAt(0)),d_s_t=("\r".charCodeAt(0),"t".charCodeAt(0)),d_s_u=("\t".charCodeAt(0),"u".charCodeAt(0)),d_s_zero="0".charCodeAt(0),d_s_nine="9".charCodeAt(0);class tt{constructor(e){this.m_functionStack=[],this.m_pushPositions=[],this.m_utf8Decoder=new TextDecoder("utf-8",{fatal:!0}),void 0===e?(this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_endToken=0,this.m_currentTokenType=0,this.m_functionStack.push(()=>this.accept_()),this.m_jsonString=null,this.m_bHasEscapes=!1):e.jsonString?this.resetParserFromString(e.jsonString):e.jsonStream?(0,i.b)("streaming json parsing not yet impl"):(0,i.c)("invalid constructor parameter")}prepSubstrString_(){}getCurrentSubstrString_(){return this.m_jsonString.slice(this.m_startToken,this.m_endToken)}stepOverCharString_(){this.m_endToken++}peekCharString_(){return this.m_jsonString.charCodeAt(this.m_endToken)}getString_(e){const n=this.m_jsonString?.slice(this.m_startToken,this.m_startToken+e-1);return this.m_endToken+=e-1,{s:n,bDone:this.m_endToken>=this.m_jsonString.length}}incrementString_(){this.m_endToken++}eofString_(){return this.m_endToken>=this.m_jsonString.length}setStringFunctions_(){this.m_prepSubstr=this.prepSubstrString_,this.m_getCurrentSubstr=this.getCurrentSubstrString_,this.m_stepOverChar=this.stepOverCharString_,this.m_peekChar=this.peekCharString_,this.m_get=this.getString_,this.m_increment=this.incrementString_,this.m_eof=this.eofString_}setStreamFunctions_(){(0,i.b)("streaming json parsing not yet impl")}reset_(){this.m_jsonString=null,this.m_endToken=0,this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_currentTokenType=0,this.m_bHasEscapes=!1,this.m_functionStack.length=0,this.m_functionStack.push(()=>this.start_()),this.m_pushPositions.length=0}resetParserFromString(e){this.reset_(),this.setStringFunctions_(),this.m_jsonString=e}resetParserFromStream(e){(0,i.b)("streaming json parsing not yet impl")}resetToPosition(e){return(0,i.g)(0),!1}nextToken(){return this.m_functionStack.at(-1)(),this.m_currentTokenType}currentToken(){return this.m_currentTokenType}currentTokenStartIndex(){return this.m_startToken}currentTokenEndIndex(){return this.m_endToken}currentText(){return(0,i.g)(0),""}childrenAsString(){return(0,i.g)(0),""}skipChildren(){this.skipChildren_()}skipChildren_(){if(1!==this.m_currentTokenType){if(2===this.m_currentTokenType){let e=1;do{this.m_currentTokenType=this.nextToken(),2===this.m_currentTokenType?e++:4===this.m_currentTokenType&&e--}while(4!==this.m_currentTokenType||0!==e)}}else{let e=1;do{this.m_currentTokenType=this.nextToken(),1===this.m_currentTokenType?e++:3===this.m_currentTokenType&&e--}while(3!==this.m_currentTokenType||0!==e)}}currentTerminalAsString_(){switch(this.m_currentTokenType){case 7:case 8:case 9:return this.m_getCurrentSubstr().slice(0,this.m_endToken-this.m_startToken);case 10:return"null";case 11:return"true";case 12:return"false"}(0,i.t)("invalid token")}toUTF8_(e,n){let r=0,a=e;for(;n.charCodeAt(a)===d_s_backslash&&n.charCodeAt(a+1)===d_s_u;)r++,a+=6;a=e;const o=new Uint8Array(r);let s=0;for(;n.charCodeAt(a)===d_s_backslash&&n.charCodeAt(a+1)===d_s_u;)o[s++]=Number.parseInt(n.slice(a+2,a+6),16),a+=6;return{u8s:this.m_utf8Decoder.decode(o),end:a}}unquoteCurrentString_(){let e="",n=1;const r=this.m_endToken-this.m_startToken-1;let a=0;const o=this.m_getCurrentSubstr();for(let s=n;s<r;s++)if(o.charCodeAt(s)!==d_s_backslash)a++;else{switch(a>0&&(e+=o.slice(n,n+a)),o.charCodeAt(++s)){case d_s_doubleQuote:e+='"';break;case d_s_u:{const{u8s:u,end:c}=this.toUTF8_(s-1,o);s=c-1,e+=u;break}case d_s_backslash:e+="\\";break;case d_s_forwardslash:e+="/";break;case d_s_b:e+="\b";break;case d_s_f:e+="\f";break;case d_s_n:e+="\n";break;case d_s_r:e+="\r";break;case d_s_t:e+="\t"}n=s+1,a=0}return a>0&&(e+=o.slice(n,n+a)),e}currentString(){return 5!==this.m_currentTokenType&&6!==this.m_currentTokenType?this.currentTerminalAsString_():this.m_bHasEscapes?this.unquoteCurrentString_():this.m_getCurrentSubstr().slice(1,this.m_endToken-this.m_startToken-2+1)}currentDoubleValue(){if(7!==this.m_currentTokenType&&8!==this.m_currentTokenType&&9!==this.m_currentTokenType&&6!==this.m_currentTokenType&&10!==this.m_currentTokenType&&(0,i.t)("invalid token"),10===this.m_currentTokenType)return Number.NaN;let e=this.m_getCurrentSubstr(),n=this.m_endToken-this.m_startToken;if(6===this.m_currentTokenType){if("NaN"===this.currentString())return Number.NaN;e=e.slice(1),n-=2,0===n&&(0,i.t)("invalid token")}const r=Number.parseFloat(e);if(6===this.m_currentTokenType)Number.isNaN(r)&&(0,i.t)("invalid token");else if(Number.isNaN(r))return Number.NaN;return r}currentInt32Value(){8!==this.m_currentTokenType&&6!==this.m_currentTokenType&&(0,i.t)("invalid token");let e=this.m_getCurrentSubstr(),n=this.m_endToken-this.m_startToken;6===this.m_currentTokenType&&(e=e.slice(1),n-=2,0===n&&(0,i.t)("invalid token"));const r=parseInt(e);return Number.isNaN(r)&&(0,i.t)("invalid token"),r}currentInt64Value(){return(0,i.g)(0),0n}currentBoolValue(){return(0,i.g)(0),!1}isError(){return 0}JSONString(){return(0,i.g)(0),""}pushPosition(){return(0,i.g)(0),!1}popPosition(){return(0,i.g)(0),!1}skipCStyleComments_(){(0,i.g)(0)}skipCppStyleComments_(){(0,i.g)(0)}skipComments_(){this.m_prepSubstr();let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token"),e=this.m_peekChar(),e===d_s_asterisk?this.skipCStyleComments_():e===d_s_forwardslash?this.skipCppStyleComments_():(0,i.t)("invalid token")}skipWhiteSpace_(){let e;do{this.m_eof()&&(0,i.t)("invalid token");let n=this.m_peekChar();for(;n>=9&&n<=13||32===n;)this.m_increment(),this.m_eof()&&(0,i.t)("invalid token"),n=this.m_peekChar();n===d_s_forwardslash?(this.m_startToken=this.m_endToken,e=!0,this.skipComments_()):e=!1}while(e)}rightBracket_(){return this.m_peekChar()===d_s_endArray&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=4,!0)}rightBrace_(){return this.m_peekChar()===d_s_endObject&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=3,!0)}string_(){this.m_prepSubstr(),this.m_bHasEscapes=!1,this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token");let e=this.m_peekChar();for(;e!==d_s_doubleQuote;){const n=e===d_s_backslash;if(this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token"),e=this.m_peekChar(),n)if(this.m_bHasEscapes=!0,e===d_s_doubleQuote||e===d_s_backslash||e===d_s_forwardslash||e===d_s_b||e===d_s_f||e===d_s_n||e===d_s_r||e===d_s_t)this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token"),e=this.m_peekChar();else if(e===d_s_u)for(let r=0;r<4;r++)this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token"),e=this.m_peekChar(),e>=d_s_zero&&e<=d_s_nine||e>=d_s_a&&e<=d_s_f||e>=d_s_A&&e<=d_s_F||(0,i.t)("invalid token");else(0,i.t)("invalid token")}this.m_stepOverChar()}comma_(){return this.m_peekChar()===d_s_comma&&(this.m_increment(),!0)}colon_(){return this.m_peekChar()===d_s_colon&&(this.m_increment(),!0)}fieldNameEnd_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.colon_()?(this.skipWhiteSpace_(),this.value_()):(0,i.t)("invalid token")}fieldNameStart_(){this.m_startToken=this.m_endToken,this.m_peekChar()!==d_s_doubleQuote&&(0,i.t)("invalid token"),this.string_(),this.m_currentTokenType=5,this.m_functionStack.push(()=>this.fieldNameEnd_())}pairEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.fieldNameStart_()):this.rightBrace_()?this.m_functionStack.pop():(0,i.t)("invalid token")}arrayStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBracket_()||(this.m_functionStack.push(()=>this.elementEnd_()),this.value_())}elementEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.value_()):this.rightBracket_()?this.m_functionStack.pop():(0,i.t)("invalid token")}objectStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBrace_()||(this.m_functionStack.push(()=>this.pairEnd_()),this.fieldNameStart_())}valueStartObject_(){this.m_increment(),this.m_currentTokenType=1,this.m_functionStack.push(()=>this.objectStart_())}valueStartArray_(){this.m_increment(),this.m_currentTokenType=2,this.m_functionStack.push(()=>this.arrayStart_())}valueString_(){this.string_(),this.m_currentTokenType=6}int_(){this.m_peekChar()!==d_s_zero?this.digits_():this.m_stepOverChar()}digits_(){let e=this.m_peekChar();do{this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token"),e=this.m_peekChar()}while(e>=d_s_zero&&e<=d_s_nine)}frac_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token"),e=this.m_peekChar(),e>=d_s_zero&&e<=d_s_nine||(0,i.t)("invalid token"),this.digits_()}exp_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token"),e=this.m_peekChar(),e!==d_s_plus&&e!==d_s_minus||(this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token"),e=this.m_peekChar()),e>=d_s_zero&&e<=d_s_nine||(0,i.t)("invalid token"),this.digits_()}valueNumber_(){this.m_prepSubstr();let e=!1,n=this.m_peekChar();if(n===d_s_minus?(this.m_stepOverChar(),this.m_eof()&&(0,i.t)("invalid token"),n=this.m_peekChar(),e=!0,n>=d_s_zero&&n<=d_s_nine||(0,i.t)("invalid token"),this.int_()):this.int_(),n=this.m_peekChar(),n===d_s_period)this.m_currentTokenType=7,this.frac_(),n=this.m_peekChar(),n!==d_s_e&&n!==d_s_E||this.exp_();else if(n===d_s_e||n===d_s_E)this.m_currentTokenType=7,this.exp_();else{let r=0;e&&r++;const a=this.m_endToken-this.m_startToken-r;if(a<10)this.m_currentTokenType=8;else if(10===a){const o=this.m_getCurrentSubstr();this.m_currentTokenType=e?o.slice(r)<="2147483648"?8:9:o.slice(r)<="2147483647"?8:9}else if(a<19)this.m_currentTokenType=9;else if(19===a){const o=this.m_getCurrentSubstr();this.m_currentTokenType=e?o.slice(r)<="9223372036854775808"?9:7:o.slice(r)<="9223372036854775807"?9:7}else this.m_currentTokenType=7}}valueNull_(){const{s:e,bDone:n}=this.m_get(5);n&&(0,i.t)("invalid token"),"null"!==e&&(0,i.t)("invalid token"),this.m_currentTokenType=10}valueTrue_(){const{s:e,bDone:n}=this.m_get(5);n&&(0,i.t)("invalid token"),"true"!==e&&(0,i.t)("invalid token"),this.m_currentTokenType=11}valueFalse_(){const{s:e,bDone:n}=this.m_get(6);n&&(0,i.t)("invalid token"),"false"!==e&&(0,i.t)("invalid token"),this.m_currentTokenType=12}valueNan_(){const{s:e,bDone:n}=this.m_get(4);n&&(0,i.t)("invalid token"),"NaN"!==e&&(0,i.t)("invalid token"),this.m_currentTokenType=7}value_(){this.m_startToken=this.m_endToken;const e=this.m_peekChar();e===d_s_beginObject?this.valueStartObject_():e===d_s_beginArray?this.valueStartArray_():e===d_s_doubleQuote?this.valueString_():e===d_s_minus||e>=d_s_zero&&e<=d_s_zero+9?this.valueNumber_():e===d_s_n?this.valueNull_():e===d_s_t?this.valueTrue_():e===d_s_f?this.valueFalse_():e===d_s_N?this.valueNan_():(0,i.t)("invalid token")}start_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.m_functionStack.push(()=>this.accept_());const e=this.m_peekChar();e!==d_s_beginObject&&e!==d_s_beginArray&&(0,i.t)("invalid token"),this.value_()}accept_(){this.m_startToken=this.m_endToken,this.m_currentTokenType=0}}const ve=new class me{constructor(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject=[]}reset(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject.length=0}startObject(){const e={};this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}startArray(){const e=[];this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}endObject(){this.m_acceptedObject=this.m_currentObject.at(-1),this.m_currentObject.pop()}endArray(){this.m_currentObject.pop()}addFieldName(e){this.m_pendingKey=e}addValue_(e){this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):this.m_currentObject.at(-1).push(e)}addString(e){this.addValue_(e)}addDouble(e,n){this.addValue_(e)}addInt64(e){(0,i.g)(0)}addInt32(e){this.addValue_(e)}addBool(e){this.addValue_(e)}addNull(){this.addValue_(null)}getObject(){return this.m_acceptedObject}},rt=new class Qe{getOperatorType(){return 10405}accelerateGeometry(e,n,r){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,n,r,a,o,s){!function Je(t,e,n,r,a){if(e||n){if(r.startObject(),null!==e)switch(e.getGeometryType()){case i.G.enumPolygon:De(!0,t,e,r);break;case i.G.enumPolyline:De(!1,t,e,r);break;case i.G.enumMultiPoint:!function Ze(t,e,n){const r=e.getImpl(),a=r.hasAttribute(1)&&!(2&t),o=r.hasAttribute(2)&&!(4&t),s=r.hasAttribute(3)&&!(8&t);a&&(n.addFieldName("hasZ"),n.addBool(!0)),o&&(n.addFieldName("hasM"),n.addBool(!0)),n.addFieldName("points");const u=e.getPointCount();if(e.isEmpty())n.startArray(),n.endArray();else{const c=17-(31&t>>13);n.startArray();const m=r.getAttributeStreamRef(0);let l=null,h=null;a&&(l=r.getAttributeStreamRef(1)),o&&(h=r.getAttributeStreamRef(2));for(let _=0;_<u;_++){const k=m.read(2*_),g=m.read(2*_+1);let S=Number.NaN,N=Number.NaN;a&&(S=l.read(_)),o&&(N=h.read(_)),pe(a,o,k,g,S,N,c,n)}n.endArray()}if(s){let c=null;r.isEmpty()||(c=r.getAttributeStreamRef(3)),(0,i.g)(0===u||null!==c&&c.size()>=u),n.addFieldName("ids"),n.startArray();for(let m=0;m<u;m++)n.addInt32(c.read(m));n.endArray()}}(t,e,r);break;case i.G.enumPoint:!function He(t,e,n){const r=e.hasAttribute(1)&&!(2&t),a=e.hasAttribute(2)&&!(4&t),o=e.hasAttribute(3)&&!(8&t);if(e.isEmpty())return n.addFieldName("x"),n.addNull(),n.addFieldName("y"),n.addNull(),r&&(n.addFieldName("z"),n.addNull()),a&&(n.addFieldName("m"),n.addNull()),void(o&&(n.addFieldName("id"),n.addInt32(0)));const s=17-(31&t>>13);n.addFieldName("x"),n.addDouble(e.getX(),s),n.addFieldName("y"),n.addDouble(e.getY(),s),r&&(n.addFieldName("z"),n.addDouble(e.getZ(),s)),a&&(n.addFieldName("m"),n.addDouble(e.getM(),s)),o&&(n.addFieldName("id"),n.addInt32(e.getID()))}(t,e,r);break;case i.G.enumEnvelope:!function qe(t,e,n){const r=e.hasAttribute(1)&&!(2&t),a=e.hasAttribute(2)&&!(4&t),o=e.hasAttribute(3)&&!(8&t);if(e.isEmpty())return n.addFieldName("xmin"),n.addNull(),n.addFieldName("ymin"),n.addNull(),n.addFieldName("xmax"),n.addNull(),n.addFieldName("ymax"),n.addNull(),r&&(n.addFieldName("zmin"),n.addNull(),n.addFieldName("zmax"),n.addNull()),a&&(n.addFieldName("mmin"),n.addNull(),n.addFieldName("mmax"),n.addNull()),void(o&&(n.addFieldName("idmin"),n.addInt32(0),n.addFieldName("idmax"),n.addInt32(0)));const s=17-(31&t>>13);if(n.addFieldName("xmin"),n.addDouble(e.getXMin(),s),n.addFieldName("ymin"),n.addDouble(e.getYMin(),s),n.addFieldName("xmax"),n.addDouble(e.getXMax(),s),n.addFieldName("ymax"),n.addDouble(e.getYMax(),s),r){const u=e.queryInterval(1,0);n.addFieldName("zmin"),n.addDouble(u.vmin,s),n.addFieldName("zmax"),n.addDouble(u.vmax,s)}if(a){const u=e.queryInterval(2,0);n.addFieldName("mmin"),n.addDouble(u.vmin,s),n.addFieldName("mmax"),n.addDouble(u.vmax,s)}if(o){const u=e.queryInterval(3,0);n.addFieldName("idmin"),n.addInt32(u.vmin),n.addFieldName("idmax"),n.addInt32(u.vmax)}}(t,e,r);break;case i.G.enumMultipatch:(0,i.g)(0);break;default:(0,i.c)("exportToJSON")}null!==n&&(r.addFieldName("spatialReference"),function et(t,e,n){n.startObject();let r=0;e.isCustomWkid()||(r=e.getOldID());let a=0;const o=e.getVCS();if(null!==o&&(o.isCustomWkid()||(a=o.getOldID()),a<=0&&(r=0)),r>0){n.addFieldName("wkid"),n.addInt32(r);const s=e.getLatestID();if(s>0&&s!==r&&(n.addFieldName("latestWkid"),n.addInt32(s)),a>0){n.addFieldName("vcsWkid"),n.addInt32(a);const u=e.getLatestVerticalID();u!==a&&(n.addFieldName("latestVcsWkid"),n.addInt32(u))}}if(0===e.getCoordinateSystemType())n.addFieldName("wkid"),n.addNull(),null!==e.getUnit()&&(n.addFieldName("unit"),function $e(t,e,n){n.startObject();const r=e.getID();r<=0&&(0,i.t)("cannot export unit that has no valid WKID"),n.addFieldName("uwkid"),n.addInt32(r),n.endObject()}(0,e.getUnit(),n));else if(r<=0||1&t){let s="";64&t&&(s=e.getText2(),n.addFieldName("wkt2"),n.addString(s));const u=e.getText();u!==s&&(n.addFieldName("wkt"),n.addString(u))}if(16&t){const s=new z.aE;e.queryPrecisionDescriptor(s),n.addFieldName("xyTolerance"),n.addDouble(s.getTolerance(0)),n.addFieldName("zTolerance"),n.addDouble(s.getTolerance(1)),n.addFieldName("mTolerance"),n.addDouble(s.getTolerance(2)),n.addFieldName("falseX"),n.addDouble(s.getFalseX()),n.addFieldName("falseY"),n.addDouble(s.getFalseY()),n.addFieldName("xyUnits"),n.addDouble(s.getGridUnitsXY()),n.addFieldName("falseZ"),n.addDouble(s.getFalseZ()),n.addFieldName("zUnits"),n.addDouble(s.getGridUnitsZ()),n.addFieldName("falseM"),n.addDouble(s.getFalseM()),n.addFieldName("mUnits"),n.addDouble(s.getGridUnitsM())}n.endObject()}(t,n,r)),r.endObject()}}(e,n,r,a)}exportSpatialReference(e,n,r,a){(0,i.g)(0)}exportProjectionTransformation(e,n,r,a){(0,i.g)(0)}exportDatumTransformation(e,n,r,a){(0,i.g)(0)}static geometryTypeToString(e){return(0,i.g)(0),""}},st=new class nt{getOperatorType(){return 10404}accelerateGeometry(e,n,r){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,n,r,a,o,s,u){let c;"string"==typeof r?(c=new tt({jsonString:r}),c.nextToken()):c=r,1!==c.currentToken()&&(0,i.t)("failed to import map geometry: start of object is expected");const m=function he(t,e,n,r,a,o){let s=!1,u=!1,c=!1,m=!1,l=!1,h=!1,_=!1,k=!1,g=!1,S=!1,N=!1,T=!1,D=!1,f=!1,v=!1,A=!1,M=!1,B=!1,L=!1,G=!1,C=!1,K=!1,R=!1,x=!1,P=Number.NaN,j=Number.NaN,V=Number.NaN,U=Number.NaN,$=0,E=Number.NaN,Y=Number.NaN,b=Number.NaN,ie=Number.NaN,ke=Number.NaN,ae=Number.NaN,ee=Number.NaN,te=Number.NaN,oe=0,Z=0,ne=!1,be=!1,Q=null,J=null,q=null,H=null,W=null;for(;3!==n.nextToken();){const p=n.currentString();if(n.nextToken(),"spatialReference"===p){if(a&&!s){s=!0,1===n.currentToken()?H=ge(n):10!==n.currentToken()&&(0,i.t)("failed to parse spatial reference: object or null is expected");continue}}else if(r)if("hasZ"===p){if(!u){u=!0,ne=11===n.currentToken();continue}}else if("hasM"===p){if(!c){c=!0,be=11===n.currentToken();continue}}else if("rings"===p){if(!(l||h||t!==i.G.enumUnknown&&t!==i.G.enumPolygon)){l=!0,({geometry:W,as:Q,bs:J}=le(!0,!1,0,n));continue}}else if("curveRings"===p){if(!h&&(t===i.G.enumUnknown||t===i.G.enumPolygon)){h=!0,({geometry:W,as:Q,bs:J}=le(!0,!0,0,n));continue}}else if("paths"===p){if(!(_||k||t!==i.G.enumUnknown&&t!==i.G.enumPolyline)){_=!0,({geometry:W,as:Q,bs:J}=le(!1,!1,0,n));continue}}else if("curvePaths"===p){if(!k&&(t===i.G.enumUnknown||t===i.G.enumPolyline)){k=!0,({geometry:W,as:Q,bs:J}=le(!1,!0,0,n));continue}}else if("points"===p){if(!g&&(t===i.G.enumUnknown||t===i.G.enumMultiPoint)){g=!0,({geometry:W,as:Q,bs:J}=Pe(0,n));continue}}else if("ids"===p){if(!m){m=!0,q=Ie(0,n);continue}}else if("x"===p){if(!S&&(t===i.G.enumUnknown||t===i.G.enumPoint)){S=!0,P=y(n);continue}}else if("y"===p){if(!N&&(t===i.G.enumUnknown||t===i.G.enumPoint)){N=!0,j=y(n);continue}}else if("z"===p){if(!T&&(t===i.G.enumUnknown||t===i.G.enumPoint)){T=!0,V=y(n);continue}}else if("m"===p){if(!D&&(t===i.G.enumUnknown||t===i.G.enumPoint)){D=!0,U=y(n);continue}}else if("id"===p){if(!f&&(t===i.G.enumUnknown||t===i.G.enumPoint)){f=!0,$=fe(n);continue}}else if("xmin"===p){if(!v&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){v=!0,E=y(n);continue}}else if("ymin"===p){if(!A&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){A=!0,Y=y(n);continue}}else if("mmin"===p){if(!C&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){C=!0,ee=y(n);continue}}else if("zmin"===p){if(!L&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){L=!0,ke=y(n);continue}}else if("idmin"===p){if(!R&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){R=!0,oe=fe(n);continue}}else if("xmax"===p){if(!M&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){M=!0,b=y(n);continue}}else if("ymax"===p){if(!B&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){B=!0,ie=y(n);continue}}else if("mmax"===p){if(!K&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){K=!0,te=y(n);continue}}else if("zmax"===p){if(!G&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){G=!0,ae=y(n);continue}}else if("idmax"===p){if(!x&&(t===i.G.enumUnknown||t===i.G.enumEnvelope)){x=!0,Z=fe(n);continue}}else"materials"===p&&(0,i.g)(0);n.skipChildren()}if(l||h||_||k||g){let p=null,Ae=null;const Te=W;ne&&(W.addAttribute(1),p=Q,p||(p=(0,F.F)(Te.getPointCount(),Number.NaN))),be&&(W.addAttribute(2),Ae=ne?J:Q),null!=q&&W.addAttribute(3),ne&&null!=p&&Te.setAttributeStreamRef(1,p),be&&null!=Ae&&Te.setAttributeStreamRef(2,Ae),null!=q&&function ze(t,e){if(t.isEmpty())return;const n=(0,F.K)(2,0),r=t.getGeometryType();let a=0;r===w.M.type?a=1:r===w.P.type||r===w.a.type?a=t.getPathCount():(0,i.c)("not implemented"),n.resize(t.getPointCount(),0);let o=0;for(let s=0;s<a;++s){const u=e.read(o);o++;const c=o+u;let m=0,l=0;r===w.M.type?m=t.getPointCount():r===w.P.type||r===w.a.type?(m=t.getPathSize(s),l=t.getPathStart(s)):(0,i.c)("not implemented");for(let h=0,_=Math.min(u,m);h<_;++h)n.write(l,e.read(o)),o++,l++;o=c}t.getImpl().setAttributeStreamRef(3,n)}(Te,q)}else if(S||N||D||T||f){(0,F.I)(P,j)||(0,i.t)("failed to parse point: x and y must be finite or nan"),(Number.isNaN(j)||Number.isNaN(P))&&(P=Number.NaN,j=Number.NaN);const p=new F.P({x:P,y:j});T&&p.setZ(V),D&&p.setM(U),f&&p.setID($),W=p}else if(v||A||M||B||L||G||C||K||R||x){(Number.isNaN(Y)||Number.isNaN(b)||Number.isNaN(ie))&&(E=Number.NaN);const p=new F.E({xmin:E,ymin:Y,xmax:b,ymax:ie});L&&G&&p.setInterval(1,0,ke,ae),C&&K&&p.setInterval(2,0,ee,te),R&&x&&p.setInterval(3,0,oe,Z),W=p}return{...W?{geom:W}:{},...H?{sr:H}:{}}}(n,0,c,a,o);return new z.aF(m)}importProjectionTransformation(e,n){return(0,i.g)(0),{}}importDatumTransformation(e,n){return(0,i.g)(0),{}}static stringToGeometryType(e){return(e=e.toLowerCase()).startsWith("esrigeometry")||(0,i.t)("string_to_geometry_type"),e.endsWith("point")?i.G.enumPoint:e.endsWith("envelope")?i.G.enumEnvelope:e.endsWith("multipoint")?i.G.enumMultiPoint:e.endsWith("polyline")?i.G.enumPolyline:e.endsWith("polygon")?i.G.enumPolygon:void(0,i.t)("string_to_geometry_type")}};function it(t){return Array.isArray(t)?t[0].spatialReference:t.spatialReference}function Fe(t,e){const n=new ue(t,{strict:!1});return n.nextToken(),st.execute(0,i.G.enumUnknown,n,!0,e)}function at(t){let e=null;return[t.map(n=>{if(null==e){const r=Ee(n);return e=r.getSpatialReference(),r.getGeometry()}return Oe(n)}),e]}function Ee(t){return Fe(t,!0)}function Oe(t){return Fe(t,!1).getGeometry()}function ot(t,e){return t instanceof z.aF&&(e=t.getSpatialReference(),t=t.getGeometry()),t?.isEmpty()?null:(ve.reset(),rt.execute(0,t,e,ve),ve.getObject())}}}]);