"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[4555],{73747:(K,R,e)=>{e.d(R,{A:()=>Z});var U,f=e(10467),r=e(8189),T=e(77806),A=e(85211),M=(e(3248),e(35150),e(15463)),u=e(76576),V=e(38582),o=e(18550),c=e(36345);let d=U=class extends((0,o.h)(V.A)){constructor(h){super(h),this.description=null,this.label=null,this.symbol=null,this.type="simple"}collectRequiredFields(h,v){var p=this;return(0,f.A)(function*(){yield Promise.all([p.collectSymbolFields(h,v),p.collectVVRequiredFields(h,v)])})()}collectSymbolFields(h,v){var p=this;return(0,f.A)(function*(){yield Promise.all(p.symbols.map(B=>B.collectRequiredFields(h,v)))})()}getSymbol(h,v){return this.symbol}getSymbolAsync(h,v){var p=this;return(0,f.A)(function*(){return p.symbol})()}get symbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables?.reduce((h,v)=>h+v.getAttributeHash(),"")??""}getMeshHash(){return this.symbols.reduce((h,v)=>h+JSON.stringify(v),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new U({description:this.description,label:this.label,symbol:(0,T.o8)(this.symbol),visualVariables:(0,T.o8)(this.visualVariables),authoringInfo:(0,T.o8)(this.authoringInfo)})}};(0,r._)([(0,A.MZ)({type:String,json:{write:!0}})],d.prototype,"description",void 0),(0,r._)([(0,A.MZ)({type:String,json:{write:!0}})],d.prototype,"label",void 0),(0,r._)([(0,A.MZ)(c.Wp)],d.prototype,"symbol",void 0),(0,r._)([(0,M.e)({simple:"simple"})],d.prototype,"type",void 0),d=U=(0,r._)([(0,u.$)("esri.renderers.SimpleRenderer")],d);const Z=d},78698:(K,R,e)=>{e.d(R,{A:()=>T,J:()=>r});var f=e(1119);function r(P,M){let u;if("string"==typeof P)u=(0,f.Wm)(P+`-seed(${M})`);else{let V=12;u=P^M;do{u=107*(u>>8^u)+V|0}while(0!=--V)}return(1+u/(1<<31))/2}function T(P){return Math.floor(r(P,A)*S)}const A=53290320,S=10},56478:(K,R,e)=>{e.r(R),e.d(R,{default:()=>pe});var f=e(10467),r=e(8189),A=(e(81098),e(31178)),S=e(5922),M=(e(3248),e(35150)),u=e(60797),V=e(56492),o=e(48900),c=e(85211),d=(e(40707),e(76576)),Z=e(28067),h=e(51995),v=e(8190),p=e(62928),B=e(28),z=(e(73747),e(88521),e(3804),e(58272),e(29430),e(23098),e(46988),e(65374)),_=(e(86468),e(68643),e(21870),e(1749),e(55861),e(93615),e(47669),e(80862),e(9015),e(69287),e(41510),e(58701),e(91766),e(47763),e(69630),e(71045),e(82854),e(65264),e(70614),e(88918),e(3691),e(25867),e(39516),e(57249),e(2544),e(34572),e(56854),e(47942),e(53737),e(3688),e(68051),e(88532),e(30365),e(91644),e(51298),e(40702),e(42425),e(77273),e(69473),e(11242),e(50915)),Q=(e(83693),e(77440),e(9599),e(96764),e(88258),e(23070),e(97550),e(55900),e(52321),e(76169)),ee=(e(54e3),e(20904),e(6115),e(89563),e(45272),e(55912),e(64559),e(8137),e(62416),e(88690),e(63367),e(79061),e(39784),e(68165),e(38730),e(12598),e(68677),e(90731),e(16006),e(13494),e(58096),e(82870),e(88636),e(79184),e(76740),e(7610),e(99046),e(2296),e(3991),e(19922),e(26248),e(26689),e(37121),e(61299),e(32034),e(8052),e(41396),e(24493),e(20047),e(67399),e(57141),e(92405),e(12225),e(20914),e(47258),e(77469),e(62931),e(18800),e(89447),e(56985),e(48875),e(82663),e(87477),e(33658),e(70744),e(9661),e(2947),e(54290),e(74847),e(15215)),te=e(77031),F=e(40611),se=e(86807),$=e(11432),ne=e(10249),ie=e(32954),re=e(83953),le=e(45475),oe=e(11152),ae=e(63888),he=e(70418),de=e(4931);const J=[1,1],x=(0,ie.vt)(),ve={none:z.fu.None,loop:z.fu.Loop,oscillate:z.fu.Oscillate};class ce extends ae.q{constructor(s){super(),this.elementView=s,this.isWrapAround=!1,this.wrapAroundShift=0,this.perspectiveTransform=(0,le.vt)(),this._handles=new se.A,this._vertices=new Float32Array(8),this._indices=new Uint16Array([0,0,0,1,1,0,1,1,1,1,0,0,0,0,0,1,1,0,1,1]),this._handles.add([(0,o.wB)(()=>this.elementView.element.opacity,n=>this.opacity=n,o.Vh),(0,o.wB)(()=>[this.elementView.coords],()=>{this.requestRender()},o.Vh),(0,o.wB)(()=>["animationOptions"in this.elementView.element&&this.elementView.element.animationOptions],()=>{this._handles.remove("play"),this.texture=(0,$.WD)(this.texture),this.requestRender()},o.Vh),(0,o.z7)(()=>this.elementView.element.loaded,()=>{const n=this.elementView.element;this.ready(),(0,oe.Ws)(n)&&null!=n.content&&(this._handles.add([(0,F.on)(n.content,"play",()=>this.requestRender()),(0,F.on)(n.content,"loadeddata",()=>this.requestRender()),(0,F.on)(n.content,"loaded",()=>this.requestRender())]),"requestVideoFrameCallback"in n.content?n.content.requestVideoFrameCallback(()=>this.requestRender()):this._handles.add([(0,F.on)(n.content,"seeked",()=>this.requestRender())]),this.requestRender())},o.Vh)]),s.element.load().catch(n=>{M.A.getLogger("esri.views.2d.layers.MediaLayerView2D").error(new S.A("element-load-error","Element cannot be displayed",{element:s,error:n}))})}getMesh(s){throw new Error("Method not implemented.")}destroy(){this._handles.destroy(),this.texture=(0,$.WD)(this.texture)}get textureSize(){return J}get dvsMat3(){return this.parent.dvsMat3}beforeRender(s){const{context:n}=s,i=this.elementView.element.content;if(null!=i){const l=i instanceof HTMLImageElement,m=i instanceof HTMLVideoElement,a=l?i.naturalWidth:m?i.videoWidth:i.width,y=l?i.naturalHeight:m?i.videoHeight:i.height;if(this._updatePerspectiveTransform(a,y),this.texture)m&&(this.texture.setData(i),this.texture.generateMipmap(),"requestVideoFrameCallback"in i?i.requestVideoFrameCallback(()=>this.requestRender()):i.paused||this.requestRender());else{const E=new de.R;if(E.wrapMode=_.pF.CLAMP_TO_EDGE,E.preMultiplyAlpha=!0,E.width=a,E.height=y,"getFrame"in i){const G=L=>{this.texture?this.texture.setData(L):this.texture=new Q.g(n,E,L),this.requestRender()};"animationOptions"in this.elementView.element&&this._handles.add((0,he.ZH)(i,function me(t){return t?{type:"CIMAnimatedSymbolProperties",...t,playAnimation:t.playing,repeatType:t.repeatType?ve[t.repeatType]:void 0}:{type:"CIMAnimatedSymbolProperties"}}(this.elementView.element.animationOptions),null,G),"play")}else this.texture=new Q.g(n,E,i);this.texture.generateMipmap(),m&&("requestVideoFrameCallback"in i?i.requestVideoFrameCallback(()=>this.requestRender()):i.paused||this.requestRender())}}super.beforeRender(s)}_createTransforms(){return null}draw(s,n){this.isReady&&null!=this.texture?n.render(s,{transform:{dvs:this.dvsMat3},config:{perspective:this.perspectiveTransform,texSize:J,wrapAroundShift:this.wrapAroundShift,isWrapAround:this.isWrapAround,opacity:this.opacity,texture:{texture:this.texture,unit:0}},position:this._vertices,tex:this._indices}):this.requestRender()}updateDrawCoords(s,n,i,l){const{coords:m,bounds:a}=this.elementView;if(null==m||null==a)return;const[y,E,G,L]=m.rings[0],Ae=this._vertices,{x:I,y:H}=s;Ae.set([E[0]-I,E[1]-H,y[0]-I,y[1]-H,G[0]-I,G[1]-H,L[0]-I,L[1]-H]);let j=n;if(l){const[Y,,w]=a,{worldWidth:b,xBounds:Pe}=l,[q,k]=Pe;Y<q&&w>q?j=b:w>k&&Y<k&&(j=-b)}this.wrapAroundShift=j,this.isWrapAround=0!==j}_updatePerspectiveTransform(s,n){const i=this._vertices;(0,ne.O)(x,[0,0,s,0,0,n,s,n],[i[0],i[1],i[4],i[5],i[2],i[3],i[6],i[7]]),(0,re.hZ)(this.perspectiveTransform,x[6]/x[8]*s,x[7]/x[8]*n)}}var ye=e(63021),fe=e(88219),ue=e(41474),N=e(98877);let O=class extends N.A{constructor(t){super(t),this.editSourcePoints=!1}};(0,r._)([(0,c.MZ)()],O.prototype,"editSourcePoints",void 0),O=(0,r._)([(0,d.$)("esri.views.3d.layers.support.MediaLayerInteractionOptions.ReshapeOptions")],O);let C=class extends N.A{constructor(t){super(t),this.tool="transform",this.reshapeOptions=new O}};(0,r._)([(0,c.MZ)()],C.prototype,"tool",void 0),(0,r._)([(0,c.MZ)({type:O})],C.prototype,"reshapeOptions",void 0),C=(0,r._)([(0,d.$)("esri.views.3d.layers.support.MediaLayerInteractionOptions")],C);const ge=t=>{let s=class extends t{constructor(...n){super(...n),this.layer=null,this.interactive=!1,this.interactionOptions=new C,this.selectedElement=null}highlight(n,i){throw new Error("missing implementation")}};return(0,r._)([(0,c.MZ)()],s.prototype,"layer",void 0),(0,r._)([(0,c.MZ)()],s.prototype,"interactive",void 0),(0,r._)([(0,c.MZ)({type:C})],s.prototype,"interactionOptions",void 0),(0,r._)([(0,c.MZ)()],s.prototype,"selectedElement",void 0),s=(0,r._)([(0,d.$)("esri.views.layers.MediaLayerView")],s),s};var Ee=e(34150);let D=class extends((0,fe.e)(ge(ue.A))){constructor(){super(...arguments),this._overlayContainer=null,this._fetchQueue=null,this._tileStrategy=null,this._elementReferences=new Map,this._debugGraphicsView=null,this._interaction=null,this.layer=null,this.elements=new A.A}initialize(){var t=this;this.addHandles([(0,o.wB)(()=>[this.interactive,this.suspended],(0,f.A)(function*(){if(t.interactive&&!t._interaction){const{MediaLayerInteraction:s}=yield e.e(930).then(e.bind(e,40930));t._interaction=new s({view:t.view,layer:t.layer}),t.selectedElement!==t._interaction.selectedElement&&(t._interaction.selectedElement=t.selectedElement),t.interactionOptions!==t._interaction.options&&(t._interaction.options=t.interactionOptions)}t._interaction&&(t._interaction.enabled=!t.suspended&&t.interactive)}),o.pc),(0,o.wB)(()=>this.interactionOptions,s=>{this._interaction&&(this._interaction.options=s)},o.pc),(0,o.wB)(()=>this.selectedElement,s=>{this._interaction&&(this._interaction.selectedElement=s)},o.pc)])}attach(){this.addAttachHandles([(0,o.on)(()=>this.layer.effectiveSource,"refresh",()=>{this._tileStrategy.refresh(t=>this._updateTile(t)),this.requestUpdate()}),(0,o.on)(()=>this.layer.effectiveSource,"change",({element:t})=>this._elementUpdateHandler(t))]),this._overlayContainer=new ye.A,this.container.addChild(this._overlayContainer),this._fetchQueue=new ee.A({tileInfoView:this.view.featuresTilingScheme,concurrency:10,process:(t,s)=>this._queryElements(t,s),scheduler:this.scheduler,priority:Ee.W6.MAPVIEW_FETCH_QUEUE}),this._tileStrategy=new te.A({cachePolicy:"purge",resampling:!0,acquireTile:t=>this._acquireTile(t),releaseTile:t=>this._releaseTile(t),tileInfoView:this.view.featuresTilingScheme}),this.requestUpdate()}detach(){this.elements.removeAll(),this._tileStrategy.destroy(),this._fetchQueue.destroy(),this._overlayContainer.removeAllChildren(),this.container.removeAllChildren(),this._elementReferences.clear(),this._debugGraphicsView?.destroy()}supportsSpatialReference(t){return!0}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}update(t){this._tileStrategy.update(t),this._debugGraphicsView?.update(t)}hitTest(t,s){var n=this;return(0,f.A)(function*(){const i=[],l=t.normalize(),m=[l.x,l.y];for(const{elementView:{normalizedCoords:a,element:y}}of n._elementReferences.values())null!=a&&(0,v.t1)(a.rings,m)&&i.push({type:"media",element:y,layer:n.layer,mapPoint:t,sourcePoint:y.toSource(t)});return i.reverse()})()}canResume(){return null!=this.layer.source&&super.canResume()}doRefresh(){var t=this;return(0,f.A)(function*(){t._fetchQueue.reset(),t._tileStrategy.refresh(s=>t._updateTile(s))})()}_acquireTile(t){const s=new Me(t.clone());return this._updateTile(s),s}_updateTile(t){this._updatingHandles.addPromise(this._fetchQueue.push(t.key).then(s=>{const[n,i]=t.setElements(s);this._referenceElements(t,n),this._dereferenceElements(t,i),this.requestUpdate()},s=>{(0,V.zf)(s)||M.A.getLogger(this).error(s)}))}_releaseTile(t){this._fetchQueue.abort(t.key.id),t.elements&&this._dereferenceElements(t,t.elements),this.requestUpdate()}_queryElements(t,s){var n=this;return(0,f.A)(function*(){const i=n.layer.effectiveSource;if(null==i)return[];n.view.featuresTilingScheme.getTileBounds(g,t,!0);const l=new Z.A({xmin:g[0],ymin:g[1],xmax:g[2],ymax:g[3],spatialReference:n.view.spatialReference});return i.queryElements(l,s)})()}_referenceElements(t,s){if(null!=this.layer.source)for(const n of s)this._referenceElement(t,n)}_referenceElement(t,s){(0,u.tE)(this._elementReferences,s.uid,()=>{const n=new B._({element:s,spatialReference:this.view.spatialReference}),i=new ce(n);return this._overlayContainer.addChild(i),this.elements.add(s),this._updatingHandles.addPromise(s.load().catch(l=>{M.A.getLogger("esri.views.2d.layers.MediaLayerView2D").error(new S.A("element-load-error","Element cannot be displayed",{element:s,error:l}))})),{debugGraphic:null,elementView:n,overlay:i,tiles:new Set}}).tiles.add(t)}_dereferenceElements(t,s){for(const n of s)this._dereferenceElement(t,n)}_dereferenceElement(t,s){const n=this._elementReferences.get(s.uid);n.tiles.delete(t),n.tiles.size||(this._overlayContainer.removeChild(n.overlay),n.overlay.destroy(),n.elementView.destroy(),this._elementReferences.delete(s.uid),this.elements.remove(s),this._debugGraphicsView?.graphics.remove(n.debugGraphic))}_elementUpdateHandler(t){let s=this._elementReferences.get(t.uid);if(s){const i=s.elementView.normalizedCoords;if(null==i)return this._overlayContainer.removeChild(s.overlay),s.overlay.destroy(),s.elementView.destroy(),this._elementReferences.delete(t.uid),this.elements.remove(t),void this._debugGraphicsView?.graphics.remove(s.debugGraphic);const l=[],m=[];for(const a of this._tileStrategy.tiles){const y=X(this.view.featuresTilingScheme,a,i);s.tiles.has(a)?y||m.push(a):y&&l.push(a)}for(const a of l)this._referenceElement(a,t);for(const a of m)this._dereferenceElement(a,t);return s=this._elementReferences.get(t.uid),void(s?.debugGraphic&&(s.debugGraphic.geometry=s.elementView.normalizedCoords,this._debugGraphicsView.graphicUpdateHandler({graphic:s.debugGraphic,property:"geometry"})))}const n=new B._({element:t,spatialReference:this.view.spatialReference}).normalizedCoords;if(null!=n)for(const i of this._tileStrategy.tiles)X(this.view.featuresTilingScheme,i,n)&&this._referenceElement(i,t)}};(0,r._)([(0,c.MZ)()],D.prototype,"layer",void 0),(0,r._)([(0,c.MZ)({readOnly:!0})],D.prototype,"elements",void 0),D=(0,r._)([(0,d.$)("esri.views.2d.layers.MediaLayerView2D")],D);const g=(0,h.vt)(),W={xmin:0,ymin:0,xmax:0,ymax:0};function X(t,s,n){return t.getTileBounds(g,s.key,!0),W.xmin=g[0],W.ymin=g[1],W.xmax=g[2],W.ymax=g[3],(0,p.fA)(W,n)}class Me{constructor(s){this.key=s,this.elements=null,this.isReady=!1,this.visible=!0}setElements(s){const n=[],i=new Set(this.elements);this.elements=s;for(const l of s)i.has(l)?i.delete(l):n.push(l);return this.isReady=!0,[n,Array.from(i)]}destroy(){}}const pe=D}}]);