"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[7829,8860,5204,6598],{33087:(fe,X,i)=>{i.d(X,{q:()=>M});var P=i(60611);class M{constructor(v,N){this._storage=new P.F,this.id="",this.name="",this.size=0,this._storage.maxSize=v,this._storage.register(this),N&&this._storage.registerRemoveFunc("",N)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(v,N,K=1){this._storage.put(this,v,N,K,1)}pop(v){return this._storage.pop(this,v)}get(v){return this._storage.get(this,v)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(v){this._storage.maxSize=v}resetHitRate(){}}},60611:(fe,X,i)=>{i.d(X,{F:()=>K,Ti:()=>M});var P=i(12438);const M=-3,Y=M-1;var v,G;(G=v||(v={}))[G.ALL=0]="ALL",G[G.SOME=1]="SOME";class K{get size(){return this._size}constructor(I=10485760){this._maxSize=I,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new P.A,this._users=new P.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear()}register(I){this._users.push(I)}deregister(I){this._users.removeUnordered(I)}registerRemoveFunc(I,g){this._removeFuncs.push([I,g])}deregisterRemoveFunc(I){this._removeFuncs.filterInPlace(g=>g[0]!==I)}get maxSize(){return this._maxSize}set maxSize(I){this._maxSize=Math.max(I,-1),this._checkSize()}getSize(I,g){return this._db.get(I.id+g)?.size??0}put(I,g,h,L,z){const F=this._db.get(g=I.id+g);if(F&&(this._size-=F.size,I.size-=F.size,this._db.delete(g),F.entry!==h&&this._notifyRemove(g,F.entry,F.size,v.ALL)),L>this._maxSize)return void this._notifyRemove(g,h,L,v.ALL);if(void 0===h)return void console.warn("Refusing to cache undefined entry ");if(!L||L<0)return console.warn(`Refusing to cache entry with size ${L} for key ${g}`),void this._notifyRemove(g,h,0,v.ALL);const k=1+Math.max(z,Y)-M;this._db.set(g,new J(h,L,k)),this._size+=L,I.size+=L,this._checkSize()}updateSize(I,g,h,L){const z=this._db.get(g=I.id+g);if(z&&z.entry===h){for(this._size-=z.size,I.size-=z.size;L>this._maxSize;){const F=this._notifyRemove(g,h,L,v.SOME);if(!(null!=F&&F>0))return void this._db.delete(g);L=F}z.size=L,this._size+=L,I.size+=L,this._checkSize()}}pop(I,g){const h=this._db.get(g=I.id+g);if(h)return this._size-=h.size,I.size-=h.size,this._db.delete(g),++this._hit,h.entry;++this._miss}get(I,g){const h=this._db.get(g=I.id+g);if(void 0!==h)return this._db.delete(g),h.lives=h.lifetime,this._db.set(g,h),++this._hit,h.entry;++this._miss}peek(I,g){const h=this._db.get(I.id+g);return h?++this._hit:++this._miss,h?.entry}get performanceInfo(){const I={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},g={},h=new Array;this._db.forEach((F,k)=>{const w=F.lifetime;h[w]=(h[w]||0)+F.size,this._users.forAll(l=>{const{id:d,name:b}=l;k.startsWith(d)&&(g[b]=(g[b]||0)+F.size)})});const L={};this._users.forAll(F=>{const k=F.name;"hitRate"in F&&"number"==typeof F.hitRate&&!isNaN(F.hitRate)&&F.hitRate>0?(g[k]=g[k]||0,L[k]=Math.round(100*F.hitRate)+"%"):L[k]="0%"});const z=Object.keys(g);z.sort((F,k)=>g[k]-g[F]),z.forEach(F=>I[F]=Math.round(g[F]/2**20)+"MB / "+L[F]);for(let F=h.length-1;F>=0;--F){const k=h[F];k&&(I["Priority "+(F+M-1)]=Math.round(k/this._size*100)+"%")}return I}resetStats(){this._hit=this._miss=0,this._users.forAll(I=>I.resetHitRate())}clear(I){const g=I.id;this._db.forEach((h,L)=>{L.startsWith(g)&&(this._size-=h.size,this._db.delete(L),this._notifyRemove(L,h.entry,h.size,v.ALL))}),I.size=0}clearAll(){this._db.forEach((I,g)=>this._notifyRemove(g,I.entry,I.size,v.ALL)),this._users.forAll(I=>I.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(I,g,h,L){let z;return this._removeFuncs.some(F=>{if(I.startsWith(F[0])){const k=F[1](g,L,h);return"number"==typeof k&&(z=k),!0}return!1}),z}_checkSize(){this._users.forAll(I=>this._checkSizeLimits(I)),this._checkSizeLimits()}_checkSizeLimits(I){const g=I??this;if(g.maxSize<0||g.size<=g.maxSize)return;const h=I?.id;let L=!0;for(;L;){L=!1;for(const[z,F]of this._db)if(0===F.lifetime&&(!h||z.startsWith(h))){if(this._purgeItem(z,F,I),g.size<=.9*g.maxSize)return;L||=this._db.has(z)}}for(const[z,F]of this._db)if((!h||z.startsWith(h))&&(this._purgeItem(z,F,I),g.size<=.9*g.maxSize))return}_purgeItem(I,g,h=this._users.find(L=>I.startsWith(L.id))){if(this._db.delete(I),g.lives<=1){this._size-=g.size,h&&(h.size-=g.size);const L=this._notifyRemove(I,g.entry,g.size,v.SOME);null!=L&&L>0&&(this._size+=L,h&&(h.size+=L),g.lives=g.lifetime,g.size=L,this._db.set(I,g))}else--g.lives,this._db.set(I,g)}}class J{constructor(I,g,h){this.entry=I,this.size=g,this.lifetime=h,this.lives=h}}},29430:(fe,X,i)=>{i.d(X,{$:()=>U,IB:()=>Q,Iy:()=>q,N2:()=>H,QP:()=>xe,RH:()=>re,Vl:()=>Be,Ws:()=>te,ZD:()=>ne,_L:()=>Ue,bJ:()=>he,e$:()=>Ee,f6:()=>Z,pW:()=>_e,pf:()=>Re});var P=i(68677),M=i(89952),Y=i(77806),K=(i(69287),i(53781),i(89141));function Q(c){return"r"in c&&"g"in c&&"b"in c}function J(c){return"h"in c&&"s"in c&&"v"in c}function G(c){return"l"in c&&"a"in c&&"b"in c}function I(c){return"l"in c&&"c"in c&&"h"in c}const h=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],L=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function z(c,j){const n=[];let m,S;if(c[0].length!==j.length)throw new Error("dimensions do not match");const R=c.length,W=c[0].length;let B=0;for(m=0;m<R;m++){for(B=0,S=0;S<W;S++)B+=c[m][S]*j[S];n.push(B)}return n}function F(c){const j=[c.r/255,c.g/255,c.b/255].map(m=>m<=.04045?m/12.92:((m+.055)/1.055)**2.4),n=z(h,j);return{x:100*n[0],y:100*n[1],z:100*n[2]}}function k(c){const j=z(L,[c.x/100,c.y/100,c.z/100]).map(n=>Math.min(1,Math.max(n<=.0031308?12.92*n:1.055*n**.4166666666666667-.055,0)));return{r:Math.round(255*j[0]),g:Math.round(255*j[1]),b:Math.round(255*j[2])}}function w(c){const j=[c.x/95.047,c.y/100,c.z/108.883].map(n=>n>.008856451679035631?n**.3333333333333333:7.787037037037035*n+.13793103448275862);return{l:116*j[1]-16,a:500*(j[0]-j[1]),b:200*(j[1]-j[2])}}function l(c){const j=c.l,n=[(j+16)/116+c.a/500,(j+16)/116,(j+16)/116-c.b/200].map(m=>m>6/29?m**3:3*(6/29)**2*(m-4/29));return{x:95.047*n[0],y:100*n[1],z:108.883*n[2]}}function U(c){return Q(c)?c:I(c)?function f(c){return k(l(function b(c){const n=c.c,m=c.h;return{l:c.l,a:n*Math.cos(m),b:n*Math.sin(m)}}(c)))}(c):G(c)?function T(c){return k(l(c))}(c):function g(c){return"x"in c&&"y"in c&&"z"in c}(c)?k(c):J(c)?function C(c){const j=(c.h+360)%360/60,m=c.v/100*255,S=m*(c.s/100),R=S*(1-Math.abs(j%2-1));let W;switch(Math.floor(j)){case 0:W={r:S,g:R,b:0};break;case 1:W={r:R,g:S,b:0};break;case 2:W={r:0,g:S,b:R};break;case 3:W={r:0,g:R,b:S};break;case 4:W={r:R,g:0,b:S};break;case 5:case 6:W={r:S,g:0,b:R};break;default:W={r:0,g:0,b:0}}return W.r=Math.round(W.r+m-S),W.g=Math.round(W.g+m-S),W.b=Math.round(W.b+m-S),W}(c):c}function H(c){return J(c)?c:function D(c){const j=c.r,n=c.g,m=c.b,S=Math.max(j,n,m),R=S-Math.min(j,n,m);let W=S,B=0===R?0:S===j?(n-m)/R%6:S===n?(m-j)/R+2:(j-n)/R+4,ye=0===R?0:R/W;return B<0&&(B+=6),B*=60,ye*=100,W*=100/255,{h:B,s:ye,v:W}}(U(c))}function ne(c){return G(c)?c:function _(c){return w(F(c))}(U(c))}function re(c){return I(c)?c:function A(c){return function d(c){const j=c.l,n=c.a,m=c.b,S=Math.sqrt(n*n+m*m);let R=Math.atan2(m,n);return R=R>0?R:R+2*Math.PI,{l:j,c:S,h:R}}(w(F(c)))}(U(c))}function te(c,j){const{r:n,g:m,b:S}=j?.ignoreAlpha?c:function ae(c){let{r:j,g:n,b:m,a:S}=c;return S<1&&(j=Math.round(S*j+255*(1-S)),n=Math.round(S*n+255*(1-S)),m=Math.round(S*m+255*(1-S))),new P.A({r:j,g:n,b:m})}(c);return.2126*n+.7152*m+.0722*S}var _e,c;function he(c,j=_e.High){return te(c,{ignoreAlpha:!0})>j?new P.A([0,0,0,c.a]):new P.A([255,255,255,c.a])}function Ee(c,j){const n=ne(c);n.l*=1-j;const m=U(n),S=c.clone();return S.setColor(m),S.a=c.a,S}function Ue(c,j){const n=c.clone();return n.a*=j,n}function Be(c,j){const n=H(c);n.s*=j;const m=U(n),S=c.clone();return S.setColor(m),S.a=c.a,S}function xe(c){return P.A.toUnitRGBA(c)}function Re(c){return(0,K.fA)(c[0],c[1],c[2],c.length>3?c[3]:1)}function Z(c,j){const n=P.A.toUnitRGBA(c);return n[3]*=j,n}function q(c,j,n={}){if(0===c.length||j<=0)return[];if(1===(c=c.map(m=>"string"==typeof m?new P.A(m):m)).length||1===j){const m=[],S=c[0];for(let R=0;R<j;R++)m.push(S.clone());return m}if(n.shuffle&&(c=(0,M.k4)((0,Y.o8)(c),n.seed)),c.length>=j){const m=[],S=(c.length-1)/(j-1);for(let R=0;R<j;R++){const W=Math.round(R*S);m.push(c[W].clone())}return m}return function se(c,j,n={}){const m=[],S=c.length-1,R=Math.ceil((j-c.length)/S);e:for(let W=0;W<S;W++){const B=c[W],ye=c[W+1];for(let ie=1;ie<=R;ie++)if(m.push(Se(B,ye,ie/(R+1),n)),m.length+c.length===j)break e}return[...c.map(W=>W.clone()),...(0,M.k4)(m,n.seed??1)]}(c,j,n)}(c=_e||(_e={}))[c.Low=160]="Low",c[c.High=225]="High";const oe=(c,j)=>{const n=Math.floor(10*j())-5;return Math.min(255,Math.max(0,c+n))};function Se(c,j,n,m={}){const S=c.r,R=c.g,W=c.b,ye=j.g,ie=j.b,Me=Math.round(S+(j.r-S)*n),ge=Math.round(R+(ye-R)*n),Ae=Math.round(W+(ie-W)*n);if(!m.offset)return new P.A([Me,ge,Ae]);const pe=(0,M.Mo)(m.seed);return new P.A([oe(Me,pe),oe(ge,pe),oe(Ae,pe)])}},46062:(fe,X,i)=>{i.r(X),i.d(X,{default:()=>ut});var P=i(10467),M=i(8189),Y=i(90660),v=i(31178),N=i(5922),K=i(4879),Q=i(39693),J=i(56492),G=i(48900),I=i(63484),g=i(45272),h=i(85211),z=(i(3248),i(35150)),k=(i(40707),i(17221)),w=i(76576),l=i(95478),d=i(94376),b=i(25936),_=i(93410),T=i(23e3),A=i(73955),f=i(58277),D=i(29674),C=i(17049),U=i(85551),H=i(1151),ne=i(33036),re=i(84311),ce=i(68438),ae=i(22329),te=i(47516),_e=i(3404),he=i(86300),Ee=i(29430),Ue=i(71224),Be=i(79122),xe=i(38582),Fe=i(73747),Ne=i(13318),Re=i(76926),E=i(83393);const x={key:"type",base:xe.A,errorContext:"renderer",typeMap:{simple:Fe.A,"unique-value":Ne.A,"class-breaks":Be.A}},Z=(0,Ue.C)({types:x}),se=["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"];var Se=i(92165),c=i(3046),j=i(77806),n=i(55098),m=i(11432),S=i(89221),R=i(50305),W=i(50501),B=i(8297),ye=i(32034),ie=i(69741),Me=i(54947),ge=i(73975),Ae=i(85791),pe=i(87086),ve=i(41843),Le=i(91644),Ce=i(48290);const we=(0,_e.p)();let We=0;function Te(a,p){let y=a.json.write;return"object"!=typeof y&&(y=a.json.write={}),y.ignoreOrigin=!0,p?.spatialOnly&&(y.layerContainerTypes=W.K),a}function be(a){const p={write:{ignoreOrigin:!0}};return a?.name&&(p.name=a.name),"object"==typeof p.write&&(a?.spatialOnly&&(p.write.layerContainerTypes=W.K),a?.target&&(p.write.target=a.target)),p}function Ze(a){switch(a){case"point":case"multipoint":return Le.UK.clone();case"polyline":return Le.A7.clone();case"polygon":case"multipatch":return Le.Cx.clone();default:return null}}function je(a,p){return null==a?null:p.subtypes?.find(y=>y.code===a)}function Je(a,p){let y=null;switch(p.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":y="point";break;case"esriGeometryPolyline":y="line";break;case"esriGeometryPolygon":case"esriGeometryMultiPatch":y="polygon";break;default:y=null}const O={},V=je(a,p);if(null!=V){const{defaultValues:ee}=V;for(const ue in ee)O[ue]=ee[ue]}return O[p.subtypeField]=a,new ie.A({name:"New Feature",drawingTool:y,prototype:{attributes:O}})}let $=class extends((0,Q.P)(Y.A.ClonableMixin(c.A.IdentifiableMixin(n.A)))){constructor(a){super(a),this.attributeTableTemplate=null,this.charts=null,this.editingEnabled=!0,this.fieldOverrides=null,this.fieldsIndex=null,this.formTemplate=null,this.id=`${Date.now().toString(16)}-subtype-sublayer-${We++}`,this.type="subtype-sublayer",this.labelsVisible=!0,this.labelingInfo=null,this.layerType="ArcGISFeatureLayer",this.legendEnabled=!0,this.listMode="show",this.minScale=0,this.maxScale=0,this.opacity=1,this.parent=null,this.popupEnabled=!0,this.popupTemplate=null,this.subtypeCode=null,this.templates=null,this.title=null,this.visible=!0}load(a){return(0,he.yp)(this.renderer,this.fieldsIndex),Promise.resolve(this)}get _titleCreator(){const a=this._get("_titleCreator");return(0,m.pR)(a),new Ae.A({fieldsIndex:this.fieldsIndex,objectIdField:this.objectIdField,displayField:this.parent?.displayField??"",fields:this.fields,effectivePopupTemplate:this.popupTemplate??this.defaultPopupTemplate})}get capabilities(){return this.parent?.capabilities}get effectiveCapabilities(){return this.parent?.effectiveCapabilities}get effectiveEditingEnabled(){const{parent:a}=this;return a?a.effectiveEditingEnabled&&this.editingEnabled:this.editingEnabled}get elevationInfo(){return this.parent?.elevationInfo}get featureTitleFields(){return[...this._titleCreator.requiredFields]}writeFieldOverrides(a,p,y){const{fields:O,parent:V}=this;let ee;if(O){ee=[];let ue=0;O.forEach(({name:me,alias:Pe,editable:Qe,visible:He})=>{if(!He)return;const Oe=V?.fields?.find(tt=>tt.name===me);if(!Oe)return;const ze={name:me};let ke=!1;Pe!==Oe.alias&&(ze.alias=Pe,ke=!0),Qe!==Oe.editable&&(ze.editable=Qe,ke=!0),ee.push(ze),ke&&ue++}),0===ue&&ee.length===O.length&&(ee=null)}else ee=(0,j.o8)(a);ee?.length&&(0,S.sM)(y,ee,p)}get fields(){const{parent:a,fieldOverrides:p,subtypeCode:y}=this,O=a?.fields;if(!a||!O?.length)return null;const{subtypes:V,subtypeField:ee}=a,ue=V?.find(He=>He.code===y),me=ue?.defaultValues,Pe=ue?.domains,Qe=[];for(const He of O){const Oe=He.clone(),{name:ze}=Oe,ke=p?.find(Ye=>Ye.name===ze);if(Oe.visible=!p?.length||!!ke,ke){const{alias:Ye,editable:ct}=ke;Ye&&(Oe.alias=Ye),!1===ct&&(Oe.editable=!1)}Oe.defaultValue=ze===ee?y:me?.[ze]??null;const rt=Pe?.[ze]??null;Oe.domain=ze===ee?null:rt?"inherited"===rt.type?Oe.domain:rt.clone():null,Qe.push(Oe)}return Qe}get floorInfo(){return this.parent?.floorInfo}get isTable(){return!!this.parent?.isTable}get geometryType(){return this.parent?.geometryType}get globalIdField(){return this.parent?this.parent.globalIdField:(z.A.getLogger(this).error(le("globalIdField")),null)}get effectiveScaleRange(){const{minScale:a,maxScale:p}=this;return{minScale:a,maxScale:p}}get objectIdField(){return this.parent||z.A.getLogger(this).error(le("objectIdField")),this.parent?.objectIdField}get defaultPopupTemplate(){return this.createPopupTemplate()}get relationships(){return this.parent?.relationships}set renderer(a){(0,he.yp)(a,this.fieldsIndex),this._override("renderer",a)}get renderer(){if(this._isOverridden("renderer"))return this._get("renderer");const{parent:a}=this;return a&&!a.isTable&&"mesh"!==a.geometryType?function Ge(a){return new Fe.A({symbol:Ze(a)})}(a.geometryType):null}readRendererFromService(a,p,y){if("Table"===p.type)return null;const O=p.drawingInfo?.renderer,V=Z(O,p,y);let ee;const{subtypeCode:ue}=this;if(null!=ue&&function $e(a,p){return!(!p||"unique-value"!==a?.type||null==a.field||a.field.toLowerCase()!==p.toLowerCase()||a.field2||a.field3||a.valueExpression)}(V,p.subtypeField)){const me=V.uniqueValueInfos?.find(({value:Pe})=>(Pe="number"==typeof Pe?String(Pe):Pe)===String(ue));me&&(ee=new Fe.A({symbol:me.symbol}))}else"simple"!==V?.type||V.visualVariables?.length||(ee=V);return ee}readRenderer(a,p,y){const O=p?.layerDefinition?.drawingInfo?.renderer;return O?O.visualVariables?.some(ee=>"rotationInfo"!==ee.type)?void 0:Z(O,p,y)||void 0:void 0}get spatialReference(){return this.parent?.spatialReference??ye.A.WGS84}get subtypeField(){return this.parent?.subtypeField}readTemplatesFromService(a,p){return[Je(this.subtypeCode,p)]}readTitleFromService(a,p){const y=je(this.subtypeCode,p);return null!=y?y.name:null}get url(){return this.parent?.url}get userHasUpdateItemPrivileges(){return!!this.parent?.userHasUpdateItemPrivileges}addAttachment(a,p){var y=this;return(0,P.A)(function*(){const{parent:O}=y;if(!O)throw le("addAttachment");if(a.getAttribute(O.subtypeField)!==y.subtypeCode)throw new N.A("subtype-sublayer:addAttachment","The feature provided does not belong to this SubtypeSublayer");return O.addAttachment(a,p)})()}updateAttachment(a,p,y){var O=this;return(0,P.A)(function*(){const{parent:V}=O;if(!V)throw le("updateAttachment");if(a.getAttribute(V.subtypeField)!==O.subtypeCode)throw new N.A("subtype-sublayer:updateAttachment","The feature provided does not belong to this SubtypeSublayer");return V.updateAttachment(a,p,y)})()}deleteAttachments(a,p){var y=this;return(0,P.A)(function*(){const{parent:O}=y;if(!O)throw le("deleteAttachments");if(a.getAttribute(O.subtypeField)!==y.subtypeCode)throw new N.A("subtype-sublayer:deleteAttachments","The feature provided does not belong to this SubtypeSublayer");return O.deleteAttachments(a,p)})()}applyEdits(a,p){var y=this;return(0,P.A)(function*(){if(!y.parent)throw le("applyEdits");return y.parent.applyEdits(a,p)})()}createPopupTemplate(a){let p=this;const{parent:y,fields:O,title:V}=this;if(y){const{displayField:ee,editFieldsInfo:ue,objectIdField:me}=y;p={displayField:ee,editFieldsInfo:ue,fields:O,objectIdField:me,title:V}}return(0,ve.tn)(p,a)}createQuery(){if(!this.parent)throw le("createQuery");const a=(0,te.VZ)(this.parent);return a.where=(0,I.mA)(`${this.parent.subtypeField}=${this.subtypeCode}`,this.parent.definitionExpression),a}getFeatureTitle(a,p={timeZone:"system",fetchMissingFields:!1}){return this._titleCreator.getTitle(this,a,p)}getField(a){return this.fieldsIndex.get(a)}getFieldDomain(a,p){if(!p?.excludeImpliedDomains&&this.parent){const y=(0,te.pc)(this.parent,a);if(y)return y}return this._getLayerDomain(a)}queryAttachments(a,p){var y=this;return(0,P.A)(function*(){const O=yield y.load();if(!O.parent)throw le("queryAttachments");const V=a.clone();return V.where=Ke(V.where,O.parent.subtypeField,O.subtypeCode),O.parent.queryAttachments(a,p)})()}queryFeatureCount(a,p){var y=this;return(0,P.A)(function*(){const O=yield y.load();if(!O.parent)throw le("queryFeatureCount");return O.parent.queryFeatureCount(Ve(O.parent,O,a),p)})()}queryFeatures(a,p){var y=this;return(0,P.A)(function*(){const O=yield y.load();if(!O.parent)throw le("queryFeatures");return O.parent.queryFeatures(Ve(O.parent,O,a),p)})()}queryObjectIds(a,p){var y=this;return(0,P.A)(function*(){const O=yield y.load();if(!O.parent)throw le("queryObjectIds");return O.parent.queryObjectIds(Ve(O.parent,O,a),p)})()}queryRelatedFeatures(a,p){var y=this;return(0,P.A)(function*(){const O=yield y.load();if(!O.parent)throw le("queryRelatedFeatures");return O.parent.queryRelatedFeatures(a,p)})()}queryRelatedFeaturesCount(a,p){var y=this;return(0,P.A)(function*(){const O=yield y.load();if(!O.parent)throw le("queryRelatedFeaturesCount");return O.parent.queryRelatedFeaturesCount(a,p)})()}_getLayerDomain(a){const p=this.fieldsIndex.get(a);return p?p.domain:null}};(0,M._)([(0,h.MZ)({clonable:!1,readOnly:!0})],$.prototype,"_titleCreator",null),(0,M._)([(0,h.MZ)({type:Ce.A,json:be({name:"attributeTableInfo"})})],$.prototype,"attributeTableTemplate",void 0),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"capabilities",null),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"effectiveCapabilities",null),(0,M._)([(0,h.MZ)({json:be()})],$.prototype,"charts",void 0),(0,M._)([(0,h.MZ)({type:Boolean,nonNullable:!0,json:be({name:"enableEditing"})})],$.prototype,"editingEnabled",void 0),(0,M._)([(0,h.MZ)({type:Boolean,readOnly:!0})],$.prototype,"effectiveEditingEnabled",null),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"elevationInfo",null),(0,M._)([(0,h.MZ)({clonable:!1,readOnly:!0})],$.prototype,"featureTitleFields",null),(0,M._)([(0,h.MZ)({json:{name:"layerDefinition.fieldOverrides",origins:{service:{read:!1}},write:{ignoreOrigin:!0,allowNull:!0}}})],$.prototype,"fieldOverrides",void 0),(0,M._)([(0,R.K)("fieldOverrides")],$.prototype,"writeFieldOverrides",null),(0,M._)([(0,h.MZ)({...we.fields,readOnly:!0,json:{read:!1}})],$.prototype,"fields",null),(0,M._)([(0,h.MZ)(we.fieldsIndex)],$.prototype,"fieldsIndex",void 0),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"floorInfo",null),(0,M._)([(0,h.MZ)({type:B.A,json:be({name:"formInfo"})})],$.prototype,"formTemplate",void 0),(0,M._)([(0,h.MZ)({type:String,clonable:!1,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],$.prototype,"id",void 0),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"isTable",null),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"geometryType",null),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"globalIdField",null),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"type",void 0),(0,M._)([(0,h.MZ)(Te((0,j.o8)(ae.kF)))],$.prototype,"labelsVisible",void 0),(0,M._)([(0,h.MZ)({type:[Me.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",origins:{service:{read:!1}},read:{reader:ge.w},write:{ignoreOrigin:!0,layerContainerTypes:W.K}}})],$.prototype,"labelingInfo",void 0),(0,M._)([(0,h.MZ)({type:["ArcGISFeatureLayer"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,layerContainerTypes:W.K}}})],$.prototype,"layerType",void 0),(0,M._)([(0,h.MZ)(Te((0,j.o8)(ae.fV)))],$.prototype,"legendEnabled",void 0),(0,M._)([(0,h.MZ)({type:["show","hide"]})],$.prototype,"listMode",void 0),(0,M._)([(0,h.MZ)((()=>{const a=(0,j.o8)(ae.hn);return a.json.origins.service.read=!1,Te(a,{spatialOnly:!0})})())],$.prototype,"minScale",void 0),(0,M._)([(0,h.MZ)((()=>{const a=(0,j.o8)(ae.hG);return a.json.origins.service.read=!1,Te(a,{spatialOnly:!0})})())],$.prototype,"maxScale",void 0),(0,M._)([(0,h.MZ)({readOnly:!0})],$.prototype,"effectiveScaleRange",null),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"objectIdField",null),(0,M._)([(0,h.MZ)({type:Number,range:{min:0,max:1},nonNullable:!0,json:be({spatialOnly:!0})})],$.prototype,"opacity",void 0),(0,M._)([(0,h.MZ)({clonable:!1})],$.prototype,"parent",void 0),(0,M._)([(0,h.MZ)(Te((0,j.o8)(ae.M6)))],$.prototype,"popupEnabled",void 0),(0,M._)([(0,h.MZ)({type:Se.A,json:be({name:"popupInfo"})})],$.prototype,"popupTemplate",void 0),(0,M._)([(0,h.MZ)({readOnly:!0})],$.prototype,"defaultPopupTemplate",null),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"relationships",null),(0,M._)([(0,h.MZ)({types:x,json:be({target:"layerDefinition.drawingInfo.renderer",spatialOnly:!0})})],$.prototype,"renderer",null),(0,M._)([(0,k.w)("service","renderer",["drawingInfo.renderer","subtypeField","type"])],$.prototype,"readRendererFromService",null),(0,M._)([(0,k.w)("renderer",["layerDefinition.drawingInfo.renderer"])],$.prototype,"readRenderer",null),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"spatialReference",null),(0,M._)([(0,h.MZ)({type:Number,json:{origins:{service:{read:!1}},write:{ignoreOrigin:!0}}})],$.prototype,"subtypeCode",void 0),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"subtypeField",null),(0,M._)([(0,h.MZ)({type:[ie.A],json:be({name:"layerDefinition.templates"})})],$.prototype,"templates",void 0),(0,M._)([(0,k.w)("service","templates",["geometryType","subtypeField","subtypes","type"])],$.prototype,"readTemplatesFromService",null),(0,M._)([(0,h.MZ)({type:String,json:be()})],$.prototype,"title",void 0),(0,M._)([(0,k.w)("service","title",["subtypes"])],$.prototype,"readTitleFromService",null),(0,M._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],$.prototype,"url",null),(0,M._)([(0,h.MZ)({readOnly:!0})],$.prototype,"userHasUpdateItemPrivileges",null),(0,M._)([(0,h.MZ)({type:Boolean,nonNullable:!0,json:be({name:"visibility",spatialOnly:!0})})],$.prototype,"visible",void 0),$=(0,M._)([(0,w.$)("esri.layers.support.SubtypeSublayer")],$);const Ve=(a,p,y)=>{if(!y)return p.createQuery();const O=pe.A.from(y);return O.where=Ke(O.where,a.subtypeField,p.subtypeCode),O},Ke=(a,p,y)=>{const O=new RegExp(`${p}\\s*=\\s*\\d+`),V=`${p}=${y}`,ee=a??"";return O.test(ee)?ee.replace(O,V):(0,I.mA)(V,ee)},le=a=>new N.A(`This sublayer must have a parent SubtypeGroupLayer in order to use ${a}`),Ie=$;var ot=i(38488),it=i(5540),at=i(68778),Xe=i(71655);const De="SubtypeGroupLayer";function st(a,p){return new N.A("layer:unsupported",`Layer (${a.title}, ${a.id}) of type '${a.declaredClass}' ${p}`,{layer:a})}function nt(a,p){const y=[];for(const O of a){const V=new Ie;V.read(O,p),y.push(V)}return y}const qe=(0,_e.p)();let de=class extends((0,D.j)((0,A.FJ)((0,f.w6)((0,_.dM)((0,re.e)((0,ne.j)((0,H.J)((0,b.b)((0,C.q)((0,U.A)((0,Q.P)((0,T.d)((0,d.p)(Y.A.ClonableMixin(l.A))))))))))))))){constructor(...a){var p;super(...a),p=this,this._sublayerLookup=new Map,this.fields=null,this.fieldsIndex=null,this.outFields=null,this.sublayers=new(v.A.ofType(Ie)),this.useUniqueColorsForSublayers=!0,this.supportedSourceTypes=new Set(["Feature Layer","Table"]),this.timeInfo=null,this.title="Layer",this.type="subtype-group",this._debouncedSaveOperations=(0,J.sg)(function(){var y=(0,P.A)(function*(O,V,ee){const{save:ue,saveAs:me}=yield i.e(639).then(i.bind(i,90639));switch(O){case Xe.X.SAVE:return ue(p,V);case Xe.X.SAVE_AS:return me(p,ee,V)}});return function(O,V,ee){return y.apply(this,arguments)}}()),this.addHandles((0,G.wB)(()=>this.sublayers,(y,O)=>this._handleSublayersChange(y,O),G.OH))}destroy(){this.source?.destroy()}normalizeCtorArgs(a,p){return"string"==typeof a?{url:a,...p}:a}load(a){var p=this;const y=null!=a?a.signal:null,O=this.loadFromPortal({supportedTypes:["Feature Service"]},a).catch(J.QP).then((0,P.A)(function*(){if(!p.url)throw new N.A("subtype-grouplayer:missing-url-or-source","SubtypeGroupLayer must be created with either a url or a portal item");if(null==p.layerId)throw new N.A("subtype-grouplayer:missing-layerid","layerId is required for a SubtypeGroupLayer created with url");return p._initLayerProperties(yield p.createGraphicsSource(y))})).then(()=>(0,te.VA)(this,"load",a));return this.addResolvingPromise(O),Promise.resolve(this)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){return this.loaded&&null!=this.capabilities&&this.capabilities.operations.supportsEditing&&this.userHasEditingPrivileges}get effectiveEditingEnabled(){return(0,te.C$)(this)}get operationalLayerType(){return this.isTable?"SubtypeGroupTable":"SubtypeGroupLayer"}get parsedUrl(){const a=(0,g.An)(this.url);return null!=a&&null!=this.layerId&&(a.path=(0,g.fj)(a.path,this.layerId.toString())),a}set source(a){this._get("source")!==a&&this._set("source",a)}readTitleFromService(a,{name:p}){return this.url?(0,ce.yG)(this.url,p):p}addAttachment(a,p){var y=this;return(0,P.A)(function*(){const O=yield(0,te.Xl)(y,a,p,De);return y.lastEditsEventDate=new Date,O})()}updateAttachment(a,p,y){var O=this;return(0,P.A)(function*(){const V=yield(0,te.bt)(O,a,p,y,De);return O.lastEditsEventDate=new Date,V})()}applyEdits(a,p){var y=this;return(0,P.A)(function*(){return(0,te.ct)(y,a,p)})()}on(a,p){return super.on(a,p)}createGraphicsSource(a){var p=this;return(0,P.A)(function*(){const{default:y}=yield(0,J.qr)(Promise.all([i.e(1732),i.e(8304),i.e(5931),i.e(8294),i.e(4314)]).then(i.bind(i,28570)),a);return new y({layer:p,supportedSourceTypes:p.supportedSourceTypes}).load({signal:a})})()}createQuery(){const a=(0,te.VZ)(this),p=this.sublayers.map(y=>y.subtypeCode);return a.where=(0,I.mA)(`${this.subtypeField} IN (${p.join(",")})`,this.definitionExpression),a}deleteAttachments(a,p){var y=this;return(0,P.A)(function*(){const O=yield(0,te.mm)(y,a,p,De);return y.lastEditsEventDate=new Date,O})()}fetchRecomputedExtents(a){var p=this;return(0,P.A)(function*(){return(0,te.WP)(p,a,De)})()}findSublayerForFeature(a){const p=this.fieldsIndex.get(this.subtypeField);return this.findSublayerForSubtypeCode(a.attributes[p.name])}findSublayerForSubtypeCode(a){return this._sublayerLookup.get(a)}getFieldDomain(a,p){if(!p?.excludeImpliedDomains){const O=(0,te.pc)(this,a);if(O)return O}const y=(0,te.Nv)(this,p?.feature);if(y){const O=y.domains?.[a];return"inherited"===O?.type?this._getLayerDomain(a):O}return this._getLayerDomain(a)}loadAll(){return(0,K.g)(this,a=>{a(this.sublayers)})}queryAttachments(a,p){var y=this;return(0,P.A)(function*(){return(0,te.lV)(y,a,p,De)})()}queryFeatures(a,p){var y=this;return(0,P.A)(function*(){const O=yield y.load(),V=pe.A.from(a)??O.createQuery(),ee=V.outFields??[];ee.includes(y.subtypeField)||(ee.push(y.subtypeField),V.outFields=ee);const ue=yield O.source.queryFeatures(V,p);if(ue?.features)for(const me of ue.features)me.layer=me.sourceLayer=y.findSublayerForFeature(me);return ue})()}queryObjectIds(a,p){var y=this;return(0,P.A)(function*(){return(yield(0,te.sg)(y,a,p,De)).filter(at.Et)})()}queryFeatureCount(a,p){var y=this;return(0,P.A)(function*(){return(0,te.Ye)(y,a,p,De)})()}queryExtent(a,p){var y=this;return(0,P.A)(function*(){return(0,te.B5)(y,a,p,De)})()}queryRelatedFeatures(a,p){var y=this;return(0,P.A)(function*(){return(0,te.hM)(y,a,p,De)})()}queryRelatedFeaturesCount(a,p){var y=this;return(0,P.A)(function*(){return(0,te.S2)(y,a,p,De)})()}save(a){var p=this;return(0,P.A)(function*(){return p._debouncedSaveOperations(Xe.X.SAVE,a)})()}saveAs(a,p){var y=this;return(0,P.A)(function*(){return y._debouncedSaveOperations(Xe.X.SAVE_AS,p,a)})()}write(a,p){const{origin:y,layerContainerType:O,messages:V}=p;if(this.isTable){if("web-scene"===y||"web-map"===y&&"tables"!==O)return V?.push(st(this,"using a table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&"web-map"===y&&"tables"===O)return V?.push(st(this,"using a non-table source cannot be written to tables in web maps")),null;return this.sublayers?.length?super.write(a,p):(V?.push(new N.A("web-document-write:invalid-property",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' has invalid value for 'sublayers' property. 'sublayers' collection should contain at least one sublayer`,{layer:this})),null)}serviceSupportsSpatialReference(a){return!!this.loaded&&(0,it.D)(this,a)}getFeatureTitle(a,p={timeZone:"system",fetchMissingFields:!1}){var y=this;return(0,P.A)(function*(){const O=y.findSublayerForFeature(a);return O?yield O.getFeatureTitle(a,p):y.displayField&&y.fieldsIndex.has(y.displayField)?a.attributes[y.fieldsIndex.get(y.displayField).name]??"":y.objectIdField&&y.fieldsIndex.has(y.objectIdField)?a.attributes[y.fieldsIndex.get(y.objectIdField).name]??"":""})()}get featureTitleFields(){const a=new Set;for(const p of this.sublayers){const y=p.featureTitleFields;for(const O of y)a.add(O)}return[...a]}_getLayerDomain(a){const p=this.fieldsIndex.get(a);return p?p.domain:null}_initLayerProperties(a){var p=this;return(0,P.A)(function*(){p._set("source",a);const{sourceJSON:y}=a;if(y&&(p.sourceJSON=y,p.read(y,{origin:"service",url:p.parsedUrl})),!p.subtypes?.length)throw new N.A("subtype-grouplayer:missing-subtypes","SubtypeGroupLayer must be created using a layer with subtypes");p._verifyFields(),(0,he.sv)(p.timeInfo,p.fieldsIndex)})()}hasDataChanged(){var a=this;return(0,P.A)(function*(){return(0,te.jp)(a)})()}_verifyFields(){const a=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("SubtypeGroupLayer: 'objectIdField' property is not defined (url: "+a+")"),this.isTable||-1!==a.search(/\/FeatureServer\//i)||this.fields?.some(p=>"geometry"===p.type)||console.log("SubtypeGroupLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+a+")")}_handleSublayersChange(a,p){p&&(p.forEach(y=>{y.parent=null}),this.removeHandles("sublayers-owner"),this._sublayerLookup.clear()),a&&(a.forEach(y=>{y.parent=this,this._sublayerLookup.set(y.subtypeCode,y)}),this.addHandles([a.on("after-add",({item:y})=>{y.parent=this,this._sublayerLookup.set(y.subtypeCode,y)}),a.on("after-remove",({item:y})=>{y.parent=null,this._sublayerLookup.delete(y.subtypeCode)})],"sublayers-owner"))}};(0,M._)([(0,h.MZ)({readOnly:!0})],de.prototype,"createQueryVersion",null),(0,M._)([(0,h.MZ)({readOnly:!0})],de.prototype,"editingEnabled",null),(0,M._)([(0,h.MZ)({readOnly:!0})],de.prototype,"effectiveEditingEnabled",null),(0,M._)([(0,h.MZ)({...qe.fields,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],de.prototype,"fields",void 0),(0,M._)([(0,h.MZ)(qe.fieldsIndex)],de.prototype,"fieldsIndex",void 0),(0,M._)([(0,h.MZ)(ae.id)],de.prototype,"id",void 0),(0,M._)([(0,h.MZ)({type:["show","hide","hide-children"],json:{origins:{"portal-item":{read:!1,write:!1}}}})],de.prototype,"listMode",void 0),(0,M._)([(0,h.MZ)({type:["SubtypeGroupLayer","SubtypeGroupTable"],json:{name:"layerType",read:{enabled:!0},write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{"web-document":{name:"layerType",read:{enabled:!0},write:{enabled:!0,ignoreOrigin:!0,isRequired:!0}},"portal-item":{name:"layerType",read:{enabled:!0},write:{enabled:!0,ignoreOrigin:!0,isRequired:!0}}}}})],de.prototype,"operationalLayerType",null),(0,M._)([(0,h.MZ)(qe.outFields)],de.prototype,"outFields",void 0),(0,M._)([(0,h.MZ)({readOnly:!0})],de.prototype,"parsedUrl",null),(0,M._)([(0,h.MZ)({clonable:!1})],de.prototype,"source",null),(0,M._)([(0,h.MZ)({type:v.A.ofType(Ie),json:{origins:{service:{read:{source:"subtypes",reader(a,p,y){let O=null;if(this.useUniqueColorsForSublayers){const ee=function q(a,p){const y=a.drawingInfo?.renderer,O=y?Z(y,a,p):null;if("simple"===O?.type)return(0,E.Sx)(O.symbol,null)?O.symbol.clone():null}(p,y);O=ee?function oe(a,p){return(0,Ee.Iy)(se,a,{offset:!0,shuffle:!0}).reverse().map(y=>{const O=p.clone();return"cim"===O.type?(0,Re.Fe)(O,y):(0,E.dt)(O,y),new Fe.A({symbol:O})})}(a.length,ee):null}const V=a.map(({code:ee},ue)=>{const me=new Ie({subtypeCode:ee});me.read(p,y);const Pe=O?.[ue];return Pe&&me.read({drawingInfo:{renderer:Pe.toJSON()}},y),me});return new(v.A.ofType(Ie))(V)}}}},read:{source:["layers","tables"],reader(a,p,y){let O;return"SubtypeGroupLayer"===p.layerType&&p.layers?.length?O=nt(p.layers,y):"SubtypeGroupTable"===p.layerType&&p.tables?.length&&(O=nt(p.tables,y)),new(v.A.ofType(Ie))(O)}},write:{ignoreOrigin:!0,writer(a,p,y,O){const V=[];for(const ee of a){const ue=ee.write({},O);V.push(ue)}this.isTable?p.tables=V:p.layers=V}}}})],de.prototype,"sublayers",void 0),(0,M._)([(0,h.MZ)()],de.prototype,"useUniqueColorsForSublayers",void 0),(0,M._)([(0,h.MZ)({type:ot.A})],de.prototype,"timeInfo",void 0),(0,M._)([(0,h.MZ)({json:{origins:{"portal-item":{write:{enabled:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}}}})],de.prototype,"title",void 0),(0,M._)([(0,k.w)("service","title",["name"])],de.prototype,"readTitleFromService",null),(0,M._)([(0,h.MZ)({json:{read:!1}})],de.prototype,"type",void 0),(0,M._)([(0,h.MZ)({clonable:!1,readOnly:!0})],de.prototype,"featureTitleFields",null),de=(0,M._)([(0,w.$)("esri.layers.SubtypeGroupLayer")],de);const ut=de},94376:(fe,X,i)=>{i.d(X,{p:()=>J});var P=i(8189),M=i(85211),K=(i(3248),i(35150),i(40707),i(76576));const J=G=>{let I=class extends G{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):function Q(G){return"portalItem"in G}(this)?this.portalItem?.apiKey:null}set apiKey(g){null!=g?this._override("apiKey",g):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return(0,P._)([(0,M.MZ)({type:String})],I.prototype,"apiKey",null),I=(0,P._)([(0,K.$)("esri.layers.mixins.APIKeyMixin")],I),I}},73258:(fe,X,i)=>{i.d(X,{A:()=>z});var P=i(5922),M=i(71065),Y=i(35150),v=i(60797),N=i(24098),K=i(86300),Q=i(20543),J=i(22639),G=i(44549);const L=new Map;class z{static fromJSON(b){return new z(b.fields,b.timeZoneByFieldName)}static fromLayer(b){return new z(b.fields??[],l(b))}static fromLayerJSON(b){return new z(b.fields??[],l(b))}constructor(b=[],_){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=b||[],this._timeZoneByFieldName=_?new Map(_):null;const T=[];for(const A of this.fields){const f=A?.name,D=k(f);if(f&&D){const C=F(f);this._fieldsMap.set(f,A),this._fieldsMap.set(C,A),this._normalizedFieldsMap.set(D,A),T.push(`${C}:${A.type}:${this._timeZoneByFieldName?.get(f)}`),(0,K.vE)(A)?(this.dateFields.push(A),this._dateFieldsSet.add(A)):(0,K.WA)(A)&&(this._numericFieldsSet.add(A),this.numericFields.push(A)),(0,K.te)(A)||(0,K.Xz)(A)||(A.editable=null==A.editable||!!A.editable,A.nullable=null==A.nullable||!!A.nullable)}}T.sort(),this.uid=T.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const b of this.fields)(0,K.te)(b)||(0,K.Xz)(b)||b.nullable||void 0!==(0,K.lD)(b)||this._requiredFields.push(b)}return this._requiredFields}equals(b){return this.uid===b?.uid}has(b){return null!=this.get(b)}get(b){if(!b)return;let _=this._fieldsMap.get(b);return _||(_=this._fieldsMap.get(F(b))??this._normalizedFieldsMap.get(k(b)),_&&this._fieldsMap.set(b,_),_)}getTimeZone(b){const _=this.get(b&&"string"!=typeof b?b.name:b);return _?this._timeZoneByFieldName?this._timeZoneByFieldName.get(_.name):"date"===_.type||"esriFieldTypeDate"===_.type?(Y.A.getLogger("esri.layers.support.FieldsIndex").errorOnce(new P.A("getTimeZone:no-timezone-information",`no time zone information for field '${_.name}'`)),Q.n$):w.has(_.type)?Q.L5:null:null}getLuxonTimeZone(b){const _=this.getTimeZone(b);return _?_===Q.L5?N.GB.instance:_===Q.n$?G.mQ.utcInstance:(0,v.tE)(L,_,()=>G.oh.create(_)):null}isDateField(b){return this._dateFieldsSet.has(this.get(b))}isTimeOnlyField(b){return(0,K.OH)(this.get(b))}isNumericField(b){return this._numericFieldsSet.has(this.get(b))}normalizeFieldName(b){return this.get(b)?.name??void 0}toJSON(){return{fields:this.fields.map(b=>M.A.isSerializable(b)?b.toJSON():b),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function F(d){return d.trim().toLowerCase()}function k(d){return(0,K.rS)(d)?.toLowerCase()??""}const w=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function l(d){const b=new Map;if(!d.fields)return b;const _=!0===d.datesInUnknownTimezone,{timeInfo:T,editFieldsInfo:A}=d,f=(T?"startField"in T?T.startField:T.startTimeField:"")??"",D=(T?"endField"in T?T.endField:T.endTimeField:"")??"",C=function h(d){return"dateFieldsTimeZone"in d}(d)?d.dateFieldsTimeZone??null:d.dateFieldsTimeReference?(0,J.ZS)(d.dateFieldsTimeReference):null,U=A?function I(d){return"timeZone"in d}(A)?A.timeZone??C:A.dateFieldsTimeReference?(0,J.ZS)(A.dateFieldsTimeReference):C??Q.n$:null,H=T?function g(d){return"timeZone"in d}(T)?T.timeZone??C:T.timeReference?(0,J.ZS)(T.timeReference):C:null,ne=new Map([[F(A?.creationDateField??""),U],[F(A?.editDateField??""),U],[F(f),H],[F(D),H]]);for(const{name:re,type:ce}of d.fields)if(w.has(ce))b.set(re,Q.L5);else if("date"!==ce&&"esriFieldTypeDate"!==ce)b.set(re,null);else if(_)b.set(re,Q.L5);else{const ae=ne.get(F(re??""))??C;b.set(re,ae)}return b}},64584:(fe,X,i)=>{i.d(X,{A:()=>g});var G,P=i(8189),M=i(31178),Y=i(71065),v=i(85211),J=(i(3248),i(35150),i(40707),i(76576));let I=G=class extends Y.A{constructor(h){super(h),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new M.A}clone(){return new G({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};(0,P._)([(0,v.MZ)({type:String,json:{write:{isRequired:!0}}})],I.prototype,"floorField",void 0),(0,P._)([(0,v.MZ)({json:{read:!1,write:!1}})],I.prototype,"viewAllMode",void 0),(0,P._)([(0,v.MZ)({json:{read:!1,write:!1}})],I.prototype,"viewAllLevelIds",void 0),I=G=(0,P._)([(0,J.$)("esri.layers.support.LayerFloorInfo")],I);const g=I},36267:(fe,X,i)=>{i.d(X,{A:()=>L});var P=i(8189),M=i(90660),Y=i(49976),v=i(71065),N=i(85211),G=(i(3248),i(35150),i(40707),i(76576));const I=new Y.J({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),g=new Y.J({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let h=class extends(M.A.ClonableMixin(v.A)){constructor(z){super(z),this.cardinality=null,this.catalogId=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};(0,P._)([(0,N.MZ)({json:{read:I.read,write:I.write}})],h.prototype,"cardinality",void 0),(0,P._)([(0,N.MZ)({json:{name:"catalogID"}})],h.prototype,"catalogId",void 0),(0,P._)([(0,N.MZ)({json:{read:!0,write:!0}})],h.prototype,"composite",void 0),(0,P._)([(0,N.MZ)({json:{read:!0,write:!0}})],h.prototype,"id",void 0),(0,P._)([(0,N.MZ)({json:{read:!0,write:!0}})],h.prototype,"keyField",void 0),(0,P._)([(0,N.MZ)({json:{read:!0,write:!0}})],h.prototype,"keyFieldInRelationshipTable",void 0),(0,P._)([(0,N.MZ)({json:{read:!0,write:!0}})],h.prototype,"name",void 0),(0,P._)([(0,N.MZ)({json:{read:!0,write:!0}})],h.prototype,"relatedTableId",void 0),(0,P._)([(0,N.MZ)({json:{read:!0,write:!0}})],h.prototype,"relationshipTableId",void 0),(0,P._)([(0,N.MZ)({json:{read:g.read,write:g.write}})],h.prototype,"role",void 0),h=(0,P._)([(0,G.$)("esri.layers.support.Relationship")],h);const L=h},85791:(fe,X,i)=>{i.d(X,{A:()=>k});var P=i(10467),M=i(8189),Y=i(98877),v=i(89447),N=i(31178),K=i(85211),I=(i(3248),i(35150),i(40707),i(76576)),g=i(86300),h=i(48218);let F=class extends Y.A{constructor(w){super(w),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||(0,v.UT)(()=>(0,h.lw)()):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??i.e(3958).then(i.bind(i,93958)).then(w=>this._featureUtils=w)}get calculatedExpressions(){const w=new N.A;if(!this.expressionsUsedInTitle.length)return w;if(!this._arcadeTask?.value){for(const l of this.expressionsUsedInTitle??[])w.push({name:l.name,invalid:!0});return w}for(const l of this.expressionsUsedInTitle)try{const d=this._arcadeTask.value.arcade.parseScript(l.expression,["$layer","$map","$datastore"]);if(d.isAsync){w.push({name:l.name,invalid:!0});break}w.push({name:l.name,syntax:d,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(d,{vars:{$feature:"any"}})})}catch{w.push({name:l.name,invalid:!0});break}return w}get expressionsUsedInTitle(){let w=this.effectivePopupTemplate?.title??"";return"string"!=typeof w?[]:(w=w.toLowerCase(),this.effectivePopupTemplate?.expressionInfos?.filter(l=>w.includes(`{expression/${l.name.toLowerCase()}}`))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some(w=>!0===w.invalid)}get requiredFields(){const w=new Set;if(this._arcadeTask?.value&&!this.hasBadExpressions)for(const d of this.calculatedExpressions?.toArray()??[])try{const b=this._arcadeTask.value.arcade.extractFieldLiterals(d.syntax);for(const _ of b){const T=_.split("."),A=this.fieldsIndex.get(T.at(-1)??"");A&&w.add(A.name)}}catch{}const l=this._extractFieldNames(this.workingTitle);for(const d of l){const b=this.fieldsIndex.get(d);b&&w.add(b.name)}return w}get titleFromDisplayField(){let w="";return this.displayField&&(w=this.fieldsIndex.get(this.displayField)?.name??""),w||(w=this.fieldsIndex.get(this.objectIdField)?.name??""),w?`{${w}}`:""}get workingTitle(){const w=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return""===w||null==w||this.hasBadExpressions||"string"!=typeof w?this.titleFromDisplayField:w}getTitle(w,l,d){var b=this;return(0,P.A)(function*(){try{const{attributes:_}=l,T=d?.timeZone??"system",[{substituteFieldsInLinksAndAttributes:A}]=yield Promise.all([b.featureUtilsPromise,b._arcadeTask?.promise]);if(d.fetchMissingFields&&(l=yield b._checkAndReQueryGraphic(w,l)),b.workingTitle&&b.fieldInfoMap){const f=b._createFormattedAttributes(w,l,T).global;return A({attributes:_,expressionAttributes:null,fieldInfoMap:b.fieldInfoMap,globalAttributes:f,layer:w,text:b.workingTitle})}return""}catch{}return""})()}_checkAndReQueryGraphic(w,l){var d=this;return(0,P.A)(function*(){const b=l.getObjectId();if(null==b)return l;if(!(0,g.Kl)(d.requiredFields,l)){const _=w.createQuery();_.where="1=1",_.outFields=[...d.requiredFields],_.objectIds=[b];const T=yield w.queryFeatures(_);if(1===T?.features.length)return T.features[0]}return l})()}_createFieldInfoMap(w){const l=new Map;if(!w)return l;for(const d of w){if(!d.fieldName)continue;const b=this.fieldsIndex.get(d.fieldName),_=b?.name??d.fieldName;d.fieldName=_,l.set(_.toLowerCase(),d)}return l}_createFormattedAttributes(w,l,d="system"){const b=this.effectivePopupTemplate?.fieldInfos??[],_={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&this._arcadeTask?.value){const A=this._arcadeTask.value.Feature.createFromGraphicLikeObject(l.geometry,l.attributes,w,null);for(const f of this.calculatedExpressions)try{_[`expression/${f.name}`]=f.func({vars:{$feature:A}})}catch{}}const T={...l.attributes,..._};return{global:this._featureUtils.formatAttributes({fieldInfos:b,attributes:T,graphic:l,timeZone:d,layer:w,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(w){return(0,g.nw)(w).filter(l=>!(0===l.indexOf("relationships/")||0===l.indexOf("expression/")))}};(0,M._)([(0,K.MZ)({readOnly:!0})],F.prototype,"_arcadeTask",null),(0,M._)([(0,K.MZ)()],F.prototype,"_featureUtils",void 0),(0,M._)([(0,K.MZ)({readOnly:!0})],F.prototype,"featureUtilsPromise",null),(0,M._)([(0,K.MZ)({readOnly:!0})],F.prototype,"calculatedExpressions",null),(0,M._)([(0,K.MZ)()],F.prototype,"displayField",void 0),(0,M._)([(0,K.MZ)()],F.prototype,"effectivePopupTemplate",void 0),(0,M._)([(0,K.MZ)()],F.prototype,"expressionsUsedInTitle",null),(0,M._)([(0,K.MZ)()],F.prototype,"fieldsIndex",void 0),(0,M._)([(0,K.MZ)()],F.prototype,"fieldInfoMap",null),(0,M._)([(0,K.MZ)()],F.prototype,"fields",void 0),(0,M._)([(0,K.MZ)()],F.prototype,"objectIdField",void 0),(0,M._)([(0,K.MZ)()],F.prototype,"requiredFields",null),F=(0,M._)([(0,I.$)("esri.layers.support.TitleCreator")],F);const k=F},27960:(fe,X,i)=>{i.d(X,{Ch:()=>N,mW:()=>Y,u2:()=>v});var P=i(69287),M=i(63484);function Y(L,z){return{...z,filterMode:L.mode}}function v(L,z){return Q(L,z).next().value??null}function N(L,z,F){const k=function K(L){if("manual"===I(L))return null;const z=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:F,maxScale:k}of L.filters)z[0]=Math.max(z[0],g(F)),z[1]=Math.min(z[1],h(k));return z}(L);if(k&&((0,P.gg)(z,k[0])||(0,P.ZH)(F,k[1])))return"";const w=Array.from(Q(L,z,F)),l=function J(L,z,F){if(0===L.length)return!0;const k=g(L.at(0)?.minScale),w=h(L.at(-1)?.maxScale);if((0,P.ZH)(k,z)||(0,P.gg)(w,F))return!0;for(let l=0;l<L.length-1;l++){const d=L[l];if((0,P.ZH)(g(L[l+1].minScale),h(d.maxScale)))return!0}return!1}(w,z,F)?"1=1":w.map(d=>d.where||"1=1").reduce((d,b)=>(0,M.IW)(d,b),"");return l&&"1=1"!==l?l:""}function*Q(L,z,F){if("manual"===I(L)){const k=L.filters.find(w=>w.id===L.activeFilterId);k&&(yield k)}else{"object"==typeof z&&(z=z.scale);for(const k of L.filters)G(k.minScale,k.maxScale,z,F)&&(yield k)}}function G(L,z,F,k){return L=g(L),F=g(F),z=h(z),!(!(0,P.Sp)(F,L)&&(k??F)>L||(0,P.Hx)(z,F)||void 0!==k&&(0,P.Sp)(k,L))}function I(L){return"mode"in L?L.mode:L.filterMode}function g(L){return L||Number.POSITIVE_INFINITY}function h(L){return L||0}},6829:(fe,X,i)=>{i.d(X,{CW:()=>L,Fm:()=>J,Hz:()=>z,JQ:()=>h,JZ:()=>D,ND:()=>k,R_:()=>K,U9:()=>g,fu:()=>M,nr:()=>F,oF:()=>Y,rq:()=>G,z$:()=>I});const P=[["binary","application/octet-stream","bin",""]];function M(C,U){return null!=b(U.name,C?.supportedFormats??[])}function Y(C,U){if(!C)return!1;const H=G(U,C.supportedFormats??[]);return null!=H&&C.editFormats.includes(H)}function K(C,U){return _(function d(C,U){const H=C.toLowerCase();return w(U).find(ne=>T(ne)===H)}(C,U))}function Q(C,U){return _(b(C,U))}function J(C,U){return T(function l(C,U){return w(U).find(H=>_(H)===C)}(C,U))}function G(C,U){return Q(C.name,U)??K(C.type,U)}function I(C,U,H){return K(C,H)??Q(U,H)}function g({supportedFormats:C}){return I("model/gltf-binary","glb",C)}function h(C){const U=g(C);return null!=U&&C.editFormats.includes(U)}function L({supportedFormats:C}){return I("model/gltf+json","gltf",C)}function z(C){if(!C)return null;const U=g(C),H=L(C);let ne=null;for(const re of C.queryFormats){if(re===U)return re;re===H&&(ne=re)}return ne}function F({supportedFormats:C}){return I("application/esri3do-SR_world","wld",C)}function k({supportedFormats:C}){return I("application/esri3do-SR_prj","prj",C)}function w(C){return[...P,...C]}function b(C,U){const H=C.toLowerCase();return w(U).find(ne=>function A(C){return C?.[2].split(",").map(U=>U.toLowerCase())??[]}(ne).some(re=>H.endsWith(re)))}function _(C){return C?.[0]}function T(C){return C?.[1].toLowerCase()}function D(C){return C.tables?.find(U=>"assetMaps"===U.role)}},4858:(fe,X,i)=>{i.d(X,{BI:()=>z,D3:()=>h,XJ:()=>L,lc:()=>g,mX:()=>k,rU:()=>F,tH:()=>T});var P=i(1119);const M="__begin__",Y="__end__",v=new RegExp(M,"ig"),N=new RegExp(Y,"ig"),K=new RegExp("^"+M,"i"),Q=new RegExp(Y+"$","i"),J='"',G=J+" + ",I=" + "+J;function g(A){return A.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function h(A){return A.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function L(A){const f={expression:"",type:"none"};return A.labelExpressionInfo?A.labelExpressionInfo.value?(f.expression=A.labelExpressionInfo.value,f.type="conventional"):A.labelExpressionInfo.expression&&(f.expression=A.labelExpressionInfo.expression,f.type="arcade"):null!=A.labelExpression&&(f.expression=g(A.labelExpression),f.type="conventional"),f}function z(A){const f=L(A);switch(f.type){case"conventional":return k(f.expression);case"arcade":return f.expression}return null}function F(A){const f=L(A);switch(f.type){case"conventional":return function l(A){return A?.match(w)?.[1].trim()||null}(f.expression);case"arcade":return T(f.expression)}return null}function k(A){let f;return A?(f=(0,P.HC)(A,D=>M+'$feature["'+D+'"]'+Y),f=K.test(f)?f.replace(K,""):J+f,f=Q.test(f)?f.replace(Q,""):f+J,f=f.replaceAll(v,G).replaceAll(N,I)):f='""',f}const w=/^\s*\{([^}]+)\}\s*$/i,d=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,b=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,_=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function T(A){if(!A)return null;let f=d.exec(A)||b.exec(A);return f?f[1]||f[3]:(f=_.exec(A),f?f[2]:null)}},90543:(fe,X,i)=>{i.d(X,{S:()=>h,d:()=>A});var P=i(3248),M=i(68438),Y=i(6829);function v(f,D,C){return!!K(f,D,C)}function N(f,D,C){return K(f,D,C)}function K(f,D,C){return f&&f.hasOwnProperty(D)?f[D]:C}const Q={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function J(f){const D=f?.supportedSpatialAggregationStatistics?.map(C=>C.toLowerCase());return{envelope:!!D?.includes("envelopeaggregate"),centroid:!!D?.includes("centroidaggregate"),convexHull:!!D?.includes("convexhullaggregate")}}function G(f,D){return!!f?.supportedOperationsWithCacheHint?.map(U=>U.toLowerCase())?.includes(D.toLowerCase())}function I(f){const D=f?.supportedStatisticTypes?.map(C=>C.toLowerCase());return{count:!!D?.includes("count"),sum:!!D?.includes("sum"),min:!!D?.includes("min"),max:!!D?.includes("max"),avg:!!D?.includes("avg"),var:!!D?.includes("var"),stddev:!!D?.includes("stddev"),percentileContinuous:!!D?.includes("percentile_continuous"),percentileDiscrete:!!D?.includes("percentile_discrete"),envelope:!!D?.includes("envelopeaggregate"),centroid:!!D?.includes("centroidaggregate"),convexHull:!!D?.includes("convexhullaggregate")}}function g(f){const D=f?.supportedNormalizationTypes?.map(C=>C.toLowerCase());return{field:!!D?.includes("field"),log:!!D?.includes("log"),naturalLog:!!D?.includes("naturallog"),percentOfTotal:!!D?.includes("percentoftotal"),squareRoot:!!D?.includes("squareroot")}}function h(f,D){return{analytics:L(f),attachment:z(f),data:F(f),metadata:k(f),operations:w(f.capabilities,f,D),query:l(f,D),queryAttributeBins:_(f),queryRelated:d(f),queryTopFeatures:b(f),editing:T(f)}}function L(f){return{supportsCacheHint:G(f.advancedQueryCapabilities,"queryAnalytics")}}function z(f){const D=f.attachmentProperties,C={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:G(f.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:v(f.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:v(f,"supportsAttachmentsResizing",!1)};return D&&Array.isArray(D)&&D.forEach(U=>{const H=Q[U.name];H&&(C[H]=!!U.isEnabled)}),C}function F(f){return{isVersioned:v(f,"isDataVersioned",!1),isBranchVersioned:v(f,"isDataBranchVersioned",!1),supportsAttachment:v(f,"hasAttachments",!1),supportsM:v(f,"hasM",!1),supportsZ:v(f,"hasZ",!1)}}function k(f){return{supportsAdvancedFieldProperties:v(f,"supportsFieldDescriptionProperty",!1)}}function w(f,D,C){const U=f?f.toLowerCase().split(",").map(Ee=>Ee.trim()):[],H=C?(0,M.qg)(C):null,ne=U.includes(null!=H&&"MapServer"===H.serverType?"data":"query"),re=U.includes("editing")&&!D.datesInUnknownTimezone;let ce=re&&U.includes("create"),ae=re&&U.includes("delete"),te=re&&U.includes("update");const _e=U.includes("changetracking"),he=D.advancedQueryCapabilities;return re&&!(ce||ae||te)&&(ce=ae=te=!0),{supportsCalculate:v(D,"supportsCalculate",!1),supportsTruncate:v(D,"supportsTruncate",!1),supportsValidateSql:v(D,"supportsValidateSql",!1),supportsAdd:ce,supportsDelete:ae,supportsEditing:re,supportsChangeTracking:_e,supportsQuery:ne,supportsQueryAnalytics:v(he,"supportsQueryAnalytic",!1),supportsQueryAttachments:v(he,"supportsQueryAttachments",!1),supportsQueryBins:v(he,"supportsQueryBins",!1),supportsQueryTopFeatures:v(he,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:v(D,"supportsAttachmentsResizing",!1),supportsSync:U.includes("sync"),supportsUpdate:te,supportsExceedsLimitStatistics:v(D,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:v(D,"supportsAsyncConvert3D",!1)}}function l(f,D){const C=f.advancedQueryCapabilities,U=f.ownershipBasedAccessControlForFeatures,H=f.archivingInfo,ne=f.currentVersion,re=D?.includes("MapServer"),ce=!re||ne>=(0,P.A)("mapserver-pbf-version-support"),ae=(0,M.Wo)(D),te=new Set((f.supportedQueryFormats??"").split(",").map(_e=>_e.toLowerCase().trim()));return{maxRecordCount:N(f,"maxRecordCount",void 0),maxRecordCountFactor:N(f,"maxRecordCountFactor",void 0),standardMaxRecordCount:N(f,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:J(C),supportsCacheHint:v(C,"supportsQueryWithCacheHint",!1)||G(C,"query"),supportsCentroid:v(C,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:ae,supportsCurrentUser:v(C,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:v(C,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:v(C,"supportsDisjointSpatialRel",!1),supportsDistance:v(C,"supportsQueryWithDistance",!1),supportsDistinct:v(C,"supportsDistinct",f.supportsAdvancedQueries),supportsExtent:v(C,"supportsReturningQueryExtent",!1),supportsFormatPBF:ce&&te.has("pbf"),supportsFullTextSearch:v(C,"supportsFullTextSearch",!1),supportsGeometryProperties:v(C,"supportsReturningGeometryProperties",!1),supportsHavingClause:v(C,"supportsHavingClause",!1),supportsHistoricMoment:v(H,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:v(C,"supportsMaxRecordCountFactor",!1),supportsOrderBy:v(C,"supportsOrderBy",f.supportsAdvancedQueries),supportsPagination:v(C,"supportsPagination",!1),supportsPercentileStatistics:v(C,"supportsPercentileStatistics",!1),supportsQuantization:v(f,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:v(f,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:v(U,"allowAnonymousToQuery",!0),supportsQueryByOthers:v(U,"allowOthersToQuery",!0),supportsQueryGeometry:v(f,"supportsReturningQueryGeometry",!1),supportsResultType:v(C,"supportsQueryWithResultType",!1),supportsReturnMesh:!!(0,Y.Hz)(f.infoFor3D),supportsSpatialAggregationStatistics:v(C,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:v(C,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:v(f,"useStandardizedQueries",!1),supportsStatistics:v(C,"supportsStatistics",f.supportsStatistics),supportsTopFeaturesQuery:v(C,"supportsTopFeaturesQuery",!1),supportsTrueCurve:v(C,"supportsTrueCurve",!1),tileMaxRecordCount:N(f,"tileMaxRecordCount",void 0)}}function d(f){const D=f.advancedQueryCapabilities,C=v(D,"supportsAdvancedQueryRelated",!1);return{supportsPagination:v(D,"supportsQueryRelatedPagination",!1),supportsCount:C,supportsOrderBy:C,supportsCacheHint:G(D,"queryRelated")}}function b(f){return{supportsCacheHint:G(f.advancedQueryCapabilities,"queryTopFilter")}}function _(f){const D=f?f.queryBinsCapabilities:void 0;return{supportsDate:v(D,"supportsDateBin",!1),supportsFixedInterval:v(D,"supportsFixedIntervalBin",!1),supportsAutoInterval:v(D,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:v(D,"supportsFixedBoundariesBin",!1),supportsStackBy:v(D,"supportsStackBy",!1),supportsSplitBy:v(D,"supportsSplitBy",!1),supportsSnapToData:v(D,"supportsSnapToData",!1),supportsReturnFullIntervalBin:v(D,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:v(D,"supportsFirstDayOfWeek",!1),supportsNormalization:v(D,"supportsNormalization",!1),supportedStatistics:I(D),supportedNormalizationTypes:g(D)}}function T(f){const D=f.ownershipBasedAccessControlForFeatures,C=f?f.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:v(f,"allowGeometryUpdates",!0),supportsGlobalId:v(f,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:v(f,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:v(f,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:v(f,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:v(f,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:v(D,"allowAnonymousToDelete",!0),supportsDeleteByOthers:v(D,"allowOthersToDelete",!0),supportsUpdateByAnonymous:v(D,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:v(D,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:v(C,"supportsAsyncApplyEdits",!1),zDefault:N(f,"zDefault",void 0)}}function A(f){return{operations:{supportsAppend:v(f,"supportsAppend",!1),supportsCoverageQuery:f?.playbackInfo?.klv["0601"]??!1,supportsExportClip:v(f,"supportsExportClip",!1),supportsExportFrameset:v(f,"supportsExportFrameset",!1),supportsMensuration:v(f,"supportsMensuration",!1),supportsUpdate:v(f,"supportsUpdate",!1)}}}},68470:(fe,X,i)=>{i.d(X,{K:()=>h,Q:()=>G});var P=i(8189),M=i(49976),Y=i(35150),v=i(85211),Q=(i(3248),i(40707),i(15463)),J=i(76576);const G=(0,M.O)()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),I="percent-of-total",g="field",h=L=>{let z=class extends L{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let F=this._get("normalizationType");const k=!!this.normalizationField,w=null!=this.normalizationTotal;return k||w?(F=k&&g||w&&I||null,k&&w&&Y.A.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):F!==g&&F!==I||(F=null),F}set normalizationType(F){this._set("normalizationType",F)}};return(0,P._)([(0,v.MZ)({type:String,json:{name:"parameters.normalizationField",write:!0}})],z.prototype,"normalizationField",void 0),(0,P._)([(0,v.MZ)({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],z.prototype,"normalizationMaxValue",void 0),(0,P._)([(0,v.MZ)({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],z.prototype,"normalizationMinValue",void 0),(0,P._)([(0,v.MZ)({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],z.prototype,"normalizationTotal",void 0),(0,P._)([(0,Q.e)(G,{name:"parameters.normalizationType"})],z.prototype,"normalizationType",null),z=(0,P._)([(0,J.$)("esri.rest.support.NormalizationBinParametersMixin")],z),z}},32117:(fe,X,i)=>{i.d(X,{$w:()=>w,Bu:()=>re,DW:()=>C,FH:()=>Ne,FM:()=>J,G9:()=>v,GV:()=>d,Go:()=>I,K3:()=>Fe,Kn:()=>f,MM:()=>L,MO:()=>x,Nl:()=>ce,Ny:()=>b,O2:()=>ae,UE:()=>te,YC:()=>E,YF:()=>he,ZO:()=>Ue,_1:()=>H,_H:()=>T,_W:()=>l,_d:()=>D,bs:()=>Re,dI:()=>c,e6:()=>g,gQ:()=>Q,iA:()=>Be,jn:()=>F,lW:()=>h,mA:()=>z,n5:()=>_e,pM:()=>U,pV:()=>A,pk:()=>Z,rB:()=>q,s4:()=>Y,xo:()=>ne,yH:()=>_,yX:()=>j,zb:()=>Ee,zr:()=>k});var P=i(46988);function Y(n,m,S,R){return function M(n){return"function"==typeof n}(n)?n(m,S,R):n}function v(n){return[n.r,n.g,n.b,n.a]}const N=" /-,\n";function K(n){let m=n.length;for(;m--;)if(!N.includes(n.charAt(m)))return!1;return!0}function Q(n,m){const S=[];let R=0,W=-1;do{if(W=n.indexOf("[",R),W>=R){if(W>R){const B=n.slice(R,W);S.push([B,null,K(B)])}if(R=W+1,W=n.indexOf("]",R),W>=R){if(W>R){const B=m[n.slice(R,W)];B&&S.push([null,B,!1])}R=W+1}}}while(-1!==W);if(R<n.length){const B=n.slice(R);S.push([B,null,K(B)])}return S}function J(n,m,S,R){let W="",B=null;for(const ye of m){const[ie,Me,ge]=ye;if(ie)ge?B=ie:(B&&(W+=B,B=null),W+=ie);else{let Ae=Me;null!=S&&(Ae=x(Me,S));const pe=n.attributes[Ae];pe&&(B&&(W+=B,B=null),W+=pe)}}return function G(n,m){switch("string"!=typeof n&&(n=String(n)),m){case"LowerCase":return n.toLowerCase();case"Allcaps":return n.toUpperCase();default:return n}}(W,R)}function I(n,m,S,R,W,B,ye=!0){const ie=m/W,Me=S/B,ge=Math.ceil(ie/2),Ae=Math.ceil(Me/2);for(let pe=0;pe<B;pe++)for(let ve=0;ve<W;ve++){const Le=4*(ve+(ye?B-pe-1:pe)*W);let Ce=0,we=0,We=0,Te=0,be=0,Ge=0,Ze=0;const $e=(pe+.5)*Me;for(let je=Math.floor(pe*Me);je<(pe+1)*Me;je++){const Je=Math.abs($e-(je+.5))/Ae,$=(ve+.5)*ie,Ve=Je*Je;for(let Ke=Math.floor(ve*ie);Ke<(ve+1)*ie;Ke++){let le=Math.abs($-(Ke+.5))/ge;const Ie=Math.sqrt(Ve+le*le);Ie>=-1&&Ie<=1&&(Ce=2*Ie*Ie*Ie-3*Ie*Ie+1,Ce>0&&(le=4*(Ke+je*m),Ze+=Ce*n[le+3],We+=Ce,n[le+3]<255&&(Ce=Ce*n[le+3]/250),Te+=Ce*n[le],be+=Ce*n[le+1],Ge+=Ce*n[le+2],we+=Ce))}}R[Le]=Te/we,R[Le+1]=be/we,R[Le+2]=Ge/we,R[Le+3]=Ze/We}}function g(n){return n?[n[0],n[1],n[2],n[3]/255]:[0,0,0,0]}function h(n){return n.data?.symbol??null}function L(n){return"CIMVectorMarker"===n.type||"CIMPictureMarker"===n.type||"CIMBarChartMarker"===n.type||"CIMCharacterMarker"===n.type||"CIMPieChartMarker"===n.type||"CIMStackedBarChartMarker"===n.type}function z(n){return"CIMGradientStroke"===n.type||"CIMPictureStroke"===n.type||"CIMSolidStroke"===n.type}function F(n){return null!=n&&("CIMGradientFill"===n.type||"CIMHatchFill"===n.type||"CIMPictureFill"===n.type||"CIMSolidFill"===n.type||"CIMWaterFill"===n.type)}function k(n){return null!=n&&("CIMMarkerPlacementAlongLineRandomSize"===n.type||"CIMMarkerPlacementAlongLineSameSize"===n.type||"CIMMarkerPlacementAlongLineVariableSize"===n.type||"CIMMarkerPlacementAtExtremities"===n.type||"CIMMarkerPlacementAtMeasuredUnits"===n.type||"CIMMarkerPlacementAtRatioPositions"===n.type||"CIMMarkerPlacementOnLine"===n.type||"CIMMarkerPlacementOnVertices"===n.type)}const w=(n,m=0)=>null==n||isNaN(n)?m:n,l=(n,m)=>n??m,d=(n,m)=>n??m,b=n=>n.tintColor?g(n.tintColor):[255,255,255,1],_=n=>{if(!n)return!1;for(const m of n)switch(m.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function T(){return Promise.all([i.e(3930),i.e(2076),i.e(4108)]).then(i.bind(i,27815))}function A(n){if(!n)return"normal";switch(n.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function f(n){if(!n)return"normal";switch(n.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function D(n){let m="normal",S="normal";if(n){const R=n.toLowerCase();R.includes("italic")?m="italic":R.includes("oblique")&&(m="oblique"),R.includes("bold")?S="bold":R.includes("light")&&(S="lighter")}return{style:m,weight:S}}function C(n){return n.underline?"underline":n.strikethrough?"line-through":"none"}function U(n){if(!n)return null;switch(n.type){case"CIMPolygonSymbol":if(n.symbolLayers)for(const m of n.symbolLayers){const S=U(m);if(null!=S)return S}break;case"CIMTextSymbol":return U(n.symbol);case"CIMSolidFill":return n.color}return null}function H(n){if(n)switch(n.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const m=n.symbolLayers;if(m)for(const S of m){const R=H(S);if(null!=R)return R}break}case"CIMTextSymbol":return H(n.symbol);case"CIMSolidStroke":return n.color}}function ne(n){if(n)switch(n.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(n.symbolLayers)for(const m of n.symbolLayers){const S=ne(m);if(void 0!==S)return S}break;case"CIMTextSymbol":return ne(n.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return n.width}}function re(n){switch(n){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function ce(n){switch(n){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function ae(n){return(n?Object.keys(n):[]).map(m=>({name:m,alias:m,type:"string"==typeof n[m]?"esriFieldTypeString":"esriFieldTypeDouble"}))}const te=n=>n.includes("data:image/svg+xml");function _e(n){if(!n)return null;switch(n.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function he(n){return n&&n.charAt(0).toLowerCase()+n.slice(1)}function Ee(n,m,S,R,W,B,ye=!0){const{infos:ie}=B;let Me=1,ge=0,Ae=0,pe=0,ve=1;for(const{absoluteAnchorPoint:we,offsetX:We,offsetY:Te,rotation:be,size:Ge,frameHeight:Ze,rotateClockWise:$e,scaleSymbolsProportionally:je}of ie)ve=we?1:Me,Ae=oe(We,Te,ge,ve,Ae),pe=se(We,Te,ge,ve,pe),Ze&&(je||ye)&&(Me*=Ge/Ze),ge=Se(be,$e,ge);const Le=oe(R,W,ge,ve,Ae),Ce=se(R,W,ge,ve,pe);return{size:n*Me,rotation:Se(m,S,ge),offsetX:Le,offsetY:Ce}}function Ue(n){if(null==n)return!1;if(Array.isArray(n))return n.every(m=>Ue(m));switch(typeof n){case"string":return!!n;case"number":return!isNaN(n)}}function Be(n,m){if("color"===m||"outlinecolor"===m||"backgroundcolor"===m||"borderlinecolor"===m||"tintcolor"===m)return[...P.K[m]];const S=P.D[n];if(!S)throw new Error(`InternalError: default value for type ${n}.`);return S[m]}function Fe(n){return"string"==typeof n?function xe(n){return n.split(" ").map(m=>Number(m))}(n):n}function Ne(n){return n?.dashTemplate&&(n.dashTemplate=Fe(n.dashTemplate)),n}function Re(n){if(null==n)return"Normal";switch(n.type){case"CIMTextSymbol":return n.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const m=n.symbolLayers;if(!m)return"Normal";for(const S of m)if("CIMVectorMarker"===S.type)return Re(S)}break;case"CIMVectorMarker":{const m=n.markerGraphics;if(!m)return"Normal";for(const S of m)if(S.symbol)return Re(S.symbol)}}return"Normal"}function E(n){if(n)switch(n.type){case"CIMTextSymbol":return n.height;case"CIMPointSymbol":{let m=0;if(n.symbolLayers)for(const S of n.symbolLayers)if(S)switch(S.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const R=S.size??P.D.CIMVectorMarker.size;R>m&&(m=R);break}}return m}case"CIMLineSymbol":case"CIMPolygonSymbol":{let m=0;if(n.symbolLayers)for(const S of n.symbolLayers)if(S)switch(S.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const R=S.width;null!=R&&R>m&&(m=R);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(S.markerPlacement&&k(S.markerPlacement)){const R=S.size??P.D.CIMVectorMarker.size;R>m&&(m=R)}break;case"CIMPictureFill":{const R=S.height;null!=R&&R>m&&(m=R)}}return m}}}function x(n,m){if(null!==m){const S=m.get(n);return S?S.name:n}return n}function Z(n){return n.map(m=>({...m,propertyName:he(m.propertyName)}))}function q(n){const m={};for(const S in n){const R=n[S];m[he(S)]=R}return m}function se(n,m,S,R,W){const B=S*Math.PI/180;if(B){const ye=Math.cos(B);return(Math.sin(B)*n+ye*m)*R+W}return m*R+W}function oe(n,m,S,R,W){const B=S*Math.PI/180;return B?(Math.cos(B)*n-Math.sin(B)*m)*R+W:n*R+W}function Se(n,m,S){return m?S-n:S+n}function c(n,m,S){const R="Color"===S||"TintColor"===S||"ToColor"===S,W="Rotation"===S||"Angle"===S||"ToRotation"===S;let B=m[he(S)];if(null!=B&&(R?B=[B[0]/255,B[1]/255,B[2]/255,B[3]/255]:W&&(B*=Math.PI/180)),null==B&&(B=Be(m.type,S.toLowerCase()),null!=B&&(R?B=[B[0]/255,B[1]/255,B[2]/255,B[3]]:W&&(B*=Math.PI/180))),null!=m.primitiveName){const ye=n[m.primitiveName];if(null!=ye){const ie=ye[S];null==ie||("string"==typeof ie||"number"==typeof ie||Array.isArray(ie)?(B=ie,null!=B&&(R?B=[B[0]/255,B[1]/255,B[2]/255,B[3]/255]:W&&(B*=Math.PI/180))):(B={valueExpressionInfo:ie,defaultValue:B},null!=B&&(R?B={type:"Process",op:"ArcadeColor",value:B}:W&&(B={type:"Process",op:"Divide",left:B,right:180/Math.PI}))))}}if(null==B)throw new Error(`Failed to derive a value or an expression for "${S}".`);return B}function j(n,m){return Math.max(Math.min((n??m)/100,1),0)}},76926:(fe,X,i)=>{i.d(X,{Fe:()=>L,Km:()=>K,Nk:()=>I});var P=i(68677),M=i(32117);function K(l,d,b,_){if(l)if("CIMTextSymbol"!==l.type){if(b&&l.effects)for(const T of l.effects)G(T,d);if(l.symbolLayers)for(const T of l.symbolLayers){switch(T.type){case"CIMPictureMarker":case"CIMVectorMarker":Q(T,d,_);break;case"CIMPictureStroke":case"CIMSolidStroke":case"CIMGradientStroke":!_?.preserveOutlineWidth&&T.width&&(T.width*=d);break;case"CIMPictureFill":T.height&&(T.height*=d),T.offsetX&&(T.offsetX*=d),T.offsetY&&(T.offsetY*=d);break;case"CIMHatchFill":K(T.lineSymbol,d,!0,{..._,preserveOutlineWidth:!1}),T.offsetX&&(T.offsetX*=d),T.offsetY&&(T.offsetY*=d),T.separation&&(T.separation*=d)}if(T.effects)for(const A of T.effects)G(A,d)}}else null!=l.height&&(l.height*=d)}function Q(l,d,b){if(l&&(l.markerPlacement&&function J(l,d){switch((0,M.zr)(l)&&l.offset&&(l.offset*=d),l.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(l.customEndingOffset&&(l.customEndingOffset*=d),l.offsetAlongLine&&(l.offsetAlongLine*=d),l.placementTemplate&&l.placementTemplate.length){const b=l.placementTemplate.map(_=>_*d);l.placementTemplate=b}break;case"CIMMarkerPlacementAlongLineVariableSize":if(l.maxRandomOffset&&(l.maxRandomOffset*=d),l.placementTemplate&&l.placementTemplate.length){const b=l.placementTemplate.map(_=>_*d);l.placementTemplate=b}break;case"CIMMarkerPlacementOnLine":l.startPointOffset&&(l.startPointOffset*=d);break;case"CIMMarkerPlacementAtExtremities":l.offsetAlongLine&&(l.offsetAlongLine*=d);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":l.beginPosition&&(l.beginPosition*=d),l.endPosition&&(l.endPosition*=d);break;case"CIMMarkerPlacementPolygonCenter":l.offsetX&&(l.offsetX*=d),l.offsetY&&(l.offsetY*=d);break;case"CIMMarkerPlacementInsidePolygon":l.offsetX&&(l.offsetX*=d),l.offsetY&&(l.offsetY*=d),l.stepX&&(l.stepX*=d),l.stepY&&(l.stepY*=d)}}(l.markerPlacement,d),l.offsetX&&(l.offsetX*=d),l.offsetY&&(l.offsetY*=d),l.anchorPoint&&"Absolute"===l.anchorPointUnits&&(l.anchorPoint={x:l.anchorPoint.x*d,y:l.anchorPoint.y*d}),l.size=null!=l.size?l.size*d:0,"CIMVectorMarker"===l.type&&l.markerGraphics))for(const _ of l.markerGraphics)l.scaleSymbolsProportionally||K(_.symbol,d,!0,b)}function G(l,d){switch(l.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":l.width&&(l.width*=d);break;case"CIMGeometricEffectBuffer":l.size&&(l.size*=d);break;case"CIMGeometricEffectCut":l.beginCut&&(l.beginCut*=d),l.endCut&&(l.endCut*=d),l.middleCut&&(l.middleCut*=d);break;case"CIMGeometricEffectDashes":if(l.customEndingOffset&&(l.customEndingOffset*=d),l.offsetAlongLine&&(l.offsetAlongLine*=d),l.dashTemplate&&l.dashTemplate.length){const b=l.dashTemplate.map(_=>_*d);l.dashTemplate=b}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":l.length&&(l.length*=d);break;case"CIMGeometricEffectMove":l.offsetX&&(l.offsetX*=d),l.offsetY&&(l.offsetY*=d);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":l.offset&&(l.offset*=d);break;case"CIMGeometricEffectRegularPolygon":l.radius&&(l.radius*=d);break;case"CIMGeometricEffectTaperedPolygon":l.fromWidth&&(l.fromWidth*=d),l.length&&(l.length*=d),l.toWidth&&(l.toWidth*=d);break;case"CIMGeometricEffectWave":l.amplitude&&(l.amplitude*=d),l.period&&(l.period*=d)}}function I(l){const d=[];return g((0,M.lW)(l),d),d.length?new P.A((0,M.e6)(d[0])):null}function g(l,d){if(!l)return;let b;b="CIMTextSymbol"===l.type?l.symbol:l;const _="CIMPolygonSymbol"===l.type;if(b?.symbolLayers)for(const T of b.symbolLayers)if(!(T.colorLocked||_&&((0,M.mA)(T)||(0,M.MM)(T)&&T.markerPlacement&&(0,M.zr)(T.markerPlacement))))switch(T.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":T.tintColor&&h(d,T.tintColor);break;case"CIMVectorMarker":T.markerGraphics?.forEach(A=>{g(A.symbol,d)});break;case"CIMSolidStroke":case"CIMSolidFill":h(d,T.color);break;case"CIMHatchFill":g(T.lineSymbol,d)}}function h(l,d){for(const b of l)if(b.join(".")===d.join("."))return;l.push(d)}function L(l,d,b){d instanceof P.A||(d=new P.A(d));const _=(0,M.lW)(l);_&&z(_,d,b)}function z(l,d,b){if(!l)return;let _;_="CIMTextSymbol"===l.type?l.symbol:l;const T="CIMPolygonSymbol"===_?.type;if(_?.symbolLayers)for(const A of _.symbolLayers){if(A.colorLocked)continue;if(T)if(b){const{layersToColor:D}=b;if(((0,M.mA)(A)||(0,M.MM)(A)&&A.markerPlacement&&(0,M.zr)(A.markerPlacement))&&"fill"===D||(0,M.jn)(A)&&"outline"===D)continue}else if((0,M.mA)(A)||(0,M.MM)(A)&&A.markerPlacement&&(0,M.zr)(A.markerPlacement))continue;const f=d.toArray();switch(A.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":A.tintColor=f;break;case"CIMVectorMarker":A.markerGraphics?.forEach(D=>{z(D.symbol,d,b)});break;case"CIMSolidStroke":case"CIMSolidFill":A.color=f;break;case"CIMHatchFill":z(A.lineSymbol,d,b)}}}},91644:(fe,X,i)=>{i.d(X,{A7:()=>J,Cx:()=>G,Hk:()=>I,JJ:()=>z,SF:()=>g,UK:()=>Q,jM:()=>h,x3:()=>L}),i(3248);var M=i(88521),Y=i(55417),v=i(46602),N=i(47705),K=i(48254);const Q=v.A.fromJSON(K.Cb),J=Y.A.fromJSON(K.yM),G=M.A.fromJSON(K.WR),I=N.A.fromJSON(K.JZ);function g(F){if(null==F)return null;switch(F.type){case"mesh":return null;case"point":case"multipoint":return Q;case"polyline":return J;case"polygon":case"extent":return G}return null}const h=v.A.fromJSON(K.nC),L=Y.A.fromJSON(K.HW),z=M.A.fromJSON(K.b6)},48254:(fe,X,i)=>{i.d(X,{Cb:()=>Y,HW:()=>J,JR:()=>M,JZ:()=>K,WR:()=>N,b6:()=>G,fT:()=>P,nC:()=>Q,yM:()=>v});const P=[252,146,31,255],M=[153,153,153,255],Y={type:"esriSMS",style:"esriSMSCircle",size:6,color:P,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},v={type:"esriSLS",style:"esriSLSSolid",width:.75,color:P},N={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},K={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},Q={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},J={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},G={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},8134:(fe,X,i)=>{i.d(X,{$4:()=>w,O0:()=>l,O1:()=>d,Sw:()=>b,eH:()=>F,rc:()=>k});var P=i(90261),M=i(68677),Y=i(89563),v=i(33087),N=i(67685),K=i(76926);const Q="picture-fill",J="simple-fill",G="simple-line",I="simple-marker",g="text",h="cim",L=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),z=new v.q(1e3);function F(_){const T=_.style;let A=null;if(_)switch(_.type){case I:"cross"!==T&&"x"!==T&&(A=_.color);break;case J:T&&"solid"!==T?"none"!==T&&(A={type:"pattern",x:0,y:0,src:(0,P.s)(`esri/symbols/patterns/${T}.png`),width:5,height:5}):A=_.color;break;case Q:A={type:"pattern",src:_.url,width:(0,N.Lz)(_.width)*_.xscale,height:(0,N.Lz)(_.height)*_.yscale,x:(0,N.Lz)(_.xoffset),y:(0,N.Lz)(_.yoffset)};break;case g:A=_.color;break;case h:A=(0,K.Nk)(_)}return A}function k(_,T){const A=_+"-"+T;return void 0!==z.get(A)?Promise.resolve(z.get(A)):(0,Y.A)(_,{responseType:"image"}).then(f=>{const D=f.data,C=D.naturalWidth,U=D.naturalHeight,H=document.createElement("canvas");H.width=C,H.height=U;const ne=H.getContext("2d");ne.fillStyle=T,ne.fillRect(0,0,C,U),ne.globalCompositeOperation="destination-in",ne.drawImage(D,0,0);const re=H.toDataURL();return z.put(A,re),re})}function w(_){if(!_)return null;let T=null;switch(_.type){case J:case Q:case I:T=w(_.outline);break;case G:{const A=(0,N.Lz)(_.width);null!=_.style&&"none"!==_.style&&0!==A&&(T={color:_.color,style:d(_.style),width:A,cap:_.cap,join:"miter"===_.join?(0,N.Lz)(_.miterLimit):_.join},T.dashArray=l(T).join(",")||"none");break}default:T=null}return T}function l(_){if(!_?.style)return[];const{dashArray:T,style:A,width:f}=_;if("string"==typeof T&&"none"!==T)return T.split(",").map(U=>Number(U));const D=f??0,C=L.has(A)?L.get(A).map(U=>U*D):[];if("butt"!==_.cap)for(const[U,H]of C.entries())C[U]=U%2==1?H+D:Math.max(H-D,1);return C}const d=(()=>{const _={};return T=>{if(_[T])return _[T];const A=T.replaceAll("-","");return _[T]=A,A}})(),b=new M.A([128,128,128])},83393:(fe,X,i)=>{i.d(X,{$d:()=>F,GG:()=>Fe,N7:()=>k,Sx:()=>w,UQ:()=>Be,di:()=>Ne,dt:()=>T,f3:()=>Re,k_:()=>z});var P=i(10467),M=i(68677),Y=i(89447),N=(i(3248),i(67685)),K=i(25866),Q=i(72211),J=i(76926),G=i(8134),I=i(74760),g=i(94048);const h=new M.A("white");function z(E){if(!E)return 0;if((0,g.wk)(E)){const x=function L(E){const x=E.symbolLayers?.at(-1);if(x&&"outline"in x)return x?.outline?.size}(E);return x??0}return(0,N.PN)((0,G.$4)(E)?.width)}function F(E){if(null==E||!("symbolLayers"in E)||null==E.symbolLayers)return!1;switch(E.type){case"point-3d":return E.symbolLayers.some(x=>"object"===x.type);case"line-3d":return E.symbolLayers.some(x=>"path"===x.type);case"polygon-3d":return E.symbolLayers.some(x=>"object"===x.type||"extrude"===x.type);default:return!1}}function k(E){return E.resource?.href??""}function w(E,x){if(!E)return null;let Z=null;return(0,g.wk)(E)?Z=function l(E){const x=E.symbolLayers;if(!x)return null;let Z=null;return x.forEach(q=>{"object"===q.type&&q.resource?.href||(Z="water"===q.type?q.color:q.material?q.material.color:null)}),Z?new M.A(Z):null}(E):(0,g.$y)(E)&&(Z="cim"===E.type?(0,J.Nk)(E):E.color?new M.A(E.color):null),Z?d(Z,x):null}function d(E,x){if(null==x||null==E)return E;const Z=E.toRgba();return Z[3]=Z[3]*x,new M.A(Z)}function T(E,x,Z){E&&(x||null!=Z)&&(x&&(x=new M.A(x)),(0,g.wk)(E)?function b(E,x,Z){const q=E.symbolLayers;if(!q)return;const se=oe=>d(x=x??oe??(null!=Z?h:null),Z);q.forEach(oe=>{if("object"!==oe.type||!oe.resource?.href||x)if("water"===oe.type)oe.color=se(oe.color);else{const c=se(null!=oe.material?oe.material.color:null);null==oe.material?oe.material=new I.N({color:c}):oe.material.color=c,null!=Z&&"outline"in oe&&null!=oe.outline?.color&&(oe.outline.color=d(oe.outline.color,Z))}})}(E,x,Z):(0,g.$y)(E)&&function _(E,x,Z){(x=x??E.color)&&(E.color=d(x,Z)),null!=Z&&"outline"in E&&E.outline?.color&&(E.outline.color=d(E.outline.color,Z))}(E,x,Z))}function f(){return f=(0,P.A)(function*(E,x){const Z=E.symbolLayers;Z&&(yield(0,Y.jJ)(Z,function(){var q=(0,P.A)(function*(se){return function D(E,x){return C.apply(this,arguments)}(se,x)});return function(se){return q.apply(this,arguments)}}()))}),f.apply(this,arguments)}function C(){return C=(0,P.A)(function*(E,x){switch(E.type){case"extrude":!function ne(E,x){E.size="number"==typeof x[2]?x[2]:0}(E,x);break;case"icon":case"line":case"text":!function U(E,x){const Z=H(x);null!=Z&&(E.size=Z)}(E,x);break;case"path":!function ae(E,x){const Z=te(x,K.Un,[E.width,void 0,E.height]);E.width=Ee(x[0],E.width,1,Z),E.height=Ee(x[2],E.height,1,Z)}(E,x);break;case"object":yield function re(E,x){return ce.apply(this,arguments)}(E,x)}}),C.apply(this,arguments)}function H(E){for(const x of E)if("number"==typeof x)return x;return null}function ce(){return ce=(0,P.A)(function*(E,x){const{resourceSize:Z,symbolSize:q}=yield function _e(E){return he.apply(this,arguments)}(E),se=te(x,Z,q);E.width=Ee(x[0],q[0],Z[0],se),E.depth=Ee(x[1],q[1],Z[1],se),E.height=Ee(x[2],q[2],Z[2],se)}),ce.apply(this,arguments)}function te(E,x,Z){for(let q=0;q<3;q++){const se=E[q];switch(se){case"symbol-value":{const oe=Z[q];return null!=oe?oe/x[q]:1}case"proportional":break;default:if(se&&x[q])return se/x[q]}}return 1}function he(){return(he=(0,P.A)(function*(E){const{computeObjectLayerResourceSize:x}=yield i.e(5020).then(i.bind(i,75020)),Z=yield x(E,10),{width:q,height:se,depth:oe}=E,Se=[q,oe,se];let c=1;for(let j=0;j<3;j++){const n=Se[j];if(null!=n){c=n/Z[j];break}}for(let j=0;j<3;j++)null==Se[j]&&(Se[j]=Z[j]*c);return{resourceSize:Z,symbolSize:Se}})).apply(this,arguments)}function Ee(E,x,Z,q){switch(E){case"proportional":return Z*q;case"symbol-value":return x??Z;default:return E}}function Be(E,x){return xe.apply(this,arguments)}function xe(){return xe=(0,P.A)(function*(E,x){if(E&&x)return(0,g.wk)(E)?function A(E,x){return f.apply(this,arguments)}(E,x):void((0,g.$y)(E)&&function Ue(E,x){const Z=H(x);if(null!=Z)switch(E.type){case"simple-marker":E.size=Z;break;case"picture-marker":{const q=E.width/E.height;q>1?(E.width=Z,E.height=Z*q):(E.width=Z*q,E.height=Z);break}case"simple-line":E.width=Z;break;case"text":E.font.size=Z}}(E,x))}),xe.apply(this,arguments)}function Fe(E,x,Z){if(E&&null!=x)if((0,g.wk)(E)){const q=E.symbolLayers;q&&q.forEach(se=>{if("object"===se.type)switch(Z){case"tilt":se.tilt=(se.tilt??0)+x;break;case"roll":se.roll=(se.roll??0)+x;break;default:se.heading=(se.heading??0)+x}"icon"===se.type&&(se.angle+=x)})}else(0,g.$y)(E)&&("simple-marker"!==E.type&&"picture-marker"!==E.type&&"text"!==E.type||(E.angle+=x))}function Ne(E){if(!E)return null;const x=E.effects.filter(Z=>"bloom"!==Z.type).map(Z=>Z.toJSON());return(0,Q.zu)(x)}function Re(E){return null!=E&&"polygon-3d"===E.type&&E.symbolLayers.some(x=>"extrude"===x.type)}},71655:(fe,X,i)=>{var P,M;i.d(X,{X:()=>P}),(M=P||(P={}))[M.SAVE=0]="SAVE",M[M.SAVE_AS=1]="SAVE_AS"}}]);