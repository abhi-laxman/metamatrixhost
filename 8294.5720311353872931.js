"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[8294,1447,9557],{32954:(at,w,r)=>{function p(){return[1,0,0,0,1,0,0,0,1]}function v(y,M,d,m,E,c,l,D,O){return[y,M,d,m,E,c,l,D,O]}r.d(w,{fA:()=>v,vt:()=>p,zK:()=>F});const F=[1,0,0,0,1,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:F,clone:function C(y){return[y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8]]},create:p,createView:function A(y,M){return new Float64Array(y,M,9)},fromValues:v},Symbol.toStringTag,{value:"Module"}))},62789:(at,w,r)=>{function p(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function C(y){return[y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8],y[9],y[10],y[11],y[12],y[13],y[14],y[15]]}function v(y,M,d,m,E,c,l,D,O,B,G,$,q,J,P,b){return[y,M,d,m,E,c,l,D,O,B,G,$,q,J,P,b]}r.d(w,{fA:()=>v,o8:()=>C,vt:()=>p,zK:()=>F});const F=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:F,clone:C,create:p,createView:function A(y,M){return new Float64Array(y,M,16)},fromValues:v},Symbol.toStringTag,{value:"Module"}))},14214:(at,w,r)=>{function p(){return[0,0,0,1]}function C(I){return[I[0],I[1],I[2],I[3]]}r.d(w,{o8:()=>C,vt:()=>p,zK:()=>A});const A=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:A,clone:C,create:p,fromValues:function v(I,y,M,d){return[I,y,M,d]}},Symbol.toStringTag,{value:"Module"}))},19890:(at,w,r)=>{r.d(w,{A6:()=>J,B8:()=>G,Xd:()=>d,Xr:()=>$,Yc:()=>vt,hZ:()=>W,lw:()=>m,t2:()=>gt,x8:()=>M});var p=r(32954),C=r(14214),v=r(25866),A=r(85952),F=r(28714),I=r(53781);function M(s,a,u){u*=.5;const h=Math.sin(u);return s[0]=h*a[0],s[1]=h*a[1],s[2]=h*a[2],s[3]=Math.cos(u),s}function d(s,a){const u=2*Math.acos(a[3]),h=Math.sin(u/2);return h>(0,A.FD)()?(s[0]=a[0]/h,s[1]=a[1]/h,s[2]=a[2]/h):(s[0]=1,s[1]=0,s[2]=0),u}function m(s,a,u){const h=a[0],R=a[1],g=a[2],x=a[3],j=u[0],K=u[1],Q=u[2],st=u[3];return s[0]=h*st+x*j+R*Q-g*K,s[1]=R*st+x*K+g*j-h*Q,s[2]=g*st+x*Q+h*K-R*j,s[3]=x*st-h*j-R*K-g*Q,s}function O(s,a,u,h){const R=a[0],g=a[1],x=a[2],j=a[3];let K,Q,st,n,e,t=u[0],i=u[1],_=u[2],T=u[3];return Q=R*t+g*i+x*_+j*T,Q<0&&(Q=-Q,t=-t,i=-i,_=-_,T=-T),1-Q>(0,A.FD)()?(K=Math.acos(Q),st=Math.sin(K),n=Math.sin((1-h)*K)/st,e=Math.sin(h*K)/st):(n=1-h,e=h),s[0]=n*R+e*t,s[1]=n*g+e*i,s[2]=n*x+e*_,s[3]=n*j+e*T,s}function G(s,a){const u=a[0],h=a[1],R=a[2],g=a[3],x=u*u+h*h+R*R+g*g,j=x?1/x:0;return s[0]=-u*j,s[1]=-h*j,s[2]=-R*j,s[3]=g*j,s}function $(s,a){return s[0]=-a[0],s[1]=-a[1],s[2]=-a[2],s[3]=a[3],s}function q(s,a){const u=a[0]+a[4]+a[8];let h;if(u>0)h=Math.sqrt(u+1),s[3]=.5*h,h=.5/h,s[0]=(a[5]-a[7])*h,s[1]=(a[6]-a[2])*h,s[2]=(a[1]-a[3])*h;else{let R=0;a[4]>a[0]&&(R=1),a[8]>a[3*R+R]&&(R=2);const g=(R+1)%3,x=(R+2)%3;h=Math.sqrt(a[3*R+R]-a[3*g+g]-a[3*x+x]+1),s[R]=.5*h,h=.5/h,s[3]=(a[3*g+x]-a[3*x+g])*h,s[g]=(a[3*g+R]+a[3*R+g])*h,s[x]=(a[3*x+R]+a[3*R+x])*h}return s}function J(s,a,u,h){const R=.5*Math.PI/180;a*=R,u*=R,h*=R;const g=Math.sin(a),x=Math.cos(a),j=Math.sin(u),K=Math.cos(u),Q=Math.sin(h),st=Math.cos(h);return s[0]=g*K*st-x*j*Q,s[1]=x*j*st+g*K*Q,s[2]=x*K*Q-g*j*st,s[3]=x*K*st+g*j*Q,s}const b=I.c,W=I.s,z=I.g,tt=m,Y=I.b,X=I.h,S=I.l,L=I.j,V=L,ot=I.f,rt=ot,_t=I.n,gt=I.a,mt=I.e;function vt(s,a,u){const h=(0,F.f)(a,u);return h<-.999999?((0,F.e)(ut,dt,a),(0,F.H)(ut)<1e-6&&(0,F.e)(ut,pt,a),(0,F.n)(ut,ut),M(s,ut,Math.PI),s):h>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):((0,F.e)(ut,a,u),s[0]=ut[0],s[1]=ut[1],s[2]=ut[2],s[3]=1+h,_t(s,s))}const ut=(0,v.vt)(),dt=(0,v.fA)(1,0,0),pt=(0,v.fA)(0,1,0),At=(0,C.vt)(),It=(0,C.vt)(),o=(0,p.vt)();Object.freeze(Object.defineProperty({__proto__:null,add:z,calculateW:function D(s,a){const u=a[0],h=a[1],R=a[2];return s[0]=u,s[1]=h,s[2]=R,s[3]=Math.sqrt(Math.abs(1-u*u-h*h-R*R)),s},conjugate:$,copy:b,dot:X,equals:mt,exactEquals:gt,fromEuler:J,fromMat3:q,getAxisAngle:d,identity:function y(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s},invert:G,len:V,length:L,lerp:S,mul:tt,multiply:m,normalize:_t,random:function B(s){const a=A.Ov,u=a(),h=a(),R=a(),g=Math.sqrt(1-u),x=Math.sqrt(u);return s[0]=g*Math.sin(2*Math.PI*h),s[1]=g*Math.cos(2*Math.PI*h),s[2]=x*Math.sin(2*Math.PI*R),s[3]=x*Math.cos(2*Math.PI*R),s},rotateX:function E(s,a,u){u*=.5;const h=a[0],R=a[1],g=a[2],x=a[3],j=Math.sin(u),K=Math.cos(u);return s[0]=h*K+x*j,s[1]=R*K+g*j,s[2]=g*K-R*j,s[3]=x*K-h*j,s},rotateY:function c(s,a,u){u*=.5;const h=a[0],R=a[1],g=a[2],x=a[3],j=Math.sin(u),K=Math.cos(u);return s[0]=h*K-g*j,s[1]=R*K+x*j,s[2]=g*K+h*j,s[3]=x*K-R*j,s},rotateZ:function l(s,a,u){u*=.5;const h=a[0],R=a[1],g=a[2],x=a[3],j=Math.sin(u),K=Math.cos(u);return s[0]=h*K+R*j,s[1]=R*K-h*j,s[2]=g*K+x*j,s[3]=x*K-g*j,s},rotationTo:vt,scale:Y,set:W,setAxes:function bt(s,a,u,h){const R=o;return R[0]=u[0],R[3]=u[1],R[6]=u[2],R[1]=h[0],R[4]=h[1],R[7]=h[2],R[2]=-a[0],R[5]=-a[1],R[8]=-a[2],_t(s,q(s,R))},setAxisAngle:M,slerp:O,sqlerp:function Rt(s,a,u,h,R,g){return O(At,a,R,g),O(It,u,h,g),O(s,At,It,2*g*(1-g)),s},sqrLen:rt,squaredLength:ot,str:function P(s){return"quat("+s[0]+", "+s[1]+", "+s[2]+", "+s[3]+")"}},Symbol.toStringTag,{value:"Module"}))},11445:(at,w,r)=>{r.d(w,{Qf:()=>M,Qh:()=>F,RS:()=>v,ez:()=>E,i5:()=>c,lM:()=>A,qK:()=>m});var p=r(79139);const v=16;function A(l){if(!l)return 0;let D=m;for(const O in l)l.hasOwnProperty(O)&&(D+=y(l[O],!1));return D}function F(l){if(!l)return 0;if("number"==typeof l[0])return M(l);if(Array.isArray(l))return function I(l){const D=l.length;if(0===D||"number"==typeof l[0])return d(l,8);let O=E;for(let B=0;B<D;B++)O+=y(l[B]);return O}(l);let D=m;for(const O in l)l.hasOwnProperty(O)&&(D+=y(l[O]));return D}function y(l,D=!0){switch(typeof l){case"object":return D?F(l):m;case"string":return function C(l){return 32+l.length}(l);case"number":return v;case"boolean":return 4;default:return 8}}function M(...l){return l.reduce((D,O)=>D+(O?(0,p.iu)(O)?O.byteLength+c:Array.isArray(O)?d(O,v):0:0),0)}function d(l,D){return E+l.length*D}const m=32,E=16,c=145},38352:(at,w,r)=>{r.d(w,{A:()=>c});var m,p=r(8189),C=r(90660),v=r(71065),A=r(85211),M=(r(3248),r(35150),r(40707),r(15463)),d=r(76576);let E=m=class extends(C.A.ClonableMixin(v.A)){constructor(l){super(l),this.type="georeferenced",this.origin=null}};E.absolute=new m,(0,p._)([(0,M.e)({georeferenced:"georeferenced"},{readOnly:!0})],E.prototype,"type",void 0),(0,p._)([(0,A.MZ)({type:[Number],nonNullable:!1,json:{write:!0}})],E.prototype,"origin",void 0),E=m=(0,p._)([(0,d.$)("esri.geometry.support.MeshGeoreferencedVertexSpace")],E);const c=E},58315:(at,w,r)=>{r.d(w,{A:()=>c});var p=r(8189),C=r(90660),v=r(71065),A=r(85211),M=(r(3248),r(35150),r(40707),r(15463)),d=r(76576),m=r(25866);let E=class extends(C.A.ClonableMixin(v.A)){constructor(l){super(l),this.type="local",this.origin=(0,m.vt)()}};(0,p._)([(0,M.e)({local:"local"},{readOnly:!0})],E.prototype,"type",void 0),(0,p._)([(0,A.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],E.prototype,"origin",void 0),E=(0,p._)([(0,d.$)("esri.geometry.support.MeshLocalVertexSpace")],E);const c=E},36812:(at,w,r)=>{r.d(w,{A:()=>G});var D,p=r(8189),C=r(71065),v=r(85211),y=(r(3248),r(35150),r(40707),r(76576)),M=r(92771),d=r(62789),m=r(19890),E=r(14214),c=r(25866),l=r(63842);let O=D=class extends C.A{constructor($){super($),this.translation=(0,c.vt)(),this.rotationAxis=(0,c.ci)(l.up),this.rotationAngle=0,this.scale=(0,c.fA)(1,1,1)}get rotation(){return(0,l.i4)(this.rotationAxis,this.rotationAngle)}set rotation($){this.rotationAxis=(0,c.o8)((0,l.yo)($)),this.rotationAngle=(0,l.g7)($)}get localMatrix(){const $=(0,d.vt)();return(0,m.x8)(B,(0,l.yo)(this.rotation),(0,l.$I)(this.rotation)),(0,M.o1)($,B,this.translation,this.scale),$}get localMatrixInverse(){return(0,M.B8)((0,d.vt)(),this.localMatrix)}equals($){return this===$||null!=$&&(0,M.t2)(this.localMatrix,$.localMatrix)}clone(){const $={translation:(0,c.o8)(this.translation),rotationAxis:(0,c.o8)(this.rotationAxis),rotationAngle:this.rotationAngle,scale:(0,c.o8)(this.scale)};return new D($)}};(0,p._)([(0,v.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],O.prototype,"translation",void 0),(0,p._)([(0,v.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],O.prototype,"rotationAxis",void 0),(0,p._)([(0,v.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],O.prototype,"rotationAngle",void 0),(0,p._)([(0,v.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],O.prototype,"scale",void 0),(0,p._)([(0,v.MZ)()],O.prototype,"rotation",null),(0,p._)([(0,v.MZ)()],O.prototype,"localMatrix",null),(0,p._)([(0,v.MZ)()],O.prototype,"localMatrixInverse",null),O=D=(0,p._)([(0,y.$)("esri.geometry.support.MeshTransform")],O);const B=(0,E.vt)(),G=O},63842:(at,w,r)=>{r.d(w,{$I:()=>q,AU:()=>B,Cr:()=>l,g7:()=>$,i4:()=>c,ui:()=>D,up:()=>P,vt:()=>y,yo:()=>G});var p=r(69287),C=r(92771),v=r(19890),A=r(14214),F=r(28714),I=r(25866);function y(S=P){return[S[0],S[1],S[2],S[3]]}function c(S,L,V=y()){return(0,F.c)(V,S),V[3]=L,V}function l(S,L,V){return(0,F.e)(V,S,L),(0,F.n)(V,V),V[3]=-(0,F.r)(S,L),V}function D(S,L=y()){const V=(0,C.l)(b,S);return J(L,(0,p.KJ)((0,v.Xd)(L,V))),L}function O(S,L,V=y()){return(0,v.x8)(b,S,q(S)),(0,v.x8)(W,L,q(L)),(0,v.lw)(b,W,b),J(V,(0,p.KJ)((0,v.Xd)(V,b)))}function B(S,L,V,ot=y()){return c(I.Cw,S,tt),c(I.JP,L,Y),c(I.Cb,V,X),O(tt,Y,tt),O(tt,X,ot),ot}function G(S){return S}function $(S){return S[3]}function q(S){return(0,p.kU)(S[3])}function J(S,L){return S[3]=L,S}const P=[0,0,1,0],b=(0,A.vt)(),W=(0,A.vt)(),tt=(y(),y()),Y=y(),X=y()},33019:(at,w,r)=>{r.d(w,{Bq:()=>y,Qp:()=>I,WN:()=>q,dK:()=>J,eN:()=>D,fH:()=>$,in:()=>O,yr:()=>M});var p=r(10467),C=r(89563),v=r(89952),A=r(56492),F=r(6829);class I{constructor(b,W,z){this.assetName=b,this.assetMimeType=W,this.parts=z}equals(b){return this===b||this.assetName===b.assetName&&this.assetMimeType===b.assetMimeType&&(0,v.aI)(this.parts,b.parts,(W,z)=>W.equals(z))}isOnService(b){return this.parts.every(W=>W.isOnService(b))}makeHash(){let b="";for(const W of this.parts)b+=W.partHash;return b}toBlob(b){var W=this;return(0,p.A)(function*(){const{parts:z}=W;if(1===z.length)return z[0].toBlob(b);const tt=yield Promise.all(z.map(Y=>Y.toBlob(b)));return(0,A.Te)(b),new Blob(tt)})()}}class y{constructor(b,W){this.partUrl=b,this.partHash=W}equals(b){return this===b||this.partUrl===b.partUrl&&this.partHash===b.partHash}isOnService(b){return this.partUrl.startsWith(`${b.path}/assets/`)}toBlob(b){var W=this;return(0,p.A)(function*(){const{data:z}=yield(0,C.A)(W.partUrl,{responseType:"blob"});return(0,A.Te)(b),z})()}}function M(P){return function c(P){return!!P&&(Array.isArray(P)?P.some(l):l(P))}(P?.source)}function d(P){return!!Array.isArray(P)&&P.every(b=>b instanceof I)}const m=/^(model\/gltf\+json)|(model\/gltf-binary)$/,E=/\.(gltf|glb)/i;function l(P){if(P instanceof File){const{type:b,name:W}=P;return m.test(b)||E.test(W)}return m.test(P.assetMimeType)||E.test(P.assetName)}function D(P,b){if(!P)return!1;const{source:W}=P;return function B(P,b){return Array.isArray(P)?P.length>0&&P.every(z=>G(z,b)):G(P,b)}(W,b)}function O(P,b){if(P===b)return!0;const{source:W}=P,{source:z}=b;if(W===z)return!0;if(d(W)&&d(z)){if(W.length!==z.length)return!1;const tt=(S,L)=>S.assetName<L.assetName?-1:S.assetName>L.assetName?1:0,Y=[...W].sort(tt),X=[...z].sort(tt);for(let S=0;S<Y.length;++S)if(!Y[S].equals(X[S]))return!1;return!0}return!1}function G(P,b){return P instanceof I&&P.isOnService(b)}function $(P,b){return P instanceof File?(0,F.rq)(P,b):(0,F.z$)(P.assetMimeType,P.assetName,b)}function q(P){return Array.isArray(P)?P:[P]}function J(P){return!!P.original}},78559:(at,w,r)=>{r.d(w,{CK:()=>y,E9:()=>F,Hq:()=>I,MW:()=>M,TE:()=>d,yJ:()=>E});var p=r(28714),C=r(1749),v=r(38352),A=r(58315);function F(c){return null==c.origin}function I(c){return null!=c.origin}function y(c){return I(c.vertexSpace)}function M(c,l){if(!I(c))return null;const[D,O,B]=c.origin;return new C.A({x:D,y:O,z:B,spatialReference:l})}function d(c,l){const{x:D,y:O,z:B,spatialReference:G}=c,$=[D,O,B??0];return"local"===(l?.vertexSpace??function m(c){return c.isGeographic||c.isWebMercator?"local":"georeferenced"}(G))?new A.A({origin:$}):new v.A({origin:$})}function E(c,l){return c.type===l.type&&(c.origin===l.origin||null!=c.origin&&null!=l.origin&&(0,p.p)(c.origin,l.origin))}},42086:(at,w,r)=>{r.d(w,{N3:()=>F,Om:()=>A});var p=r(11445),C=r(27999),v=r(13682);class A{constructor(M=null,d={},m,E,c=0){this.geometry=M,this.attributes=d,this.centroid=m,this.objectId=E,this.displayId=c}static fromJSON(M){const d=M.geometry?v.A.fromJSON(M.geometry):null,m=M.centroid?v.A.fromJSON(M.centroid):null;return new A(d,M.attributes,m,M.objectId)}weakClone(){const M=new A(this.geometry,this.attributes,this.centroid,this.objectId);return M.displayId=this.displayId,M}clone(){const M=this.geometry?.clone(),d=new A(M,{...this.attributes},this.centroid?.clone(),this.objectId);return d.displayId=this.displayId,d}ensureCentroid(M){return this.centroid??=(0,C.Q)(new v.A,this.geometry,M.hasZ,M.hasM),this.centroid}get usedMemory(){return 128+(0,p.lM)(this.attributes)+(this.geometry?.usedMemory??0)}}function F(y){return!!y.geometry?.coords?.length}},61808:(at,w,r)=>{r.d(w,{A:()=>p});class p{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const v=new p;return v.objectIdFieldName=this.objectIdFieldName,v.globalIdFieldName=this.globalIdFieldName,v.geohashFieldName=this.geohashFieldName,v.geometryProperties=this.geometryProperties,v.geometryType=this.geometryType,v.spatialReference=this.spatialReference,v.hasZ=this.hasZ,v.hasM=this.hasM,v.features=this.features,v.fields=this.fields,v.transform=this.transform,v.exceededTransferLimit=this.exceededTransferLimit,v.uniqueIdField=this.uniqueIdField,v.queryGeometry=this.queryGeometry,v.queryGeometryType=this.queryGeometryType,v}}},13682:(at,w,r)=>{r.d(w,{A:()=>v});var p=r(11445);class v{constructor(F=[],I=[]){this.lengths=F??[],this.coords=I??[]}static fromJSON(F){return new v(F.lengths,F.coords)}static fromRect(F){const[I,y,M,d]=F,m=M-I,E=d-y;return new v([5],[I,y,m,0,0,E,-m,0,0,-E])}get isPoint(){return 0===this.lengths.length&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((F,I)=>F+I)}get usedMemory(){return 64+(0,p.Qf)(this.lengths,this.coords)}area(){let F=0,I=0;if(!this.lengths.length)return 0;for(let y=0;y<this.lengths.length;y++){const M=this.lengths[y];if(M<3)continue;let d=this.coords[2*I],m=this.coords[2*I+1];for(let E=1;E<M;E+=1){const c=this.coords[2*(E+I)],l=this.coords[2*(E+I)+1];F+=-.5*(c-d)*(l+m),d=c,m=l}I+=M}return F}forEachVertex(F){let I=0;this.lengths.length||F(this.coords[0],this.coords[1]);for(let y=0;y<this.lengths.length;y++){const M=this.lengths[y];for(let d=0;d<M;d++)F(this.coords[2*(d+I)],this.coords[2*(d+I)+1]);I+=M}}deltaDecode(){const F=this.clone(),{coords:I,lengths:y}=F;let M=0;for(const d of y){for(let m=1;m<d;m++)I[2*(M+m)]+=I[2*(M+m)-2],I[2*(M+m)+1]+=I[2*(M+m)-1];M+=d}return F}clone(F){if(0===this.lengths.length)return new v([],[this.coords[0],this.coords[1]]);const I=2*(0===this.lengths.length?1:this.lengths.reduce((M,d)=>M+d)),y=this.coords.slice(0,I);return F?(F.set(y),new v(this.lengths,F)):new v(Array.from(this.lengths),Array.from(y))}}},27999:(at,w,r)=>{function p(d,m){return d?m?4:3:m?3:2}function C(d,m,E,c){if(!m?.lengths.length)return null;d.lengths.length&&(d.lengths.length=0),d.coords.length&&(d.coords.length=0);const l=d.coords,D=[],O=E?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:B,coords:G}=m,$=p(E,c);let q=0;for(const J of B){const P=v(O,G,q,J,E,c);P&&D.push(P),q+=J*$}if(D.sort((J,P)=>{let b=J[2]-P[2];return 0===b&&E&&(b=J[4]-P[4]),b}),D.length){let J=6*D[0][2];l[0]=D[0][0]/J,l[1]=D[0][1]/J,E&&(J=6*D[0][4],l[2]=0!==J?D[0][3]/J:0),(l[0]<O[0]||l[0]>O[1]||l[1]<O[2]||l[1]>O[3]||E&&(l[2]<O[4]||l[2]>O[5]))&&(l.length=0)}if(!l.length){const J=m.lengths[0]?function A(d,m,E,c,l){const D=p(c,l);let O=m,B=m+D,G=0,$=0,q=0,J=0;for(let P=0,b=E-1;P<b;P++,O+=D,B+=D){const W=d[O],z=d[O+1],tt=d[O+2],Y=d[B],X=d[B+1],S=d[B+2],L=c?I(W,z,tt,Y,X,S):F(W,z,Y,X);if(L)if(G+=L,c){const V=M(W,z,tt,Y,X,S);$+=L*V[0],q+=L*V[1],J+=L*V[2]}else{const V=y(W,z,Y,X);$+=L*V[0],q+=L*V[1]}}return G>0?c?[$/G,q/G,J/G]:[$/G,q/G]:E>0?c?[d[m],d[m+1],d[m+2]]:[d[m],d[m+1]]:null}(G,0,B[0],E,c):null;if(!J)return null;l[0]=J[0],l[1]=J[1],E&&J.length>2&&(l[2]=J[2])}return d}function v(d,m,E,c,l,D){const O=p(l,D);let B=E,G=E+O,$=0,q=0,J=0,P=0,b=0;for(let z=0,tt=c-1;z<tt;z++,B+=O,G+=O){const Y=m[B],X=m[B+1],S=m[B+2],L=m[G],V=m[G+1],ot=m[G+2];let rt=Y*V-L*X;P+=rt,$+=(Y+L)*rt,q+=(X+V)*rt,l&&(rt=Y*ot-L*S,J+=(S+ot)*rt,b+=rt),Y<d[0]&&(d[0]=Y),Y>d[1]&&(d[1]=Y),X<d[2]&&(d[2]=X),X>d[3]&&(d[3]=X),l&&(S<d[4]&&(d[4]=S),S>d[5]&&(d[5]=S))}if(P>0&&(P*=-1),b>0&&(b*=-1),!P)return null;const W=[$,q,.5*P];return l&&(W[3]=J,W[4]=.5*b),W}function F(d,m,E,c){const l=E-d,D=c-m;return Math.sqrt(l*l+D*D)}function I(d,m,E,c,l,D){const O=c-d,B=l-m,G=D-E;return Math.sqrt(O*O+B*B+G*G)}function y(d,m,E,c){return[d+.5*(E-d),m+.5*(c-m)]}function M(d,m,E,c,l,D){return[d+.5*(c-d),m+.5*(l-m),E+.5*(D-E)]}r.d(w,{Q:()=>C})},78200:(at,w,r)=>{r.d(w,{F:()=>p,P:()=>C});const p={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsCurrentUser:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsReturnMesh:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0,supportsTrueCurve:!1},C={supportsDate:!0,supportsFixedInterval:!0,supportsAutoInterval:!0,supportsFixedBoundaries:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsSnapToData:!1,supportsReturnFullIntervalBin:!1,supportsFirstDayOfWeek:!1,supportsNormalization:!0,supportedStatistics:{count:!0,sum:!0,avg:!0,var:!0,stddev:!0,min:!0,max:!0,percentileContinuous:!0,percentileDiscrete:!0,envelope:!0,centroid:!0,convexHull:!0},supportedNormalizationTypes:{field:!0,log:!0,naturalLog:!0,percentOfTotal:!0,squareRoot:!0}}},13828:(at,w,r)=>{r.r(w),r.d(w,{applyEdits:()=>P,checkEditingCapabilities:()=>dt,isFeatureIdentifierArrayWithGlobalId:()=>J,isFeatureIdentifierArrayWithObjectId:()=>$,isFeatureIdentifierWithGlobalId:()=>q,isFeatureIdentifierWithObjectId:()=>G,normalizeCollections:()=>vt,normalizeEdits:()=>ut,normalizeGeometries:()=>gt,shallowCloneFeature:()=>pt,uploadAssets:()=>bt});var p=r(10467),C=r(81098),v=r(31178),A=r(5922),F=r(77806),I=r(35150),y=r(56492),M=r(45272),d=r(43085),m=r(77098),E=r(58701),c=r(58277),l=r(86300),D=r(6829),O=r(58443);function B(o){return null!=o?.applyEdits}function G(o){return"object"==typeof o&&null!=o&&"objectId"in o&&!!o.objectId}function $(o){return o.every(G)}function q(o){return"object"==typeof o&&null!=o&&"globalId"in o&&!!o.globalId}function J(o){return o.every(q)}function P(o,f,s){return b.apply(this,arguments)}function b(){return b=(0,p.A)(function*(o,f,s,a={}){let u;const R=a.gdbVersion??("gdbVersion"in o?o.gdbVersion:null);(0,c.Mk)(o)&&o.url?u=(0,c.Zk)(o.url,o.layerId,R,"original-and-current-features"===a.returnServiceEditsOption):(u=(0,y.Tw)(),u.promise.then(x=>{(x.addedFeatures.length||x.updatedFeatures.length||x.deletedFeatures.length||x.addedAttachments.length||x.updatedAttachments.length||x.deletedAttachments.length)&&o.emit("edits",x)}),o.emit("apply-edits",{result:u.promise}));try{const{results:g,edits:x}=yield function W(o,f,s,a){return z.apply(this,arguments)}(o,f,s,a),j=Q=>Q.filter(st=>!st.error).map(F.o8),K={edits:x,addedFeatures:j(g.addFeatureResults),updatedFeatures:j(g.updateFeatureResults),deletedFeatures:j(g.deleteFeatureResults),addedAttachments:j(g.addAttachmentResults),updatedAttachments:j(g.updateAttachmentResults),deletedAttachments:j(g.deleteAttachmentResults),exceededTransferLimit:!1,historicMoment:g.editMoment?new Date(g.editMoment):null,globalIdToObjectId:a.globalIdToObjectId};return g.editedFeatureResults?.length&&(K.editedFeatures=g.editedFeatureResults),u.resolve(K),g}catch(g){throw u.reject(g),g}}),b.apply(this,arguments)}function z(){return z=(0,p.A)(function*(o,f,s,a){if(yield o.load(),!B(f))throw new A.A(`${o.type}-layer:no-editing-support`,"Layer source does not support applyEdits capability",{layer:o});if(!(0,O.tk)(o))throw new A.A(`${o.type}-layer:editing-disabled`,"Editing is disabled for layer",{layer:o});const{edits:u,options:h}=yield function tt(o,f,s){return Y.apply(this,arguments)}(o,s,a);return u.addFeatures?.length||u.updateFeatures?.length||u.deleteFeatures?.length||u.addAttachments?.length||u.updateAttachments?.length||u.deleteAttachments?.length?{edits:u,results:yield f.applyEdits(u,h)}:{edits:u,results:{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}}),z.apply(this,arguments)}function Y(){return Y=(0,p.A)(function*(o,f,s){const a=(0,O.BR)(o),R=null!=o.infoFor3D;if(dt(f,a,s,!(!f||!(f.addFeatures||f.updateFeatures||f.deleteFeatures)),!(!f||!(f.addAttachments||f.updateAttachments||f.deleteAttachments)),`${o.type}-layer`),!a.data.isVersioned&&s?.gdbVersion)throw new A.A(`${o.type}-layer:invalid-parameter`,"'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'");if(!a.editing.supportsRollbackOnFailure&&s?.rollbackOnFailureEnabled)throw new A.A(`${o.type}-layer:invalid-parameter`,"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'");const g={...s};if(null!=g.rollbackOnFailureEnabled||a.editing.supportsRollbackOnFailure||(g.rollbackOnFailureEnabled=!0),g.rollbackOnFailureEnabled||"original-and-current-features"!==g.returnServiceEditsOption||(!1===g.rollbackOnFailureEnabled&&I.A.getLogger("esri.layers.graphics.editingSupport").warn(`${o.type}-layer:invalid-parameter`,"'original-and-current-features' is valid for 'returnServiceEditsOption' only when 'rollBackOnFailure' is true, but 'rollBackOnFailure' was set to false. 'rollBackOnFailure' has been overwritten and set to true."),g.rollbackOnFailureEnabled=!0),!a.editing.supportsReturnServiceEditsInSourceSpatialReference&&g.returnServiceEditsInSourceSR)throw new A.A(`${o.type}-layer:invalid-parameter`,"This layer does not support 'returnServiceEditsInSourceSR' parameter. See: 'capabilities.editing.supportsReturnServiceEditsInSourceSpatialReference'");if(g.returnServiceEditsInSourceSR&&"original-and-current-features"!==g.returnServiceEditsOption)throw new A.A(`${o.type}-layer:invalid-parameter`,"'returnServiceEditsInSourceSR' is valid only when 'returnServiceEditsOption' is set to 'original-and-current-features'");const x=ut(f,a,`${o.type}-layer`),j=s?.globalIdUsed||R,K=o.fields.filter(Q=>"big-integer"===Q.type||"oid"===Q.type&&(Q.length||0)>=8);if(j){const{globalIdField:Q}=o;if(null==Q)throw new A.A(`${o.type}-layer:invalid-parameter`,"Layer does not specify a global id field.");x.addFeatures.forEach(st=>function _t(o,f){const{attributes:s}=o;null==s[f]&&(s[f]=(0,d.yS)())}(st,Q))}return x.addFeatures.forEach(Q=>function L(o,f,s,a){X(o,f,s,a),S(o,f)}(Q,o,j,K)),x.updateFeatures.forEach(Q=>function ot(o,f,s,a){X(o,f,s,a),S(o,f);const u=(0,O.BR)(f);if("geometry"in o&&null!=o.geometry&&!u?.editing.supportsGeometryUpdate)throw new A.A(`${f.type}-layer:unsupported-operation`,"Layer does not support geometry updates.")}(Q,o,j,K)),x.deleteFeatures.forEach(Q=>function V(o,f,s,a){X(o,f,s,a)}(Q,o,j,K)),x.addAttachments.forEach(Q=>rt(Q,o)),x.updateAttachments.forEach(Q=>rt(Q,o)),R&&(yield function Rt(o,f){return At.apply(this,arguments)}(x,o)),{edits:yield gt(x),options:g}}),Y.apply(this,arguments)}function X(o,f,s,a){if(s){if("attributes"in o&&!o.attributes[f.globalIdField])throw new A.A(`${f.type}-layer:invalid-parameter`,`Feature should have '${f.globalIdField}' when 'globalIdUsed' is true`);if(!("attributes"in o)&&!o.globalId)throw new A.A(`${f.type}-layer:invalid-parameter`,"`'globalId' of the feature should be passed when 'globalIdUsed' is true")}if(a.length&&"attributes"in o)for(const u of a){const h=o.attributes[u.name];if(void 0!==h&&!(0,l.OG)(u,h))throw new A.A(`${f.type}-layer:invalid-parameter`,`Big-integer field '${u.name}' of the feature must be less than ${Number.MAX_SAFE_INTEGER}`,{feature:o})}if("geometry"in o&&null!=o.geometry){if(o.geometry.hasZ&&!1===f.capabilities?.data.supportsZ)throw new A.A(`${f.type}-layer:z-unsupported`,"Layer does not support z values while feature has z values.");if(o.geometry.hasM&&!1===f.capabilities?.data.supportsM)throw new A.A(`${f.type}-layer:m-unsupported`,"Layer does not support m values while feature has m values.")}}function S(o,f){if("geometry"in o&&"mesh"===o.geometry?.type&&null!=f.infoFor3D&&null!=f.spatialReference){const{geometry:s}=o,{spatialReference:a,vertexSpace:u}=s,h=f.spatialReference,R="local"===u.type,g=(0,E.EA)(h),x=(0,E.aI)(h,a),j=x||(0,E.oT)(h)&&((0,E.oT)(a)||(0,E.K8)(a));if(!(R&&g&&j||!R&&!g&&x))throw new A.A(`${f.type}-layer:mesh-unsupported`,`Uploading a mesh with a ${u.type} vertex space and a spatial reference wkid:${a.wkid} to a layer with a spatial reference wkid:${h.wkid} is not supported.`)}}function rt(o,f){const{feature:s,attachment:a}=o;if(!s||"attributes"in s&&!s.attributes[f.globalIdField])throw new A.A(`${f.type}-layer:invalid-parameter`,"Attachment should have reference to a feature with 'globalId'");if(!("attributes"in s)&&!s.globalId)throw new A.A(`${f.type}-layer:invalid-parameter`,"Attachment should have reference to 'globalId' of the parent feature");if(!a.globalId)throw new A.A(`${f.type}-layer:invalid-parameter`,"Attachment should have 'globalId'");if(!a.data&&!a.uploadId)throw new A.A(`${f.type}-layer:invalid-parameter`,"Attachment should have 'data' or 'uploadId'");if(!(a.data instanceof File&&a.data.name||a.name))throw new A.A(`${f.type}-layer:invalid-parameter`,"'name' is required when attachment is specified as Base64 encoded string using 'data'");if(!f.capabilities?.editing.supportsUploadWithItemId&&a.uploadId)throw new A.A(`${f.type}-layer:invalid-parameter`,"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'");if("string"==typeof a.data){const u=(0,M.r$)(a.data);if(u&&!u.isBase64)throw new A.A(`${f.type}-layer:invalid-parameter`,"Attachment 'data' should be a Blob, File or Base64 encoded string")}}function gt(o){return mt.apply(this,arguments)}function mt(){return(mt=(0,p.A)(function*(o){const f=o.addFeatures??[],s=o.updateFeatures??[],a=f.concat(s).map(g=>g.geometry),u=yield(0,m.el)(a),h=f.length,R=s.length;return u.slice(0,h).forEach((g,x)=>f[x].geometry=g),u.slice(h,h+R).forEach((g,x)=>s[x].geometry=g),o})).apply(this,arguments)}function vt(o){return{addFeatures:Array.from(o?.addFeatures??[]),updateFeatures:Array.from(o?.updateFeatures??[]),deleteFeatures:o&&v.A.isCollection(o.deleteFeatures)?o.deleteFeatures.toArray():o.deleteFeatures||[],addAttachments:o.addAttachments||[],updateAttachments:o.updateAttachments||[],deleteAttachments:o.deleteAttachments||[]}}function ut(o,f,s){const a=vt(o);if(a.addFeatures?.length&&!f.operations.supportsAdd)throw new A.A(`${s}:unsupported-operation`,"Layer does not support adding features.");if(a.updateFeatures?.length&&!f.operations.supportsUpdate)throw new A.A(`${s}:unsupported-operation`,"Layer does not support updating features.");if(a.deleteFeatures?.length&&!f.operations.supportsDelete)throw new A.A(`${s}:unsupported-operation`,"Layer does not support deleting features.");return a.addFeatures=a.addFeatures.map(pt),a.updateFeatures=a.updateFeatures.map(pt),a.addAssetFeatures=[],a}function dt(o,f,s,a,u,h){if(!o||!a&&!u)throw new A.A(`${h}:missing-parameters`,"'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required");if(!f.editing.supportsGlobalId&&s?.globalIdUsed&&!s.usingFeatureServiceEndpoint)throw new A.A(`${h}:invalid-parameter`,"This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'");if(!f.editing.supportsGlobalId&&u)throw new A.A(`${h}:invalid-parameter`,"'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'");if(!s?.globalIdUsed&&u)throw new A.A(`${h}:invalid-parameter`,"When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true")}function pt(o){const f=new C.A;return o.attributes||(o.attributes={}),f.geometry=o.geometry,f.attributes=o.attributes,f}function At(){return(At=(0,p.A)(function*(o,f){const{infoFor3D:s}=f;if(null==s)return;if(!(0,D.JQ)(s))throw new A.A(`${f.type}-layer:binary-gltf-asset-not-supported`,"3DObjectFeatureLayer requires binary glTF (.glb) support for updating mesh geometry.");o.addAssetFeatures??=[];const{addAssetFeatures:a}=o;for(const u of o.addFeatures??[])It(u)&&a.push(u);for(const u of o.updateFeatures??[])It(u)&&a.push(u)})).apply(this,arguments)}function It(o){return"mesh"===o?.geometry?.type}function bt(o,f,s,a){if(!B(f))throw new A.A(`${o.type}-layer:no-editing-support`,"Layer source does not support applyEdits capability",{layer:o});if(!f.uploadAssets)throw new A.A(`${o.type}-layer:no-asset-upload-support`,"Layer source does not support uploadAssets capability",{layer:o});return f.uploadAssets(s,a)}},28570:(at,w,r)=>{r.r(w),r.d(w,{default:()=>st});var p=r(10467),C=r(8189),v=r(23098),A=r(89563),F=r(89952),I=r(5922),y=r(3248),M=r(49976),d=r(55098),m=r(35150),E=r(89221),c=r(56492),l=r(48900),D=r(45272),O=r(43085),B=r(85211),G=r(76576),$=r(28067),q=r(32034),J=r(38352),P=r(78559),b=r(33019),W=r(81098),z=r(82663),tt=r(13970),Y=r(61320),X=r(36812),S=r(58701),L=r(13828);function V(n,e,t){return ot.apply(this,arguments)}function ot(){return(ot=(0,p.A)(function*(n,e,t){const{geometry:i}=e,_={...e.attributes};if(null!=t&&"mesh"===i?.type){const{transformFieldRoles:T}=t,{origin:U,spatialReference:N,vertexSpace:Z}=i,H=i.transform??new X.A,k="local"===Z.type,et=n.spatialReference,ht=et.isGeographic,Mt=(0,S.aI)(et,N),Et=(0,tt.isEqualBaseGCS)(N,et)&&(0,tt.canProjectWithoutEngine)(N,et);if(!(k&&ht&&Et||!k&&!ht&&Mt))return null;const nt=(0,tt.projectWithoutEngine)(U,N,et);if(null==nt)return null;if(_[T.originX]=nt.x,_[T.originY]=nt.y,_[T.originZ]=nt.z??0,null!=H){const{translation:it,scale:Ot,rotation:lt}=H,yt=k?1:(0,z.KX)(N)/(0,z.KX)(et);_[T.translationX]=it[0]*yt,_[T.translationY]=it[2]*yt,_[T.translationZ]=-it[1]*yt,_[T.scaleX]=Ot[0],_[T.scaleY]=Ot[2],_[T.scaleZ]=Ot[1],_[T.rotationX]=lt[0],_[T.rotationY]=lt[2],_[T.rotationZ]=-lt[1],_[T.rotationDeg]=lt[3]}return{attributes:_}}return null==i?{attributes:_}:"mesh"===i.type||"extent"===i.type?null:{geometry:i.toJSON(),attributes:_}})).apply(this,arguments)}function _t(){return(_t=(0,p.A)(function*(n,e){const t=yield Promise.all((e.addAttachments??[]).map(T=>gt(n,T))),i=yield Promise.all((e.updateAttachments??[]).map(T=>gt(n,T))),_=e.deleteAttachments??[];return t.length||i.length||_.length?{adds:t,updates:i,deletes:[..._]}:null})).apply(this,arguments)}function gt(n,e){return mt.apply(this,arguments)}function mt(){return(mt=(0,p.A)(function*(n,e){const{feature:t,attachment:i}=e,{globalId:_,name:T,contentType:U,data:N,uploadId:Z}=i,H={globalId:_};if(t&&("attributes"in t?H.parentGlobalId=t.attributes?.[n.globalIdField]:t.globalId&&(H.parentGlobalId=t.globalId)),Z)H.uploadId=Z;else if(N){const k=yield(0,D._0)(N);k&&(H.contentType=k.mediaType,H.data=k.data),N instanceof File&&(H.name=N.name)}return T&&(H.name=T),U&&(H.contentType=U),H})).apply(this,arguments)}function dt(n){const e=!0===n.success?null:n.error||{code:void 0,description:void 0};return{objectId:n.objectId,globalId:n.globalId,error:e?new I.A("feature-layer-source:edit-failure",e.description,{code:e.code}):null}}function pt(n,e){return new W.A({attributes:n.attributes,geometry:(0,Y.rS)({...n.geometry,spatialReference:e})})}function Rt(n,e){return{adds:n?.adds?.map(t=>pt(t,e))||[],updates:n?.updates?.map(t=>({original:pt(t[0],e),current:pt(t[1],e)}))||[],deletes:n?.deletes?.map(t=>pt(t,e))||[],spatialReference:e}}var It=r(89962),bt=r(5931),o=r(68438),f=r(47516),s=r(6829),a=r(34687),u=r(28872),h=r(87086),R=r(17181),g=r(30448);const x=new M.J({originalAndCurrentFeatures:"original-and-current-features",none:"none"}),j=new M.J({Started:"published",Publishing:"publishing",Stopped:"unavailable"});let K=class extends d.A{constructor(n){var e;super(n),e=this,this.type="feature-layer",this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.refresh=(0,c.sg)((0,p.A)(function*(){yield e.load();const t=e.sourceJSON.editingInfo?.lastEditDate;if(null==t)return{dataChanged:!0,updates:{}};try{yield e._fetchService(null)}catch{return{dataChanged:!0,updates:{}}}const i=t!==e.sourceJSON.editingInfo?.lastEditDate;return{dataChanged:i,updates:i?{editingInfo:e.sourceJSON.editingInfo,extent:e.sourceJSON.extent}:null}})),this._ongoingAssetUploads=new Map}load(n){const t=this._fetchService(this.layer.sourceJSON,{...n}).then(()=>this.layer.setUserPrivileges(this.sourceJSON.serviceItemId,n)).then(()=>this._ensureLatestMetadata(n));return this.addResolvingPromise(t),Promise.resolve(this)}initialize(){this.addHandles([(0,l.wB)(()=>{const n=this.layer;return n&&"lastEditsEventDate"in n?n.lastEditsEventDate:null},n=>this._handleLastEditsEventChange(n))])}destroy(){this._removeEditInterceptor()}get queryTask(){const{capabilities:n,parsedUrl:e,gdbVersion:t,spatialReference:i,fieldsIndex:_}=this.layer,T="infoFor3D"in this.layer?this.layer.infoFor3D:null,U="dynamicDataSource"in this.layer?this.layer.dynamicDataSource:null,N=(0,y.A)("featurelayer-pbf")&&n?.query.supportsFormatPBF&&null==T;return new bt.A({url:e.path,pbfSupported:N,fieldsIndex:_,infoFor3D:T,dynamicDataSource:U,gdbVersion:t,sourceSpatialReference:i,queryAttachmentsSupported:n?.operations?.supportsQueryAttachments??!1})}addAttachment(n,e){var t=this;return(0,p.A)(function*(){yield t.load();const{layer:i}=t;yield(0,f.VA)(i,"editing");const _=n.attributes[i.objectIdField],T=i.parsedUrl.path+"/"+_+"/addAttachment",U=t._getLayerRequestOptions(),N=t._getFormDataForAttachment(e,U.query);try{return dt((yield(0,A.A)(T,{body:N})).data.addAttachmentResult)}catch(Z){throw t._createAttachmentErrorResult(_,Z)}})()}updateAttachment(n,e,t){var i=this;return(0,p.A)(function*(){yield i.load();const{layer:_}=i;yield(0,f.VA)(_,"editing");const T=n.attributes[_.objectIdField],U=_.parsedUrl.path+"/"+T+"/updateAttachment",N=i._getLayerRequestOptions({query:{attachmentId:e}}),Z=i._getFormDataForAttachment(t,N.query);try{return dt((yield(0,A.A)(U,{body:Z})).data.updateAttachmentResult)}catch(H){throw i._createAttachmentErrorResult(T,H)}})()}applyEdits(n,e){var t=this;return(0,p.A)(function*(){yield t.load();const{layer:i}=t;yield(0,f.VA)(i,"editing");const _="infoFor3D"in i?i.infoFor3D:null,T=null!=_,U=T||(e?.globalIdUsed??!1),N=T?yield t._uploadMeshesAndGetAssetMapEditsJSON(n):null,Z=n.addFeatures?.map(ft=>V(t.layer,ft,_))??[],H=(yield Promise.all(Z)).filter(F.Ru),k=n.updateFeatures?.map(ft=>V(t.layer,ft,_))??[],et=(yield Promise.all(k)).filter(F.Ru),ht=function vt(n,e,t){if(!e||0===e.length)return[];if(t&&(0,L.isFeatureIdentifierArrayWithGlobalId)(e))return e.map(_=>_.globalId);if((0,L.isFeatureIdentifierArrayWithObjectId)(e))return e.map(_=>_.objectId);const i=t?n.globalIdField:n.objectIdField;return i?e.map(_=>_.getAttribute(i)):[]}(t.layer,n.deleteFeatures,U);(0,u.u)(H,et,i.spatialReference);const Mt=yield function rt(n,e){return _t.apply(this,arguments)}(t.layer,n),Et=i.capabilities.editing.supportsAsyncApplyEdits&&T,nt=e?.gdbVersion||i.gdbVersion,it={gdbVersion:nt,rollbackOnFailure:e?.rollbackOnFailureEnabled,useGlobalIds:U,returnEditMoment:e?.returnEditMoment,usePreviousEditMoment:e?.usePreviousEditMoment,async:Et};yield(0,g.ZJ)(t.layer.url,nt,!0);const Ot=(0,g.w5)(t.layer.url,nt||null);if(yield(0,g.We)(i.url,nt,i.historicMoment))throw new I.A("feature-layer-source:historic-version","Editing a historic version is not allowed");e?.returnServiceEditsOption?(it.edits=JSON.stringify([{id:i.layerId,adds:H.length?H:null,updates:et.length?et:null,deletes:ht.length?ht:null,attachments:Mt,assetMaps:N}]),it.returnServiceEditsOption=x.toJSON(e?.returnServiceEditsOption),it.returnServiceEditsInSourceSR=e?.returnServiceEditsInSourceSR):(it.adds=H.length?JSON.stringify(H):null,it.updates=et.length?JSON.stringify(et):null,it.deletes=ht.length?U?JSON.stringify(ht):ht.join(","):null,it.attachments=Mt&&JSON.stringify(Mt),it.assetMaps=null!=N?JSON.stringify(N):void 0);const lt=t._getLayerRequestOptions({method:"post",query:it});Ot&&(lt.authMode="immediate",lt.query.returnEditMoment=!0,lt.query.sessionId=g.TA);const yt=e?.returnServiceEditsOption?i.url:i.parsedUrl.path;let ct;try{ct=Et?yield t._asyncApplyEdits(yt+"/applyEdits",lt):yield(0,A.A)(yt+"/applyEdits",lt)}catch(ft){if(!function At(n){const e=n.details.raw,i=+e.extendedCode;return 500==+e.code&&(-2147217144===i||-2147467261===i)}(ft))throw ft;lt.authMode="immediate",ct=Et?yield t._asyncApplyEdits(yt+"/applyEdits",lt):yield(0,A.A)(yt+"/applyEdits",lt)}return t._createEditsResult(ct)})()}deleteAttachments(n,e){var t=this;return(0,p.A)(function*(){yield t.load();const{layer:i}=t;yield(0,f.VA)(i,"editing");const _=n.attributes[i.objectIdField],T=i.parsedUrl.path+"/"+_+"/deleteAttachments";try{return(yield(0,A.A)(T,t._getLayerRequestOptions({query:{attachmentIds:e.join(",")},method:"post"}))).data.deleteAttachmentResults.map(dt)}catch(U){throw t._createAttachmentErrorResult(_,U)}})()}fetchRecomputedExtents(n={}){var e=this;return this.load({signal:n.signal}).then((0,p.A)(function*(){const i=e._getLayerRequestOptions({...n,query:{returnUpdates:!0}}),{layerId:_,url:T}=e.layer,{data:U}=yield(0,A.A)(`${T}/${_}`,i),{id:N,extent:Z,fullExtent:H,timeExtent:k}=U,et=Z||H;return{id:N,fullExtent:et&&$.A.fromJSON(et),timeExtent:k&&R.A.fromJSON({start:k[0],end:k[1]})}}))}queryAttachments(n,e={}){var t=this;return(0,p.A)(function*(){yield t.load();const i=t._getLayerRequestOptions(e);return t.queryTask.executeAttachmentQuery(n,i)})()}queryFeatures(n,e){var t=this;return(0,p.A)(function*(){yield t.load();const i=yield t.queryTask.execute(n,{...e,query:t._createRequestQueryOptions(e)});if(n.outStatistics?.length&&i.features.length){const _=new Map;if(i.features.forEach(T=>{const U=T.attributes;n.outStatistics?.forEach(({outStatisticFieldName:N})=>{if(N){const Z=N.toLowerCase();Z&&Z in U&&N!==Z&&(U[N]=U[Z],delete U[Z],_.set(Z,N))}})}),null!=i.fields)for(const T of i.fields){const U=_.get(T.name.toLowerCase());null!=U&&(T.name=U)}}return i})()}queryFeaturesJSON(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeJSON(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryObjectIds(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeForIds(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryFeatureCount(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeForCount(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryExtent(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeForExtent(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryRelatedFeatures(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeRelationshipQuery(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryRelatedFeaturesCount(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeRelationshipQueryForCount(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryTopFeatures(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeTopFeaturesQuery(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryAttributeBins(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeAttributeBinsQuery(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryTopObjectIds(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeForTopIds(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryTopExtents(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeForTopExtents(n,{...e,query:t._createRequestQueryOptions(e)})})()}queryTopCount(n,e){var t=this;return(0,p.A)(function*(){return yield t.load(),t.queryTask.executeForTopCount(n,{...e,query:t._createRequestQueryOptions(e)})})()}fetchPublishingStatus(){var n=this;return(0,p.A)(function*(){if(!(0,o.Wo)(n.layer.url))return"unavailable";const e=(0,D.fj)(n.layer.url,"status"),t=yield(0,A.A)(e,{query:{f:"json"}});return j.fromJSON(t.data.status)})()}uploadAssets(n,e){var t=this;return(0,p.A)(function*(){const{uploadAssets:i}=yield Promise.all([r.e(2076),r.e(2403)]).then(r.bind(r,22403));return i(n,{layer:t.layer,ongoingUploads:t._ongoingAssetUploads},e)})()}_handleLastEditsEventChange(n){const e=this.layer;if(null==n||!("capabilities"in e)||!("effectiveCapabilities"in e)||e.capabilities?.operations?.supportsEditing||!e.effectiveCapabilities?.operations?.supportsEditing)return;const t=e.url;null!=t&&("layerId"in e&&(0,D.fj)(t,e.layerId.toString()),this._getOrCreateEditInterceptor(t).before=i=>{const _=i.requestOptions.method??"auto";if("auto"===_||"head"===_){const T=i.requestOptions.query??{};T._ts=n.getTime(),i.requestOptions.query=T}})}_getOrCreateEditInterceptor(n){return null==this._editInterceptor&&(this._editInterceptor={urls:n},v.A.request.internalInterceptors.push(this._editInterceptor)),this._editInterceptor}_removeEditInterceptor(){null!=this._editInterceptor&&((0,F.TF)(v.A.request.internalInterceptors,this._editInterceptor),this._editInterceptor=null)}_asyncApplyEdits(n,e){return(0,p.A)(function*(){const t=(yield(0,A.A)(n,e)).data.statusUrl;for(;;){const i=(yield(0,A.A)(t,{query:{f:"json"},responseType:"json"})).data;switch(i.status){case"Completed":return(0,A.A)(i.resultUrl,{query:{f:"json"},responseType:"json"});case"CompletedWithErrors":throw new I.A("async-applyEdits-failed","asynchronous applyEdits call failed.");case"Failed ImportChanges":case"InProgress":case"Pending":case"ExportAttachments":case"ExportChanges":case"ExportingData":case"ExportingSnapshot":case"ImportAttachments":case"ProvisioningReplica":case"UnRegisteringReplica":break;default:throw new I.A("async-applyEdits-failed","asynchronous applyEdits call failed (undefined response status)")}yield(0,c.Pl)(Q)}})()}_createRequestQueryOptions(n){const e={...this.layer.customParameters,token:this.layer.apiKey,...n?.query};return this.layer.datesInUnknownTimezone&&(e.timeReferenceUnknownClient=!0),e}_fetchService(n,e){var t=this;return(0,p.A)(function*(){if(!n){const _={};(0,y.A)("featurelayer-advanced-symbols")&&(_.returnAdvancedSymbols=!0),e?.cacheBust&&(_._ts=Date.now());const{data:T}=yield(0,A.A)(t.layer.parsedUrl.path,t._getLayerRequestOptions({query:_,signal:e?.signal}));n=T}t.sourceJSON=yield t._patchServiceJSON(n,e?.signal);const i=n.type;if(!t.supportedSourceTypes.has(i))throw new I.A("feature-layer-source:unsupported-type",`Source type "${i}" is not supported`)})()}_patchServiceJSON(n,e){var t=this;return(0,p.A)(function*(){if("Table"!==n.type&&n.geometryType&&!n?.drawingInfo?.renderer&&!n.defaultSymbol){const i=(0,It.F0)(n.geometryType).renderer;(0,E.sM)("drawingInfo.renderer",i,n)}if("esriGeometryMultiPatch"===n.geometryType&&n.infoFor3D&&(n.geometryType="mesh"),null==n.extent)try{const{data:i}=yield(0,A.A)(t.layer.url,t._getLayerRequestOptions({signal:e}));i.spatialReference&&(n.extent={xmin:0,ymin:0,xmax:0,ymax:0,spatialReference:i.spatialReference})}catch(i){(0,c.QP)(i)}return n})()}_ensureLatestMetadata(n){var e=this;return(0,p.A)(function*(){if(e.layer.userHasUpdateItemPrivileges&&e.sourceJSON.cacheMaxAge>0)return e._fetchService(null,{...n,cacheBust:!0})})()}_uploadMeshesAndGetAssetMapEditsJSON(n){var e=this;return(0,p.A)(function*(){const{addAssetFeatures:t}=n;if(!t?.length||(yield e._areAllAssetsAlreadyMapped(t)))return null;const i=n.addFeatures.filter(U=>U.geometry);if(t.length!==i.length+n.updateFeatures.length)throw new I.A("feature-layer-source:unsupported-mesh-edits","Mixing attribute only edits with mesh geometry edits is not currently supported");const _=new Array,T=new Map;for(const U of t){const{geometry:N}=U,{vertexSpace:Z}=N;if((0,P.Hq)(Z))_.push(N);else{const H=N.origin,{convertMeshVertexSpace:k}=yield Promise.all([r.e(5434),r.e(6456),r.e(5652)]).then(r.bind(r,72782)),et=yield k(N,new J.A({origin:[H.x,H.y,H.z??0]}));T.set(et,N),U.geometry=et,_.push(et)}}yield e.uploadAssets(_);for(const[U,N]of T)N.addExternalSources(U.metadata.externalSources.items);return{adds:e._getAssetMapEditsJSON(t),updates:[],deletes:[]}})()}_getAssetMapEditsJSON(n){const e=new Array,t=this.layer.globalIdField,i=this.layer.parsedUrl;for(const _ of n){const T=_.geometry,{metadata:U}=T,N=U.getExternalSourcesOnService(i),Z=_.getAttribute(t);if(0===N.length){m.A.getLogger(this).error(`Skipping feature ${Z}. The mesh it is associated with has not been uploaded to the service and cannot be mapped to it.`);continue}const{source:H}=N.find(b.dK)??N[0];for(const k of H)1===k.parts.length?e.push({globalId:(0,O.yS)(),parentGlobalId:Z,assetName:k.assetName,assetHash:k.parts[0].partHash,flags:[]}):m.A.getLogger(this).error(`Skipping asset ${k.assetName}. It does not have exactly one part, so we cannot map it to a feature.`)}return e}_createEditsResult(n){const e=n.data,{layerId:t}=this.layer,i=[];let _=null;if(Array.isArray(e))for(const U of e)i.push({id:U.id,editedFeatures:U.editedFeatures}),U.id===t&&(_={addResults:U.addResults??[],updateResults:U.updateResults??[],deleteResults:U.deleteResults??[],attachments:U.attachments,editMoment:U.editMoment});else _=e;const T=function ut(n){const e=n?.assetMaps;if(e){for(const _ of e.addResults)_.success||m.A.getLogger("esri.layers.graphics.sources.support.sourceUtils").error(`Failed to map asset to feature with globalId ${_.globalId}.`);for(const _ of e.updateResults)_.success||m.A.getLogger("esri.layers.graphics.sources.support.sourceUtils").error(`Failed to map asset to feature with globalId ${_.globalId}.`)}const t=n?.attachments,i={addFeatureResults:n?.addResults?.map(dt)??[],updateFeatureResults:n?.updateResults?.map(dt)??[],deleteFeatureResults:n?.deleteResults?.map(dt)??[],addAttachmentResults:t?.addResults?t.addResults.map(dt):[],updateAttachmentResults:t?.updateResults?t.updateResults.map(dt):[],deleteAttachmentResults:t?.deleteResults?t.deleteResults.map(dt):[]};return n?.editMoment&&(i.editMoment=n.editMoment),i}(_);if(i.length>0){T.editedFeatureResults=[];for(const U of i){const{editedFeatures:N}=U,Z=N?.spatialReference?new q.A(N.spatialReference):null;T.editedFeatureResults.push({layerId:U.id,editedFeatures:Rt(N,Z)})}}return T}_createAttachmentErrorResult(n,e){return{objectId:n,globalId:null,error:new I.A("feature-layer-source:attachment-failure",e.details.messages?.[0]||e.message,{code:e.details.httpStatus||e.details.messageCode})}}_getFormDataForAttachment(n,e){const t=n instanceof FormData?n:n&&n.elements?new FormData(n):null;if(t)for(const i in e){const _=e[i];null!=_&&(t.set?t.set(i,_):t.append(i,_))}return t}_getLayerRequestOptions(n={}){const{layer:e,layer:{parsedUrl:t,gdbVersion:i}}=this;return{...n,query:{gdbVersion:i,layer:"dynamicDataSource"in e&&e.dynamicDataSource?JSON.stringify({source:e.dynamicDataSource}):void 0,...t.query,f:"json",...this._createRequestQueryOptions(n)},responseType:"json"}}_areAllAssetsAlreadyMapped(n){var e=this;return(0,p.A)(function*(){const{layer:t}=e,{globalIdField:i,parsedUrl:_}=t,T="infoFor3D"in t?t.infoFor3D:null;if(null==T||null==i)return!1;const U=(0,s.JZ)(T);if(null==U)return!1;const N=(0,D.fj)(_.path,`../${U.id}`),Z=new Array;for(const nt of n){if(!(nt.geometry.metadata.getExternalSourcesOnService(_).length>0))return!1;Z.push(nt)}const H=Z.map(nt=>nt.getAttribute(i)).filter(F.Ru);if(0===H.length)return!1;const{assetMapFieldRoles:{parentGlobalId:k,assetHash:et}}=T,ht=new h.A({where:`${k} IN (${H.map(nt=>`'${nt}'`)})`,outFields:[et,k],returnGeometry:!1}),Mt=yield(0,a.s)(N,ht),{features:Et}=Mt;return 0!==Et.length&&!Z.some(nt=>{const it=nt.getAttribute(i);if(!it)return!0;const{metadata:Ot}=nt.geometry,lt=Et.filter(ct=>ct.getAttribute(k)===it);if(0===lt.length)return!0;const yt=lt.map(ct=>ct.getAttribute(et));return Ot.getExternalSourcesOnService(_).flatMap(({source:ct})=>ct.flatMap(ft=>ft.parts.map(Pt=>Pt.partHash))).some(ct=>yt.every(ft=>ct!==ft))})})()}};(0,C._)([(0,B.MZ)()],K.prototype,"type",void 0),(0,C._)([(0,B.MZ)({constructOnly:!0})],K.prototype,"layer",void 0),(0,C._)([(0,B.MZ)({constructOnly:!0})],K.prototype,"supportedSourceTypes",void 0),(0,C._)([(0,B.MZ)({readOnly:!0})],K.prototype,"queryTask",null),K=(0,C._)([(0,G.$)("esri.layers.graphics.sources.FeatureLayerSource")],K);const Q=1e3,st=K},89962:(at,w,r)=>{r.d(w,{F0:()=>F,Vx:()=>M,e2:()=>m,f:()=>E});var p=r(3248),C=r(77806),v=r(78200),A=r(48254);function F(c){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===c||"esriGeometryMultipoint"===c?A.Cb:"esriGeometryPolyline"===c?A.yM:A.WR}}}const I=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let y=1;function M(c,l){if((0,p.A)("esri-csp-restrictions"))return()=>({[l]:null,...c});try{let D=`this${d(l)} = null;`;for(const B in c)D+=`this${d(B)} = ${JSON.stringify(c[B])};`;const O=new Function(`\n      return class AttributesClass$${y++} {\n        constructor() {\n          ${D};\n        }\n      }\n    `)();return()=>new O}catch{return()=>({[l]:null,...c})}}function d(c){return I.test(c)?`.${c}`:`["${c}"]`}function m(c={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,C.o8)(c)}}]}function E(c,l){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:c},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:l,supportsDelete:l,supportsEditing:l,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:l,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:v.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:v.P,editing:{supportsGeometryUpdate:l,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}}}]);