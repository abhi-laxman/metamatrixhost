"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[5090],{75090:(G,D,e)=>{e.r(D),e.d(D,{default:()=>a});var r,i=e(10467),l=e(8189),S=e(89563),f=e(5922),R=e(39693),T=e(1119),A=e(45272),y=e(85211),I=(e(3248),e(35150),e(40707),e(17221)),c=e(76576),o=e(50305),p=e(28067),d=e(1749),E=e(32034),M=e(95478),U=e(93410),W=e(17049),B=e(85551),K=e(1151),O=e(33036),g=e(63014),n=e(29598),L=e(11333),s=e(5079);let t=r=class extends((0,U.dM)((0,K.J)((0,O.j)((0,W.q)((0,B.A)((0,R.P)(M.A))))))){constructor(...u){super(...u),this.copyright="",this.fullExtent=new p.A(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,E.A.WebMercator),this.legendEnabled=!1,this.isReference=null,this.popupEnabled=!1,this.spatialReference=E.A.WebMercator,this.subDomains=null,this.tileInfo=new L.A({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new d.A({x:-20037508.342787,y:20037508.342787,spatialReference:E.A.WebMercator}),spatialReference:E.A.WebMercator,lods:[new n.A({level:0,scale:591657527.591555,resolution:156543.033928}),new n.A({level:1,scale:295828763.795777,resolution:78271.5169639999}),new n.A({level:2,scale:147914381.897889,resolution:39135.7584820001}),new n.A({level:3,scale:73957190.948944,resolution:19567.8792409999}),new n.A({level:4,scale:36978595.474472,resolution:9783.93962049996}),new n.A({level:5,scale:18489297.737236,resolution:4891.96981024998}),new n.A({level:6,scale:9244648.868618,resolution:2445.98490512499}),new n.A({level:7,scale:4622324.434309,resolution:1222.99245256249}),new n.A({level:8,scale:2311162.217155,resolution:611.49622628138}),new n.A({level:9,scale:1155581.108577,resolution:305.748113140558}),new n.A({level:10,scale:577790.554289,resolution:152.874056570411}),new n.A({level:11,scale:288895.277144,resolution:76.4370282850732}),new n.A({level:12,scale:144447.638572,resolution:38.2185141425366}),new n.A({level:13,scale:72223.819286,resolution:19.1092570712683}),new n.A({level:14,scale:36111.909643,resolution:9.55462853563415}),new n.A({level:15,scale:18055.954822,resolution:4.77731426794937}),new n.A({level:16,scale:9027.977411,resolution:2.38865713397468}),new n.A({level:17,scale:4513.988705,resolution:1.19432856685505}),new n.A({level:18,scale:2256.994353,resolution:.597164283559817}),new n.A({level:19,scale:1128.497176,resolution:.298582141647617}),new n.A({level:20,scale:564.248588,resolution:.14929107082380833}),new n.A({level:21,scale:282.124294,resolution:.07464553541190416}),new n.A({level:22,scale:141.062147,resolution:.03732276770595208}),new n.A({level:23,scale:70.5310735,resolution:.01866138385297604})]}),this.type="web-tile",this.urlTemplate=null,this.wmtsInfo=null}normalizeCtorArgs(u,v){return"string"==typeof u?{urlTemplate:u,...v}:u}load(u){const v=this.loadFromPortal({supportedTypes:["WMTS"]},u).then(()=>{let P="";if(this.urlTemplate)if(this.spatialReference.equals(this.tileInfo.spatialReference)){const C=new A.s0(this.urlTemplate);!(this.subDomains&&this.subDomains.length>0)&&C.authority?.includes("{subDomain}")&&(P="is missing 'subDomains' property")}else P="spatialReference must match tileInfo.spatialReference";else P="is missing the required 'urlTemplate' property value";if(P)throw new f.A("web-tile-layer:load",`WebTileLayer (title: '${this.title}', id: '${this.id}') ${P}`)});return this.addResolvingPromise(v),Promise.resolve(this)}get levelValues(){const u=[];if(!this.tileInfo)return null;for(const v of this.tileInfo.lods)u[v.level]=v.levelValue||v.level;return u}readSpatialReference(u,v){return u||E.A.fromJSON(v.fullExtent?.spatialReference)}get tileServers(){if(!this.urlTemplate)return null;const u=[],{urlTemplate:v,subDomains:P}=this,C=new A.s0(v),j=C.scheme?C.scheme+"://":"//",b=j+C.authority+"/",w=C.authority;if(w?.includes("{subDomain}")){if(P&&P.length>0&&w.split(".").length>1)for(const x of P)u.push(j+w.replaceAll(/\{subDomain\}/gi,x)+"/")}else u.push(b);return u.map(A.Il)}get urlPath(){if(!this.urlTemplate)return null;const u=this.urlTemplate,v=new A.s0(u);return u.slice(((v.scheme?v.scheme+"://":"//")+v.authority+"/").length)}readUrlTemplate(u,v){return u||v.templateUrl}writeUrlTemplate(u,v){(0,A.BQ)(u)&&(u="https:"+u),u&&(u=u.replaceAll(/\{z\}/gi,"{level}").replaceAll(/\{x\}/gi,"{col}").replaceAll(/\{y\}/gi,"{row}"),u=(0,A.S8)(u)),v.templateUrl=u}fetchTile(u,v,P,C={}){const{signal:j}=C,b=this.getTileUrl(u,v,P),w={responseType:"image",signal:j,query:{...this.refreshParameters}};return(0,S.A)(b,w).then(x=>x.data)}fetchImageBitmapTile(u,v,P,C={}){var j=this;return(0,i.A)(function*(){const{signal:b}=C;if(j.fetchTile!==r.prototype.fetchTile){const $=yield j.fetchTile(u,v,P,C);return(0,g.C)($,u,v,P,b)}const w=j.getTileUrl(u,v,P),x={responseType:"blob",signal:b,query:{...j.refreshParameters}},{data:Z}=yield(0,S.A)(w,x);return(0,g.C)(Z,u,v,P,b)})()}getTileUrl(u,v,P){const{levelValues:C,tileServers:j,urlPath:b}=this;if(!C||!j||!b)return"";const w=C[u];return j[v%j.length]+(0,T.HC)(b,{level:w,z:w,col:P,x:P,row:v,y:v})}};(0,l._)([(0,y.MZ)({type:String,value:"",json:{write:!0}})],t.prototype,"copyright",void 0),(0,l._)([(0,y.MZ)({type:p.A,json:{write:!0},nonNullable:!0})],t.prototype,"fullExtent",void 0),(0,l._)([(0,y.MZ)({readOnly:!0,json:{read:!1,write:!1}})],t.prototype,"legendEnabled",void 0),(0,l._)([(0,y.MZ)({type:["show","hide"]})],t.prototype,"listMode",void 0),(0,l._)([(0,y.MZ)({json:{read:!0,write:!0}})],t.prototype,"blendMode",void 0),(0,l._)([(0,y.MZ)()],t.prototype,"levelValues",null),(0,l._)([(0,y.MZ)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],t.prototype,"isReference",void 0),(0,l._)([(0,y.MZ)({type:["WebTiledLayer"],value:"WebTiledLayer"})],t.prototype,"operationalLayerType",void 0),(0,l._)([(0,y.MZ)({readOnly:!0,json:{read:!1,write:!1}})],t.prototype,"popupEnabled",void 0),(0,l._)([(0,y.MZ)({type:E.A})],t.prototype,"spatialReference",void 0),(0,l._)([(0,I.w)("spatialReference",["spatialReference","fullExtent.spatialReference"])],t.prototype,"readSpatialReference",null),(0,l._)([(0,y.MZ)({type:[String],json:{write:!0}})],t.prototype,"subDomains",void 0),(0,l._)([(0,y.MZ)({type:L.A,json:{write:!0}})],t.prototype,"tileInfo",void 0),(0,l._)([(0,y.MZ)({readOnly:!0})],t.prototype,"tileServers",null),(0,l._)([(0,y.MZ)({json:{read:!1}})],t.prototype,"type",void 0),(0,l._)([(0,y.MZ)()],t.prototype,"urlPath",null),(0,l._)([(0,y.MZ)({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],t.prototype,"urlTemplate",void 0),(0,l._)([(0,I.w)("urlTemplate",["urlTemplate","templateUrl"])],t.prototype,"readUrlTemplate",null),(0,l._)([(0,o.K)("urlTemplate",{templateUrl:{type:String}})],t.prototype,"writeUrlTemplate",null),(0,l._)([(0,y.MZ)({type:s.x,json:{write:!0}})],t.prototype,"wmtsInfo",void 0),t=r=(0,l._)([(0,c.$)("esri.layers.WebTileLayer")],t);const a=t},72211:(G,D,e)=>{e.d(D,{LF:()=>R,M9:()=>T,zu:()=>_});var i=e(5922),l=e(89221),S=e(79845),f=e(26073);function R(c,o,p){try{return function y(c){if(!c||0===c.length)return null;if(function m(c){const o=c[0];return!!o&&"scale"in o}(c)){const o=[];for(const p of c)o.push({scale:p.scale,value:_(p.value)});return o}return _(c)}(c)}catch(d){p?.messages?.push(d)}return null}function T(c,o,p,d){try{const E=function A(c){const o=(0,S.q)(c);return o?(0,f.dw)(o)?o.map(p=>p.toJSON()):o.map(({scale:p,effects:d})=>({scale:p,value:d.map(E=>E.toJSON())})):null}(c);(0,l.sM)(p,E,o)}catch(E){d.messages&&d.messages.push(E)}}function _(c){if(!c?.length)return"";const o=[];for(const p of c){let d=[];switch(p.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":d=[h(p,"amount")];break;case"blur":d=[h(p,"radius","pt")];break;case"hue-rotate":d=[h(p,"angle","deg")];break;case"drop-shadow":d=[h(p,"xoffset","pt"),h(p,"yoffset","pt"),h(p,"blurRadius","pt"),I(p,"color")];break;case"bloom":d=[h(p,"strength"),h(p,"radius","pt"),h(p,"threshold")]}const E=`${p.type}(${d.filter(Boolean).join(" ")})`;(0,S.q)(E),o.push(E)}return o.join(" ")}function h(c,o,p){if(null==c[o])throw new i.A("effect:missing-parameter",`Missing parameter '${o}' in ${c.type} effect`,{effect:c});return p?c[o]+p:""+c[o]}function I(c,o){if(null==c[o])throw new i.A("effect:missing-parameter",`Missing parameter '${o}' in ${c.type} effect`,{effect:c});const p=c[o];return`rgba(${p[0]||0}, ${p[1]||0}, ${p[2]||0}, ${p[3]/255||0})`}},93410:(G,D,e)=>{e.d(D,{LF:()=>h,dM:()=>I,sU:()=>m});var i=e(8189),l=e(85211),T=(e(3248),e(35150),e(40707),e(76576)),A=e(50501),y=e(72211);const m={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:A.K}},"portal-item":{read:!0,write:{layerContainerTypes:A.K}}}}},_={read:{reader:y.LF},write:{allowNull:!0,writer:y.M9,layerContainerTypes:A.K}},h={json:{read:!1,write:!1,origins:{"web-map":_,"portal-item":_}}},I=c=>{let o=class extends c{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,i._)([(0,l.MZ)(m)],o.prototype,"blendMode",void 0),(0,i._)([(0,l.MZ)(h)],o.prototype,"effect",void 0),o=(0,i._)([(0,T.$)("esri.layers.mixins.BlendLayer")],o),o}},17049:(G,D,e)=>{e.d(D,{q:()=>W});var i=e(8189),l=e(5922),S=e(45272),f=e(85211),R=e(55739),y=(e(3248),e(40707),e(17221)),m=e(76576),_=e(50305),h=e(50501),I=e(34813),c=e(56558);const o={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},p={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},d={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},E={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,Object3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":o,"web-map/basemap":p,"web-map/tables":d,"link-chart/operational-layers":{...o,LinkChartLayer:!0},"link-chart/basemap":p,"link-chart/tables":d,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0,WCS:!0},"portal-item/tables":{ArcGISFeatureLayer:!0,SubtypeGroupTable:!0}};var M=e(22329),U=e(17181);const W=K=>{let O=class extends K{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(g,n,L){return"Group Layer"===L?.portalItem?.type?void 0:g}writeListMode(g,n,L,s){(s&&"ground"===s.layerContainerType||g&&(0,c.R)(this,L,{},s))&&(n[L]=g)}writeOperationalLayerType(g,n,L){g&&(n[L]=g)}writeTitle(g,n){n.title=g??"Layer"}readVisibilityTimeExtent(g){return g?U.A.fromArray(g):null}writeVisibilityTimeExtent(g,n,L,s){g&&"tables"!==s.layerContainerType&&(g.isEmpty?s?.messages&&s.messages.push(new l.A("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):n[L]=g.toArray())}read(g,n){n&&(n.layer=this),(0,I.t)(this,g,L=>super.read(g,L),n)}write(g,n){if(!this.persistenceEnabled&&!n?.ignorePersistenceEnabled)return null;if(n?.origin){const r=`${n.origin}/${n.layerContainerType||"operational-layers"}`;let a=!!E[r]?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===r&&(a=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===r&&(a=!1),!a)return n.messages?.push(new l.A("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${r}'`,{layer:this})),null}const L=super.write(g,{...n,layer:this}),s=!!n&&!!n.messages&&!!n.messages.filter(r=>r instanceof l.A&&"web-document-write:property-required"===r.name).length;return(0,S.w8)(L?.url)?(n?.messages?.push(new l.A("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&s?null:L}beforeSave(){}};return(0,i._)([(0,f.MZ)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],O.prototype,"id",void 0),(0,i._)([(0,y.w)("id",["id"])],O.prototype,"readId",null),(0,i._)([(0,f.MZ)(M.C1)],O.prototype,"listMode",void 0),(0,i._)([(0,_.K)("listMode")],O.prototype,"writeListMode",null),(0,i._)([(0,f.MZ)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:h.K,isRequired:!0}}}}})],O.prototype,"operationalLayerType",void 0),(0,i._)([(0,_.K)("operationalLayerType")],O.prototype,"writeOperationalLayerType",null),(0,i._)([(0,f.MZ)(M.ke)],O.prototype,"opacity",void 0),(0,i._)([(0,f.MZ)({type:Boolean,readOnly:!1})],O.prototype,"persistenceEnabled",void 0),(0,i._)([(0,f.MZ)({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],O.prototype,"title",void 0),(0,i._)([(0,_.K)("title"),(0,_.K)(["web-scene"],"title")],O.prototype,"writeTitle",null),(0,i._)([(0,f.MZ)({type:U.A,json:{origins:{"web-scene":{write:{layerContainerTypes:h.K}}}}})],O.prototype,"visibilityTimeExtent",void 0),(0,i._)([(0,y.w)("visibilityTimeExtent")],O.prototype,"readVisibilityTimeExtent",null),(0,i._)([(0,_.K)(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[R.jz,R.Uv]]}})],O.prototype,"writeVisibilityTimeExtent",null),(0,i._)([(0,f.MZ)({type:Boolean,json:{name:"visibility",write:{layerContainerTypes:h.K}}})],O.prototype,"visible",void 0),O=(0,i._)([(0,m.$)("esri.layers.mixins.OperationalLayer")],O),O}},85551:(G,D,e)=>{e.d(D,{A:()=>O});var i=e(10467),l=e(8189),S=e(23098),f=e(77469),R=e(89563),T=e(89447),A=e(5922),y=e(35150),m=e(11432),_=e(56492),h=e(45272),I=e(85211),p=(e(3248),e(40707),e(17221)),d=e(76576),E=e(50305),M=e(58443),U=e(73874),W=e(46577),B=e(52606),K=e(69927);const O=n=>{let L=class extends n{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,m.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(s){s!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",s))}readPortalItem(s,r,t){if(r.itemId)return new W.default({id:r.itemId,portal:t?.portal})}writePortalItem(s,r){s?.id&&(r.itemId=s.id)}loadFromPortal(s,r){var t=this;return(0,i.A)(function*(){if(t.portalItem?.id)try{const{load:a}=yield Promise.all([e.e(2076),e.e(6180)]).then(e.bind(e,56180));return(0,_.Te)(r),yield a({instance:t,supportedTypes:s.supportedTypes,validateItem:s.validateItem,supportsData:s.supportsData,layerModuleTypeMap:s.layerModuleTypeMap,populateGroupLayer:s.populateGroupLayer},r)}catch(a){throw(0,_.zf)(a)||y.A.getLogger(t).warn(`Failed to load layer (${t.title}, ${t.id}) portal item (${t.portalItem.id})\n  ${a}`),a}})()}finishLoadEditablePortalLayer(s){var r=this;return(0,i.A)(function*(){r._set("userHasEditingPrivileges",yield r._fetchUserHasEditingPrivileges(s).catch(t=>((0,_.QP)(t),!0)))})()}setUserPrivileges(s,r){var t=this;return(0,i.A)(function*(){if(!S.A.userPrivilegesApplied)return t.finishLoadEditablePortalLayer(r);if(t.url)try{const{features:{edit:a,fullEdit:u},content:{updateItem:v}}=yield t._fetchUserPrivileges(s,r);t._set("userHasEditingPrivileges",a),t._set("userHasFullEditingPrivileges",u),t._set("userHasUpdateItemPrivileges",v)}catch(a){(0,_.QP)(a)}})()}_fetchUserPrivileges(s,r){var t=this;return(0,i.A)(function*(){let a=t.portalItem;if(!s||!a||!a.loaded||a.sourceUrl)return t._fetchFallbackUserPrivileges(r);const u=!f.id?.findCredential(t.url),v=s===a.id;if(v&&a.portal.user)return t._getUserPrivileges(a,u);let P,C;if(v)P=a.portal.url;else try{P=yield(0,M.wI)(t.url,r)}catch(x){(0,_.QP)(x)}if(!P||!(0,h.b8)(P,a.portal.url))return t._fetchFallbackUserPrivileges(r);try{const x=null!=r?r.signal:null;C=yield f.id?.getCredential(`${P}/sharing`,{prompt:!1,signal:x})}catch(x){(0,_.QP)(x)}if(!C)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(v?yield a.reload():(a=new W.default({id:s,portal:{url:P}}),yield a.load(r)),a.portal.user)return t._getUserPrivileges(a,u)}catch(x){(0,_.QP)(x)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_getUserPrivileges(s,r){const t=(0,K.It)(s);return r&&(t.features.edit=!0),t}_fetchFallbackUserPrivileges(s){var r=this;return(0,i.A)(function*(){let t=!0;try{t=yield r._fetchUserHasEditingPrivileges(s)}catch(a){(0,_.QP)(a)}return{features:{edit:t,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(s){var r=this;return(0,i.A)(function*(){const t=r.url?f.id?.findCredential(r.url):null;if(!t)return!0;const a=g.credential===t?g.user:yield r._fetchEditingUser(s);return g.credential=t,g.user=a,null==a?.privileges||a.privileges.includes("features:user:edit")})()}_fetchEditingUser(s){var r=this;return(0,i.A)(function*(){const t=r.portalItem?.portal?.user;if(t)return t;const a=f.id?.findServerInfo(r.url??"");if(!a?.owningSystemUrl)return null;const u=`${a.owningSystemUrl}/sharing/rest`,v=U.A.getDefault();if(v&&v.loaded&&(0,h.S8)(v.restUrl)===(0,h.S8)(u))return v.user;const P=`${u}/community/self`,C=null!=s?s.signal:null,j=yield(0,T.Ke)((0,R.A)(P,{authMode:"no-prompt",query:{f:"json"},signal:C}));return j.ok?B.A.fromJSON(j.value.data):null})()}read(s,r){r&&(r.layer=this),super.read(s,r)}write(s,r){const t=r?.portal,a=this.portalItem?.id&&(this.portalItem.portal||U.A.getDefault());return t&&a&&!(0,h.ut)(a.restUrl,t.restUrl)?(r.messages&&r.messages.push(new A.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(s,{...r,layer:this})}};return(0,l._)([(0,I.MZ)({type:W.default})],L.prototype,"portalItem",null),(0,l._)([(0,p.w)("web-document","portalItem",["itemId"])],L.prototype,"readPortalItem",null),(0,l._)([(0,E.K)("web-document","portalItem",{itemId:{type:String}})],L.prototype,"writePortalItem",null),(0,l._)([(0,I.MZ)({clonable:!1})],L.prototype,"resourceReferences",void 0),(0,l._)([(0,I.MZ)({type:Boolean,readOnly:!0})],L.prototype,"userHasEditingPrivileges",void 0),(0,l._)([(0,I.MZ)({type:Boolean,readOnly:!0})],L.prototype,"userHasFullEditingPrivileges",void 0),(0,l._)([(0,I.MZ)({type:Boolean,readOnly:!0})],L.prototype,"userHasUpdateItemPrivileges",void 0),L=(0,l._)([(0,d.$)("esri.layers.mixins.PortalLayer")],L),L},g={credential:null,user:null}},1151:(G,D,e)=>{e.d(D,{J:()=>L});var i=e(10467),l=e(8189),f=(e(3248),e(35150)),R=e(56492),T=e(85211),A=e(48669),m=(e(40707),e(76576)),_=e(50501),h=e(31178),I=e(48900),c=e(34703);const o=new h.A,p=new WeakMap;function U(s,r){return Number.isFinite(s)&&Number.isFinite(r)?r<=0?s:U(r,s%r):0}let W=0,B=0;function K(){const s=Date.now();let r=!1;for(const t of o){const a=t.deref();a?a.refreshInterval&&s-(p.get(a)??0)+5>=6e4*a.refreshInterval&&(p.set(a,s),a.refresh(s)):r=!0}if(r)for(let t=o.length-1;t>=0;t--)o.at(t).deref()||o.removeAt(t)}(0,c.fm)(()=>{const s=Date.now();let r=0;for(const t of o){const a=t.deref();a&&(r=U(Math.round(6e4*a.refreshInterval),r),a.refreshInterval?p.get(a)||p.set(a,s):p.delete(a))}if(r!==B){if(B=r,clearInterval(W),0===B)return void(W=0);W=setInterval(K,B)}},I.OH);const L=s=>{let r=class extends s{constructor(...t){super(...t),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,R.sg)(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||function d(s){(function M(s){return null!=s&&"object"==typeof s&&"refreshInterval"in s&&"refresh"in s})(s)&&o.push(new WeakRef(s))}(this)},()=>{})}destroy(){!function E(s){const r=o.find(t=>t.deref()===s);r&&o.remove(r)}(this)}castRefreshInterval(t){return t>=.1?t:t<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(t=Date.now()){(0,R.QZ)(this._debounceHasDataChanged()).then(a=>{a&&this._set("refreshTimestamp",t),this.emit("refresh",{dataChanged:a})},a=>{f.A.getLogger(this).error(a),this.emit("refresh",{dataChanged:!1,error:a})})}hasDataChanged(){return(0,i.A)(function*(){return!0})()}get test(){}};return(0,l._)([(0,T.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:_.K}}}}})],r.prototype,"refreshInterval",void 0),(0,l._)([(0,A.w)("refreshInterval")],r.prototype,"castRefreshInterval",null),(0,l._)([(0,T.MZ)({readOnly:!0})],r.prototype,"refreshTimestamp",void 0),(0,l._)([(0,T.MZ)({readOnly:!0})],r.prototype,"refreshParameters",null),r=(0,l._)([(0,m.$)("esri.layers.mixins.RefreshableLayer")],r),r}},33036:(G,D,e)=>{e.d(D,{j:()=>A});var i=e(8189),l=e(85211),T=(e(3248),e(35150),e(40707),e(76576));const A=m=>{let _=class extends m{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const h={minScale:this.minScale,maxScale:this.maxScale},I=this.parent;I&&"effectiveScaleRange"in I&&function y(m,_){m.minScale=m.minScale>0?_.minScale>0?Math.min(m.minScale,_.minScale):m.minScale:_.minScale,m.maxScale=m.maxScale>0?_.maxScale>0?Math.max(m.maxScale,_.maxScale):m.maxScale:_.maxScale}(h,I.effectiveScaleRange);const c=this._get("effectiveScaleRange");return c&&c.minScale===h.minScale&&c.maxScale===h.maxScale?c:h}};return(0,i._)([(0,l.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],_.prototype,"minScale",void 0),(0,i._)([(0,l.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],_.prototype,"maxScale",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],_.prototype,"effectiveScaleRange",null),_=(0,i._)([(0,T.$)("esri.layers.mixins.ScaleRangeLayer")],_),_}},5079:(G,D,e)=>{e.d(D,{x:()=>m});var y,i=e(8189),l=e(71065),S=e(77806),f=e(85211),A=(e(3248),e(35150),e(76576));let m=y=class extends l.A{constructor(_){super(_)}clone(){return new y({customLayerParameters:(0,S.o8)(this.customLayerParameters),customParameters:(0,S.o8)(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})}};(0,i._)([(0,f.MZ)({json:{type:Object,write:!0}})],m.prototype,"customLayerParameters",void 0),(0,i._)([(0,f.MZ)({json:{type:Object,write:!0}})],m.prototype,"customParameters",void 0),(0,i._)([(0,f.MZ)({type:String,json:{write:!0}})],m.prototype,"layerIdentifier",void 0),(0,i._)([(0,f.MZ)({type:String,json:{write:!0}})],m.prototype,"tileMatrixSet",void 0),(0,i._)([(0,f.MZ)({type:String,json:{write:!0}})],m.prototype,"url",void 0),m=y=(0,i._)([(0,A.$)("esri.layers.support.WMTSLayerInfo")],m)},63014:(G,D,e)=>{e.d(D,{C:()=>T,m:()=>f});var i=e(10467),l=e(5922),S=e(56492);function f(y,m,_){return R.apply(this,arguments)}function R(){return(R=(0,i.A)(function*(y,m,_){let h;try{h=yield createImageBitmap(y)}catch(I){throw new l.A("request:server",`Unable to load ${m}`,{url:m,error:I})}return(0,S.Te)(_),h})).apply(this,arguments)}function T(y,m,_,h,I){return A.apply(this,arguments)}function A(){return(A=(0,i.A)(function*(y,m,_,h,I){let c;try{c=yield createImageBitmap(y)}catch(o){throw new l.A("request:server",`Unable to load tile ${m}/${_}/${h}`,{error:o,level:m,row:_,col:h})}return(0,S.Te)(I),c})).apply(this,arguments)}},69927:(G,D,e)=>{e.d(D,{It:()=>p,LG:()=>A,OM:()=>_,Sm:()=>h,Y:()=>y,bK:()=>m,mm:()=>o,sQ:()=>I});var i=e(10467),l=e(13970),S=e(32034),f=e(55039);function T(){return(T=(0,i.A)(function*(d){const E=d.spatialReference;if(E.isWGS84)return d.clone();if(E.isWebMercator)return(0,f.ci)(d);const M=S.A.WGS84;return yield(0,l.initializeProjection)(E,M),(0,l.project)(d,M)})).apply(this,arguments)}function A(d,E){if(!y(d,E)){const M=d.typeKeywords;M?M.push(E):d.typeKeywords=[E]}}function y(d,E){return!!d.typeKeywords?.includes(E)}function m(d){return y(d,o.HOSTED_SERVICE)}function _(d,E){const M=d.typeKeywords;if(M){const U=M.indexOf(E);U>-1&&M.splice(U,1)}}function h(d,E,M){M?A(d,E):_(d,E)}function I(d){return c.apply(this,arguments)}function c(){return c=(0,i.A)(function*(d){const E=d.clone().normalize();let M;if(E.length>1)for(const U of E)M?U.width>M.width&&(M=U):M=U;else M=E[0];return function R(d){return T.apply(this,arguments)}(M)}),c.apply(this,arguments)}const o={DEVELOPER_BASEMAP:"DeveloperBasemap",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",LOCAL_SCENE:"ViewingMode-Local",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function p(d){const{portal:E,isOrgItem:M,itemControl:U}=d,W=E.user?.privileges;let B=!W||W.includes("features:user:edit"),K=!!M&&!!W?.includes("features:user:fullEdit");const O="update"===U||"admin"===U;return O?K=B=!0:K&&(B=!0),{features:{edit:B,fullEdit:K},content:{updateItem:O}}}}}]);