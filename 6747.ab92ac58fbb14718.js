"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[6747],{47139:(yt,at,A)=>{A.d(at,{y:()=>X});const q=new(A(82818).A);function X(W){if(null==W)return["",!1];if(!q.hasBidiChar(W))return[W,!1];let B;return B="rtl"===q.checkContextual(W)?"IDNNN":"ICNNN",[q.bidiTransform(W,B,"VLYSN"),!0]}},86468:(yt,at,A)=>{A.d(at,{T:()=>X,U:()=>q});var it=A(69287);function q(b,_,o=0){const u=(0,it.qE)(b,0,E);for(let d=0;d<4;d++)_[o+d]=Math.floor(256*P(u*W[d]))}function X(b,_=0){let o=0;for(let u=0;u<4;u++)o+=b[_+u]*B[u];return o}const W=[1,256,65536,16777216],B=[1/256,1/65536,1/16777216,1/4294967296],E=X(new Uint8ClampedArray([255,255,255,255]));function P(b){return b-Math.floor(b)}},98894:(yt,at,A)=>{A.d(at,{Al:()=>b,NZ:()=>u,Vb:()=>X,af:()=>d,rK:()=>m});var it=A(10467),q=A(23098);const X="arial-unicode-ms",W="woff2",B=new Map,E=new Set;class P{constructor(f,x){this.fontFace=f,this.promise=x}}function b(n){return _.apply(this,arguments)}function _(){return(_=(0,it.A)(function*(n){const f=function h(n){const f=r(n)+c(n);return(n.family||X)+(f.length>0?f:"-regular")}(n),x=m(n),w=B.get(f);if(w)return w.promise;const O=new FontFace(n.family,`url('${q.A.fontsUrl}/woff2/${x}.${W}') format('${W}')`,{style:n.style,weight:n.weight}),U=document.fonts;if(U.has(O)&&"loading"===O.status)return O.loaded;const G=O.load().then(()=>(U.add(O),O));return B.set(f,new P(O,G)),E.add(O),G})).apply(this,arguments)}function u(n){return E.has(n)}function d(n){if(!n)return X;const f=n.toLowerCase().split(" ").join("-");switch(f){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return f}}function m(n){const f=r(n)+c(n);return d(n.family)+(f.length>0?f:"-regular")}function r(n){if(!n.weight)return"";switch(n.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}function c(n){if(!n.style)return"";switch(n.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}},72137:(yt,at,A)=>{A.d(at,{z:()=>B});var it=A(77806),q=A(53262),X=A(61320),W=A(13682);class B{static fromOptimized(r,c,n=!1,f=!1,x=1){return(new E).initialize(r,c,n,f,x)}static fromJSON(r,c=!1,n=!1){const[f,x]=b(r);return(new _).initialize(f,x,c,n,1)}static fromOptimizedCIM(r,c,n=!1,f=!1,x=1){return(new d).initialize(r,c,n,f,x)}static fromJSONCIM(r,c=!1,n=!1,f=1){const[x,w]=b(r);return(new m).initialize(x,w,c,n,f)}static fromFeatureSetReader(r){const c=r.readGeometryForDisplay(),n=r.geometryType;return c&&n?this.fromOptimized(c,n):null}static fromFeatureSetReaderCIM(r){const c=r.readGeometryForDisplay(),n=r.geometryType;return c&&n?this.fromOptimizedCIM(c,n):null}static createEmptyOptimized(r,c=!1,n=!1,f=1){return(new E).initialize(new W.A,r,c,n,f)}static createEmptyJSON(r,c=!1,n=!1){return(new _).initialize([],r,c,n,1)}static createEmptyOptimizedCIM(r,c=!1,n=!1,f=1){return(new d).initialize(new W.A,r,c,n,f)}static createEmptyJSONCIM(r,c=!1,n=!1,f=1){return(new m).initialize([],r,c,n,f)}asJSON(){const r=(0,q.x)(this);return"esriGeometryEnvelope"===this.geometryType?{xmin:r[0][0][0],ymin:r[0][0][1],xmax:r[0][2][0],ymax:r[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:r.flat()}:"esriGeometryPoint"===this.geometryType?{x:r[0][0][0],y:r[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:r}:{paths:r}}getCurrentRingArea(){if(this.pathSize<3)return 0;let r,c,n=0;if(this.seekPathStart(),!this.nextPoint())return 0;r=this.x,c=this.y;const f=r,x=c;for(;this.nextPoint();)n+=(r-this.x)*(c+this.y),r=this.x,c=this.y;return n+=(r-f)*(c+x),-.5*n}invertY(){this.yFactor*=-1}}class E extends B{constructor(){super(...arguments),this._end=-1}initialize(r,c,n,f,x){return this.hasZ=n,this.hasM=f,this.geometryType=c,this._stride=2+Number(n)+Number(f),this._geometry=r,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=x,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(r){if(r>=0&&r<this.totalSize){if(this._pathIndex<r)for(;this._pathIndex<r&&this.nextPath(););else if(this._pathIndex>r)for(;this._pathIndex>r&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(r){const c=this._pathOffset+r*this._stride;return c>=0&&c<this._end&&(this._pointOffset=c,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return!(this.pathIndex>=this.totalSize-1||(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,0))}prevPath(){return!(this.pathIndex<=0||(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,0))}getCurrentPath(){const r=this._end,c=this._geometry.coords,n=this._pathOffset;return(new E).initialize(new W.A([this.pathSize],c.slice(n,r)),this.geometryType,this.hasZ,this.hasM,this.yFactor)}pathLength(){const r=this._end,c=this._stride,n=this._geometry.coords;let f=0;for(let x=this._pathOffset+c;x<r;x+=c){const U=n[x]-n[x-c],G=n[x+1]-n[x-c+1];f+=Math.sqrt(U*U+G*G)}return f}startPath(){this._geometry.lengths.push(0)}pushPath(r){this.startPath(),this.pushPoints(r)}pushPoint(r){for(let c=0;c<this._stride;++c)this._geometry.coords.push(r[c]);this._geometry.lengths[this.totalSize-1]++}pushXY(r,c){this._geometry.coords.push(r,c),this._geometry.lengths[this.totalSize-1]++}pushPoints(r){for(const c of r)for(let n=0;n<this._stride;++n)this._geometry.coords.push(c[n]);this._geometry.lengths[this.totalSize-1]+=r.length}pushCursor(r){const c=r.asOptimized();this._geometry.coords.push(...c.coords),this._geometry.lengths.push(...c.lengths)}asOptimized(){const r=this._geometry.clone();if(1!==this.yFactor)for(let c=1;c<r.coords.length;c+=this._stride)r.coords[c]*=this.yFactor;return"esriGeometryPoint"===this.geometryType&&(r.lengths.length=0),r}isClosed(){const r=this._geometry.coords,c=this._pathOffset,n=this._end-this._stride;for(let f=0;f<this._stride;f++)if(r[c+f]!==r[n+f])return!1;return!0}clone(){return(new E).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce((r,c)=>r+c)}get pathSize(){const{lengths:r}=this._geometry;return this._geometry.isPoint?1:this._pathIndex<0||this._pathIndex>r.length-1?0:r[this._pathIndex]}get totalSize(){return this._geometry.isPoint?1:this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(r){this._geometry.coords[this._pointOffset]=r}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(r){this._geometry.coords[this._pointOffset+1]=this.yFactor*r}get z(){return this._geometry.coords[this._pointOffset+2]}set z(r){this._geometry.coords[this._pointOffset+2]=r}get m(){return this._geometry.coords[this._pointOffset+(this.hasZ?3:2)]}set m(r){this._geometry.coords[this._pointOffset+3]=r}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}}function P(h){const r=[h.x,h.y];return h.z&&r.push(h.z),h.m&&r.push(h.m),r}function b(h){return(0,X.Bi)(h)?[h.rings,"esriGeometryPolygon"]:(0,X.Rg)(h)?[h.paths,"esriGeometryPolyline"]:(0,X.U9)(h)?[[h.points],"esriGeometryMultipoint"]:(0,X.ZC)(h)?[[[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]]],"esriGeometryEnvelope"]:(0,X.fT)(h)?[[[P(h)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}class _ extends B{initialize(r,c,n,f,x){return this._paths=r,this.geometryType=c,this.hasZ=n,this.hasM=f,this._pathIndex=this._pointIndex=-1,this.yFactor=x,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(r){return this._pathIndex=r,this._pointIndex=-1,r>=0&&r<this.totalSize&&(this._currentPath=this._paths[r],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(r){return r>=0&&r<this._currentPath.length&&(this._pointIndex=r,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const r=this._currentPath.length,c=this._currentPath;let n=0;for(let f=1;f<r;f++){const x=c[f-1],w=c[f],G=w[0]-x[0],N=w[1]-x[1];n+=Math.sqrt(G*G+N*N)}return n}startPath(){this._paths.push([])}getCurrentPath(){return(new _).initialize([this._currentPath],this.geometryType,this.hasZ,this.hasM,this.yFactor)}pushPath(r){this._paths.push(r)}pushPoint(r){this._paths[this.totalSize-1].push(r)}pushXY(r,c){this._paths[this.totalSize-1].push([r,c])}pushPoints(r){this._paths[this.totalSize-1].push(...r)}pushCursor(r){const c=(0,q.x)(r);for(const n of c)this.pushPath(n)}asOptimized(){const r=new W.A;if("esriGeometryPoint"===this.geometryType)r.coords.push(...this._paths[0][0]),r.lengths.length=0;else for(const c of this._paths){for(const n of c)r.coords.push(n[0]),r.coords.push(n[1]*this.yFactor),this.hasZ&&r.coords.push(n[2]),this.hasM&&r.coords.push(n[this._mIndex]);r.lengths.push(c.length)}return r}isClosed(){const r=this._currentPath[0],c=this._currentPath[this._currentPath.length-1];for(let n=0;n<r.length;n++)if(r[n]!==c[n])return!1;return!0}clone(){return(new _).initialize((0,it.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map(r=>r.length).reduce((r,c)=>r+c)}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(r){this._currentPoint[0]=r}get y(){return this.yFactor*this._currentPoint[1]}set y(r){this._currentPoint[1]=this.yFactor*r}get z(){return this._currentPoint[2]}set z(r){this._currentPoint[2]=r}get m(){return this._currentPoint[this._mIndex]}set m(r){this._currentPoint[this._mIndex]=r}get pathIndex(){return this._pathIndex}}class d extends E{initialize(r,c,n,f,x){return super.initialize(r,c,n,f,x),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map(w=>new Set)),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const r=(new d).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return r._controlPoints=this._controlPoints,r}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(r){this._controlPoints[this.pathIndex].add(r)}getControlPointAt(r){return this._controlPoints[this.pathIndex].has(r)}}class m extends _{initialize(r,c,n,f,x){return super.initialize(r,c,n,f,x)}clone(){return(new m).initialize((0,it.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][4]=1}getControlPoint(){return 1===this._paths[this.pathIndex][this._pointIndex][4]}setControlPointAt(r){this._paths[this.pathIndex][r][4]=1}getControlPointAt(r){return 1===this._paths[this.pathIndex][r][4]}}},13259:(yt,at,A)=>{A.d(at,{d:()=>P});var it=A(51995),q=A(83065),X=A(39239),W=A(15268),B=A(62928);const E=222045e-19;function P(R){if(0===R.totalSize)return null;const v=(0,q.z8)(R);if(!v)return null;const L=4*(Math.abs(v[0])+Math.abs(v[2])+Math.abs(v[1])+Math.abs(v[3])+1)*E;let I=0,y=0;R.reset();for(let tt=0;R.nextPath();tt++){const C=R.getCurrentRingArea();C>y&&(y=C,I=tt)}if(R.seekPath(I),0===R.pathSize)return null;R.seekPathStart();const z=(0,q.B$)(R);if(Math.abs(y)<=2*L*L)return[(z[0]+z[2])/2,(z[1]+z[3])/2];R.seekPathStart();const k=(0,X.w2)(R,(0,it.vt)());if(null===k)return null;if(R.totalPoints<4)return k;const D=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],H=[NaN,NaN,NaN,NaN],$=[NaN,NaN,NaN,NaN];let rt=!1,Z=_(k,R,!0);0===Z.distance&&(rt=!0,D[0][0]=k[0],D[0][1]=k[1],Z=_(k,R,!1)),H[0]=Z.distance,$[0]=0;const et=[NaN,NaN];let lt=!1,ct=.25,_t=-1,ut=NaN;do{if(ut=NaN,D[1]=o(R,f(z[0],z[2],ct),0,v),isNaN(D[1][0])||isNaN(D[1][1])||(Z=_(D[1],R,!1),ut=Z.distance),!isNaN(ut)&&ut>L&&b(D[1],R))lt=!0,H[1]=ut,$[1]=x(D[1],k);else if(!isNaN(ut)&&ut>_t&&(_t=ut,et[0]=D[1][0],et[1]=D[1][1]),ct-=.01,ct<.1){if(!(_t>=0))break;lt=!0,H[1]=_t,D[1][0]=et[0],D[1][1]=et[1],$[1]=x(D[1],k)}}while(!lt);lt=!1,ct=.5,_t=-1;let Pt=.01,xt=1;do{if(ut=NaN,D[2]=o(R,f(z[0],z[2],ct),0,v),isNaN(D[2][0])||isNaN(D[2][1])||(Z=_(D[2],R,!1),ut=Z.distance),!isNaN(ut)&&ut>L&&b(D[2],R))lt=!0,H[2]=ut,$[2]=x(D[2],k);else if(!isNaN(ut)&&ut>_t)_t=ut,et[0]=D[2][0],et[1]=D[2][1];else if(ut>_t&&(_t=ut,et[0]=D[2][0],et[1]=D[2][1]),ct=.5+Pt*xt,Pt+=.01,xt*=-1,ct<.3||ct>.7){if(!(_t>=0))break;lt=!0,H[2]=_t,D[2][0]=et[0],D[2][1]=et[1],$[2]=x(D[2],k)}}while(!lt);lt=!1,ct=.75,_t=-1;do{if(ut=NaN,D[3]=o(R,f(z[0],z[2],ct),0,v),isNaN(D[3][0])||isNaN(D[3][1])||(Z=_(D[3],R,!1),ut=Z.distance),!isNaN(ut)&&ut>L&&b(D[3],R))lt=!0,H[3]=ut,$[3]=x(D[3],k);else if(ut>_t&&(_t=ut,et[0]=D[3][0],et[1]=D[3][1]),ct+=.01,ct>.9){if(!(_t>=0))break;lt=!0,H[3]=_t,D[3][0]=et[0],D[3][1]=et[1],$[3]=x(D[3],k)}}while(!lt);const mt=[0,1,2,3],Ct=rt?0:1;let dt;for(let tt=Ct;tt<4;tt++)for(let C=Ct;C<3;C++){const e=$[C],l=$[C+1];w(e,l)>0&&(dt=mt[C],mt[C]=mt[C+1],mt[C+1]=dt,$[C]=l,$[C+1]=e)}let Lt=Ct,Dt=0,Tt=0;for(let tt=Ct;tt<4;tt++){switch(tt){case 0:Tt=2*H[mt[tt]];break;case 1:Tt=1.66666666*H[mt[tt]];break;case 2:Tt=1.33333333*H[mt[tt]];break;case 3:Tt=H[mt[tt]]}Tt>Dt&&(Dt=Tt,Lt=mt[tt])}return D[Lt]}function b(R,v){let L,I,y,z,k=0;for(v.reset();v.nextPath()&&v.nextPoint();)for(L=v.x,I=v.y;v.nextPoint();L=y,I=z)y=v.x,z=v.y,I>R[1]!=z>R[1]&&((y-L)*(R[1]-I)-(z-I)*(R[0]-L)>0?k++:k--);return 0!==k}function _(R,v,L){if(L&&b(R,v))return{coord:R,distance:0};let I=1/0,y=0,z=0,k=[0,0],D=[0,0];const H=[0,0];for(v.reset();v.nextPath()&&v.nextPoint();)if(!(v.pathSize<2))for(k[0]=v.x,k[1]=v.y;v.nextPoint();k=D){D=[v.x,v.y],(0,W.gR)(H,R,k,D);const $=x(R,H);$<I&&(I=$,y=H[0],z=H[1])}return{coord:[y,z],distance:Math.sqrt(I)}}function o(R,v,L,I){const y=[v,0];let z=1/0,k=1/0,D=!1,H=!1;const $=[[v,I[1]-1],[v,I[3]+1]],rt=[0,0],Z=[0,0],et=[0,0],lt=[[0,0],[0,0]],ct=(0,it.vt)();for(R.reset();R.nextPath()&&R.nextPoint();)if(!(R.pathSize<2))for(lt[0][0]=R.x,lt[0][1]=R.y;R.nextPoint();lt[0][0]=lt[1][0],lt[0][1]=lt[1][1]){if(lt[1][0]=R.x,lt[1][1]=R.y,null===u(ct,lt)||(Z[0]=$[0][0],Z[1]=$[0][1],et[0]=$[1][0],et[1]=$[1][1],0===c(ct,Z,et))||!(0,B.Ql)($[0],$[1],lt[0],lt[1],rt))continue;const _t=rt[1];z>k?_t<z&&(z=_t,D=!0):_t<k&&(k=_t,H=!0)}return D&&H?y[1]=(z+k)/2:y[0]=y[1]=NaN,y}function u(R,v){if(v.length<2)return null;R||(R=(0,it.vt)());const[L,I]=v[0],[y,z]=v[1];return R[0]=Math.min(L,y),R[1]=Math.min(I,z),R[2]=Math.max(L,y),R[3]=Math.max(I,z),R}const d=1,m=4,h=3,r=12;function c(R,v,L){let I=n(v,R),y=n(L,R);const z=R[0],k=R[1],D=R[2],H=R[3];if(I&y)return 0;if(!(I|y))return 4;const $=(I?1:0)|(y?2:0);do{const rt=L[0]-v[0],Z=L[1]-v[1];if(rt>Z)I&h?(I&d?(v[1]+=Z*(z-v[0])/rt,v[0]=z):(v[1]+=Z*(D-v[0])/rt,v[0]=D),I=n(v,R)):y&h?(y&d?(L[1]+=Z*(z-L[0])/rt,L[0]=z):(L[1]+=Z*(D-L[0])/rt,L[0]=D),y=n(L,R)):I?(I&m?(v[0]+=rt*(k-v[1])/Z,v[1]=k):(v[0]+=rt*(H-v[1])/Z,v[1]=H),I=n(v,R)):(y&m?(L[0]+=rt*(k-L[1])/Z,L[1]=k):(L[0]+=rt*(H-L[1])/Z,L[1]=H),y=n(L,R));else if(I&r?(I&m?(v[0]+=rt*(k-v[1])/Z,v[1]=k):(v[0]+=rt*(H-v[1])/Z,v[1]=H),I=n(v,R)):y&r?(y&m?(L[0]+=rt*(k-L[1])/Z,L[1]=k):(L[0]+=rt*(H-L[1])/Z,L[1]=H),y=n(L,R)):I?(I&d?(v[1]+=Z*(z-v[0])/rt,v[0]=z):(v[1]+=Z*(D-v[0])/rt,v[0]=D),I=n(v,R)):(y&d?(L[1]+=Z*(z-L[0])/rt,L[0]=z):(L[1]+=Z*(D-L[0])/rt,L[0]=D),y=n(L,R)),I&y)return 0}while(I|y);return $}function n(R,v){return(R[0]<v[0]?1:0)|(R[0]>v[2]?1:0)<<1|(R[1]<v[1]?1:0)<<2|(R[1]>v[3]?1:0)<<3}function f(R,v,L){return R+(v-R)*L}function x(R,v){return(R[0]-v[0])*(R[0]-v[0])+(R[1]-v[1])*(R[1]-v[1])}function w(R,v){if(R<v)return-1;if(R>v)return 1;if(R===v)return 0;const L=isNaN(R),I=isNaN(v);return L<I?-1:L>I?1:0}},61245:(yt,at,A)=>{A.d(at,{Aq:()=>q,pC:()=>X,rx:()=>W});var it=A(76571);function q(B,E){B[4]=E}class X{constructor(E,P=!0,b=!0,_=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!P&&"esriGeometryPolygon"===E.geometryType||!b&&"esriGeometryPolyline"===E.geometryType?null:E,this.geomUnitsPerPoint=_,this.iterateMultiPath=!1,this.iteratePath=!1,this.internalPlacement=new it.W}next(){if(!this.geometryCursor)return null;const E=this.processMultiPath(this.geometryCursor);return this.iterateMultiPath&&E||(this.geometryCursor=null),E}processMultiPath(E){for(;this.iteratePath||E.pathIndex<E.totalSize-1;){this.iteratePath||E.nextPath(),this.iterateMultiPath=!0;const P=this.processPath(E);if(P)return P}return this.iterateMultiPath=!1,null}}class W{constructor(E,P,b,_=0){this.isClosed=!1,this.inputGeometries=E,this.acceptPolygon=P,this.acceptPolyline=b,this.geomUnitsPerPoint=_,this.iteratePath=!1,this.multiPathCursor=null}next(){for(;;){if(!this.multiPathCursor){let E=this.inputGeometries.next();for(;E&&(this.isClosed=this.acceptPolygon&&"esriGeometryPolygon"===E.geometryType||"esriGeometryEnvelope"===E.geometryType,this.multiPathCursor=E,!this.multiPathCursor);)E=this.inputGeometries.next();if(!this.multiPathCursor)return null}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const E=this.processPath(this.multiPathCursor);if(E)return E}this.multiPathCursor=null}}}},47961:(yt,at,A)=>{A.d(at,{k:()=>B,q:()=>E});var it=A(72137),q=A(91766);const X=512;let W;class B{constructor(b){this._geometry=b}next(){const b=this._geometry;return this._geometry=null,b}}function E(P,b){W||(W=new q.O3(0,0,0,1));const _="esriGeometryPolygon"===P.geometryType,u=_?3:2;let d,m;for(W.reset(_?q.dC.Polygon:q.dC.LineString),W.setPixelMargin(b+1),W.setExtent(X);P.nextPath();)if(!(P.pathSize<u)){for(P.nextPoint(),d=P.x,m=-P.y,W.moveTo(d,m);P.nextPoint();)d=P.x,m=-P.y,W.lineTo(d,m);_&&W.close()}const h=W.result(!1);if(h){const r=it.z.createEmptyOptimizedCIM(P.geometryType);for(const c of h){r.startPath();for(const n of c)r.pushXY(n.x,-n.y)}return r.reset(),r}return null}},91486:(yt,at,A)=>{A.d(at,{A:()=>v,c:()=>L});let it=(()=>{class I{static local(){return null===I.instance&&(I.instance=new I),I.instance}execute(z,k,D,H,$){return new q(z,k,D)}}return I.instance=null,I})();class q{constructor(y,z,k){this._inputGeometries=y,this._angleTolerance=void 0!==z.angleTolerance?z.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let y=this._inputGeometries.next();for(;y;){if("esriGeometryPolygon"===y.geometryType)this._isClosed=!0;else if("esriGeometryPolyline"===y.geometryType)this._isClosed=!1;else{if("esriGeometryEnvelope"!==y.geometryType){y=this._inputGeometries.next();continue}if(this._maxCosAngle)return y;this._isClosed=!0}for(;y.nextPath();)this._processPath(y);return y.reset(),y}return null}_processPath(y){if(y.nextPoint()){const z=y.x,k=y.y;let D=z,H=k,$=y.pathSize,rt=0,Z=0,et=0,lt=0,ct=0,_t=0;this._isClosed&&++$;for(let ut=1;y.nextPoint()||ut<$;++ut){let Pt,xt;this._isClosed&&ut===$-1?(Pt=z,xt=k):(Pt=y.x,xt=y.y);const mt=Pt-D,Ct=xt-H,dt=Math.sqrt(mt*mt+Ct*Ct);ut>1&&dt>0&&et>0&&(rt*mt+Z*Ct)/dt/et<=this._maxCosAngle&&y.setControlPointAt(ut-1),1===ut&&(lt=mt,ct=Ct,_t=dt),dt>0&&(D=Pt,H=xt,rt=mt,Z=Ct,et=dt)}this._isClosed&&et>0&&_t>0&&(rt*lt+Z*ct)/_t/et<=this._maxCosAngle&&y.setControlPointAt(0)}}}var X=A(47763),W=A(69630),B=A(71045),E=A(82854),P=A(65264),b=A(70614),_=A(88918);let o=(()=>{class I{static local(){return null===I.instance&&(I.instance=new I),I.instance}execute(z,k,D,H,$){return new u(z,k,D)}}return I.instance=null,I})();class u{constructor(y,z,k){this._inputGeometries=y,this._offsetX=void 0!==z.offsetX?z.offsetX*k:0,this._offsetY=void 0!==z.offsetY?z.offsetY*k:0}next(){let y=this._inputGeometries.next();for(;y;){if(y.totalSize>0)return this._move(y.clone(),this._offsetX,this._offsetY);y=this._inputGeometries.next()}return null}_move(y,z,k){for(;y.nextPath();)for(;y.nextPoint();)y.x=y.x+z,y.y=y.y+k;return y.reset(),y}}var d=A(3691);let m=(()=>{class I{static local(){return null===I.instance&&(I.instance=new I),I.instance}execute(z,k,D,H,$){return new h(z,k,D)}}return I.instance=null,I})();class h{constructor(y,z,k){this._inputGeometries=y,this._reverse=void 0===z.reverse||z.reverse}next(){let y=this._inputGeometries.next();for(;y;){if(!this._reverse)return y;if("esriGeometryPolyline"===y.geometryType)return r(y.clone());y=this._inputGeometries.next()}return null}}function r(I){for(;I.nextPath();)for(let y=0;y<I.pathSize/2;y++){I.seekInPath(y);const z=I.x,k=I.y;I.seekInPath(I.pathSize-y-1);const D=I.x,H=I.y;I.x=z,I.y=k,I.seekInPath(y),I.x=D,I.y=H}return I.reset(),I}var c=A(25867),n=A(39516),f=A(57249),x=A(2544),w=A(34572),O=A(56854),U=A(47942),G=A(53737),N=A(3688),R=A(68051);function v(I){if(!I)return null;switch(I.type){case"CIMGeometricEffectAddControlPoints":return it.local();case"CIMGeometricEffectArrow":return X.B.local();case"CIMGeometricEffectBuffer":return W.s.local();case"CIMGeometricEffectControlMeasureLine":return B.v.local();case"CIMGeometricEffectCut":return E.y.local();case"CIMGeometricEffectDashes":return P.I.local();case"CIMGeometricEffectDonut":return b.O.local();case"CIMGeometricEffectJog":return _.U.local();case"CIMGeometricEffectMove":return o.local();case"CIMGeometricEffectOffset":return d.V.local();case"CIMGeometricEffectReverse":return m.local();case"CIMGeometricEffectRotate":return c.v.local();case"CIMGeometricEffectScale":return n.W.local();case"CIMGeometricEffectWave":return f.l.local()}return null}function L(I){if(!I)return null;switch(I.type){case"CIMMarkerPlacementAlongLineSameSize":return x.e.local();case"CIMMarkerPlacementAtExtremities":return w.y.local();case"CIMMarkerPlacementAtRatioPositions":return O.S.local();case"CIMMarkerPlacementInsidePolygon":return U.M.local();case"CIMMarkerPlacementOnLine":return G.R.local();case"CIMMarkerPlacementOnVertices":return N.A.local();case"CIMMarkerPlacementPolygonCenter":return R.L.local()}return null}},76571:(yt,at,A)=>{A.d(at,{W:()=>it});class it{constructor(){this.setIdentity()}getAngle(){return(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}setTranslate(X,W){this.tx=X,this.ty=W}setTranslateZ(X){this.tz=X}setRotateCS(X,W){this.rz=void 0,this.rzCos=X,this.rzSin=W}setRotate(X){this.rz=X,this.rzCos=void 0,this.rzSin=void 0}setRotateY(X){this.ry=X}setScale(X){this.s=X}setMeasure(X){this.m=X}}},94529:(yt,at,A)=>{A.d(at,{Rj:()=>ut,mx:()=>ct,CK:()=>_t,IT:()=>et,QF:()=>Lt});var it=A(98894),q=A(3248),X=A(77806),W=A(35150),B=A(69287),E=A(61591),P=A(67685),b=A(72137),_=A(51995),o=A(83065),u=A(39239),d=A(61320),m=A(47961);class h{applyColorSubstitution(e,l){if(!l)return e;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:g,height:p}=e,M=this._rasterizationCanvas,T=M.getContext("2d",{willReadFrequently:!0});e!==M&&(M.width=g,M.height=p,T.drawImage(e,0,0,g,p));const S=T.getImageData(0,0,g,p).data;if(l)for(const j of l)if(j&&j.oldColor&&4===j.oldColor.length&&j.newColor&&4===j.newColor.length){const[K,Q,st,nt]=j.oldColor,[J,Y,V,ot]=j.newColor;if(K===J&&Q===Y&&st===V&&nt===ot)continue;for(let ht=0;ht<S.length;ht+=4)K===S[ht]&&Q===S[ht+1]&&st===S[ht+2]&&nt===S[ht+3]&&(S[ht]=J,S[ht+1]=Y,S[ht+2]=V,S[ht+3]=ot)}const F=new ImageData(S,g,p);return T.putImageData(F,0,0),M}tintImageData(e,l){if(!l||l.length<4)return e;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:g,height:p}=e,M=this._rasterizationCanvas,T=M.getContext("2d",{willReadFrequently:!0});e!==M&&(M.width=g,M.height=p,T.drawImage(e,0,0,g,p));const S=T.getImageData(0,0,g,p),F=new Uint8Array(S.data),j=[l[0]/255,l[1]/255,l[2]/255,l[3]/255];for(let Q=0;Q<F.length;Q+=4)F[Q]*=j[0],F[Q+1]*=j[1],F[Q+2]*=j[2],F[Q+3]*=j[3];const K=new ImageData(new Uint8ClampedArray(F.buffer),g,p);return T.putImageData(K,0,0),M}}var r=A(91486),c=A(76571),n=A(46988),f=A(65374);function x(C){const e=C.getFrame(0);if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement)return e;const l=document.createElement("canvas");l.width=C.width,l.height=C.height;const g=l.getContext("2d");return e instanceof ImageData?g.putImageData(e,0,0):g.drawImage(e,0,0),l}function w(C,e=0){if(0===e)return C;const l=Math.cos(e),g=Math.sin(e),[p,M]=C;return[p*l+M*-g,p*g+M*l]}var O=A(28685),U=A(9792),G=A(68448);function R(C){return`rgba(${C.slice(0,3).toString()},${C[3]})`}class v{constructor(e){e&&(this._textRasterizationCanvas=e)}rasterizeText(e,l){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const g=this._textRasterizationCanvas,p=g.getContext("2d",{willReadFrequently:!0});L(p,l),this._parameters=l,this._textLines=e.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const{decoration:M,weight:T}=l.font;this._lineThroughWidthOffset=M&&"line-through"===M?.1*this._lineHeight:0;const S=null!=l.backgroundColor||null!=l.borderLine,F=S?G.y7:0,j=this._computeTextWidth(p,l)+2*F,K=this._lineHeight*this._textLines.length+2*F;if(g.width=j+2*this._lineThroughWidthOffset,g.height=K,0===g.width||0===g.height)return g.width=g.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:g};this._renderedLineHeight=Math.round(this._lineHeight),this._renderedOutlineSize=(l.outline.size||0)*l.pixelRatio,this._renderedHaloSize=(l.halo.size||0)*l.pixelRatio,this._renderedWidth=j,this._renderedHeight=K,this._lineThroughWidthOffset*=l.pixelRatio;const Q=(l.outline&&l.outline.color)??[0,0,0,0],nt=l.halo&&l.halo.color?l.halo.color:[0,0,0,0];this._fillStyle=R(l.color??[0,0,0,0]),this._outlineStyle=R(Q),this._haloStyle=function N(C){return`rgb(${C.slice(0,3).toString()})`}(nt);const J=this._renderedLineHeight,Y=this._renderedOutlineSize,V=this._renderedHaloSize;p.save(),p.clearRect(0,0,g.width,g.height),L(p,l);const ot=F*l.pixelRatio,ht=function I(C,e,l){return"center"===C?.5*e:"right"===C?e-l:l}(p.textAlign,this._renderedWidth-2*ot,this._renderedHaloSize+this._renderedOutlineSize)+ot,ft=V+Y+ot,gt=V>0;let Mt=this._lineThroughWidthOffset,pt=0;if(S){p.save();const Et=l.backgroundColor??[0,0,0,0],wt=l.borderLine?.color??[0,0,0,0],Ot=2*(l.borderLine?.size??0);p.fillStyle=R(Et),p.strokeStyle=R(wt),p.lineWidth=Ot,p.fillRect(0,0,g.width,g.height),p.strokeRect(0,0,g.width,g.height),p.restore()}gt&&this._renderHalo(p,ht,ft,Mt,pt,l),Y>0&&this._renderOutline(p,ht,ft,Mt,pt,l),pt+=ft,Mt+=ht;for(const Et of this._textLines)gt?(p.globalCompositeOperation="destination-out",p.fillStyle="rgb(0, 0, 0)",p.fillText(Et,Mt,pt),p.globalCompositeOperation="source-over",p.fillStyle=this._fillStyle,p.fillText(Et,Mt,pt)):(p.fillStyle=this._fillStyle,p.fillText(Et,Mt,pt)),M&&"none"!==M&&this._renderDecoration(p,Mt,pt,M,T),pt+=J;p.restore();const St=this._renderedWidth+2*this._lineThroughWidthOffset,vt=this._renderedHeight,It=p.getImageData(0,0,St,vt),bt=new Uint8Array(It.data);if(l.premultiplyColors){let Et;for(let wt=0;wt<bt.length;wt+=4)Et=bt[wt+3]/255,bt[wt]=bt[wt]*Et,bt[wt+1]=bt[wt+1]*Et,bt[wt+2]=bt[wt+2]*Et}let At,zt;switch(l.horizontalAlignment){case"left":At=-.5;break;case"right":At=.5;break;default:At=0}switch(l.verticalAlignment){case"bottom":zt=-.5;break;case"top":zt=.5;break;case"baseline":zt=-1/6;break;default:zt=0}return{size:[St,vt],image:new Uint32Array(bt.buffer),sdf:!1,simplePattern:!1,anchorX:At,anchorY:zt,canvas:g}}_renderHalo(e,l,g,p,M,T){const S=this._renderedWidth,F=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement("canvas")),this._outlineRasterizationCanvas.width=S,this._outlineRasterizationCanvas.height=F;const j=this._outlineRasterizationCanvas,K=j.getContext("2d");K.clearRect(0,0,S,F),L(K,T);const{decoration:Q,weight:st}=T.font;K.fillStyle=this._haloStyle,K.strokeStyle=this._haloStyle,K.lineJoin="round",this._renderOutlineNative(K,l,g,Q,st,this._renderedHaloSize+this._renderedOutlineSize),e.globalAlpha=this._parameters.halo.color[3],e.drawImage(j,0,0,S,F,p,M,S,F),e.globalAlpha=1}_renderOutline(e,l,g,p,M,T){const S=this._renderedWidth,F=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement("canvas")),this._outlineRasterizationCanvas.width=S,this._outlineRasterizationCanvas.height=F;const j=this._outlineRasterizationCanvas,K=j.getContext("2d");K.clearRect(0,0,S,F),L(K,T);const{decoration:Q,weight:st}=T.font;K.fillStyle=this._outlineStyle,K.strokeStyle=this._outlineStyle,K.lineJoin="round",this._renderOutlineNative(K,l,g,Q,st,this._renderedOutlineSize),e.globalAlpha=this._parameters.outline.color[3],e.drawImage(j,0,0,S,F,p,M,S,F),e.globalAlpha=1}_renderOutlineNative(e,l,g,p,M,T){const S=this._renderedLineHeight;for(const F of this._textLines){const j=2*T,K=5,Q=.1;for(let st=0;st<K;st++){const nt=(1-(K-1)*Q+st*Q)*j;e.lineWidth=nt,e.strokeText(F,l,g),p&&"none"!==p&&this._renderDecoration(e,l,g,p,M,nt)}g+=S}}computeTextSize(e,l){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const g=this._textRasterizationCanvas,p=g.getContext("2d");L(p,l),this._parameters=l,this._textLines=e.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const M=this._computeTextWidth(p,l),T=this._lineHeight*this._textLines.length;return g.width=M,g.height=T,[M*l.pixelRatio,T*l.pixelRatio]}_computeTextWidth(e,l){let g=0;for(const M of this._textLines)g=Math.max(g,e.measureText(M).width);const p=l.font;return("italic"===p.style||"oblique"===p.style||"string"==typeof p.weight&&("bold"===p.weight||"bolder"===p.weight)||"number"==typeof p.weight&&p.weight>600)&&(g+=.3*e.measureText("w").width),g+=2*(0,P.Lz)(this._parameters.halo.size),Math.round(g)}_computeLineHeightBase(){return 1.275*this._parameters.size}_computeLineHeight(){let e=this._computeLineHeightBase();const l=this._parameters.font.decoration;return l&&"underline"===l&&(e*=1.3),Math.round(e+2*(0,P.Lz)(this._parameters.halo.size))}_renderDecoration(e,l,g,p,M,T){let S=.9*this._lineHeight;const F="bold"===M?.06:"bolder"===M?.09:.04;switch(e.textAlign){case"center":l-=this._renderedWidth/2;break;case"right":l-=this._renderedWidth}const j=e.textBaseline;if("underline"===p)switch(S=.9*this._computeLineHeightBase(),j){case"top":g+=S;break;case"middle":g+=S/2}else if("line-through"===p)switch(j){case"top":g+=S/1.5;break;case"middle":g+=S/3}const K=T?1.5*T:Math.ceil(S*F);e.save(),e.beginPath(),e.strokeStyle=e.fillStyle,e.lineWidth=K,e.moveTo(l-this._lineThroughWidthOffset,g),e.lineTo(l+this._renderedWidth+2*this._lineThroughWidthOffset,g),e.stroke(),e.restore()}}function L(C,e){const l=Math.max(e.size,.5),g=e.font,p=`${g.style} ${g.weight} ${(0,P.Lz)(l).toFixed(1)}px ${g.family}, sans-serif`;let M;switch(C.font=p,C.textBaseline="top",e.horizontalAlignment){case"left":default:M="left";break;case"right":M="right";break;case"center":M="center"}C.textAlign=M}var y=A(32117),z=A(40794),k=A(47669),D=A(42058),H=A(36741);const $=Math.PI/180,Z=()=>W.A.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");class et{constructor(e){this._t=e}static createIdentity(){return new et([1,0,0,0,1,0])}clone(){return new et(this._t.slice())}transform(e){const l=this._t;return[l[0]*e[0]+l[1]*e[1]+l[2],l[3]*e[0]+l[4]*e[1]+l[5]]}static createScale(e,l){return new et([e,0,0,0,l,0])}scale(e,l){const g=this._t;return g[0]*=e,g[1]*=e,g[2]*=e,g[3]*=l,g[4]*=l,g[5]*=l,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(e,l){return new et([0,0,e,0,0,l])}translate(e,l){const g=this._t;return g[2]+=e,g[5]+=l,this}static createRotate(e){const l=Math.cos(e),g=Math.sin(e);return new et([l,-g,0,g,l,0])}rotate(e){return et.multiply(this,et.createRotate(e),this)}angle(){const e=this._t[0],l=this._t[3],g=Math.sqrt(e*e+l*l);return[e/g,l/g]}static multiply(e,l,g){const p=e._t,M=l._t,S=p[1]*M[0]+p[4]*M[1],F=p[2]*M[0]+p[5]*M[1]+M[2],j=p[0]*M[3]+p[3]*M[4],K=p[1]*M[3]+p[4]*M[4],Q=p[2]*M[3]+p[5]*M[4]+M[5],st=g._t;return st[0]=p[0]*M[0]+p[3]*M[1],st[1]=S,st[2]=F,st[3]=j,st[4]=K,st[5]=Q,g}invert(){const e=this._t;let l=e[0]*e[4]-e[1]*e[3];return 0===l?new et([0,0,0,0,0,0]):(l=1/l,new et([e[4]*l,-e[1]*l,(e[1]*e[5]-e[2]*e[4])*l,-e[3]*l,e[0]*l,(e[2]*e[3]-e[0]*e[5])*l]))}}class lt{constructor(e,l){this._resourceManager=e,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new E.A(c.W,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(l||et.createIdentity()),this._sizeTransfos.push(l?l.scaleRatio():1)}setTransform(e,l){this._transfos=[e||et.createIdentity()],this._sizeTransfos=[l||(e?e.scaleRatio():1)]}setGeomUnitsPerPoint(e){this._geomUnitsPerPoint=e}transformPt(e){return this._transfos[this._transfos.length-1].transform(e)}transformSize(e){return e*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(e){return this._transfos[this._transfos.length-1].invert().transform(e)}reverseTransformSize(e){return e/this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformScalar(e){return e/this._transfos[this._transfos.length-1].scaleRatio()}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}prevGeomUnitsPerPoint(){return this._transfos.length>2?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(e,l){const g=l?e.scaleRatio():1;et.multiply(e,this.back(),e),this._transfos.push(e),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*g)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(e,l,g){if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(e,l);break;case"CIMTextSymbol":this.drawTextSymbol(e,l,g)}}drawMultiLayerSymbol(e,l){if(!e||!l)return;const g=e.symbolLayers;if(!g)return;const p=e.effects;if(p&&p.length>0){const M=this.executeEffects(p,l);if(M){let T=M.next();for(;T;)this.drawSymbolLayers(g,T.asJSON()),T=M.next()}}else this.drawSymbolLayers(g,l)}executeEffects(e,l){const g=this._resourceManager.geometryEngine;let p=new m.k(b.z.fromJSONCIM(l));for(const M of e){const T=(0,r.A)(M);T&&(p=T.execute(p,M,this.geomUnitsPerPoint(),null,g))}return p}drawSymbolLayers(e,l){let g=e.length;for(;g--;){const p=e[g];if(!p||!1===p.enable)continue;const M=p.effects;if(M&&M.length>0){const T=this.executeEffects(M,l);if(T){let S=null;for(;(S=T.next())&&(this.drawSymbolLayer(p,S.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(p,l);if(this._earlyReturn)return}}drawSymbolLayer(e,l){switch(e.type){case"CIMSolidFill":this.drawSolidFill(l,e.color,e.path);break;case"CIMHatchFill":this.drawHatchFill(l,e);break;case"CIMPictureFill":this.drawPictureFill(l,e);break;case"CIMGradientFill":this.drawGradientFill(l,e);break;case"CIMSolidStroke":this.drawSolidStroke(l,e.color,e.width,e.capStyle,e.joinStyle,e.miterLimit,e.path);break;case"CIMPictureStroke":this.drawPictureStroke(l,e);break;case"CIMGradientStroke":this.drawGradientStroke(l,e);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(e,l)}}drawHatchFill(e,l){const g=function Pt(C,e,l){let g=(0,y.$w)(C.separation,n.D.CIMHatchFill.separation)*l,p=(0,y.$w)(C.rotation);if(0===g)return null;g<0&&(g=-g);let M=0;const T=.5*g;for(;M>T;)M-=g;for(;M<-T;)M+=g;const S=(0,_.vt)();(0,o.Rg)(S,e),S[0]-=T,S[1]-=T,S[2]+=T,S[3]+=T;const F=[[S[0],S[1]],[S[0],S[3]],[S[2],S[3]],[S[2],S[1]]];for(;p>180;)p-=180;for(;p<0;)p+=180;const j=Math.cos(p*$),K=Math.sin(p*$),Q=-g*K,st=g*j;let nt,J,Y,V;M=(0,y.$w)(C.offsetX)*l*K-(0,y.$w)(C.offsetY)*l*j,nt=Y=Number.MAX_VALUE,J=V=-Number.MAX_VALUE;for(const St of F){const vt=St[0],It=St[1],bt=j*vt+K*It,At=-K*vt+j*It;nt=Math.min(nt,bt),Y=Math.min(Y,At),J=Math.max(J,bt),V=Math.max(V,At)}Y=Math.floor(Y/g)*g;let ot=j*nt-K*Y-Q*M/g,ht=K*nt+j*Y-st*M/g,ft=j*J-K*Y-Q*M/g,gt=K*J+j*Y-st*M/g;const Mt=1+Math.round((V-Y)/g),pt=[];for(let St=0;St<Mt;St++)ot+=Q,ht+=st,ft+=Q,gt+=st,pt.push([[ot,ht],[ft,gt]]);return{paths:pt}}(l,e,this.geomUnitsPerPoint());g&&(this.pushClipPath(e),this.drawMultiLayerSymbol(l.lineSymbol,g),this.popClipPath())}drawPictureFill(e,l){}drawGradientFill(e,l){}drawPictureStroke(e,l){}drawGradientStroke(e,l){}drawMarkerLayer(e,l){const g=e.markerPlacement;if(g){const p=(0,r.c)(g);if(p){const M="CIMMarkerPlacementInsidePolygon"===g.type||"CIMMarkerPlacementPolygonCenter"===g.type&&g.clipAtBoundary;M&&this.pushClipPath(l);const T=p.execute(b.z.fromJSONCIM(l),g,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(T){let S=null;for(;(S=T.next())&&(this.drawMarker(e,S),!this._earlyReturn););}M&&this.popClipPath()}}else{const p=this._placementPool.acquire();if((0,d.fT)(l))p.tx=l.x,p.ty=l.y,this.drawMarker(e,p);else if((0,d.Bi)(l)){const M=(0,u.l8)(l);M&&([p.tx,p.ty]=M,this.drawMarker(e,p))}else if((0,d.Rg)(l)){for(const M of l.paths)for(const T of M)if(p.tx=T[0],p.ty=T[1],this.drawMarker(e,p),this._earlyReturn)break}else for(const M of l.points)if(p.tx=M[0],p.ty=M[1],this.drawMarker(e,p),this._earlyReturn)break;this._placementPool.release(p)}}drawMarker(e,l){switch(e.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(e,l);break;case"CIMVectorMarker":this.drawVectorMarker(e,l)}}drawPictureMarker(e,l){if(!e)return;const g=this._resourceManager.getResource(e.url),p=(0,y.$w)(e.size,n.D.CIMPictureMarker.size);if(null==g||p<=0)return;const M=g.width,T=g.height;if(!M||!T)return;const S=M/T,F=(0,y.$w)(e.scaleX,1),j=et.createIdentity(),K=e.anchorPoint;if(K){let V=K.x,ot=K.y;"Absolute"!==e.anchorPointUnits&&(V*=p*S*F,ot*=p),j.translate(-V,-ot)}let Q=(0,y.$w)(e.rotation);e.rotateClockwise&&(Q=-Q),this._mapRotation&&(Q+=this._mapRotation),Q&&j.rotate(Q*$);let st=(0,y.$w)(e.offsetX),nt=(0,y.$w)(e.offsetY);if(st||nt){if(this._mapRotation){const V=$*this._mapRotation,ot=Math.cos(V),ht=Math.sin(V),ft=st*ht+nt*ot;st=st*ot-nt*ht,nt=ft}j.translate(st,nt)}const J=this.geomUnitsPerPoint();1!==J&&j.scale(J,J);const Y=l.getAngle();Y&&j.rotate(Y),j.translate(l.tx,l.ty),this.push(j,!1),this.drawImage(e,p),this.pop()}drawVectorMarker(e,l){if(!e)return;const g=e.markerGraphics;if(!g)return;const p=(0,y.$w)(e.size,n.D.CIMVectorMarker.size),M=e.frame,T=M?M.ymax-M.ymin:0,S=p&&T?p/T:1,F=et.createIdentity();M&&F.translate(.5*-(M.xmax+M.xmin),.5*-(M.ymax+M.ymin));const j=e.anchorPoint;if(j){let Y=j.x,V=j.y;"Absolute"!==e.anchorPointUnits?M&&(Y*=M.xmax-M.xmin,V*=M.ymax-M.ymin):(Y/=S,V/=S),F.translate(-Y,-V)}1!==S&&F.scale(S,S);let K=(0,y.$w)(e.rotation);e.rotateClockwise&&(K=-K),this._mapRotation&&(K+=this._mapRotation),K&&F.rotate(K*$);let Q=(0,y.$w)(e.offsetX),st=(0,y.$w)(e.offsetY);if(Q||st){if(this._mapRotation){const Y=$*this._mapRotation,V=Math.cos(Y),ot=Math.sin(Y),ht=Q*ot+st*V;Q=Q*V-st*ot,st=ht}F.translate(Q,st)}const nt=this.geomUnitsPerPoint();1!==nt&&F.scale(nt,nt);const J=l.getAngle();J&&F.rotate(J),F.translate(l.tx,l.ty),this.push(F,e.scaleSymbolsProportionally);for(const Y of g){Y?.symbol&&Y.geometry||Z().error("Invalid marker graphic",Y);let V=Y.textString;if("number"==typeof V&&(V=V.toString()),this.drawSymbol(Y.symbol,Y.geometry,V),this._earlyReturn)break}this.pop()}drawTextSymbol(e,l,g){if(!e||!(0,d.fT)(l)||(0,y.$w)(e.height,n.D.CIMTextSymbol.height)<=0)return;const p=et.createIdentity();let M=(0,y.$w)(e.angle);M=-M,M&&p.rotate(M*$);const T=(0,y.$w)(e.offsetX),S=(0,y.$w)(e.offsetY);(T||S)&&p.translate(T,S);const F=this.geomUnitsPerPoint();1!==F&&p.scale(F,F),p.translate(l.x,l.y),this.push(p,!1),this.drawText(e,g),this.pop()}}class ct extends lt{constructor(e,l){super(e,l),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new U.A(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return(0,_.fA)(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(e){if(e&&!(this._clipCount>0))if((0,d.Bi)(e))this._processPath(e.rings,0);else if((0,d.Rg)(e))this._processPath(e.paths,0);else if((0,d.ZC)(e)){const l=dt(e);l&&this._processPath(l.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}drawSolidStroke(e,l,g){if(!e||this._clipCount>0||null==g||g<=0)return;const p=Math.max(.5*this.transformSize((0,y.$w)(g,n.D.CIMSolidStroke.width)),.25);if((0,d.Bi)(e))this._processPath(e.rings,p);else if((0,d.Rg)(e))this._processPath(e.paths,p);else if((0,d.ZC)(e)){const M=dt(e);M&&this._processPath(M.rings,p)}else console.error("drawSolidStroke unexpected geometry type!")}drawMarkerLayer(e,l){(0,d.Bi)(l)&&e.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===e.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===e.markerPlacement.type&&e.markerPlacement.clipAtBoundary)?this._processPath(l.rings,0):super.drawMarkerLayer(e,l)}drawHatchFill(e,l){this.drawSolidFill(e)}drawPictureFill(e,l){this.drawSolidFill(e)}drawGradientFill(e,l){this.drawSolidFill(e)}drawPictureStroke(e,l){this.drawSolidStroke(e,null,l.width)}drawGradientStroke(e,l){this.drawSolidStroke(e,null,l.width)}pushClipPath(e){this.drawSolidFill(e),this._clipCount++}popClipPath(){this._clipCount--}drawImage(e,l){const{url:g}=e,p=(0,y.$w)(e.scaleX,1);let M=p*l,T=l;const S=this._resourceManager.getResource(g);if(null!=S){const F=S.height/S.width;M=p*(l?F>1?l:l/F:S.width),T=l?F>1?l*F:l:S.height}this._merge(this.transformPt([-M/2,-T/2]),0),this._merge(this.transformPt([-M/2,T/2]),0),this._merge(this.transformPt([M/2,-T/2]),0),this._merge(this.transformPt([M/2,T/2]),0)}drawText(e,l){if(!l||0===l.length)return;this._textRasterizer||(this._textRasterizer=new v);const g=Dt(e);let[p,M]=this._textRasterizer.computeTextSize(l,g);p=(0,P.PN)(p),M=(0,P.PN)(M);const T=this.transformSize(1)*this.reverseTransformScalar(1);p*=T,M*=T;let S=0;switch(e.horizontalAlignment){case"Left":S=p/2;break;case"Right":S=-p/2}let F=0;switch(e.verticalAlignment){case"Bottom":F=M/2;break;case"Top":F=-M/2;break;case"Baseline":F=M/6}this._merge(this.transformPt([-p/2+S,-M/2+F]),0),this._merge(this.transformPt([-p/2+S,M/2+F]),0),this._merge(this.transformPt([p/2+S,-M/2+F]),0),this._merge(this.transformPt([p/2+S,M/2+F]),0)}_processPath(e,l){if(e)for(const g of e){const p=g?g.length:0;if(p>1){this._merge(this.transformPt(g[0]),l);for(let M=1;M<p;M++)this._merge(this.transformPt(g[M]),l)}}}_merge(e,l){e[0]-l<this._xmin&&(this._xmin=e[0]-l),e[0]+l>this._xmax&&(this._xmax=e[0]+l),e[1]-l<this._ymin&&(this._ymin=e[1]-l),e[1]+l>this._ymax&&(this._ymax=e[1]+l)}}class _t extends lt{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null,this._svg=null,this._path=null,this._canvas=null}destroy(){this._svg=(0,z.pK)(this._svg),this._path=null,this._canvas=null}hitTest(e,l,g,p,M,T){const S=T*(0,P.Lz)(1);if(this.setTransform(),this.setGeomUnitsPerPoint(S),this._searchPoint=[(e[0]+e[2])/2,(e[1]+e[3])/2],this._searchDistPoint=(e[2]-e[0])/2/S,this._textInfo=p,this._mapRotation=l&&("CIMPointSymbol"===l.type&&"Map"!==l.angleAlignment||"CIMTextSymbol"===l.type)?M:0,!(0,q.A)("esri-mobile")){const j=(0,P.PN)(k._M*window.devicePixelRatio),K=(0,P.PN)(k.ie);("CIMLineSymbol"!==l?.type&&"CIMPolygonSymbol"!==l?.type||!l.symbolLayers?.some(y.jn))&&"CIMMeshSymbol"!==l?.type&&((0,y.YC)(l)??0)<K&&(this._searchDistPoint=j)}return this._earlyReturn=!1,this.drawSymbol(l,g),this._earlyReturn}executeEffects(e,l){return"CIMGeometricEffectDashes"===e.at(-1)?.type&&(e=e.slice(0,-1)),super.executeEffects(e,l)}drawSolidFill(e,l,g){null!=g?this._hittestSvgPath(e,g,!0):this._hitTestFill(e)}drawHatchFill(e,l){this._hitTestFill(e)}drawPictureFill(e,l){this._hitTestFill(e)}drawGradientFill(e,l){this._hitTestFill(e)}drawSolidStroke(e,l,g,p,M,T,S){null!=S?this._hittestSvgPath(e,S,!1,g):this._hitTestStroke(e,g)}drawPictureStroke(e,l){this._hitTestStroke(e,l.width)}drawGradientStroke(e,l){this._hitTestStroke(e,l.width)}drawMarkerLayer(e,l){e.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===e.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===e.markerPlacement.type&&e.markerPlacement.clipAtBoundary)?this._hitTestFill(l):super.drawMarkerLayer(e,l)}pushClipPath(e){}popClipPath(){}drawImage(e,l){const{url:g}=e,p=(0,y.$w)(e.scaleX,1),M=this._resourceManager.getResource(g);if(null==M||0===M.height||0===l)return;const T=l*this.geomUnitsPerPoint(),S=T*p*(M.width/M.height),F=this.reverseTransformPt(this._searchPoint),j=this._searchDistPoint;Math.abs(F[0])<S/2+j&&Math.abs(F[1])<T/2+j&&(this._earlyReturn=!0)}drawText(e,l){const g=this._textInfo;if(!g)return;const p=g.get(e);if(!p||!p.glyphMosaicItems.glyphs.length)return;const M=(0,H.hV)((0,y.$w)(e.height,n.D.CIMTextSymbol.height)),{lineGapType:T,lineGap:S}=e,F=T?Lt(T,(0,y.$w)(S),M):0,j="CIMBackgroundCallout"===e.callout?.type,K=(0,D.Tl)(p.glyphMosaicItems,{scale:M/k.eG,angle:0,xOffset:0,yOffset:0,horizontalAlignment:e.horizontalAlignment,verticalAlignment:e.verticalAlignment,maxLineWidth:(0,H.Lu)(e.lineWidth),lineHeight:k.DY*Math.max(.25,Math.min(F||1,4)),decoration:e.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:j}),Q=this.reverseTransformPt(this._searchPoint),st=Q[0],nt=Q[1];for(const J of K.glyphs)if(st>J.xTopLeft&&st<J.xBottomRight&&nt>-J.yBottomRight&&nt<-J.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(e){let l=null;if((0,d.ZC)(e))l=[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]];else if((0,d.Bi)(e))l=e.rings;else{if(!(0,d.Rg)(e))return;l=e.paths}const g=this.reverseTransformPt(this._searchPoint);(function xt(C,e){let l=0;for(const g of e){const p=g.length;for(let M=1;M<p;M++){const T=g[M-1],S=g[M];T[1]>C[1]!=S[1]>C[1]&&((S[0]-T[0])*(C[1]-T[1])-(S[1]-T[1])*(C[0]-T[0])>0?l++:l--)}}return 0!==l})(g,l)&&(this._earlyReturn=!0),!this._earlyReturn&&mt(g,l,this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}_getSvgPath(){return null!=this._svg&&null!=this._path||(this._svg??=(0,z.p)(),this._path??=(0,z.FJ)("path"),this._svg.appendChild(this._path)),this._path}_getCanvasContext(e,l){return this._canvas??=document.createElement("canvas"),this._canvas.width=e,this._canvas.height=l,this._canvas.getContext("2d",{willReadFrequently:!0})}_hittestSvgPath(e,l,g,p=0){const M=this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint(),T=this.reverseTransformPt(this._searchPoint),S=(0,_.vt)();(0,o.Rg)(S,e);const F_x=S[0],F_y=S[1],F_width=S[2]-S[0],F_height=S[3]-S[1],j=this._getSvgPath();j.setAttribute("d",l);const K=j.getBBox();let Q=Math.max(K.width/F_width,K.height/F_height),st=1;const nt=2*M*Q;nt<1&&(st=2/nt,Q*=st,K.x*=st,K.y*=st,K.width*=st,K.height*=st);const J=1+p*Q/2,Y=this._getCanvasContext(K.width+2*J,K.height+2*J);Y.setTransform(st,0,0,st,-K.x+J,-K.y+J);const V=new Path2D(l);g?Y.fill(V):(Y.lineWidth=p*(Q/st),Y.stroke(V));const ht=(F_height*Q-K.height)/2,ft=Math.floor((T[0]-F_x-M)*Q-(F_width*Q-K.width)/2+J),gt=Math.floor((F_height-(T[1]-F_y)-M)*Q+ht+J),Mt=Math.ceil(2*M*Q),pt=Math.ceil(2*M*Q),St=Y.getImageData(ft,gt,Mt,pt).data;for(let vt=3;vt<St.length;vt+=4)if(St[vt]>127.5)return void(this._earlyReturn=!0)}_hitTestStroke(e,l){let g=null;if((0,d.ZC)(e))g=[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]];else if((0,d.Bi)(e))g=e.rings;else{if(!(0,d.Rg)(e))return;g=e.paths}mt(this.reverseTransformPt(this._searchPoint),g,(0,y.$w)(l,n.D.CIMSolidStroke.width)*this.geomUnitsPerPoint()/2+this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}}class ut extends lt{constructor(e,l,g,p){super(l,g),this._applyAdditionalRenderProps=p,this._colorSubstitutionHelper=new h,this._ctx=e}drawSolidFill(e,l){if(!e)return;if((0,d.Bi)(e))this._buildPath(e.rings,!0);else if((0,d.Rg)(e))this._buildPath(e.paths,!0);else if((0,d.ZC)(e))this._buildPath(dt(e).rings,!0);else{if(!(0,d.U9)(e))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}const g=this._ctx;g.fillStyle="string"==typeof l?l:"rgba("+Math.round(l[0])+","+Math.round(l[1])+","+Math.round(l[2])+","+(l[3]??255)/255+")",g.fill("evenodd")}drawSolidStroke(e,l,g,p,M,T){if(!e||!l||0===g)return;if((0,d.Bi)(e))this._buildPath(e.rings,!0);else if((0,d.Rg)(e))this._buildPath(e.paths,!1);else{if(!(0,d.ZC)(e))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(dt(e).rings,!0)}const S=this._ctx;S.strokeStyle="string"==typeof l?l:"rgba("+Math.round(l[0])+","+Math.round(l[1])+","+Math.round(l[2])+","+(l[3]??255)/255+")",S.lineWidth=Math.max(this.transformSize(g),.5),this._setCapStyle(p),this._setJoinStyle(M),S.miterLimit=T,S.stroke()}pushClipPath(e){if(this._ctx.save(),(0,d.Bi)(e))this._buildPath(e.rings,!0);else if((0,d.Rg)(e))this._buildPath(e.paths,!0);else{if(!(0,d.ZC)(e))return;this._buildPath(dt(e).rings,!0)}this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}drawImage(e,l){const{colorSubstitutions:g,url:p,tintColor:M}=e,T=(0,y.$w)(e.scaleX,1),S=this._resourceManager.getResource(p);if(null==S)return;let F=l*(S.width/S.height),j=l;l||(F=S.width,j=S.height);const K=(0,y.UE)(p)||"src"in S&&(0,y.UE)(S.src);let Q="getFrame"in S?x(S):S;g&&(Q=this._colorSubstitutionHelper.applyColorSubstitution(Q,g)),this._applyAdditionalRenderProps&&!K&&M&&(Q=this._colorSubstitutionHelper.tintImageData(Q,M));const st=this.transformPt([0,0]),[nt,J]=this.getTransformAngle(),Y=this.transformSize(1),V=this._ctx;V.save(),V.setTransform({m11:T*Y*nt,m12:T*Y*J,m21:-Y*J,m22:Y*nt,m41:st[0],m42:st[1]}),V.drawImage(Q,-F/2,-j/2,F,j),V.restore()}drawText(e,l){if(!l||0===l.length)return;this._textRasterizer||(this._textRasterizer=new v);const g=Dt(e,this.transformSize((0,P.PN)(1))),p=this._textRasterizer.rasterizeText(l,g);if(!p)return;const{size:M,anchorX:T,anchorY:S,canvas:F}=p,j=M[0]*(T+.5),K=M[1]*(S-.5),Q=this._ctx,st=this.transformPt([0,0]),[nt,J]=this.getTransformAngle();Q.save(),Q.setTransform({m11:1*nt,m12:1*J,m21:-1*J,m22:1*nt,m41:st[0]-1*j,m42:st[1]+1*K}),Q.drawImage(F,0,0),Q.restore()}drawPictureFill(e,l){if(!e)return;let{colorSubstitutions:g,height:p,offsetX:M,offsetY:T,rotation:S,scaleX:F,tintColor:j,url:K}=l;const Q=this._resourceManager.getResource(K);if(null==Q)return;if((0,d.Bi)(e))this._buildPath(e.rings,!0);else if((0,d.Rg)(e))this._buildPath(e.paths,!0);else if((0,d.ZC)(e))this._buildPath(dt(e).rings,!0);else{if(!(0,d.U9)(e))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}const st=this._ctx,nt=(0,y.UE)(K)||"src"in Q&&(0,y.UE)(Q.src);let J,Y="getFrame"in Q?x(Q):Q;if(g&&(Y=this._colorSubstitutionHelper.applyColorSubstitution(Y,g)),this._applyAdditionalRenderProps){nt||j&&(Y=this._colorSubstitutionHelper.tintImageData(Y,j)),J=st.createPattern(Y,"repeat");const V=this.transformSize(1);S||(S=0),M?M*=V:M=0,T?T*=V:T=0,p&&(p*=V);const ot=p?p/Q.height:1,ht=F&&p?F*p/Q.width:1;if(0!==S||1!==ot||1!==ht||0!==M||0!==T){const ft=new DOMMatrix;ft.rotateSelf(0,0,-S).translateSelf(M,T).scaleSelf(ht,ot,1),J.setTransform(ft)}}else J=st.createPattern(Y,"repeat");st.save(),st.fillStyle=J,st.fill("evenodd"),st.restore()}drawPictureStroke(e,l){if(!e)return;let{colorSubstitutions:g,capStyle:p,joinStyle:M,miterLimit:T,tintColor:S,url:F,width:j}=l;const K=this._resourceManager.getResource(F);if(null==K)return;let Q;if((0,d.Bi)(e))Q=e.rings;else if((0,d.Rg)(e))Q=e.paths;else{if(!(0,d.ZC)(e))return(0,d.U9)(e)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;Q=dt(e).rings}j||(j=K.width);const st=(0,y.UE)(F)||"src"in K&&(0,y.UE)(K.src);let nt="getFrame"in K?x(K):K;g&&(nt=this._colorSubstitutionHelper.applyColorSubstitution(nt,g)),this._applyAdditionalRenderProps&&(st||S&&(nt=this._colorSubstitutionHelper.tintImageData(nt,S)));const J=Math.max(this.transformSize((0,P.Lz)(j)),.5),Y=J/nt.width,V=this._ctx,ot=V.createPattern(nt,"repeat-y");let ht,ft;V.save(),this._setCapStyle(p),this._setJoinStyle(M),void 0!==T&&(V.miterLimit=T),V.lineWidth=J;for(let gt of Q)if(gt=(0,X.o8)(gt),tt(gt),gt&&!(gt.length<=1)){ht=this.transformPt(gt[0]);for(let Mt=1;Mt<gt.length;Mt++){ft=this.transformPt(gt[Mt]);const pt=Ct(ht,ft),St=new DOMMatrix;St.translateSelf(0,ht[1]-J/2).scaleSelf(Y,Y,1).rotateSelf(0,0,90-pt),ot.setTransform(St),V.strokeStyle=ot,V.beginPath(),V.moveTo(ht[0],ht[1]),V.lineTo(ft[0],ft[1]),V.stroke(),ht=ft}}V.restore()}drawGradientFill(e,l){if(!e)return;let g;if((0,d.Bi)(e))g=e.rings;else if((0,d.Rg)(e))g=e.paths;else{if(!(0,d.ZC)(e))return void Z().error("Unable to draw gradient fill");g=dt(e).rings}this._buildPath(g,!0);const{angle:p,gradientMethod:M,gradientSize:T,gradientSizeUnits:S}=l,F=n.D.CIMGradientFill,j=l.gradientType??F.gradientType,K=-(0,B.kU)(p??0),Q=(0,_.Ie)();for(const ot of g){const ht=ot?ot.length:0;if(ht>1)for(let ft=0;ft<ht;ft++){let gt=this.transformPt(ot[ft]);"Linear"!==M&&"Rectangular"!==M||(gt=w(gt,-K)),(0,_.tK)(Q,gt)}}const[st,nt,J,Y]=Q,V=this._ctx;switch(V.save(),M){case"Buffered":Z().error(`Gradient method "${M}" currently unsupported.`);break;case"Linear":{const ot=(nt+Y)/2,ht="Absolute"===S?this.transformSize((0,P.Lz)(T)):(0,y.yX)(T,F.gradientSize)*(J-st),[ft,gt]="Discrete"===j?[J,J-ht]:[st+ht,st],Mt=w([ft,ot],K),pt=w([gt,ot],K),St=V.createLinearGradient(Mt[0],Mt[1],pt[0],pt[1]);(0,O.AH)(St,l),V.fillStyle=St,V.fill("evenodd");break}case"Circular":{const ot=(0,_.gX)(Q),ht=(0,_.ib)(Q)/2,ft="Absolute"===S?this.transformSize((0,P.Lz)(T)):(0,y.yX)(T,F.gradientSize)*ht,[gt,Mt]="Discrete"===j?[ht,ht-ft]:[ft,0],pt=V.createRadialGradient(ot[0],ot[1],gt,ot[0],ot[1],Mt);(0,O.AH)(pt,l),V.fillStyle=pt,V.fill("evenodd");break}case"Rectangular":{const ot=(0,_.gX)(Q),ht=ot[0],ft=ot[1],gt=w(ot,K),Mt=(At,zt,Et,wt,Ot,Rt,Wt,Nt)=>{V.save(),this.pushClipPath(e);const kt=w([Ot,Rt],K),Bt=w([Wt,Nt],K);V.beginPath(),V.moveTo(gt[0],gt[1]),V.lineTo(kt[0],kt[1]),V.lineTo(Bt[0],Bt[1]),V.lineTo(gt[0],gt[1]),V.clip();const Ut=w([At,zt],K),Gt=w([Et,wt],K),Ft=V.createLinearGradient(Ut[0],Ut[1],Gt[0],Gt[1]);(0,O.AH)(Ft,l),V.fillStyle=Ft,V.fill("evenodd"),V.restore()};let pt="Absolute"===S?this.transformSize((0,P.Lz)(T)):(0,y.yX)(T,F.gradientSize)*((0,_.VL)(Q)/2),[St,vt]="Discrete"===j?[J,J-pt]:[ht+pt,ht];Mt(St,ft,vt,ft,J,nt,J,Y),[St,vt]="Discrete"===j?[st,st+pt]:[ht-pt,ht],Mt(St,ft,vt,ft,st,Y,st,nt),pt="Absolute"===S?this.transformSize((0,P.Lz)(T)):(0,y.yX)(T,F.gradientSize)*((0,_.uJ)(Q)/2);let[It,bt]="Discrete"===j?[Y,Y-pt]:[ft+pt,ft];Mt(ht,It,ht,bt,J,Y,st,Y),[It,bt]="Discrete"===j?[nt,nt+pt]:[ft-pt,ft],Mt(ht,It,ht,bt,st,nt,J,nt);break}}V.restore()}drawGradientStroke(e,l){const{capStyle:g,gradientMethod:p,gradientSize:M,gradientSizeUnits:T,joinStyle:S,miterLimit:F,width:j}=l;if(!e||0===j)return;let K;if((0,d.Bi)(e))K=e.rings;else if((0,d.Rg)(e))K=e.paths;else{if(!(0,d.ZC)(e))return void Z().error("Unable to draw gradient stroke");K=dt(e).rings}const Q=l.gradientType??n.D.CIMGradientStroke.gradientType,st=Math.max(this.transformSize((0,P.Lz)(j)),.5),nt=this._ctx;let J,Y;nt.save(),this._setCapStyle(g),this._setJoinStyle(S),void 0!==F&&(nt.miterLimit=F),nt.lineWidth=st;for(let V of K){if(V=(0,X.o8)(V),tt(V),!V||V.length<=1)continue;let ot=0;J=this.transformPt(V[0]);for(let gt=1;gt<V.length;gt++){Y=this.transformPt(V[gt]);const Mt=Y[0]-J[0],pt=Y[1]-J[1];ot+=Math.sqrt(Mt*Mt+pt*pt),J=Y}const ht="Absolute"===T?this.transformSize((0,P.Lz)(M)):(0,y.yX)(M,n.D.CIMGradientStroke.gradientSize)*("AcrossLine"===p?st:ot);let ft=0;J=this.transformPt(V[0]);for(let gt=1;gt<V.length;gt++){Y=this.transformPt(V[gt]);const Mt=Y[0]-J[0],pt=Y[1]-J[1],St=Math.sqrt(Mt*Mt+pt*pt);let vt,It,bt,At;switch(p){case"AcrossLine":{const[Et,wt]=w([Mt/St,pt/St],-Math.PI/2),Ot=st/2,Rt="Discrete"===Q?Ot:ht-Ot;vt=(J[0]+Y[0])/2+Et*Rt,It=(J[1]+Y[1])/2+wt*Rt,bt=vt-Et*ht,At=It-wt*ht;break}case"AlongLine":{const Et=Mt/St,wt=pt/St;"Discrete"===Q?(vt=J[0]-Et*ft,It=J[1]-wt*ft,bt=vt+Et*ht,At=It+wt*ht):(bt=J[0]+Et*(ot-ft),At=J[1]+wt*(ot-ft),vt=bt-Et*ht,It=At-wt*ht);break}default:return Z().error("Unrecognized gradient method:",p),void nt.restore()}const zt=nt.createLinearGradient(vt,It,bt,At);(0,O.AH)(zt,l),nt.strokeStyle=zt,nt.beginPath(),nt.moveTo(J[0],J[1]),nt.lineTo(Y[0],Y[1]),nt.stroke(),ft+=St,J=Y}}nt.restore()}_buildPath(e,l){const g=this._ctx;if(g.beginPath(),e)for(const p of e){const M=p?p.length:0;if(M>1){let T=this.transformPt(p[0]);g.moveTo(T[0],T[1]);for(let S=1;S<M;S++)T=this.transformPt(p[S]),g.lineTo(T[0],T[1]);l&&g.closePath()}}}_setCapStyle(e){switch(e){case f.uT.Butt:this._ctx.lineCap="butt";break;case f.uT.Round:this._ctx.lineCap="round";break;case f.uT.Square:this._ctx.lineCap="square"}}_setJoinStyle(e){switch(e){case f.wd.Bevel:this._ctx.lineJoin="bevel";break;case f.wd.Round:this._ctx.lineJoin="round";break;case f.wd.Miter:this._ctx.lineJoin="miter"}}}function mt(C,e,l){for(const g of e){const p=g.length;for(let M=1;M<p;M++){const T=g[M-1],S=g[M];let F=(S[0]-T[0])*(S[0]-T[0])+(S[1]-T[1])*(S[1]-T[1]);if(0!==F&&(F=Math.sqrt(F),Math.abs(((S[0]-T[0])*(C[1]-T[1])-(S[1]-T[1])*(C[0]-T[0]))/F)<l)){const K=((S[0]-T[0])*(C[0]-T[0])+(S[1]-T[1])*(C[1]-T[1]))/F;if(K>-l&&K<F+l)return!0}}}return!1}function Ct(C,e){return 180/Math.PI*Math.atan2(e[1]-C[1],e[0]-C[0])}const dt=C=>C?{spatialReference:C.spatialReference,rings:[[[C.xmin,C.ymin],[C.xmin,C.ymax],[C.xmax,C.ymax],[C.xmax,C.ymin],[C.xmin,C.ymin]]]}:null,Lt=(C,e,l)=>{switch(C){case"ExtraLeading":return 1+e/l;case"Multiple":return e;case"Exact":return e/l}};function Dt(C,e=1){const l=(0,y.DW)(C),g=(0,y._d)(C.fontStyleName),p=C.fontFamilyName??it.Vb,{weight:M,style:T}=g,S=e*(C.height||5),F=(0,y.Bu)(C.horizontalAlignment),j=(0,y.Nl)(C.verticalAlignment),K=(0,y.pM)(C),Q=(0,y.pM)(C.haloSymbol),st=null!=Q?e*(C.haloSize??0):0,nt=(0,y._1)(C.symbol),J=e*((0,y.xo)(C.symbol)||0),Y="CIMBackgroundCallout"===C.callout?.type?C.callout.backgroundSymbol:null,V=(0,y.pM)(Y),ot=(0,y.xo)(Y),ht=(0,y._1)(Y);return{color:K,size:S,horizontalAlignment:F,verticalAlignment:j,font:{family:p,style:(0,y.pV)(T),weight:(0,y.Kn)(M),decoration:l},outline:{size:J||0,color:nt},halo:{size:st||0,color:Q,style:T},backgroundColor:V,borderLine:null!=ot&&null!=ht?{size:ot,color:ht}:null,pixelRatio:1,premultiplyColors:!0}}const Tt=1e-4;function tt(C){let e,l,g,p,M,T=C[0],S=1;for(;S<C.length;)e=C[S][0]-T[0],l=C[S][1]-T[1],p=0!==e?l/e:Math.PI/2,void 0!==g&&Math.abs(p-g)<=Tt?(C.splice(S-1,1),T=M):(M=T,T=C[S],S++),g=p}},26747:(yt,at,A)=>{A.d(at,{BW:()=>mt,Sc:()=>H,Vb:()=>I,ll:()=>D,wp:()=>$});var it=A(47139),q=A(3248),X=A(77806),W=A(35150),B=A(40707),E=A(67685),P=A(51995),b=A(83065),_=A(9015),o=A(76571),u=A(94529),d=A(46988),m=A(65374),h=A(32117),r=A(91644),c=A(4139),n=A(47669),f=A(42058),x=A(36741);const w=Math.PI,O=w/2,U=Math.PI/180,G=96/72,L=()=>W.A.getLogger("esri.symbols.cim.CIMSymbolHelper");function I(tt){let C;switch(tt.type){case"cim":return tt.data;case"web-style":return tt;case"simple-marker":{const e=$.fromSimpleMarker(tt);if(!e)throw new Error("InternalError: Cannot convert symbol to CIM");C=e;break}case"picture-marker":C=$.fromPictureMarker(tt);break;case"simple-line":C=$.fromSimpleLineSymbol(tt);break;case"simple-fill":C=$.fromSimpleFillSymbol(tt);break;case"picture-fill":C=$.fromPictureFillSymbol(tt);break;case"text":C=$.fromTextSymbol(tt)}return{type:"CIMSymbolReference",symbol:C}}function y(tt,C,e){switch(C.type){case"CIMSymbolReference":return y(tt,C.symbol,e);case"CIMPointSymbol":null==e&&(e={x:0,y:0}),tt.drawSymbol(C,e);break;case"CIMLineSymbol":null==e&&(e={paths:[[[0,0],[10,0]]]}),tt.drawSymbol(C,e);break;case"CIMPolygonSymbol":null==e&&(e={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),tt.drawSymbol(C,e);break;case"CIMTextSymbol":tt.drawSymbol(C,{x:0,y:0});break;case"CIMVectorMarker":{const l=new o.W;tt.drawMarker(C,l);break}}return tt.envelope()}function z(tt){if(!tt)return 0;switch(tt.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(tt.offset);default:return 0}}function k(tt){if(!tt)return 0;switch(tt.type){case"CIMGeometricEffectArrow":return Math.abs(.5*tt.width);case"CIMGeometricEffectBuffer":return Math.abs(tt.size);case"CIMGeometricEffectControlMeasureLine":return 500;case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(tt.length);case"CIMGeometricEffectJog":return Math.abs(.5*tt.length);case"CIMGeometricEffectMove":return Math.max(Math.abs((0,h.$w)(tt.offsetX)),Math.abs((0,h.$w)(tt.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(tt.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(tt.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(tt.fromWidth),Math.abs(tt.toWidth));case"CIMGeometricEffectWave":return Math.abs(tt.amplitude);case"CIMGeometricEffectDonut":return Math.abs(tt.width)}}function D(tt){if(!tt)return 0;let C=0;for(const e of tt)C+=k(e);return C}class H{static getSymbolInflateSize(C,e,l,g,p){return C||(C=[0,0,0,0]),e?this._getInflateSize(C,e,l,g,p):C}static safeSize(C){const e=Math.max(Math.abs(C[0]),Math.abs(C[2])),l=Math.max(Math.abs(C[1]),Math.abs(C[3]));return Math.sqrt(e*e+l*l)}static _vectorMarkerBounds(C,e,l,g){let p=!0;const M=(0,P.vt)();if(e?.markerGraphics)for(const T of e.markerGraphics){const S=[0,0,0,0];T.geometry&&((0,b.Rg)(M,T.geometry),S[0]=0,S[1]=0,S[2]=0,S[3]=0,this.getSymbolInflateSize(S,T.symbol,l,0,g),M[0]+=S[0],M[1]+=S[1],M[2]+=S[2],M[3]+=S[3],p?(C[0]=M[0],C[1]=M[1],C[2]=M[2],C[3]=M[3],p=!1):(C[0]=Math.min(C[0],M[0]),C[1]=Math.min(C[1],M[1]),C[2]=Math.max(C[2],M[2]),C[3]=Math.max(C[3],M[3])))}return C}static _getInflateSize(C,e,l,g,p){if(function Ct(tt){return void 0!==tt.symbolLayers}(e)){const M=this._getLayersInflateSize(C,e.symbolLayers,l,g,p),T=D(e.effects);return T>0&&(M[0]-=T,M[1]-=T,M[2]+=T,M[3]+=T),M}return this._getTextInflatedSize(C,e,p)}static _getLayersInflateSize(C,e,l,g,p){let M=!0;if(!e)return C;for(const T of e){if(!T)continue;let S=[0,0,0,0];switch(T.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{let K=T.width;null!=K&&(K/=T.capStyle===m.uT.Square||T.joinStyle===m.wd.Miter?1.4142135623730951:2,S[0]=-K,S[1]=-K,S[2]=K,S[3]=K);break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const j=T;if("CIMVectorMarker"===T.type){const J=T;if(S=this._vectorMarkerBounds(S,J,l,p),J.frame){const Y=(J.frame.xmin+J.frame.xmax)/2,V=(J.frame.ymin+J.frame.ymax)/2;if(S[0]-=Y,S[1]-=V,S[2]-=Y,S[3]-=V,null!=J.size){const ot=J.size/(J.frame.ymax-J.frame.ymin);S[0]*=ot,S[1]*=ot,S[2]*=ot,S[3]*=ot}}}else if("CIMPictureMarker"===T.type){const J=T,Y=l.getResource(J.url);let V=1;if(null!=Y&&Y.height&&(V=Y.width/Y.height),null!=j.size){const ot=j.size/2,ht=j.size*V*J.scaleX/2;S=[-ht,-ot,ht,ot]}}else if(null!=j.size){const J=j.size/2;S=[-J,-J,J,J]}if(j.anchorPoint){let J,Y;"Absolute"===j.anchorPointUnits?(J=j.anchorPoint.x,Y=j.anchorPoint.y):(J=j.anchorPoint.x*(S[2]-S[0]),Y=j.anchorPoint.y*(S[3]-S[1]));const V=1.25*Math.sqrt(J*J+Y*Y);S[0]-=V,S[1]-=V,S[2]+=V,S[3]+=V}let K=(0,h.$w)(j.rotation);if(j.rotateClockwise&&(K=-K),g&&(K-=g),K){const J=U*K,Y=Math.cos(J),V=Math.sin(J),ot=(0,P.vt)([c.MG,c.MG,-c.MG,-c.MG]);(0,P.tK)(ot,[S[0]*Y-S[1]*V,S[0]*V+S[1]*Y]),(0,P.tK)(ot,[S[0]*Y-S[3]*V,S[0]*V+S[3]*Y]),(0,P.tK)(ot,[S[2]*Y-S[1]*V,S[2]*V+S[1]*Y]),(0,P.tK)(ot,[S[2]*Y-S[3]*V,S[2]*V+S[3]*Y]),S=ot}let Q=(0,h.$w)(j.offsetX),st=(0,h.$w)(j.offsetY);if(g){const J=U*g,Y=Math.cos(J),V=Math.sin(J),ot=Q*V+st*Y;Q=Q*Y-st*V,st=ot}S[0]+=Q,S[1]+=st,S[2]+=Q,S[3]+=st;const nt=z(j.markerPlacement);nt>0&&(S[0]-=nt,S[1]-=nt,S[2]+=nt,S[3]+=nt);break}}const F=D(T.effects);F>0&&(S[0]-=F,S[1]-=F,S[2]+=F,S[3]+=F),M?(C[0]=S[0],C[1]=S[1],C[2]=S[2],C[3]=S[3],M=!1):(C[0]=Math.min(C[0],S[0]),C[1]=Math.min(C[1],S[1]),C[2]=Math.max(C[2],S[2]),C[3]=Math.max(C[3],S[3]))}return C}static _getTextInflatedSize(C,e,l){const g=(0,x.hV)(e.height??d.D.CIMTextSymbol.height);if(C[0]=-g/2,C[1]=-g/2,C[2]=g/2,C[3]=g/2,!l)return C;const p=l.get(e);if(!p||!p.glyphMosaicItems.glyphs.length)return C;const{lineGapType:M,lineGap:T}=e,S=M?(0,u.QF)(M,T??0,g):0,F="CIMBackgroundCallout"===e.callout?.type,j=(0,f.Tl)(p.glyphMosaicItems,{scale:g/n.eG,angle:(0,h.$w)(e.angle),xOffset:(0,h.$w)(e.offsetX),yOffset:(0,h.$w)(e.offsetY),horizontalAlignment:e.horizontalAlignment,verticalAlignment:e.verticalAlignment,maxLineWidth:(0,x.Lu)(e.lineWidth),lineHeight:n.DY*Math.max(.25,Math.min(S||1,4)),decoration:e.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:F}).boundsT,K=Math.sqrt(j.width*j.width+j.height*j.height);return C[0]-=j.x+K,C[1]-=j.y-K,C[2]+=j.x+K,C[3]+=-j.y+K,C}}class ${static getEnvelope(C,e,l){if(!C)return null;const g=new u.mx(l);if(Array.isArray(C)){let p;for(const M of C)p?p.union(y(g,M,e)):p=y(g,M,e);return p}return y(g,C,e)}static getTextureInfo(C,e,l,g,p){const M=g??this.getEnvelope(C,null,e);if(!M)return[0,0,0,0,1];const T=Math.max(M.width,M.height)*G;let S=null!=p?Math.max(p/T,1):1;S*=G,M.x*=S,M.y*=S,M.width*=S,M.height*=S,M.width=Math.max(Math.ceil(M.x+M.width)-Math.floor(M.x),1)-1,M.height=Math.max(Math.ceil(M.y+M.height)-Math.floor(M.y),1)-1;let F=M.x+.5*M.width,j=M.y+.5*M.height;return F+=M.x-Math.floor(M.x),j+=M.y-Math.floor(M.y),g||(M.width+=l,M.height+=l,F+=l/2,j+=l/2),[M.width,M.height,F,j,S]}static getTextureAnchor(C,e,l){const[g,p,M,T,S]=this.getTextureInfo(C,e,2,null,l);return[-M/g,-T/p,p/S*G]}static rasterize(C,e,l,g,p=!0,M){const[T,S,F,j,K]=this.getTextureInfo(e,g,2,l,M);C.width=T,C.height=S;const Q=C.getContext("2d",{willReadFrequently:!0}),st=u.IT.createScale(K,-K);st.translate(.5*T-F,.5*S+j);const nt=new u.Rj(Q,g,st);switch(e.type){case"CIMPointSymbol":nt.drawSymbol(e,{type:"point",x:0,y:0});break;case"CIMVectorMarker":{const V=new o.W;nt.drawMarker(e,V);break}}const J=Q.getImageData(0,0,C.width,C.height),Y=new Uint8Array(J.data);if(p){let V;for(let ot=0;ot<Y.length;ot+=4)V=Y[ot+3]/255,Y[ot]=Y[ot]*V,Y[ot+1]=Y[ot+1]*V,Y[ot+2]=Y[ot+2]*V}return[Y,C.width,C.height,-F/T,-j/S]}static fromTextSymbol(C){const{text:e}=C;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:$.createCIMTextSymbolfromTextSymbol(C),textString:e}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(C){const{height:e,outline:l,width:g,xoffset:p,xscale:M,yoffset:T,yscale:S}=C,F=[],j={type:"CIMPolygonSymbol",symbolLayers:F};if(l){const J=Tt(l);J&&F.push(J)}let K=C.url;"esriPFS"===C.type&&C.imageData&&(K=C.imageData);const Q="angle"in C?C.angle??0:0;return F.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:m.O$.Picture,tintColor:null,url:K,height:(e??0)*(S||1),width:(g??0)*(M||1),offsetX:(0,h.$w)(p),offsetY:(0,h.$w)(T),rotation:(0,h.$w)(-Q),colorSubstitutions:null}),j}static fromSimpleFillSymbol(C){const{color:e,style:l,outline:g}=C,p=[],M={type:"CIMPolygonSymbol",symbolLayers:p};if(g){const T=Tt(g);T&&p.push(T)}if(l&&"solid"!==l&&"none"!==l&&"esriSFSSolid"!==l&&"esriSFSNull"!==l){const T={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:_t(e),capStyle:m.uT.Butt,joinStyle:m.wd.Miter,width:.75}]};let S=0;const F=(0,E.PN)(Lt(l)?8:10);switch(l){case"vertical":case"esriSFSVertical":S=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":S=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":S=45;break;case"cross":case"esriSFSCross":S=0}p.push({type:"CIMHatchFill",lineSymbol:T,offsetX:0,offsetY:0,rotation:S,separation:F}),"cross"===l||"esriSFSCross"===l?p.push({type:"CIMHatchFill",lineSymbol:(0,X.o8)(T),offsetX:0,offsetY:0,rotation:90,separation:F}):"diagonal-cross"!==l&&"esriSFSDiagonalCross"!==l||p.push({type:"CIMHatchFill",lineSymbol:(0,X.o8)(T),offsetX:0,offsetY:0,rotation:45,separation:F})}else!l||"solid"!==l&&"esriSFSSolid"!==l||p.push({type:"CIMSolidFill",enable:!0,color:_t(e)});return M}static fromSimpleLineSymbol(C){const{cap:e,color:l,join:g,marker:p,miterLimit:M,style:T,width:S}=C;let F=null;"solid"!==T&&"none"!==T&&"esriSLSSolid"!==T&&"esriSLSNull"!==T&&(F=[{type:"CIMGeometricEffectDashes",dashTemplate:mt(T,e),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const j=[];if(p){let K;switch(p.placement){case"begin-end":K=m.$2.Both;break;case"begin":K=m.$2.JustBegin;break;case"end":K=m.$2.JustEnd;break;default:K=m.$2.None}const Q=$.fromSimpleMarker(p,S,l).symbolLayers[0];Q.markerPlacement={type:"CIMMarkerPlacementAtExtremities",placePerPart:!1,angleToLine:!0,offset:0,extremityPlacement:K,offsetAlongLine:0},j.push(Q)}return j.push({type:"CIMSolidStroke",color:"none"!==T&&"esriSLSNull"!==T?_t(l):[0,0,0,0],capStyle:Z(e),joinStyle:et(g),miterLimit:M,width:S,effects:F}),{type:"CIMLineSymbol",symbolLayers:j}}static fromPictureMarker(C){const{angle:e,height:l,width:g,xoffset:p,yoffset:M}=C;let T=C.url;return"esriPMS"===C.type&&C.imageData&&(T=C.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:m.O$.Picture,tintColor:null,url:T,size:l,width:g,offsetX:(0,h.$w)(p),offsetY:(0,h.$w)(M),rotation:(0,h.$w)(-e)}]}}static createCIMTextSymbolfromTextSymbol(C){const{angle:e,color:l,font:g,haloColor:p,haloSize:M,horizontalAlignment:T,kerning:S,lineWidth:F,text:j,verticalAlignment:K,xoffset:Q,yoffset:st,backgroundColor:nt,borderLineColor:J,borderLineSize:Y}=C;let V,ot,ht,ft,gt,Mt;g&&(V=g.family,ot=g.style,ht=g.weight,ft=g.size,gt=g.decoration);let pt=!1;return j&&(pt=(0,it.y)(j)[1]),(nt||Y)&&(Mt={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:_t(nt)},{type:"CIMSolidStroke",color:_t(J),width:Y}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMTextSymbol",angle:e,blockProgression:m.TZ.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:m.Y.Normal,fontEncoding:m.bj.Unicode,fontFamilyName:V||"Arial",fontStyleName:ut(ot,ht),fontType:m.g7.Unspecified,haloSize:M,height:ft,hinting:m.mU.Default,horizontalAlignment:lt(T??"center"),kerning:S,letterWidth:100,ligatures:!0,lineGapType:"Multiple",lineWidth:F,offsetX:(0,h.$w)(Q),offsetY:(0,h.$w)(st),strikethrough:"line-through"===gt,underline:"underline"===gt,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:_t(l)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:_t(p)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:pt?m.f0.RTL:m.f0.LTR,verticalAlignment:ct(K??"baseline"),verticalGlyphOrientation:m.vG.Right,wordSpacing:100,billboardMode3D:m.xn.FaceNearPlane,callout:Mt}}static createPictureMarkerRasterizationParam(C){const{angle:e,height:l,width:g,xoffset:p,yoffset:M}=C,T=C.url??C.source?.url??C.source?.imageData;return T?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:m.O$.Picture,tintColor:null,url:T,size:l,width:g,offsetX:(0,h.$w)(p),offsetY:(0,h.$w)(M),rotation:(0,h.$w)(-e)}}:null}static createPictureFillRasterizationParam(C){const{width:e,height:l,xoffset:g,yoffset:p,url:M}=C;return M?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureFill",scaleX:1,textureFilter:m.O$.Picture,tintColor:null,url:M,width:e,height:l,offsetX:(0,h.$w)(g),offsetY:(0,h.$w)(p),rotation:0}}:null}static fromSimpleMarker(C,e,l){const{style:g}=C,p=C.color??l;if("path"===g||"esriSMSPath"===g){const K=[];if("outline"in C&&C.outline){const nt=C.outline;K.push({type:"CIMSolidStroke",enable:!0,width:nt.width,color:_t(nt.color),path:C.path})}K.push({type:"CIMSolidFill",enable:!0,color:_t(p),path:C.path});const[Q,st]=dt("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:-(0,h.$w)(C.angle),size:(0,h.$w)(C.size||6),offsetX:(0,h.$w)(C.xoffset),offsetY:(0,h.$w)(C.yoffset),scaleSymbolsProportionally:!1,frame:Q,markerGraphics:[{type:"CIMMarkerGraphic",geometry:st,symbol:{type:"CIMPolygonSymbol",symbolLayers:K}}]}]}}const M=[];let T,S,F=C.size;if("outline"in C&&C.outline&&"none"!==C.outline.style&&"esriSLSNull"!==C.outline.style){const K=C.outline,Q="solid"!==K.style&&"esriSLSSolid"!==K.style;[T,S]=Q?dt(g,C.size):dt(g);const st=K.width??r.A7.width;if(Q){const Y=st/C.size,V=(T.xmax-T.xmin)*Y/2,ot=(T.ymax-T.ymin)*Y/2;T.xmin-=V,T.xmax+=V,T.ymin-=ot,T.ymax+=ot,F&&(F+=st)}const nt="cross"!==C.style&&"x"!==C.style||"dot"===C?.outline.style||"short-dot"===C?.outline.style?m.yS.HalfGap:m.yS.FullPattern,J=Q?[{type:"CIMGeometricEffectAddControlPoints"},{type:"CIMGeometricEffectDashes",dashTemplate:mt(K.style,null).map(Y=>K.width&&K.width>0?Y*K.width:Y),lineDashEnding:nt,controlPointEnding:m.yS.FullPattern}]:void 0;M.push({type:"CIMSolidStroke",capStyle:Q?m.uT.Round:m.uT.Butt,enable:!0,width:st,color:_t(K.color),effects:J})}else!e||"line-marker"!==C.type||"cross"!==C.style&&"x"!==C.style?[T,S]=dt(g):([T,S]=dt(g),M.push({type:"CIMSolidStroke",enable:!0,width:e,color:_t(p)}));M.push({type:"CIMSolidFill",enable:!0,color:_t(p)});const j={type:"CIMPolygonSymbol",symbolLayers:M};return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,h.$w)(-C.angle),size:(0,h.$w)(F||6*e),offsetX:(0,h.$w)(C.xoffset),offsetY:(0,h.$w)(C.yoffset),scaleSymbolsProportionally:!1,frame:T,markerGraphics:[{type:"CIMMarkerGraphic",geometry:S,symbol:j}]}]}}static fromCIMHatchFill(C,e){const l=e*(C.separation??d.D.CIMHatchFill.separation),g=l/2,p=(0,X.o8)(C.lineSymbol);p.symbolLayers?.forEach(S=>{switch(S.type){case"CIMSolidStroke":null!=S.width&&(S.width*=e),S.effects?.forEach(F=>{if("CIMGeometricEffectDashes"===F.type){const j=F.dashTemplate;F.dashTemplate=j?.map(K=>K*e)}});break;case"CIMVectorMarker":{null!=S.size&&(S.size*=e);const F=S.markerPlacement;null!=F&&"placementTemplate"in F&&(F.placementTemplate=F.placementTemplate.map(j=>j*e));break}}});let M=this._getLineSymbolPeriod(p)||4;for(;M<4;)M*=2;const T=M/2;return{type:"CIMVectorMarker",frame:{xmin:-T,xmax:T,ymin:-g,ymax:g},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-T,0],[T,0]]]},symbol:p}],size:l}}static fetchResources(C,e,l,g=null){return C&&e&&rt(C,p=>{(function Dt(tt,C,e){if(tt.effects&&null==C.geometryEngine){if(C.geometryEnginePromise)return void e.push(C.geometryEnginePromise);(0,h.yH)(tt.effects)&&(C.geometryEnginePromise=(0,h._H)(),e.push(C.geometryEnginePromise),C.geometryEnginePromise.then(l=>C.geometryEngine=l))}})(p,e,l),"url"in p&&p.url&&l.push(e.fetchResource(p.url,{signal:g}))}),l}static fetchFonts(C,e,l){if(C&&e)if("symbolLayers"in C&&C.symbolLayers){for(const g of C.symbolLayers)if("CIMVectorMarker"===g.type&&g.markerGraphics)for(const p of g.markerGraphics)p?.symbol&&$.fetchFonts(p.symbol,e,l)}else if("CIMTextSymbol"===C.type){const{fontFamilyName:g,fontStyleName:p}=C;if(!g||"calcitewebcoreicons"===g.toLowerCase())return;const{style:M,weight:T}=(0,h._d)(p),S=(0,h.DW)(C),F=new _.A({family:g,style:M,weight:T,decoration:S});l.push(e.loadFont(F).catch(()=>{L().error(`Unsupported font ${g} in CIM symbol`)}))}}static _getLineSymbolPeriod(C){if(C){const e=this._getEffectsRepeat(C.effects);if(e)return e;if(C.symbolLayers)for(const l of C.symbolLayers)if(l){const g=this._getEffectsRepeat(l.effects);if(g)return g;switch(l.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const p=this._getPlacementRepeat(l.markerPlacement);if(p)return p}}}}return 0}static _getEffectsRepeat(C){if(C)for(const e of C)if(e)switch(e.type){case"CIMGeometricEffectDashes":{const l=e.dashTemplate;if(l&&l.length){let g=0;for(const p of l)g+=p;return 1&l.length&&(g*=2),g}break}case"CIMGeometricEffectWave":return e.period;default:L().error(`unsupported geometric effect type ${e.type}`)}return 0}static _getPlacementRepeat(C){if(C)switch(C.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const e=C.placementTemplate;if(e&&e.length){let l=0;for(const g of e)l+=+g;return 1&e.length&&(l*=2),l}break}}return 0}static fromCIMInsidePolygon(C){const e=C.markerPlacement,l={...C};l.markerPlacement=null,l.anchorPoint=null;const g=Math.abs(e.stepX),p=Math.abs(e.stepY),M=(e.randomness??100)/100;let T,S,F,j;if("Random"===e.gridType){const K=(0,E.PN)(n.yv),Q=Math.max(Math.floor(K/g),1),st=Math.max(Math.floor(K/p),1);T=Q*g/2,S=st*p/2,F=2*S;const nt=new B.A(e.seed),J=M*g/1.5,Y=M*p/1.5;j=[];for(let V=0;V<Q;V++)for(let ot=0;ot<st;ot++){const ht=V*g-T+J*(.5-nt.getFloat()),ft=ot*p-S+Y*(.5-nt.getFloat());j.push({x:ht,y:ft}),0===V&&j.push({x:ht+2*T,y:ft}),0===ot&&j.push({x:ht,y:ft+2*S})}}else!0===e.shiftOddRows?(T=g/2,S=p,F=2*p,j=[{x:-T,y:0},{x:T,y:0},{x:0,y:S},{x:0,y:-S}]):(T=g/2,S=p/2,F=p,j=[{x:-g,y:0},{x:0,y:-p},{x:-g,y:-p},{x:0,y:0},{x:g,y:0},{x:0,y:p},{x:g,y:p},{x:-g,y:p},{x:g,y:-p}]);return{type:"CIMVectorMarker",frame:{xmin:-T,xmax:T,ymin:-S,ymax:S},markerGraphics:j.map(K=>({type:"CIMMarkerGraphic",geometry:K,symbol:{type:"CIMPointSymbol",symbolLayers:[l]}})),size:F}}}function rt(tt,C){if(tt)switch(tt.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=tt.symbolLayers;if(!e)return;for(const l of e)if(C(l),"CIMVectorMarker"===l.type){const g=l.markerGraphics;if(!g)continue;for(const p of g)if(p){const M=p.symbol;M&&rt(M,C)}}break}}}const Z=tt=>{if(!tt)return m.uT.Butt;switch(tt){case"butt":return m.uT.Butt;case"square":return m.uT.Square;case"round":return m.uT.Round}},et=tt=>{if(!tt)return m.wd.Miter;switch(tt){case"miter":return m.wd.Miter;case"round":return m.wd.Round;case"bevel":return m.wd.Bevel}},lt=tt=>{if(null==tt)return"Center";switch(tt){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},ct=tt=>{if(null==tt)return"Center";switch(tt){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},_t=tt=>{if(!tt)return[0,0,0,0];const{r:C,g:e,b:l,a:g}=tt;return[C,e,l,255*g]},ut=(tt,C)=>{const e=Pt(C),l=xt(tt);return e&&l?`${e}-${l}`:`${e}${l}`},Pt=tt=>{if(!tt)return"";switch(tt.toLowerCase()){case"bold":case"bolder":return"bold"}return""},xt=tt=>{if(!tt)return"";switch(tt.toLowerCase()){case"italic":case"oblique":return"italic"}return""},mt=(tt,C)=>{const e=(0,q.A)("safari")?.001:0,l="butt"===C;switch(tt){case"dash":case"esriSLSDash":return l?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return l?[4,3,1,3]:[3,4,e,4];case"dot":case"esriSLSDot":return l?[1,3]:[e,4];case"long-dash":case"esriSLSLongDash":return l?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return l?[8,3,1,3]:[7,4,e,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return l?[8,3,1,3,1,3]:[7,4,e,4,e,4];case"short-dash":case"esriSLSShortDash":return l?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return l?[4,1,1,1]:[3,2,e,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return l?[4,1,1,1,1,1]:[3,2,e,2,e,2];case"short-dot":case"esriSLSShortDot":return l?[1,1]:[e,2];case"solid":case"esriSLSSolid":case"none":return L().error("Unexpected: style does not require rasterization"),[0,0];default:return L().error(`Tried to rasterize SLS, but found an unexpected style: ${tt}!`),[0,0]}},dt=(tt,C=100)=>{const e=C/2;let l,g;const p=tt;if("circle"===p||"esriSMSCircle"===p){let T=Math.acos(1-.25/e),S=Math.ceil(w/T/4);0===S&&(S=1),T=O/S,S*=4;const F=[];F.push([e,0]);for(let j=1;j<S;j++)F.push([e*Math.cos(j*T),-e*Math.sin(j*T)]);F.push([e,0]),l={rings:[F]},g={xmin:-e,ymin:-e,xmax:e,ymax:e}}else if("cross"===p||"esriSMSCross"===p)l={paths:[[[0,e],[0,-e]],[[e,0],[-e,0]]]},g={xmin:-e,ymin:-e,xmax:e,ymax:e};else if("diamond"===p||"esriSMSDiamond"===p)l={rings:[[[-e,0],[0,e],[e,0],[0,-e],[-e,0]]]},g={xmin:-e,ymin:-e,xmax:e,ymax:e};else if("square"===p||"esriSMSSquare"===p)l={rings:[[[-e,-e],[-e,e],[e,e],[e,-e],[-e,-e]]]},g={xmin:-e,ymin:-e,xmax:e,ymax:e};else if("x"===p||"esriSMSX"===p)l={paths:[[[e,e],[-e,-e]],[[e,-e],[-e,e]]]},g={xmin:-e,ymin:-e,xmax:e,ymax:e};else if("triangle"===p||"esriSMSTriangle"===p){const M=.5773502691896257*C,T=-M,S=2/3*C,F=S-C;l={rings:[[[T,F],[0,S],[M,F],[T,F]]]},g={xmin:T,ymin:F,xmax:M,ymax:S}}else"arrow"===p&&(l={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},g={xmin:-e,ymin:-e,xmax:e,ymax:e});return[g,l]},Lt=tt=>"vertical"===tt||"horizontal"===tt||"cross"===tt||"esriSFSCross"===tt||"esriSFSVertical"===tt||"esriSFSHorizontal"===tt;function Tt(tt){if(!tt)return null;let C=null;const{cap:e,color:l,join:g,miterLimit:p,style:M,width:T}=tt;return"solid"!==M&&"none"!==M&&"esriSLSSolid"!==M&&"esriSLSNull"!==M&&(C=[{type:"CIMGeometricEffectDashes",dashTemplate:mt(M,e),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:"esriSLSNull"!==M&&"none"!==M?_t(l):[0,0,0,0],capStyle:Z(e),joinStyle:et(g),miterLimit:p,width:T,effects:C}}},67311:(yt,at,A)=>{A.d(at,{I:()=>W,U:()=>X});var it=A(72137),q=A(65374);const X=.03;class W{constructor(E=0,P=!1){}isEmpty(E){if(!E.nextPoint())return!0;let P,b,_,o;for(P=E.x,b=E.y;E.nextPoint();P=b,b=o)if(_=E.x,o=E.y,_!==P||o!==b)return E.seekPathStart(),!1;return E.seekPathStart(),!0}normalize(E){const P=Math.sqrt(E[0]*E[0]+E[1]*E[1]);0!==P&&(E[0]/=P,E[1]/=P)}getLength(E,P,b,_){const o=b-E,u=_-P;return Math.sqrt(o*o+u*u)}getSegLength(E){const[[P,b],[_,o]]=E;return this.getLength(P,b,_,o)}getCoord2D(E,P,b,_,o){return[E+(b-E)*o,P+(_-P)*o]}getSegCoord2D(E,P){const[[b,_],[o,u]]=E;return this.getCoord2D(b,_,o,u,P)}getAngle(E,P,b,_,o){return Math.atan2(_-P,b-E)}getAngleCS(E,P,b,_,o){const u=b-E,d=_-P,m=Math.sqrt(u*u+d*d);return m>0?[u/m,d/m]:[1,0]}getSegAngleCS(E,P){const[[b,_],[o,u]]=E;return this.getAngleCS(b,_,o,u,P)}cut(E,P,b,_,o,u){return[o<=0?[E,P]:this.getCoord2D(E,P,b,_,o),u>=1?[b,_]:this.getCoord2D(E,P,b,_,u)]}getSubCurve(E,P,b){const _=it.z.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(_,E,P,b)?_:null}appendSubCurve(E,P,b,_){E.startPath(),P.seekPathStart();let o=0,u=!0;if(!P.nextPoint())return!1;let d=P.x,m=P.y;for(;P.nextPoint();){const h=this.getLength(d,m,P.x,P.y);if(0!==h){if(u){if(o+h>b){let c=1,n=!1;o+h>=_&&(c=(_-o)/h,n=!0);const f=this.cut(d,m,P.x,P.y,(b-o)/h,c);if(f&&E.pushPoints(f),n)break;u=!1}}else{if(o+h>_){const r=this.cut(d,m,P.x,P.y,0,(_-o)/h);r&&E.pushPoint(r[1]);break}E.pushXY(P.x,P.y)}o+=h,d=P.x,m=P.y}else d=P.x,m=P.y}return!0}getCIMPointAlong(E,P){if(!E.nextPoint())return null;let b,_,o,u,d=0;for(b=E.x,_=E.y;E.nextPoint();b=o,_=u){o=E.x,u=E.y;const m=this.getLength(b,_,o,u);if(0!==m){if(d+m>P)return this.getCoord2D(b,_,o,u,(P-d)/m);d+=m}}return null}offset(E,P,b,_,o){if(!E||E.length<2)return null;let u=0,d=E[u++],m=u;for(;u<E.length;){const n=E[u];n[0]===d[0]&&n[1]===d[1]||(u!==m&&(E[m]=E[u]),d=E[m++]),u++}const h=E[0][0]===E[m-1][0]&&E[0][1]===E[m-1][1];if(h&&--m,m<(h?3:2))return null;const r=[];d=h?E[m-1]:null;let c=E[0];for(let n=0;n<m;n++){const f=n===m-1?h?E[0]:null:E[n+1];if(d)if(f){const x=[f[0]-c[0],f[1]-c[1]];this.normalize(x);const w=[c[0]-d[0],c[1]-d[1]];this.normalize(w);const O=w[0]*x[1]-w[1]*x[0],U=w[0]*x[0]+w[1]*x[1];if(0===O&&1===U){c=f;continue}if(O>=0==P<=0){if(U<1){const G=[x[0]-w[0],x[1]-w[1]];this.normalize(G);const N=Math.sqrt((1+U)/2);if(N>1/_){const R=-Math.abs(P)/N;r.push([c[0]-G[0]*R,c[1]-G[1]*R])}}}else switch(b){case q.xw.Mitered:{const G=Math.sqrt((1+U)/2);if(G>0&&1/G<_){const N=[x[0]-w[0],x[1]-w[1]];this.normalize(N);const R=Math.abs(P)/G;r.push([c[0]-N[0]*R,c[1]-N[1]*R]);break}}case q.xw.Bevelled:r.push([c[0]+w[1]*P,c[1]-w[0]*P]),r.push([c[0]+x[1]*P,c[1]-x[0]*P]);break;case q.xw.Rounded:if(U<1){r.push([c[0]+w[1]*P,c[1]-w[0]*P]);const G=Math.floor(2.5*(1-U));if(G>0){const N=1/G;let R=N;for(let v=1;v<G;v++,R+=N){const L=[w[1]*(1-R)+x[1]*R,-w[0]*(1-R)-x[0]*R];this.normalize(L),r.push([c[0]+L[0]*P,c[1]+L[1]*P])}}r.push([c[0]+x[1]*P,c[1]-x[0]*P])}break;default:if(O<0)r.push([c[0]+(w[1]+w[0])*P,c[1]+(w[1]-w[0])*P]),r.push([c[0]+(x[1]-x[0])*P,c[1]-(x[0]+x[1])*P]);else{const G=Math.sqrt((1+Math.abs(U))/2),N=[x[0]-w[0],x[1]-w[1]];this.normalize(N);const R=P/G;r.push([c[0]-N[0]*R,c[1]-N[1]*R])}}}else{const x=[c[0]-d[0],c[1]-d[1]];this.normalize(x),r.push([c[0]+x[1]*P,c[1]-x[0]*P])}else{const x=[f[0]-c[0],f[1]-c[1]];this.normalize(x),r.push([c[0]+x[1]*P,c[1]-x[0]*P])}d=c,c=f}return r.length<(h?3:2)?null:(h&&r.push([r[0][0],r[0][1]]),r)}}},61116:(yt,at,A)=>{A.d(at,{VA:()=>W,YQ:()=>E,Z1:()=>b,ps:()=>B});var E,_,it=A(72137),q=A(67311);class W{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(o,u,d=!0){if(this._setEmpty(),!o||0===o.length)return!1;for(let m=0;m<o.length;m++){let h=Math.abs(o[m]);d&&h<1e-7&&(h=1e-7),this._values.push(h),this._length+=h}return u&&1&o.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(o){const u=this._values?this._values.length:0;for(let d=0;d<u;++d)this._values[d]*=o;this._length*=o,this.extPtGap*=o,this.ctrlPtGap*=o}addValue(o){this._length+=o,this._values.push(o)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}class B{constructor(){this.pt=null,this.ca=0,this.sa=0}}(_=E||(E={}))[_.FAIL=0]="FAIL",_[_.END=1]="END",_[_.CONTINUE=2]="CONTINUE";class P{constructor(){this.reset()}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return null!==this.segment}copyTo(o){o.segment=this.segment,o.segmentLength=this.segmentLength,o.abscissa=this.abscissa,o.isPathEnd=this.isPathEnd,o.isPartEnd=this.isPartEnd}}class b extends q.I{constructor(o=0,u=!1){super(o,u),this._tolerance=q.U,this._currentPosition=new P}updateTolerance(o){this._tolerance=q.U*o}init(o,u,d=!0){return d?(this._patternLength=u.length(),this._partExtPtGap=u.extPtGap,this._partCtrlPtGap=u.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=o,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(o,u=E.FAIL){const d=new P;return!!this._nextPosition(o,d,null,u)&&(d.copyTo(this._currentPosition),!0)}curPointAndAngle(o){o.pt=this._getPoint(this._currentPosition);const[u,d]=this._getAngleCS(this._currentPosition);o.ca=u,o.sa=d}nextPointAndAngle(o,u,d=E.FAIL){const m=new P;if(!this._nextPosition(o,m,null,d))return!1;m.copyTo(this._currentPosition),u.pt=this._getPoint(m);const[h,r]=this._getAngleCS(m);return u.ca=h,u.sa=r,!0}nextCurve(o){if(0===o)return null;const u=it.z.createEmptyOptimizedCIM("esriGeometryPolyline");u.startPath(),u.nextPath();const d=new P;return this._nextPosition(o,d,u,E.END)?(d.copyTo(this._currentPosition),u):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(o){return this._pathCursor.seekInPath(o),[this._pathCursor.x,this._pathCursor.y]}getSeg(o){return[this.getPt(o),this.getPt(o+1)]}_nextPosition(o,u,d,m){if(this._currentPosition.isPathEnd)return!1;let h=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(h/=this._currentPosition.segmentLength),this._currentPosition.copyTo(u);u.abscissa+o*this._partLengthRatio>u.segmentLength+this._tolerance;){if(d){if(0===d.pathSize)if(0===h){const c=u.segment[0];d.pushXY(c[0],c[1])}else d.pushPoint(this.getSegCoord2D(u.segment,h));const r=u.segment[1];d.pushXY(r[0],r[1])}if(h=0,o-=(u.segmentLength-u.abscissa)/this._partLengthRatio,this._partSegCount)u.segment=this._nextSegment(),u.segmentLength=this.getSegLength(u.segment),u.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return m!==E.FAIL&&(u.segmentLength=this.getSegLength(u.segment),u.isPartEnd=!0,m===E.END?(u.abscissa=u.segmentLength,u.isPathEnd=!0):u.abscissa=u.segmentLength+o,!0);this._currentPosition.copyTo(u)}}if(u.abscissa+=o*this._partLengthRatio,d){0===d.pathSize&&d.pushPoint(0===h?u.segment[0]:this.getSegCoord2D(u.segment,h));const r=u.abscissa/u.segmentLength;d.pushPoint(1===r?u.segment[1]:this.getSegCoord2D(u.segment,r))}return this._partSegCount||Math.abs(u.abscissa-u.segmentLength)<this._tolerance&&(u.isPathEnd=this._partIsLast,u.isPartEnd=!0),!0}_getPoint(o){return this.getSegCoord2D(this._currentPosition.segment,o.segmentLength<=0?0:o.abscissa/o.segmentLength)}_getAngleCS(o){return this.getSegAngleCS(this._currentPosition.segment,o.segmentLength<=0?0:o.abscissa/o.segmentLength)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let o=this._partSegCount;for(;o;)this._previousSegment(),--o;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const u=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(u);let d=u+this._partSegCount+1;if(d>=this._pathCursor.pathSize&&(d=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(d),this._patternLength>0){const m=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,h=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let r=Math.round((this._partLength-(m+h))/this._patternLength);r<=0&&(r=m+h>0?0:1),this._partLengthRatio=this._partLength/(m+h+r*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}}},9792:(yt,at,A)=>{A.d(at,{A:()=>it});class it{constructor(X=0,W=0,B=0,E=0){this.x=X,this.y=W,this.width=B,this.height=E}static fromExtent(X){return new it(X.xmin,-X.ymax,X.xmax-X.xmin,X.ymax-X.ymin)}get isEmpty(){return this.width<=0||this.height<=0}union(X){this.x=Math.min(this.x,X.x),this.y=Math.min(this.y,X.y),this.width=Math.max(this.width,X.width),this.height=Math.max(this.height,X.height)}}},84289:(yt,at,A)=>{A.d(at,{$o:()=>it,$u:()=>W,gR:()=>X,zA:()=>q});const it=15.5,q=4,X=64,W=1024},47763:(yt,at,A)=>{A.d(at,{B:()=>_});var it=A(72137),q=A(53262),X=A(61245),W=A(67311),B=A(65374);const E=1.7320508075688772,b=B.oF.OpenEnded;let _=(()=>{class u{static local(){return null===u.instance&&(u.instance=new u),u.instance}execute(m,h,r,c,n){return new o(m,h,r)}}return u.instance=null,u})();class o extends X.rx{constructor(d,m,h){super(d,!1,!0),this._curveHelper=new W.I,this._width=(void 0!==m.width?m.width:5)*h,this._arrowType=void 0!==m.geometricEffectArrowType?m.geometricEffectArrowType:void 0!==m.arrowType?m.arrowType:b,this._offsetFlattenError=W.U*h}processPath(d){const m=it.z.createEmptyOptimizedCIM(d.geometryType);switch(this._arrowType){case B.oF.OpenEnded:default:this._constructSimpleArrow(m,d,!0);break;case B.oF.Block:this._constructSimpleArrow(m,d,!1);break;case B.oF.Crossed:this._constructCrossedArrow(m,d)}return m}_constructSimpleArrow(d,m,h){const r=m.pathLength();let c=this._width;r<2*c&&(c=r/2);const n=this._curveHelper.getSubCurve(m,0,r-c);if(!n||!n.nextPath())return;n.seekPathStart();const f=c/2;if(this._curveHelper.isEmpty(n))return;const x=(0,q.A)(n),w=this._constructOffset(x,-f);if(!w)return;const O=this._constructOffset(x,f);if(!O)return;const U=this._constructArrowBasePoint(w,-f/2);if(!U)return;const G=this._constructArrowBasePoint(O,f/2);if(!G)return;m.seekInPath(m.pathSize-1);const N=[m.x,m.y];d.pushPath(O),d.nextPath(),d.nextPoint(),d.setControlPoint(),d.pushPoint(G),d.nextPoint(),d.setControlPoint(),d.pushPoint(N),d.nextPoint(),d.setControlPoint(),d.pushPoint(U),d.nextPoint(),d.setControlPoint(),d.pushPoints(w.reverse()),d.setControlPoint(),h||(d.setControlPointAt(0),d.setControlPointAt(d.pathSize-1),d.pushPoint(O[0])),d.reset()}_constructCrossedArrow(d,m){const h=m.pathLength();let r=this._width;h<r*(1+E+1)&&(r=h/(1+E+1)),m.seekPathStart();const c=this._curveHelper.getSubCurve(m,0,h-r*(1+E));if(!c)return;c.nextPath();const n=r/2;if(this._curveHelper.isEmpty(c))return;const f=(0,q.A)(c),x=this._constructOffset(f,n);if(!x)return;const w=this._constructOffset(f,-n);if(!w)return;const O=this._curveHelper.getSubCurve(m,0,h-r);if(!O||(O.nextPath(),this._curveHelper.isEmpty(O)))return;const U=(0,q.A)(O),G=this._constructOffset(U,n);if(!G)return;const N=this._constructOffset(U,-n);if(!N)return;const R=G[G.length-1],v=this._constructArrowBasePoint(G,n/2);if(!v)return;const L=N[N.length-1],I=this._constructArrowBasePoint(N,-n/2);if(!I)return;m.seekInPath(m.pathSize-1);const y=[m.x,m.y];d.pushPath(x),d.nextPath(),d.nextPoint(),d.setControlPoint(),d.pushPoint(L),d.nextPoint(),d.setControlPoint(),d.pushPoint(I),d.nextPoint(),d.setControlPoint(),d.pushPoint(y),d.nextPoint(),d.setControlPoint(),d.pushPoint(v),d.nextPoint(),d.setControlPoint(),d.pushPoint(R),d.nextPoint(),d.setControlPoint(),d.pushPoints(w.reverse()),d.nextPoint(),d.setControlPoint(),d.reset()}_constructOffset(d,m){return this._curveHelper.offset(d,m,B.xw.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(d,m){if(!d||d.length<2)return null;const h=d[d.length-2],r=d[d.length-1],c=[r[0]-h[0],r[1]-h[1]];return this._curveHelper.normalize(c),[r[0]+c[1]*m,r[1]-c[0]*m]}}},69630:(yt,at,A)=>{A.d(at,{s:()=>P});var it=A(72137),q=A(53262),X=A(32034),W=A(47961),B=A(67311),E=A(65374);let P=(()=>{class _{static local(){return null===_.instance&&(_.instance=new _),_.instance}execute(u,d,m,h,r,c,n){return new b(u,d,m,h,r,c,n)}}return _.instance=null,_})();class b{constructor(o,u,d,m,h,r,c){this._preventClipping=c,this._inputGeometries=o,this._tileKey=m,this._geometryEngine=h,this._curveHelper=new B.I,this._size=(void 0!==u.size?u.size:1)*d,this._maxInflateSize=r*d,this._offsetFlattenError=B.U*d}next(){let o;for(;o=this._inputGeometries.next();){if(0===this._size)return o;if("esriGeometryEnvelope"===o.geometryType)if(this._size>0){const h=it.z.createEmptyOptimizedCIM(o.geometryType),r=(0,q.x)(o)[0],c=this._curveHelper.offset(r,this._size,E.xw.Rounded,4,this._offsetFlattenError);if(c)return h.pushPath(c),h}else if(this._size<0){const h=o.asJSON();if(Math.min(h.xmax-h.xmin,h.ymax-h.ymin)+2*this._size>0)return it.z.fromJSONCIM({xmin:h.xmin-this._size,xmax:h.xmax+this._size,ymin:h.ymin-this._size,ymax:h.ymax+this._size})}const u=this._geometryEngine;if(null==u)return null;const d=!this._preventClipping&&this._tileKey?(0,W.q)(o,this._maxInflateSize):o;if(!d)continue;const m=u.buffer(X.A.WebMercator,d.asJSON(),this._size,1);return m?it.z.fromJSONCIM(m):null}return null}}},71045:(yt,at,A)=>{A.d(at,{v:()=>E});var it=A(72137),q=A(53262),X=A(15268),W=A(61245),B=A(65374);let E=(()=>{class b{static local(){return null===b.instance&&(b.instance=new b),b.instance}execute(o,u,d,m,h){return new P(o,u,d)}}return b.instance=null,b})();class P{constructor(_,o,u){this._defaultPointSize=20,this._inputGeometries=_,this._geomUnitsPerPoint=u,this._rule=o.rule??B.uQ.FullGeometry,this._defaultSize=this._defaultPointSize*u}next(){let _;for(;_=this._inputGeometries.next();){const o=this._processGeom((0,q.x)(_));if(o?.length)return it.z.fromJSONCIM({paths:o})}return null}_clone(_){return[_[0],_[1]]}_mid(_,o){return[(_[0]+o[0])/2,(_[1]+o[1])/2]}_mix(_,o,u,d){return[_[0]*o+u[0]*d,_[1]*o+u[1]*d]}_add(_,o){return[_[0]+o[0],_[1]+o[1]]}_add2(_,o,u){return[_[0]+o,_[1]+u]}_sub(_,o){return[_[0]-o[0],_[1]-o[1]]}_dist(_,o){return Math.sqrt((_[0]-o[0])*(_[0]-o[0])+(_[1]-o[1])*(_[1]-o[1]))}_norm(_){return Math.sqrt(_[0]*_[0]+_[1]*_[1])}_normalize(_,o=1){const u=o/this._norm(_);_[0]*=u,_[1]*=u}_leftPerpendicular(_){const u=_[0];_[0]=-_[1],_[1]=u}_leftPerp(_){return[-_[1],_[0]]}_rightPerpendicular(_){const u=-_[0];_[0]=_[1],_[1]=u}_rightPerp(_){return[_[1],-_[0]]}_dotProduct(_,o){return _[0]*o[0]+_[1]*o[1]}_crossProduct(_,o){return _[0]*o[1]-_[1]*o[0]}_rotateDirect(_,o,u){const m=_[0]*u+_[1]*o;_[0]=_[0]*o-_[1]*u,_[1]=m}_makeCtrlPt(_){const o=[_[0],_[1]];return(0,W.Aq)(o,1),o}_addAngledTicks(_,o,u,d){const m=this._sub(u,o);this._normalize(m);const h=this._crossProduct(m,this._sub(d,o));let r;r=h>0?this._rightPerp(m):this._leftPerp(m);const c=Math.abs(h)/2,n=[];n.push([o[0]+(r[0]-m[0])*c,o[1]+(r[1]-m[1])*c]),n.push(o),n.push(u),n.push([u[0]+(r[0]+m[0])*c,u[1]+(r[1]+m[1])*c]),_.push(n)}_addBezier2(_,o,u,d,m){if(0==m--)return void _.push(d);const h=this._mid(o,u),r=this._mid(u,d),c=this._mid(h,r);this._addBezier2(_,o,h,c,m),this._addBezier2(_,c,r,d,m)}_addBezier3(_,o,u,d,m,h){if(0==h--)return void _.push(m);const r=this._mid(o,u),c=this._mid(u,d),n=this._mid(d,m),f=this._mid(r,c),x=this._mid(c,n),w=this._mid(f,x);this._addBezier3(_,o,r,f,w,h),this._addBezier3(_,w,x,n,m,h)}_add90DegArc(_,o,u,d,m){const h=m??this._crossProduct(this._sub(u,o),this._sub(d,o))>0,r=this._mid(o,u),c=this._sub(r,o);h?this._leftPerpendicular(c):this._rightPerpendicular(c),r[0]+=c[0],r[1]+=c[1],this._addBezier3(_,o,this._mix(o,.33333,r,.66667),this._mix(u,.33333,r,.66667),u,4)}_addArrow(_,o,u){const d=o[0],m=o[1],h=o[o.length-1],r=this._sub(d,m),c=this._norm(r);this._normalize(r);const n=Math.abs(this._crossProduct(r,this._sub(h,m)));let f=this._dotProduct(r,this._sub(h,m));f<.05*c?f=.05*c:f>.95*c&&(f=.95*c);const x=.5*n,w=this._leftPerp(r),O=[m[0]+r[0]*f,m[1]+r[1]*f],U=o.length-1,G=[];G.push(u?[-w[0],-w[1]]:w);let N=[-r[0],-r[1]];for(let R=1;R<U-1;R++){const v=this._sub(o[R+1],o[R]);this._normalize(v);const L=this._dotProduct(v,N),I=this._crossProduct(v,N),y=Math.sqrt((1+L)/2),z=this._sub(v,N);this._normalize(z),z[0]/=y,z[1]/=y,G.push(I<0?[-z[0],-z[1]]:z),N=v}G.push(this._rightPerp(N));for(let R=G.length-1;R>0;R--)_.push([o[R][0]+G[R][0]*x,o[R][1]+G[R][1]*x]);_.push([O[0]+G[0][0]*x,O[1]+G[0][1]*x]),_.push([O[0]+G[0][0]*n,O[1]+G[0][1]*n]),_.push(d),_.push([O[0]-G[0][0]*n,O[1]-G[0][1]*n]),_.push([O[0]-G[0][0]*x,O[1]-G[0][1]*x]);for(let R=1;R<G.length;R++)_.push([o[R][0]-G[R][0]*x,o[R][1]-G[R][1]*x])}_addDash(_,o,u){const d=this._norm(u)/7;this._normalize(u);let m=[];for(let h=0;h<=7;h++)m.push([o[0]+u[0]*h*d,o[1]+u[1]*h*d]),1&h&&(_.push(m),m=[])}_cp2(_,o,u){return _.length>=2?_[1]:this._add2(_[0],o*this._defaultSize,u*this._defaultSize)}_cp3(_,o,u,d){if(_.length>=3)return _[2];const m=this._mix(_[0],1-u,o,u),h=this._sub(o,_[0]);return this._normalize(h),this._rightPerpendicular(h),[m[0]+h[0]*d*this._defaultSize,m[1]+h[1]*d*this._defaultSize]}_arrowPath(_){if(_.length>2)return _;const o=_[0],u=this._cp2(_,-4,0),d=this._sub(o,u);this._normalize(d);const m=this._rightPerp(d);return[o,u,[o[0]+(m[0]-d[0])*this._defaultSize,o[1]+(m[1]-d[1])*this._defaultSize]]}_arrowLastSeg(_){const o=_[0],u=this._cp2(_,-4,0);let d;if(_.length>=3)d=_[_.length-1];else{const m=this._sub(o,u);this._normalize(m);const h=this._rightPerp(m);d=[o[0]+(h[0]-m[0])*this._defaultSize,o[1]+(h[1]-m[1])*this._defaultSize]}return[u,d]}_processGeom(_){if(!_)return null;const o=[];for(const u of _){const d=u.length>1&&(0,X.Yl)(u)<this._defaultSize;if(!u||0===u.length||d)continue;const m=u.length;let h=u[0];switch(this._rule){case B.uQ.PerpendicularFromFirstSegment:{const r=this._cp2(u,0,-1),c=this._cp3(u,r,.5,4),n=[];n.push(c),n.push(this._mid(h,r)),o.push(n);break}case B.uQ.ReversedFirstSegment:{const r=this._cp2(u,0,-1);o.push([r,h]);break}case B.uQ.PerpendicularToSecondSegment:{if(u.length<3)return[];const r=this._cp2(u,-4,1),c=this._cp3(u,r,.882353,-1.94),n=[];n.push(this._mid(r,c)),n.push(h),o.push(n);break}case B.uQ.SecondSegmentWithTicks:{if(u.length<3)return[];const r=this._cp2(u,-4,1),c=this._cp3(u,r,.882353,-1.94),n=this._sub(c,r);let f;f=this._crossProduct(n,this._sub(h,r))>0?this._rightPerp(n):this._leftPerp(n);const x=[];x.push([r[0]+(f[0]-n[0])/3,r[1]+(f[1]-n[1])/3]),x.push(r),x.push(c),x.push([c[0]+(f[0]+n[0])/3,c[1]+(f[1]+n[1])/3]),o.push(x);break}case B.uQ.DoublePerpendicular:{const r=this._cp2(u,0,-1),c=this._cp3(u,r,.5,3),n=this._mid(h,r),f=this._sub(n,c);this._normalize(f);const x=this._crossProduct(f,this._sub(h,c));this._leftPerpendicular(f);const w=[];w.push(h),w.push([c[0]+f[0]*x,c[1]+f[1]*x]),o.push(w);const O=[];O.push([c[0]-f[0]*x,c[1]-f[1]*x]),O.push(r),o.push(O);break}case B.uQ.OppositeToFirstSegment:{const r=this._cp2(u,0,-1),c=this._cp3(u,r,.5,3),n=this._mid(h,r),f=this._sub(n,c);this._normalize(f);const x=this._crossProduct(f,this._sub(h,c));this._leftPerpendicular(f);const w=[];w.push([c[0]+f[0]*x,c[1]+f[1]*x]),w.push([c[0]-f[0]*x,c[1]-f[1]*x]),o.push(w);break}case B.uQ.TriplePerpendicular:{const r=this._cp2(u,0,-1),c=this._cp3(u,r,.5,4),n=this._mid(h,r),f=this._sub(n,c);this._normalize(f);const x=this._crossProduct(f,this._sub(h,c));this._leftPerpendicular(f);const w=[];w.push([c[0]+f[0]*x*.8,c[1]+f[1]*x*.8]),w.push([n[0]+.8*(h[0]-n[0]),n[1]+.8*(h[1]-n[1])]),o.push(w),o.push([c,n]);const O=[];O.push([c[0]-f[0]*x*.8,c[1]-f[1]*x*.8]),O.push([n[0]+.8*(r[0]-n[0]),n[1]+.8*(r[1]-n[1])]),o.push(O);break}case B.uQ.HalfCircleFirstSegment:{const r=this._cp2(u,0,-1),c=this._cp3(u,r,.5,4),n=this._mid(h,r);let f=this._sub(r,h);const x=Math.cos(Math.PI/18),w=Math.sin(Math.PI/18),O=Math.sqrt((1+x)/2),U=Math.sqrt((1-x)/2),G=[];let N;this._crossProduct(f,this._sub(c,h))>0?(G.push(h),f=this._sub(h,n),N=r):(G.push(r),f=this._sub(r,n),N=h),this._rotateDirect(f,O,U),f[0]/=O,f[1]/=O;for(let R=1;R<=18;R++)G.push(this._add(n,f)),this._rotateDirect(f,x,w);G.push(N),o.push(G);break}case B.uQ.HalfCircleSecondSegment:{const r=this._cp2(u,0,-1),c=this._cp3(u,r,1,-1);let n=this._sub(h,r);this._normalize(n);const f=this._crossProduct(n,this._sub(c,r))/2;this._leftPerpendicular(n);const x=[r[0]+n[0]*f,r[1]+n[1]*f];n=this._sub(r,x);const w=Math.cos(Math.PI/18);let O=Math.sin(Math.PI/18);f>0&&(O=-O);const U=[r];for(let G=1;G<=18;G++)this._rotateDirect(n,w,O),U.push(this._add(x,n));o.push(U);break}case B.uQ.HalfCircleExtended:{const r=this._cp2(u,0,-2),c=this._cp3(u,r,1,-1);let n;if(m>=4)n=u[3];else{const G=this._sub(h,r);n=this._add(c,G)}const f=this._dist(r,c)/2/.75,x=this._sub(r,h);this._normalize(x,f);const w=this._sub(c,n);this._normalize(w,f),o.push([n,c]);const U=[this._clone(c)];this._addBezier3(U,c,this._add(c,w),this._add(r,x),r,4),U.push(h),o.push(U);break}case B.uQ.OpenCircle:{const r=this._cp2(u,-2,0),c=this._sub(r,h),n=Math.cos(Math.PI/18),f=-Math.sin(Math.PI/18),x=[r];for(let w=1;w<=33;w++)this._rotateDirect(c,n,f),x.push(this._add(h,c));o.push(x);break}case B.uQ.CoverageEdgesWithTicks:{const r=this._cp2(u,0,-1);let c,n;if(m>=3)c=u[2];else{const O=this._sub(r,h),U=this._leftPerp(O);c=[h[0]+U[0]-.25*O[0],h[1]+U[1]-.25*O[1]]}if(m>=4)n=u[3];else{const O=this._mid(h,r),U=this._sub(h,r);this._normalize(U),this._leftPerpendicular(U);const G=this._crossProduct(U,this._sub(c,O));this._rightPerpendicular(U),n=[c[0]+U[0]*G*2,c[1]+U[1]*G*2]}const f=this._sub(r,h);let x,w;x=this._crossProduct(f,this._sub(c,h))>0?this._rightPerp(f):this._leftPerp(f),w=[],w.push(c),w.push(h),w.push([h[0]+(x[0]-f[0])/3,h[1]+(x[1]-f[1])/3]),o.push(w),x=this._crossProduct(f,this._sub(n,r))>0?this._rightPerp(f):this._leftPerp(f),w=[],w.push([r[0]+(x[0]+f[0])/3,r[1]+(x[1]+f[1])/3]),w.push(r),w.push(n),o.push(w);break}case B.uQ.GapExtentWithDoubleTicks:{const r=this._cp2(u,0,2),c=this._cp3(u,r,0,1);let n;if(m>=4)n=u[3];else{const f=this._sub(r,h);n=this._add(c,f)}this._addAngledTicks(o,h,r,this._mid(c,n)),this._addAngledTicks(o,c,n,this._mid(h,r));break}case B.uQ.GapExtentMidline:{const r=this._cp2(u,2,0),c=this._cp3(u,r,0,1);let n;if(m>=4)n=u[3];else{const x=this._sub(r,h);n=this._add(c,x)}const f=[];f.push(this._mid(h,c)),f.push(this._mid(r,n)),o.push(f);break}case B.uQ.Chevron:{const r=this._cp2(u,-1,-1);let c;if(m>=3)c=u[2];else{const n=this._sub(r,h);this._leftPerpendicular(n),c=this._add(h,n)}o.push([r,this._makeCtrlPt(h),c]);break}case B.uQ.PerpendicularWithArc:{const r=this._cp2(u,0,-2),c=this._cp3(u,r,.5,-1),n=this._sub(r,h),f=this._norm(n);n[0]/=f,n[1]/=f;const x=this._crossProduct(n,this._sub(c,h));let w=this._dotProduct(n,this._sub(c,h));w<.05*f?w=.05*f:w>.95*f&&(w=.95*f);const O=[h[0]+n[0]*w,h[1]+n[1]*w];let U=this._leftPerp(n),G=[];if(G.push([O[0]-U[0]*x,O[1]-U[1]*x]),G.push([O[0]+U[0]*x,O[1]+U[1]*x]),o.push(G),m>=4){const L=u[3];let I=this._dotProduct(n,this._sub(L,h));I<.1*f?I=.1*f:I>.9*f&&(I=.9*f);const y=[h[0]+n[0]*I,h[1]+n[1]*I],z=this._crossProduct(n,this._sub(L,h)),k=[];k.push([y[0]-U[0]*z,y[1]-U[1]*z]),k.push([y[0]+U[0]*z,y[1]+U[1]*z]),o.push(k)}const N=[r[0]+U[0]*x,r[1]+U[1]*x];U=this._sub(r,N);const R=Math.cos(Math.PI/18);let v=Math.sin(Math.PI/18);x<0&&(v=-v),G=[h,r];for(let L=1;L<=9;L++)this._rotateDirect(U,R,v),G.push(this._add(N,U));o.push(G);break}case B.uQ.ClosedHalfCircle:{const r=this._cp2(u,2,0),c=this._mid(h,r),n=this._sub(r,c),f=Math.cos(Math.PI/18),x=Math.sin(Math.PI/18),w=[h,r];for(let O=1;O<=18;O++)this._rotateDirect(n,f,x),w.push(this._add(c,n));o.push(w);break}case B.uQ.TripleParallelExtended:{const r=this._cp2(u,0,-2),c=this._cp3(u,r,1,-2),n=this._mid(h,r),f=this._sub(c,r);this._normalize(f);const x=Math.abs(this._crossProduct(f,this._sub(n,r)))/2,w=this._dist(r,c),O=[r,h];O.push([h[0]+f[0]*w*.5,h[1]+f[1]*w*.5]),o.push(O);const U=[];U.push([n[0]-f[0]*x,n[1]-f[1]*x]),U.push([n[0]+f[0]*w*.375,n[1]+f[1]*w*.375]),(0,W.Aq)(U[U.length-1],1),U.push([n[0]+f[0]*w*.75,n[1]+f[1]*w*.75]),o.push(U),o.push([r,c]);break}case B.uQ.ParallelWithTicks:{const r=this._cp2(u,3,0),c=this._cp3(u,r,.5,-1),n=this._sub(c,r);this._normalize(n);const f=this._crossProduct(n,this._sub(c,h));this._leftPerpendicular(n),this._addAngledTicks(o,h,r,c),this._addAngledTicks(o,this._mix(h,1,n,f),this._mix(r,1,n,f),this._mid(h,r));break}case B.uQ.Parallel:{const r=this._cp2(u,3,0),c=this._cp3(u,r,.5,-1),n=this._sub(r,h);this._normalize(n);const f=this._leftPerp(n),x=this._crossProduct(n,this._sub(c,h));let w=[h,r];o.push(w),w=[],w.push([h[0]+f[0]*x,h[1]+f[1]*x]),w.push([r[0]+f[0]*x,r[1]+f[1]*x]),o.push(w);break}case B.uQ.PerpendicularToFirstSegment:{const r=this._cp2(u,3,0),c=this._cp3(u,r,.5,-1),n=this._mid(h,r),f=this._sub(r,h);this._normalize(f);const x=this._crossProduct(f,this._sub(c,h));this._leftPerpendicular(f);const w=[];w.push([n[0]-f[0]*x*.25,n[1]-f[1]*x*.25]),w.push([n[0]+f[0]*x*1.25,n[1]+f[1]*x*1.25]),o.push(w);break}case B.uQ.ParallelOffset:{const r=this._cp2(u,3,0),c=this._cp3(u,r,.5,-1),n=this._sub(r,h);this._normalize(n);const f=this._crossProduct(n,this._sub(c,h));this._leftPerpendicular(n);const x=[];x.push([h[0]-n[0]*f,h[1]-n[1]*f]),x.push([r[0]-n[0]*f,r[1]-n[1]*f]),o.push(x);const w=[];w.push([h[0]+n[0]*f,h[1]+n[1]*f]),w.push([r[0]+n[0]*f,r[1]+n[1]*f]),o.push(w);break}case B.uQ.OffsetOpposite:{const r=this._cp2(u,3,0),c=this._cp3(u,r,.5,-1),n=this._sub(r,h);this._normalize(n);const f=this._crossProduct(n,this._sub(c,h));this._leftPerpendicular(n);const x=[];x.push([h[0]-n[0]*f,h[1]-n[1]*f]),x.push([r[0]-n[0]*f,r[1]-n[1]*f]),o.push(x);break}case B.uQ.OffsetSame:{const r=this._cp2(u,3,0),c=this._cp3(u,r,.5,-1),n=this._sub(r,h);this._normalize(n);const f=this._crossProduct(n,this._sub(c,h));this._leftPerpendicular(n);const x=[];x.push([h[0]+n[0]*f,h[1]+n[1]*f]),x.push([r[0]+n[0]*f,r[1]+n[1]*f]),o.push(x);break}case B.uQ.CircleWithArc:{let r=this._cp2(u,3,0);const c=this._cp3(u,r,.5,-1);let n,f;if(m>=4)n=u[3],f=this._crossProduct(this._sub(n,r),this._sub(c,r))>0;else{n=r,f=this._crossProduct(this._sub(n,h),this._sub(c,h))>0;const G=24*this._geomUnitsPerPoint,N=this._sub(n,h);this._normalize(N,G);const R=Math.sqrt(2)/2;this._rotateDirect(N,R,f?R:-R),r=this._add(h,N)}const x=this._sub(r,h),w=Math.cos(Math.PI/18),O=Math.sin(Math.PI/18),U=[r];for(let G=1;G<=36;G++)this._rotateDirect(x,w,O),U.push(this._add(h,x));this._add90DegArc(U,r,n,c,f),(0,W.Aq)(U[U.length-8],1),o.push(U);break}case B.uQ.DoubleJog:{let r,c=this._cp2(u,-3,1),n=this._cp3(u,c,-1,-.5);if(m>=4)r=u[3];else{const v=h;h=c,r=n;const L=this._dist(h,v),I=this._dist(r,v);let y=30*this._geomUnitsPerPoint;.5*L<y&&(y=.5*L),.5*I<y&&(y=.5*I),c=this._mix(h,y/L,v,(L-y)/L),n=this._mix(r,y/I,v,(I-y)/I)}const f=this._mid(h,c),x=this._mid(r,n),w=this._dist(h,c),O=this._dist(n,r);let U=Math.min(w,O)/8;U=Math.min(U,24*this._geomUnitsPerPoint);const G=Math.cos(Math.PI/4);let N=this._sub(h,c);this._normalize(N,U),this._crossProduct(N,this._sub(r,c))>0?this._rotateDirect(N,G,-G):this._rotateDirect(N,G,G);let R=[];R.push(c),R.push(this._add(f,N)),R.push(this._sub(f,N)),R.push(h),o.push(R),N=this._sub(r,n),this._normalize(N,U),this._crossProduct(N,this._sub(h,n))<0?this._rotateDirect(N,G,G):this._rotateDirect(N,G,-G),R=[],R.push(n),R.push(this._add(x,N)),R.push(this._sub(x,N)),R.push(r),o.push(R);break}case B.uQ.PerpendicularOffset:{const r=this._cp2(u,-4,1),c=this._cp3(u,r,.882353,-1.94),n=this._sub(c,r);this._crossProduct(n,this._sub(h,r))>0?this._rightPerpendicular(n):this._leftPerpendicular(n);const f=[n[0]/8,n[1]/8],x=this._sub(this._mid(r,c),f);o.push([x,h]);break}case B.uQ.LineExcludingLastSegment:{const r=this._arrowPath(u),c=[];let n=r.length-2;for(;n--;)c.push(r[n]);o.push(c);break}case B.uQ.MultivertexArrow:{const r=this._arrowPath(u),c=[];this._addArrow(c,r,!1),o.push(c);break}case B.uQ.CrossedArrow:{const r=this._arrowPath(u),c=[];this._addArrow(c,r,!0),o.push(c);break}case B.uQ.ChevronArrow:{const[r,c]=this._arrowLastSeg(u),n=10*this._geomUnitsPerPoint,f=this._sub(h,r),x=this._norm(f);this._normalize(f);const w=this._crossProduct(f,this._sub(c,r));let O=this._dotProduct(f,this._sub(c,r));O<.05*x?O=.05*x:O>.95*x-n&&(O=.95*x-n);const U=[r[0]+f[0]*O,r[1]+f[1]*O],G=this._leftPerp(f),N=[];N.push([U[0]+G[0]*w+f[0]*n,U[1]+G[1]*w+f[1]*n]),N.push(h),N.push([U[0]-G[0]*w+f[0]*n,U[1]-G[1]*w+f[1]*n]),o.push(N);break}case B.uQ.ChevronArrowOffset:{const[r,c]=this._arrowLastSeg(u),n=this._sub(h,r),f=this._norm(n);this._normalize(n);const x=this._crossProduct(n,this._sub(c,r));let w=this._dotProduct(n,this._sub(c,r));w<.05*f?w=.05*f:w>.95*f&&(w=.95*f);const O=[r[0]+n[0]*w,r[1]+n[1]*w];this._leftPerpendicular(n);const U=[];U.push([O[0]+n[0]*x*.5,O[1]+n[1]*x*.5]),U.push(this._mid(O,h)),U.push([O[0]-n[0]*x*.5,O[1]-n[1]*x*.5]),o.push(U);break}case B.uQ.PartialFirstSegment:{const[r,c]=this._arrowLastSeg(u),n=this._sub(h,r),f=this._norm(n);this._normalize(n);let x=this._dotProduct(n,this._sub(c,r));x<.05*f?x=.05*f:x>.95*f&&(x=.95*f),o.push([r,[r[0]+n[0]*x,r[1]+n[1]*x]]);break}case B.uQ.Arch:{const r=this._cp2(u,0,-1),c=this._cp3(u,r,.5,1),n=this._sub(h,r),f=this._mix(c,1,n,.55),x=this._mix(c,1,n,-.55),w=[h];this._addBezier2(w,h,f,c,4),this._addBezier2(w,c,x,r,4),o.push(w);break}case B.uQ.CurvedParallelTicks:{const r=this._cp2(u,-4,1),c=this._cp3(u,r,.882353,-1.94),n=this._sub(c,r);this._crossProduct(n,this._sub(h,r))>0?this._rightPerpendicular(n):this._leftPerpendicular(n);const f=[n[0]/8,n[1]/8],x=this._sub(this._mid(r,c),f),w=this._sub(this._mix(r,.75,c,.25),f),O=this._sub(this._mix(r,.25,c,.75),f),U=[r];this._addBezier2(U,r,w,x,3),this._addBezier2(U,x,O,c,3),o.push(U);for(let G=0;G<8;G++){const N=U[2*G+1],R=[this._clone(N)];R.push(this._add(N,[n[0]/4,n[1]/4])),o.push(R)}break}case B.uQ.Arc90Degrees:{const r=this._cp2(u,0,-1),c=this._cp3(u,r,.5,1),n=[r];this._add90DegArc(n,r,h,c),o.push(n);break}case B.uQ.TipWithPerpendicularAndTicks:{const[r,c]=this._arrowLastSeg(u),n=10*this._geomUnitsPerPoint,f=this._sub(h,r),x=this._norm(f);this._normalize(f);let w=this._crossProduct(f,this._sub(c,r)),O=this._dotProduct(f,this._sub(c,r));O<.05*x?O=.05*x:O>.95*x-n&&(O=.95*x-n);const U=this._leftPerp(f),G=[h[0]-f[0]*n,h[1]-f[1]*n],N=.5*Math.max(x-O-n,n);w=Math.abs(w);const R=[];R.push([G[0]+U[0]*(w+N)-f[0]*N,G[1]+U[1]*(w+N)-f[1]*N]),R.push([G[0]+U[0]*w,G[1]+U[1]*w]),R.push([G[0]-U[0]*w,G[1]-U[1]*w]),R.push([G[0]-U[0]*(w+N)-f[0]*N,G[1]-U[1]*(w+N)-f[1]*N]),o.push(R),o.push([G,h]);break}case B.uQ.ConcentricCircles:{const r=this._cp2(u,1,0),c=this._cp3(u,r,2,0),n=Math.cos(Math.PI/18),f=Math.sin(Math.PI/18);let x=this._dist(r,h),w=[x,0],O=[];for(let U=0;U<=36;U++)O.push(this._add(h,w)),this._rotateDirect(w,n,f);if(o.push(O),m>=4){O=[],x=this._dist(u[3],h),w=[x,0];for(let G=0;G<=36;G++)O.push(this._add(h,w)),0===G&&(O.push(this._add(h,w)),(0,W.Aq)(O[1],1)),this._rotateDirect(w,n,f);o.push(O)}O=[],x=this._dist(c,h),w=[x,0];for(let U=0;U<=36;U++)O.push(this._add(h,w)),this._rotateDirect(w,n,f);o.push(O);break}case B.uQ.DoubleJogArrow:{h=this._arrowPath(u)[0];const[r,c]=this._arrowLastSeg(u),n=this._sub(h,r),f=this._norm(n);this._normalize(n);const x=Math.abs(this._crossProduct(n,this._sub(c,h)));let w=Math.abs(this._dotProduct(n,this._sub(c,h)));w<.05*f?w=.05*f:w>.95*f&&(w=.95*f);const O=Math.max(x,w),U=this._leftPerp(n);let G=[];const N=[h[0]-n[0]*w*.5+U[0]*x*.5,h[1]-n[1]*w*.5+U[1]*x*.5];G.push([N[0],N[1]]),N[0]+=n[0]*O*.5+U[0]*O*.4,N[1]+=n[1]*O*.5+U[1]*O*.4,G.push([N[0],N[1]]),N[0]-=U[0]*O*.25,N[1]-=U[1]*O*.25,G.push([N[0],N[1]]),N[0]+=n[0]*O*.5+U[0]*O*.4,N[1]+=n[1]*O*.5+U[1]*O*.4,G.push([N[0],N[1]]),o.push(G),G=[],N[0]=h[0]-n[0]*w*.5-U[0]*x*.5,N[1]=h[1]-n[1]*w*.5-U[1]*x*.5,G.push([N[0],N[1]]),N[0]+=n[0]*O*.5-U[0]*O*.4,N[1]+=n[1]*O*.5-U[1]*O*.4,G.push([N[0],N[1]]),N[0]+=U[0]*O*.25,N[1]+=U[1]*O*.25,G.push([N[0],N[1]]),N[0]+=n[0]*O*.5-U[0]*O*.4,N[1]+=n[1]*O*.5-U[1]*O*.4,G.push([N[0],N[1]]),o.push(G);break}case B.uQ.LinkedChevrons:{const r=this._cp2(u,-5,0),c=this._cp3(u,r,-.2,1),n=this._sub(h,r);this._normalize(n);const f=this._leftPerp(n),x=Math.abs(this._crossProduct(n,this._sub(c,r)));o.push([r,h]);const w=[];w.push([h[0]-n[0]*x+f[0]*x,h[1]-n[1]*x+f[1]*x]),w.push(h),w.push([h[0]-n[0]*x-f[0]*x,h[1]-n[1]*x-f[1]*x]),o.push(w),this._addDash(o,r,[-n[0]*x+f[0]*x,-n[1]*x+f[1]*x]),this._addDash(o,r,[-n[0]*x-f[0]*x,-n[1]*x-f[1]*x]);break}case B.uQ.SegmentThenHalfCircle:{const r=this._cp2(u,2,0),c=this._cp3(u,r,1.5,0);let n;n=m>=4?u[3]:this._cp3(u,r,1.25,-.5);const f=this._sub(r,h);this._normalize(f);const x=.5*this._dist(r,c),w=this._crossProduct(f,this._sub(n,h))>0,O=Math.cos(Math.PI/18);let U=Math.sin(Math.PI/18);w&&(U=-U);const G=[h,r];f[0]*=x,f[1]*=x;const N=this._add(r,f);f[0]=-f[0],f[1]=-f[1];for(let R=1;R<=18;R++)this._rotateDirect(f,O,U),G.push(this._add(N,f));o.push(G);break}case B.uQ.LineWithStraightTicks:{const r=this._cp2(u,-2,1),c=this._cp3(u,r,-1,-.5),n=this._sub(c,r);this._normalize(n);const f=this._dotProduct(n,this._sub(r,h)),x=this._dotProduct(n,this._sub(c,h));let w=[h];w.push([h[0]+n[0]*f,h[1]+n[1]*f]),w.push(r),o.push(w),w=[h],w.push([h[0]+n[0]*x,h[1]+n[1]*x]),w.push(c),o.push(w);break}case B.uQ.DoubleCurve:{const r=this._cp2(u,-5,-1),c=this._cp3(u,r,2,0),n=Math.atan2(1,5),f=Math.cos(n),x=Math.sin(n),w=this._sub(r,h),O=this._dist(h,r);this._normalize(w),this._rotateDirect(w,f,-x);const U=[h];U.push([h[0]+w[0]*O*.5,h[1]+w[1]*O*.5]),(0,W.Aq)(U[1],1),U.push([h[0]+w[0]*O*.8,h[1]+w[1]*O*.8]),this._addBezier2(U,U[2],[h[0]+w[0]*O,h[1]+w[1]*O],r,3);const G=this._sub(c,r),N=this._dist(r,c);this._normalize(G),this._rotateDirect(G,f,-x),this._addBezier2(U,r,[c[0]-G[0]*N,c[1]-G[1]*N],[c[0]-G[0]*N*.8,c[1]-G[1]*N*.8],3),U.push(c),o.push(U);break}case B.uQ.ParallelWithTicksByWidth:{const r=this._cp2(u,0,-1),c=this._cp3(u,r,.5,3),n=this._sub(r,h);this._normalize(n);const f=this._crossProduct(n,this._sub(c,h));this._leftPerpendicular(n),f>0?(this._addAngledTicks(o,h,[h[0]+n[0]*f,h[1]+n[1]*f],r),this._addAngledTicks(o,r,[r[0]+n[0]*f,r[1]+n[1]*f],h)):(this._addAngledTicks(o,[h[0]+n[0]*f,h[1]+n[1]*f],h,r),this._addAngledTicks(o,[r[0]+n[0]*f,r[1]+n[1]*f],h,r));break}case B.uQ.EnclosingRoundedRectangle:{const r=this._cp2(u,3,-2),c=[Math.min(h[0],r[0]),Math.max(h[1],r[1])],n=[Math.max(h[0],r[0]),Math.min(h[1],r[1])],f=n[0]-c[0],w=Math.min(f,c[1]-n[1])/10,O=[];O.push([c[0]+w+.75*(f-2*w),c[1]]),O.push([n[0]-w,c[1]]),this._add90DegArc(O,[n[0]-w,c[1]],[n[0],c[1]-w],[n[0],c[1]]),O.push([n[0],n[1]+w]),this._add90DegArc(O,[n[0],n[1]+w],[n[0]-w,n[1]],n),O.push([c[0]+w,n[1]]),this._add90DegArc(O,[c[0]+w,n[1]],[c[0],n[1]+w],[c[0],n[1]]),O.push([c[0],c[1]-w]),this._add90DegArc(O,[c[0],c[1]-w],[c[0]+w,c[1]],c),O.push([c[0]+w+.75*(f-2*w),c[1]]);break}default:o.push(u)}}return o}}},82854:(yt,at,A)=>{A.d(at,{y:()=>W});var it=A(72137),q=A(61245),X=A(67311);let W=(()=>{class E{static local(){return null===E.instance&&(E.instance=new E),E.instance}execute(b,_,o,u,d){return new B(b,_,o)}}return E.instance=null,E})();class B extends q.rx{constructor(P,b,_){super(P,!0,!0),this._curveHelper=new X.I,this._beginCut=(void 0!==b.beginCut?b.beginCut:1)*_,this._endCut=(void 0!==b.endCut?b.endCut:1)*_,this._middleCut=(void 0!==b.middleCut?b.middleCut:0)*_,this._invert=void 0!==b.invert&&b.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(P){const{_beginCut:b,_endCut:_,_middleCut:o}=this,u=P.pathLength(),d=it.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(0!==b||0!==_||0!==o)if(b+_+o>=u)for(d.startPath();P.nextPoint();)d.pushXY(P.x,P.y);else this._curveHelper.appendSubCurve(d,P,0,b),this._curveHelper.appendSubCurve(d,P,.5*(u-o),.5*(u+o)),this._curveHelper.appendSubCurve(d,P,u-_,_)}else if(0===b&&0===_&&0===o)for(d.startPath();P.nextPoint();)d.pushXY(P.x,P.y);else b+_+o<u&&(0===o?this._curveHelper.appendSubCurve(d,P,b,u-_):(this._curveHelper.appendSubCurve(d,P,b,.5*(u-o)),this._curveHelper.appendSubCurve(d,P,.5*(u+o),u-_)));return 0===d.totalSize?null:d}}},65264:(yt,at,A)=>{A.d(at,{I:()=>P});var it=A(72137),q=A(53262),X=A(61245),W=A(65374),B=A(61116),E=A(32117);let P=(()=>{class _{static local(){return null===_.instance&&(_.instance=new _),_.instance}execute(u,d,m,h,r){return new b(u,d,m)}}return _.instance=null,_})();class b extends X.rx{constructor(o,u,d){super(o,!0,!0),this._firstCurve=null,this._walker=new B.Z1,this._walker.updateTolerance(d),this._endings=u.lineDashEnding,this._customDashPos=-(u.offsetAlongLine??0)*d,this._offsetAtEnd=(u.customEndingOffset??0)*d;let m=(0,E.FH)(u).dashTemplate;null==m&&(m=[]),m.length%2&&(m=[...m,...m]),this._pattern=new B.VA,this._pattern.init(m,!0),this._pattern.scale(d)}processPath(o){if(0===this._pattern.length()){this.iteratePath=!1;const m=(0,q.A)(o);return it.z.fromJSONCIM({paths:[m]})}if(!this.iteratePath){let m=!0;switch(this._endings){case W.yS.HalfPattern:case W.yS.HalfGap:default:this._pattern.extPtGap=0;break;case W.yS.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case W.yS.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case W.yS.NoConstraint:this.isClosed||(m=!1);break;case W.yS.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const h=o.pathLength();if(this._pattern.isEmpty()||h<.1*this._pattern.length()){const r=(0,q.A)(o);return it.z.fromJSONCIM({paths:[r]})}if(!this._walker.init(o,this._pattern,m)){const r=(0,q.A)(o);return it.z.fromJSONCIM({paths:[r]})}}let u;if(this.iteratePath)u=this._pattern.nextValue();else{let m;switch(this._endings){case W.yS.HalfPattern:default:m=.5*this._pattern.firstValue();break;case W.yS.HalfGap:m=.5*-this._pattern.lastValue();break;case W.yS.FullGap:m=-this._pattern.lastValue();break;case W.yS.FullPattern:m=0;break;case W.yS.NoConstraint:case W.yS.Custom:m=-this._customDashPos}let h=m/this._pattern.length();h-=Math.floor(h),m=h*this._pattern.length(),this._pattern.reset(),u=this._pattern.nextValue();let r=!1;for(;m>=u;)m-=u,u=this._pattern.nextValue(),r=!r;u-=m,r?(this._walker.nextPosition(u),u=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(u),u=this._pattern.nextValue(),this._walker.nextPosition(u),u=this._pattern.nextValue())}let d=this._walker.nextCurve(u);if(d)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)d.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else u=this._pattern.nextValue(),!this._walker.nextPosition(u)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(d.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,d=this._firstCurve,this._firstCurve=null;return d?.reset(),d}}},70614:(yt,at,A)=>{A.d(at,{O:()=>B});var it=A(72137),q=A(32034),X=A(47961);A(65374);let B=(()=>{class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(_,o,u,d,m,h,r){return new E(_,o,u,d,m,h,r)}}return P.instance=null,P})();class E{constructor(b,_,o,u,d,m,h){this._preventClipping=h,this._inputGeometries=b,this._tileKey=u,this._geometryEngine=d,this._maxInflateSize=m*o,this._width=(void 0!==_.width?_.width:2)*o,this._option=_.option}next(){let b;for(;b=this._inputGeometries.next();){if("esriGeometryEnvelope"===b.geometryType&&this._width>0){const _=b.asJSON();return Math.min(_.xmax-_.xmin,_.ymax-_.ymin)-2*this._width<0?b:it.z.fromJSONCIM({paths:[[[_.xmin+this._width,_.ymin+this._width],[_.xmax-this._width,_.ymin+this._width],[_.xmax-this._width,_.ymax-this._width],[_.xmin+this._width,_.ymax-this._width],[_.xmin+this._width,_.ymin+this._width]],[[_.xmin,_.ymin],[_.xmin,_.ymax],[_.xmax,_.ymax],[_.xmax,_.ymin],[_.xmin,_.ymin]]]})}if("esriGeometryPolygon"===b.geometryType){if(0===this._width)return b.clone();const _=this._geometryEngine;if(null==_)return null;const o=!this._preventClipping&&this._tileKey?(0,X.q)(b,this._maxInflateSize):b.clone();if(!o)continue;const u=_.buffer(q.A.WebMercator,o.asJSON(),-this._width,1);if(u)for(const d of u.rings)if(d){o.startPath();for(const m of d.reverse())o.pushXY(m[0],o.yFactor*m[1])}return o}}return null}}},88918:(yt,at,A)=>{A.d(at,{U:()=>W});var it=A(72137),q=A(61245),X=A(67311);let W=(()=>{class E{static local(){return null===E.instance&&(E.instance=new E),E.instance}execute(b,_,o,u,d){return new B(b,_,o)}}return E.instance=null,E})();class B extends q.rx{constructor(P,b,_){super(P,!1,!0),this._curveHelper=new X.I,this._length=(void 0!==b.length?b.length:20)*_,this._angle=void 0!==b.angle?b.angle:225,this._position=void 0!==b.position?b.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(P){const b=it.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(P))return null;P.seekInPath(0);const _=P.x,o=P.y;P.seekInPath(P.pathSize-1);const u=P.x,d=P.y;this._curveHelper.normalize([u-_,d-o]);const h=_+(u-_)*this._position/100,r=o+(d-o)*this._position/100,c=Math.cos((90-this._angle)/180*Math.PI);let n=Math.sin((90-this._angle)/180*Math.PI);return this._mirror&&(n=-n),this._mirror=!this._mirror,b.pushPath([[_,o],[h-this._length/2*c,r-this._length/2*n],[h+this._length/2*c,r+this._length/2*n],[u,d]]),b}}},3691:(yt,at,A)=>{A.d(at,{V:()=>_});var it=A(72137),q=A(53262),X=A(32034),W=A(61320),B=A(47961),E=A(67311),P=A(65374);let _=(()=>{class u{static local(){return null===u.instance&&(u.instance=new u),u.instance}execute(m,h,r,c,n,f,x){return new o(m,h,r,c,n,f,x)}}return u.instance=null,u})();class o{constructor(d,m,h,r,c,n,f){this._preventClipping=f,this._inputGeometries=d,this._tileKey=r,this._geometryEngine=c,this._curveHelper=new E.I,this._offset=(m.offset??1)*h,this._method=m.method,this._maxInflateSize=Math.max(Math.abs(n*h),10),this._option=m.option,this._offsetFlattenError=E.U*h}next(){let d;for(;d=this._inputGeometries.next();){if(0===this._offset)return d.clone();if("esriGeometryEnvelope"===d.geometryType){if(this._method===P.xw.Rounded&&this._offset>0){const n=(0,q.A)(d),f=this._curveHelper.offset(n,-this._offset,this._method,4,this._offsetFlattenError);if(f){const x=it.z.createEmptyOptimizedCIM(d.geometryType);return x.pushPath(f),x}return null}const c=d.asJSON();if((0,W.ZC)(c)&&Math.min(c.xmax-c.xmin,c.ymax-c.ymin)+2*this._offset>0)return it.z.fromJSONCIM({xmin:c.xmin-this._offset,xmax:c.xmax+this._offset,ymin:c.ymin-this._offset,ymax:c.ymax+this._offset})}const m=this._geometryEngine;if(null==m)continue;const h=!this._preventClipping&&this._tileKey?(0,B.q)(d,this._maxInflateSize):d.clone();if(!h)continue;const r=m.offset(X.A.WebMercator,h.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return r?it.z.fromJSONCIM(r):null}return null}}},25867:(yt,at,A)=>{A.d(at,{v:()=>q});var it=A(83065);let q=(()=>{class W{static local(){return null===W.instance&&(W.instance=new W),W.instance}execute(E,P,b,_,o){return new X(E,P,b)}}return W.instance=null,W})();class X{constructor(B,E,P){this._inputGeometries=B,this._rotateAngle=void 0!==E.angle?E.angle*Math.PI/180:0}next(){let B=this._inputGeometries.next();for(;B;){if(0===this._rotateAngle||"esriGeometryPoint"===B.geometryType)return B;if(B.totalSize>0){const E=(0,it.z8)(B),P=(E[2]+E[0])/2,b=(E[3]+E[1])/2;return B.reset(),this._rotate(B.clone(),P,b)}B=this._inputGeometries.next()}return null}_rotate(B,E,P){const b=Math.cos(this._rotateAngle),_=Math.sin(this._rotateAngle);for(;B.nextPath();)for(;B.nextPoint();){const o=B.x-E,u=B.y-P;B.x=E+o*b-u*_,B.y=P+o*_+u*b}return B.reset(),B}}},39516:(yt,at,A)=>{A.d(at,{W:()=>q});var it=A(83065);let q=(()=>{class W{static local(){return null===W.instance&&(W.instance=new W),W.instance}execute(E,P,b,_,o){return new X(E,P,b)}}return W.instance=null,W})();class X{constructor(B,E,P){this._inputGeometries=B,this._xFactor=void 0!==E.xScaleFactor?E.xScaleFactor:1.15,this._yFactor=void 0!==E.yScaleFactor?E.yScaleFactor:1.15}next(){const B=this._inputGeometries.next();if(B){if(1===this._xFactor&&1===this._yFactor||"esriGeometryPoint"===B.geometryType)return B;if(B.totalSize>0){const E=(0,it.z8)(B),P=(E[2]+E[0])/2,b=(E[3]+E[1])/2;return B.reset(),this._scaleCursor(B.clone(),P,b)}}return null}_scaleCursor(B,E,P){for(;B.nextPath();)for(;B.nextPoint();)B.x=E+(B.x-E)*this._xFactor,B.y=P+(B.y-P)*this._yFactor;return B.reset(),B}}},57249:(yt,at,A)=>{A.d(at,{l:()=>W});var it=A(72137),q=A(65374),X=A(61116);let W=(()=>{class E{static local(){return null===E.instance&&(E.instance=new E),E.instance}execute(b,_,o,u,d){return new B(b,_,o)}}return E.instance=null,E})();class B{constructor(P,b,_){this._inputGeometries=P,this._height=(void 0!==b.amplitude?b.amplitude:2)*_,this._period=(void 0!==b.period?b.period:3)*_,this._style=b.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new X.VA,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new X.Z1,this._walker.updateTolerance(_)}next(){let P=this._inputGeometries.next();for(;P;){if(0===this._height||0===this._period)return P;const b=this._processGeom(P);if(b)return b;P=this._inputGeometries.next()}return null}_processGeom(P){const b=it.z.createEmptyOptimizedCIM(P.geometryType);for(;P.nextPath();){b.startPath();const _=P.pathLength();if(this._walker.init(P,this._pattern))switch(this._style){case q.WE.Sinus:default:this._constructCurve(b,_,!1);break;case q.WE.Square:this._constructSquare(b,_);break;case q.WE.Triangle:this._constructTriangle(b,_);break;case q.WE.Random:this._constructCurve(b,_,!0)}else for(;P.nextPoint();)b.pushXY(P.x,P.y)}return b}_constructCurve(P,b,_){let o=Math.round(b/this._period);0===o&&(o=1);const m=this._period/16,h=1/(16*o+1),r=2*Math.PI*b/(b/o),c=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),f=2*Math.PI*Math.random(),x=.75-Math.random()/2,w=.75-Math.random()/2,O=new X.ps;this._walker.curPointAndAngle(O),P.pushPoint(O.pt);let U=0;for(;;){if(!this._walker.nextPointAndAngle(m,O)){P.pushPoint(this._walker.getPathEnd());break}{const G=U;let N;if(U+=h,_){const R=this._height/2*(1+.3*Math.sin(x*r*G+c));N=R*Math.sin(r*G+n),N+=R*Math.sin(w*r*G+f),N/=2}else N=.5*this._height*Math.sin(.5*r*G);P.pushXY(O.pt[0]-N*O.sa,O.pt[1]+N*O.ca)}}}_constructSquare(P,b){Math.round(b/this._period);let _=!0;for(;;){let o=!1;if(this._walker.curPositionIsValid()){const u=new X.ps;this._walker.curPointAndAngle(u);const d=new X.ps;if(this._walker.nextPointAndAngle(this._period,d)){const m=new X.ps;this._walker.nextPointAndAngle(this._period,m)&&(_?(P.pushPoint(u.pt),_=!1):P.pushPoint(u.pt),P.pushXY(u.pt[0]-this._height/2*u.sa,u.pt[1]+this._height/2*u.ca),P.pushXY(d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca),P.pushXY(d.pt[0]+this._height/2*d.sa,d.pt[1]-this._height/2*d.ca),P.pushXY(m.pt[0]+this._height/2*m.sa,m.pt[1]-this._height/2*m.ca),o=!0)}}if(!o){P.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(P,b){Math.round(b/this._period);let _=!0;for(;;){let o=!1;if(this._walker.curPositionIsValid()){const u=new X.ps;this._walker.curPointAndAngle(u);const d=new X.ps;if(this._walker.nextPointAndAngle(this._period/2,d)){const m=new X.ps;this._walker.nextPointAndAngle(this._period,m)&&(this._walker.nextPosition(this._period/2)&&(_?(P.pushPoint(u.pt),_=!1):P.pushPoint(u.pt),P.pushXY(d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca),P.pushXY(m.pt[0]+this._height/2*m.sa,m.pt[1]-this._height/2*m.ca)),o=!0)}}if(!o){P.pushPoint(this._walker.getPathEnd());break}}}}},2544:(yt,at,A)=>{A.d(at,{e:()=>W});var it=A(61245),q=A(65374),X=A(61116);let W=(()=>{class E{static local(){return null===E.instance&&(E.instance=new E),E.instance}execute(b,_,o,u,d){return new B(b,_,o)}}return E.instance=null,E})();class B extends it.pC{constructor(P,b,_){super(P),this._geometryWalker=new X.Z1,this._geometryWalker.updateTolerance(_),this._angleToLine=b.angleToLine??!0,this._offset=(b.offset?b.offset:0)*_,this._originalEndings=b.endings,this._offsetAtEnd=(b.customEndingOffset?b.customEndingOffset:0)*_,this._position=-(b.offsetAlongLine?b.offsetAlongLine:0)*_,this._pattern=new X.VA,this._pattern.init(b.placementTemplate,!1),this._pattern.scale(_),this._endings=this._originalEndings}processPath(P){if(this._pattern.isEmpty())return null;let b;if(this.iteratePath)b=this._pattern.nextValue();else{this._endings=this._originalEndings===q.e_.WithFullGap&&this.isClosed?q.e_.WithMarkers:this._originalEndings,this._pattern.extPtGap=0;let o,u=!0;switch(this._endings){case q.e_.NoConstraint:o=-this._position,o=this._adjustPosition(o),u=!1;break;case q.e_.WithHalfGap:default:o=-this._pattern.lastValue()/2;break;case q.e_.WithFullGap:o=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case q.e_.WithMarkers:o=0;break;case q.e_.Custom:o=-this._position,o=this._adjustPosition(o),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(P,this._pattern,u))return null;this._pattern.reset();let d=0;for(;o>d;)o-=d,d=this._pattern.nextValue();d-=o,b=d,this.iteratePath=!0}const _=new X.ps;return this._geometryWalker.nextPointAndAngle(b,_)?this._endings===q.e_.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===q.e_.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(_.pt[0]-this._offset*_.sa,_.pt[1]+this._offset*_.ca),this._angleToLine&&this.internalPlacement.setRotateCS(_.ca,_.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(P){let b=P/this._pattern.length();return b-=Math.floor(b),b*this._pattern.length()}}},34572:(yt,at,A)=>{A.d(at,{y:()=>W});var it=A(61245),q=A(67311),X=A(65374);let W=(()=>{class E{static local(){return null===E.instance&&(E.instance=new E),E.instance}execute(b,_,o,u,d){return new B(b,_,o)}}return E.instance=null,E})();class B extends it.pC{constructor(P,b,_){super(P,!1,!0),this._curveHelper=new q.I,this._placePerPart=b.placePerPart??!1,this._angleToLine=void 0===b.angleToLine||b.angleToLine,this._offset=void 0!==b.offset?b.offset*_:0,this._type=b.extremityPlacement,this._position=void 0!==b.offsetAlongLine?b.offsetAlongLine*_:0,this._beginProcessed=!1}processMultiPath(P){return this._placePerPart?super.processMultiPath(P):this.processPath(P)}processPath(P){let b;switch(this._type){case X.$2.Both:default:this._beginProcessed?(b=this._atExtremities(P,this._position,!1),this._beginProcessed=!1,this.iterateMultiPath=!1,this.iteratePath=!1):(b=this._atExtremities(P,this._position,!0),this._beginProcessed=!0,this.iterateMultiPath=!0,this.iteratePath=!0);break;case X.$2.JustBegin:b=this._atExtremities(P,this._position,!0);break;case X.$2.JustEnd:b=this._atExtremities(P,this._position,!1);case X.$2.None:}return b}_atExtremities(P,b,_){if(this._placePerPart||P.seekPath(_?0:P.totalSize-1),_||P.seekPathEnd(),_?P.nextPoint():P.prevPoint()){let o=0,[u,d]=[0,0],[m,h]=[P.x,P.y];for(;_?P.nextPoint():P.prevPoint();){u=m,d=h,m=P.x,h=P.y;const r=this._curveHelper.getLength(u,d,m,h);if(o+r>b){const c=(b-o)/r,[n,f]=this._curveHelper.getAngleCS(u,d,m,h,c),x=this._curveHelper.getCoord2D(u,d,m,h,c);return this.internalPlacement.setTranslate(x[0]-this._offset*f,x[1]+this._offset*n),this._angleToLine&&this.internalPlacement.setRotateCS(-n,-f),this.internalPlacement}o+=r}}return null}}},56854:(yt,at,A)=>{A.d(at,{S:()=>X});var it=A(61245),q=A(61116);let X=(()=>{class B{static local(){return null===B.instance&&(B.instance=new B),B.instance}execute(P,b,_,o,u){return new W(P,b,_)}}return B.instance=null,B})();class W extends it.pC{constructor(E,P,b){super(E),this._walker=new q.Z1,this._walker.updateTolerance(b),this._angleToLine=void 0===P.angleToLine||P.angleToLine,this._offset=void 0!==P.offset?P.offset*b:0,this._beginGap=void 0!==P.beginPosition?P.beginPosition*b:0,this._endGap=void 0!==P.endPosition?P.endPosition*b:0,this._flipFirst=void 0===P.flipFirst||P.flipFirst,this._pattern=new q.VA,this._pattern.init(P.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(E){if(this._pattern.isEmpty())return null;let P;if(this.iteratePath){const d=this._pattern.nextValue()*this._subPathLen,m=this._beginGap+d;P=m-this._prevPos,this._prevPos=m}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=E.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(E,this._pattern,!1))return null;this._pattern.reset();const d=this._pattern.nextValue()*this._subPathLen,m=this._beginGap+d;P=m-this._prevPos,this._prevPos=m,this.iteratePath=!0}const b=new q.ps;if(!this._walker.nextPointAndAngle(P,b,q.YQ.END))return this.iteratePath=!1,null;let o,u;return this.internalPlacement.setTranslate(b.pt[0]-this._offset*b.sa,b.pt[1]+this._offset*b.ca),this._angleToLine?(o=b.ca,u=b.sa):(o=1,u=0),this._isFirst&&this._flipFirst&&(o=-o,u=-u),this.internalPlacement.setRotateCS(o,u),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}},47942:(yt,at,A)=>{A.d(at,{M:()=>b});var it=A(40707),q=A(76571),X=A(65374);const W=512,E=24,P=1e-6;let b=(()=>{class d{static local(){return null===d.instance&&(d.instance=new d),d.instance}execute(h,r,c,n,f){return new _(h,r,c,n,f)}}return d.instance=null,d})();class _{constructor(m,h,r,c,n){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(h.stepX??16)*r,this._stepY=Math.abs(h.stepY??16)*r,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,0!==this._stepX&&0!==this._stepY){if(this._gridType=h.gridType??X.Q1.Fixed,this._gridType===X.Q1.Random)this._randomLCG=new it.A(1*(h.seed??13)),this._randomness=(h.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues();else{if(this._randomness=0,this._gridAngle=h.gridAngle??0,this._shiftOddRows=h.shiftOddRows??!1,this._offsetX=(h.offsetX??0)*r,this._offsetY=(h.offsetY??0)*r,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,null!=c){const[f,x,w,O]=c.split("/"),U=parseFloat(f),G=parseFloat(x),N=parseFloat(w),R=parseFloat(O);this._graphicOriginX=-(R*2**U+N)*W,this._graphicOriginY=G*W,this._testInsidePolygon=!0}this._internalPlacement=new q.W,this._calculateMinMax(m),this._geometryCursor=m}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!_._randValues){_._randValues=[];for(let m=0;m<E;m++)for(let h=0;h<E;h++)_._randValues.push(this._randomLCG.getFloat()),_._randValues.push(this._randomLCG.getFloat())}}_calculateMinMax(m){let h,r,c,n,f,x,w,O,U,G,N,R,v,L;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,w=O=v=N=Number.MAX_VALUE,U=G=L=R=-Number.MAX_VALUE;const I=1!==this._cosAngle;for(m.reset();m.nextPath();)for(;m.nextPoint();)x=m.x,f=m.y,h=x-this._graphicOriginX-this._offsetX,r=f-this._graphicOriginY-this._offsetY,I?(c=this._cosAngle*h-this._sinAngle*r,n=this._sinAngle*h+this._cosAngle*r):(c=h,n=r),w=Math.min(w,c),U=Math.max(U,c),O=Math.min(O,n),G=Math.max(G,n),N=Math.min(N,f),R=Math.max(R,f),v=Math.min(v,x),L=Math.max(L,x);if(N=N!==Number.MAX_VALUE?N:-512-this._stepY,R=R!==-Number.MAX_VALUE?R:this._stepY,v=v!==Number.MAX_VALUE?v:-this._stepX,L=L!==-Number.MAX_VALUE?L:W+this._stepX,this._verticalSubdivision=R-N>=L-v,this._polygonMin=this._verticalSubdivision?N:v,this._testInsidePolygon){let k=0-this._graphicOriginX-this._offsetX-this._stepX,D=W-this._graphicOriginX-this._offsetX+this._stepX,H=-512-this._graphicOriginY-this._offsetY-this._stepY,$=0-this._graphicOriginY-this._offsetY+this._stepY;if(I){const rt=[[k,H],[k,$],[D,H],[D,$]];k=H=Number.MAX_VALUE,D=$=-Number.MAX_VALUE;for(const Z of rt){const et=this._cosAngle*Z[0]-this._sinAngle*Z[1],lt=this._sinAngle*Z[0]+this._cosAngle*Z[1];k=Math.min(k,et),D=Math.max(D,et),H=Math.min(H,lt),$=Math.max($,lt)}}w=w!==Number.MAX_VALUE?Math.max(w,k):k,O=O!==Number.MAX_VALUE?Math.max(O,H):H,U=U!==-Number.MAX_VALUE?Math.min(U,D):D,G=G!==-Number.MAX_VALUE?Math.min(G,$):$}this._xMin=Math.round(w/this._stepX),this._xMax=Math.round(U/this._stepX),this._yMin=Math.round(O/this._stepY),this._yMax=Math.round(G/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(m,v,L,N,R)}_buildAccelerationMap(m,h,r,c,n){m.reset();const f=new Map,x=this._verticalSubdivision,w=x?n-c:r-h;let O=Math.ceil(w/10);if(O<=1)return;const U=Math.floor(w/O);let G,N,R,v,L,I,y,z,k,D,H;for(O++,this._delta=U,x?(k=-512-2*this._stepY,D=2*this._stepY,H=c):(k=-2*this._stepX,D=W+2*this._stepX,H=h);m.nextPath();)if(!(m.pathSize<2)&&m.nextPoint())for(G=m.x,N=m.y;m.nextPoint();G=R,N=v){if(R=m.x,v=m.y,x){if(N===v||N<k&&v<k||N>D&&v>D)continue;L=Math.min(N,v),I=Math.max(N,v)}else{if(G===R||G<k&&R<k||G>D&&R>D)continue;L=Math.min(G,R),I=Math.max(G,R)}for(;L<I;)y=Math.floor((L-H)/U),u(y,G,N,R,v,f),L+=U;z=Math.floor((I-H)/U),z>y&&u(z,G,N,R,v,f)}this._accelerationMap=f}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let m=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(m+=.5*this._stepX);const h=this._currentY*this._stepY+this._offsetY;let r,c;if(this._currentX++,this._gridType===X.Q1.Random){const n=(this._currentX%E+E)%E,f=(this._currentY%E+E)%E;r=this._graphicOriginX+m+this._stepX*this._randomness*(.5-_._randValues[f*E+n])*2/3,c=this._graphicOriginY+h+this._stepY*this._randomness*(.5-_._randValues[f*E+n+1])*2/3}else r=this._graphicOriginX+this._cosAngle*m+this._sinAngle*h,c=this._graphicOriginY-this._sinAngle*m+this._cosAngle*h;if(!this._testInsidePolygon||this._isInsidePolygon(r,c,this._geometryCursor))return this._internalPlacement.setTranslate(r,c),this._internalPlacement}}_isInsidePolygon(m,h,r){if(null==this._accelerationMap)return function o(d,m,h){let r,c,n,f,x=0;for(d+=P,m+=P,h.reset();h.nextPath();)if(h.nextPoint())for(r=h.x,c=h.y;h.nextPoint();r=n,c=f)n=h.x,f=h.y,c>m!=f>m&&((n-r)*(m-c)-(f-c)*(d-r)>0?x++:x--);return 0!==x}(m,h,r);m+=P,h+=P;const c=this._verticalSubdivision,f=Math.floor(((c?h:m)-this._polygonMin)/this._delta),x=this._accelerationMap.get(f);if(!x)return!1;let w,O,U,G=0;for(const N of x){if(w=N[0],O=N[1],c){if(w[1]>h==O[1]>h)continue;U=(O[0]-w[0])*(h-w[1])-(O[1]-w[1])*(m-w[0])}else{if(w[0]>m==O[0]>m)continue;U=(O[1]-w[1])*(m-w[0])-(O[0]-w[0])*(h-w[1])}U>0?G++:G--}return 0!==G}}function u(d,m,h,r,c,n){let f=n.get(d);f||(f=[],n.set(d,f)),f.push([[m,h],[r,c]])}},53737:(yt,at,A)=>{A.d(at,{R:()=>B});var it=A(61245),q=A(67311),X=A(65374);let B=(()=>{class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(_,o,u,d,m){return new E(_,o,u)}}return P.instance=null,P})();class E extends it.pC{constructor(b,_,o){super(b),this._curveHelper=new q.I,this._angleToLine=void 0===_.angleToLine||_.angleToLine,this._offset=void 0!==_.offset?_.offset*o:0,this._relativeTo=_.relativeTo,this._position=void 0!==_.startPointOffset?_.startPointOffset*o:0,this._epsilon=.001*o}processPath(b){const _=this._position;if(this._relativeTo===X.ip.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),b.nextPoint()){let[u,d]=[b.x,b.y],[m,h]=[0,0];for(;b.nextPoint();){m=b.x,h=b.y;const r=this._curveHelper.getLength(u,d,m,h);if(r<this._epsilon){u=m,d=h;continue}const c=.5+this._position/r,[n,f]=this._curveHelper.getAngleCS(u,d,m,h,c),x=this._curveHelper.getCoord2D(u,d,m,h,c);return this.internalPlacement.setTranslate(x[0]-this._offset*f,x[1]+this._offset*n),this._angleToLine&&this.internalPlacement.setRotateCS(n,f),this.internalPlacement}}return this.iteratePath=!1,null}return this.onLine(b,_,this._relativeTo===X.ip.LineEnd)}onLine(b,_,o){let u,d=!1;switch(this._relativeTo){case X.ip.LineMiddle:default:b.seekPathStart(),u=b.pathLength()/2+_;break;case X.ip.LineBeginning:u=_;break;case X.ip.LineEnd:u=_,d=!0}o?b.seekPathEnd():b.seekPathStart();let m=0;if(o?b.prevPoint():b.nextPoint()){let[h,r]=[b.x,b.y],[c,n]=[0,0];for(;o?b.prevPoint():b.nextPoint();){c=b.x,n=b.y;const f=this._curveHelper.getLength(h,r,c,n);if(m+f>u){const x=(u-m)/f,[w,O]=this._curveHelper.getAngleCS(h,r,c,n,x),U=this._curveHelper.getCoord2D(h,r,c,n,x),G=d?-this._offset:this._offset;return this.internalPlacement.setTranslate(U[0]-G*O,U[1]+G*w),this._angleToLine&&(d?this.internalPlacement.setRotateCS(-w,-O):this.internalPlacement.setRotateCS(w,O)),this.internalPlacement}h=c,r=n,m+=f}}return null}}},3688:(yt,at,A)=>{A.d(at,{A:()=>W});var it=A(61245),q=A(67311);let W=(()=>{class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(_,o,u,d,m){return new B(_,o,u)}}return P.instance=null,P})();class B extends it.pC{constructor(b,_,o){super(b),this._curveHelper=new q.I,this._angleToLine=void 0===_.angleToLine||_.angleToLine,this._offset=void 0!==_.offset?_.offset*o:0,this._endPoints=void 0===_.placeOnEndPoints||_.placeOnEndPoints,this._controlPoints=void 0===_.placeOnControlPoints||_.placeOnControlPoints,this._regularVertices=void 0===_.placeOnRegularVertices||_.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(b){if(this.iteratePath||(this._preparePath(b),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const _=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(_[2]);let o=_[0],u=_[1];if(0!==this._offset){const d=Math.cos(_[2]),m=Math.sin(_[2]);o-=this._offset*m,u+=this._offset*d}return this.internalPlacement.setTranslate(o,u),this._tagIterator++,this.internalPlacement}_preparePath(b){this._tags.length=0,this._tagIterator=0,b.seekPathStart();const _=b.isClosed();let o=0,u=!1,d=0,m=0;if(b.seekPathStart(),b.nextPoint()){let h=b.x,r=b.y,c=b.getControlPoint(),n=!0,f=b.nextPoint();for(;f;){const x=b.x,w=b.y,O=b.getControlPoint();(this._angleToLine||0!==this._offset)&&(d=this._curveHelper.getAngle(h,r,x,w,0)),n?(n=!1,_?(o=d,u=c):(this._endPoints||this._controlPoints&&c)&&this._tags.push([h,r,d])):c?this._controlPoints&&this._tags.push([h,r,E(m,d)]):this._regularVertices&&this._tags.push([h,r,E(m,d)]),(this._angleToLine||0!==this._offset)&&(m=this._curveHelper.getAngle(h,r,x,w,1)),f=b.nextPoint(),f||(_?O||u?this._controlPoints&&this._tags.push([x,w,E(m,o)]):this._regularVertices&&this._tags.push([x,w,E(m,o)]):(this._endPoints||this._controlPoints&&O)&&this._tags.push([x,w,m])),h=x,r=w,c=O}}this._tagIterator=0}}function E(P,b){const _=Math.PI;for(;Math.abs(b-P)>_+2e-15;)b-P>_?b-=2*_:b+=2*_;return(P+b)/2}},68051:(yt,at,A)=>{A.d(at,{L:()=>E});var it=A(83065),q=A(39239),X=A(13259),W=A(76571),B=A(65374);let E=(()=>{class b{static local(){return null===b.instance&&(b.instance=new b),b.instance}execute(o,u,d,m,h){return new P(o,u,d)}}return b.instance=null,b})();class P{constructor(_,o,u){this._geometryCursor=_,this._offsetX=void 0!==o.offsetX?o.offsetX*u:0,this._offsetY=void 0!==o.offsetY?o.offsetY*u:0,this._method=void 0!==o.method?o.method:B.YI.OnPolygon,this._placementPerPart=void 0!==o.placePerPart&&o.placePerPart,this._internalPlacement=new W.W}next(){const _=this._geometryCursor;if(!_)return null;if(!this._placementPerPart)return this._geometryCursor=null,this._polygonCenter(_);for(;_.nextPath();)if(!(_.getCurrentRingArea()<0))return this._polygonCenter(_.getCurrentPath());return this._geometryCursor=null,null}_polygonCenter(_){let o=!1;switch(this._method){case B.YI.CenterOfMass:{const u=(0,q.TP)(_);u&&(this._internalPlacement.setTranslate(u[0]+this._offsetX,u[1]+this._offsetY),o=!0)}break;case B.YI.BoundingBoxCenter:{const u=(0,it.z8)(_);u&&(this._internalPlacement.setTranslate((u[2]+u[0])/2+this._offsetX,(u[3]+u[1])/2+this._offsetY),o=!0)}break;default:{const u=(0,X.d)(_);null!==u&&(this._internalPlacement.setTranslate(u[0]+this._offsetX,u[1]+this._offsetY),o=!0)}}return o?this._internalPlacement:null}}},28685:(yt,at,A)=>{A.d(at,{AH:()=>r,Kj:()=>m,Tl:()=>R,c5:()=>o,f0:()=>u,hs:()=>N,k2:()=>d});var it=A(86468),q=A(35150),X=A(69287),W=A(84289),B=A(46988),E=A(47669);const P=()=>q.A.getLogger("esri.symbols.cim.rasterizingUtils"),b=32,_=v=>"vertical"===v||"horizontal"===v||"cross"===v||"esriSFSCross"===v||"esriSFSVertical"===v||"esriSFSHorizontal"===v;function o(v,L,I){const y=L.style,z=(0,X.yR)(Math.ceil(I)),k=_(y)?8*z:16*z,D=2*z;v.width=k,v.height=k;const H=v.getContext("2d");H.strokeStyle="#ffffff",H.lineWidth=z,H.beginPath(),"vertical"!==y&&"cross"!==y&&"esriSFSCross"!==y&&"esriSFSVertical"!==y||(H.moveTo(k/2,-D),H.lineTo(k/2,k+D)),"horizontal"!==y&&"cross"!==y&&"esriSFSCross"!==y&&"esriSFSHorizontal"!==y||(H.moveTo(-D,k/2),H.lineTo(k+D,k/2)),"backward-diagonal"!==y&&"diagonal-cross"!==y&&"esriSFSDiagonalCross"!==y&&"esriSFSBackwardDiagonal"!==y||(H.moveTo(-D,-D),H.lineTo(k+D,k+D),H.moveTo(k-D,-D),H.lineTo(k+D,D),H.moveTo(-D,k-D),H.lineTo(D,k+D)),"forward-diagonal"!==y&&"diagonal-cross"!==y&&"esriSFSForwardDiagonal"!==y&&"esriSFSDiagonalCross"!==y||(H.moveTo(k+D,-D),H.lineTo(-D,k+D),H.moveTo(D,-D),H.lineTo(-D,D),H.moveTo(k+D,k-D),H.lineTo(k-D,k+D)),H.stroke();const $=H.getImageData(0,0,v.width,v.height),rt=new Uint8Array($.data);let Z;for(let et=0;et<rt.length;et+=4)Z=rt[et+3]/255,rt[et]=rt[et]*Z,rt[et+1]=rt[et+1]*Z,rt[et+2]=rt[et+2]*Z;return[rt,v.width,v.height,z]}function u(v){v.length%2==1&&(v=[...v,...v]);const L=v.reduce((et,lt)=>et+lt,0),I=Math.round(L*W.zA),z=new Float32Array(1*I);let k=0,D=0,H=.5,$=!0;for(const et of v){for(k=D,D+=et*W.zA;H<=D;){const lt=H-.5,ct=Math.min(Math.abs(H-k),Math.abs(H-D));z[lt]=$?-ct:ct,H++}$=!$}const rt=z.length,Z=new Uint8Array(4*rt);for(let et=0;et<rt;++et)(0,it.U)(z[et]/W.zA/W.gR*.5+.5,Z,4*et);return[Z,I,1]}function d(v,L){null==v&&(v=[]);const I="Butt"===L,y="Square"===L,z=!I&&!y;v.length%2==1&&(v=[...v,...v]);const k=W.$o,D=2*k;let H=0;for(const xt of v)H+=xt;const $=Math.round(H*k),rt=new Float32Array($*D),Z=.5*k;let et=0,lt=0,ct=.5,_t=!0;for(const xt of v){for(et=lt,lt+=xt*k;ct<=lt;){let mt=.5;for(;mt<D;){const Ct=(mt-.5)*$+ct-.5,dt=z?(mt-k)*(mt-k):Math.abs(mt-k);rt[Ct]=_t?I?Math.max(Math.max(et+Z-ct,dt),Math.max(ct-lt+Z,dt)):dt:z?Math.min((ct-et)*(ct-et)+dt,(ct-lt)*(ct-lt)+dt):y?Math.min(Math.max(ct-et,dt),Math.max(lt-ct,dt)):Math.min(Math.max(ct-et+Z,dt),Math.max(lt+Z-ct,dt)),mt++}ct++}_t=!_t}const ut=rt.length,Pt=new Uint8Array(4*ut);for(let xt=0;xt<ut;++xt){const mt=(z?Math.sqrt(rt[xt]):rt[xt])/k;(0,it.U)(mt,Pt,4*xt)}return[Pt,$,D]}function m(v,L){const{colorRamp:I,gradientType:y}=L,z="CIMFixedColorRamp"===I.type,k=L.interval||B.D.CIMGradientFill.interval;let D=c(I);return z&&(D=n(D,k)),"Discrete"===y||z?function x(v,L,I){return O(v,L,I,1,E.MZ),U(v)}(v,D,k):function f(v,L){return O(v,L,b,1,E.MZ),U(v)}(v,D)}let h;function r(v,L){const{colorRamp:I,gradientType:y}=L,z=c(I),k="CIMFixedColorRamp"===I.type;if("Continuous"===y&&!k)return w(v,z);const D=L.interval??B.D.CIMGradientFill.interval;if(k)return w(v,n(z,D));const H=[];h??=document.createElement("canvas"),O(h,z,D,1,0);const $=h.getContext("2d").getImageData(0,0,D,1).data;for(let rt=0,Z=0;rt<D;rt++,Z=4*rt){const et=[$[Z+0],$[Z+1],$[Z+2],$[Z+3]];H.push({offset:rt/D,color:et}),H.push({offset:(rt+1)/D,color:et})}return w(v,H)}function c(v){const L=[];switch(v.type){case"CIMPolarContinuousColorRamp":case"CIMLinearContinuousColorRamp":{"CIMPolarContinuousColorRamp"===v.type&&P().warnOnce("CIMPolarContinuousColorRamp is currently unsupported. Falling back to CIMLinearContinuousColorRamp.");const I=v;L.push({offset:0,color:[I.fromColor[0],I.fromColor[1],I.fromColor[2],I.fromColor[3]/255]}),L.push({offset:1,color:[I.toColor[0],I.toColor[1],I.toColor[2],I.toColor[3]/255]});break}case"CIMFixedColorRamp":{const I=v,y=1/(I.colors.length-1);let z=0;for(const k of I.colors)L.push({offset:z,color:[k[0],k[1],k[2],k[3]/255]}),z+=y;break}case"CIMMultipartColorRamp":{const I=v,y=I.weights.reduce((k,D)=>k+D,0);let z=0;for(let k=0;k<I.colorRamps.length;k++){const H=I.weights[k],$=c(I.colorRamps[k]);for(const rt of $)L.push({offset:(z+rt.offset*H)/y,color:rt.color});z+=H}break}default:P().error(`Color ramp "${v.type}" currently unsupported.`)}return L}function n(v,L){const I=[],y=(v.length-1)/(L-1);for(let z=0;z<L;z++){const k=v[Math.round(z*y)].color;I.push({offset:z/L,color:k}),I.push({offset:(z+1)/L,color:k})}return I}function w(v,L,I=0){for(const{offset:y,color:z}of L)v.addColorStop(Math.min(Math.max(y,I),1-I),`rgba(${z[0]}, ${z[1]}, ${z[2]}, ${z[3]})`)}function O(v,L,I,y,z){const k=I+2*z;v.width=k,v.height=y;const D=(z+1)/k,H=v.getContext("2d",{willReadFrequently:!0});if(L.length>0){const $=H.createLinearGradient(0,0,k,y);w($,L,D),H.fillStyle=$}else H.fillStyle="rgba(128, 128, 128, 1)";H.fillRect(0,0,k,y)}function U(v){const{width:L,height:I}=v,y=v.getContext("2d").getImageData(0,0,L,I),z=new Uint8Array(y.data);for(let k=0;k<z.length;k+=4){const D=z[k+3]/255;z[k]*=D,z[k+1]*=D,z[k+2]*=D}return[z,L,I]}function N(v,L){const I=function G(v){const L=v[0]?.[0]?.[0]??0,I=v[0]?.[0]?.[1]??0,y={ymin:I,xmin:L,ymax:I,xmax:L,width:0,height:0};for(let z=0;z<v.length;z++){const k=v[z];for(let D=0;D<k.length;D++){const H=k[D][0],$=k[D][1];H<y.xmin&&(y.xmin=H),H>y.xmax&&(y.xmax=H),$<y.ymin&&(y.ymin=$),$>y.ymax&&(y.ymax=$)}}return y.width=Math.abs(y.xmax-y.xmin),y.height=Math.abs(y.ymax-y.ymin),y}(v),y=0===I.width?1:I.width,z=0===I.height?1:I.height,k=[];for(let D=0;D<v.length;D++){const H=v[D],$=[];for(let rt=0;rt<H.length;rt++){let Z=Math.round(H[rt][0]-I.xmin),et=Math.round(H[rt][1]-I.ymin);if(Z=L.xmin+Z*L.width/y,et=L.ymin+et*L.height/z,isNaN(Z)||isNaN(et))throw new Error("Scaled shape has NaN values");$.push([Z,et])}k.push($)}return k}function R(v,L,I){const y=[];for(let z=0;z<v.length;z++){const k=v[z],D=[];for(let H=0;H<k.length;H++){const $=k[H][0]+L,rt=k[H][1]+I;if(isNaN($)||isNaN(rt))throw new Error("Scaled shape has NaN values");D.push([$,rt])}y.push(D)}return y}},40794:(yt,at,A)=>{function it(W){return document.createElementNS("http://www.w3.org/2000/svg",W)}function q(){const W=it("svg");return W.setAttribute("style","position: absolute;"),W.setAttribute("width","0"),W.setAttribute("height","0"),W.setAttribute("aria-hidden","true"),W.setAttribute("role","presentation"),document.body.appendChild(W),W}function X(W){return null!=W&&document.body.removeChild(W),null}A.d(at,{FJ:()=>it,p:()=>q,pK:()=>X})},30365:(yt,at,A)=>{A.d(at,{Dy:()=>_,UD:()=>E,fO:()=>P,gy:()=>W,iT:()=>b,xy:()=>B});var it=A(35150);const q=()=>it.A.getLogger("esri.views.2d.engine.webgl.alignmentUtils");var X,W,o;function B(o){if(!o)return X.Center;switch(o){case"Left":case"left":return X.Left;case"Right":case"right":return X.Right;case"Justify":return q().warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),X.Center;case"Center":case"center":return X.Center}}function E(o){if(!o)return W.Center;switch(o){case"Top":case"top":return W.Top;case"Center":case"middle":return W.Center;case"Baseline":case"baseline":return W.Baseline;case"Bottom":case"bottom":return W.Bottom}}function P(o){switch(o){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return["right","bottom"];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return["center","bottom"];case"above-right":case"esriServerPointLabelPlacementAboveRight":return["left","bottom"];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return["right","middle"];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return["center","middle"];case"center-right":case"esriServerPointLabelPlacementCenterRight":return["left","middle"];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return["right","top"];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return["center","top"];case"below-right":case"esriServerPointLabelPlacementBelowRight":return["left","top"];default:return console.debug(`Found invalid placement type ${o}`),["center","middle"]}}function b(o){switch(o){case X.Right:case"right":return-1;case X.Center:case"center":return 0;case X.Left:case"left":return 1;default:return console.debug(`Found invalid horizontal alignment ${o}`),0}}function _(o){switch(o){case W.Top:case"top":return 1;case W.Center:case"middle":return 0;case W.Bottom:case W.Baseline:case"baseline":case"bottom":return-1;default:return console.debug(`Found invalid vertical alignment ${o}`),0}}(o=X||(X={}))[o.Left=-1]="Left",o[o.Center=0]="Center",o[o.Right=1]="Right",function(o){o[o.Top=1]="Top",o[o.Center=0]="Center",o[o.Bottom=-1]="Bottom",o[o.Baseline=2]="Baseline"}(W||(W={}))},42058:(yt,at,A)=>{A.d(at,{Tl:()=>R});var it=A(76329),q=A(3672),X=A(83953),W=A(88532),B=A(30365),E=A(68973),P=A(21260);const _=4,o=22+_,d=3,m=Math.PI/180;class c{constructor(L,I,y,z){this._rotationT=(0,q.vt)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const k=y.rect,D=new Float32Array(8);L*=z,I*=z;const H=y.code?k.width*z:y.metrics.width,$=y.code?k.height*z:y.metrics.height;this.width=H,this.height=$,D[0]=L,D[1]=I,D[2]=L+H,D[3]=I,D[4]=L,D[5]=I+$,D[6]=L+H,D[7]=I+$,this._data=D,this._setTextureCoords(k),this._scale=z,this._mosaic=y,this.x=L,this.y=I,this.maxOffset=Math.max(L+H,I+$)}get mosaic(){return this._mosaic}set angle(L){this._angle=L,(0,it.$0)(this._rotationT,-L),this._setOffsets()}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:L,width:I}=this._mosaic.metrics,y=I*this._scale,z=Math.abs(L)*this._scale,k=new Float32Array(8);k[0]=this.x,k[1]=this.y,k[2]=this.x+y,k[3]=this.y,k[4]=this.x,k[5]=this.y+z,k[6]=this.x+y,k[7]=this.y+z;const D=(0,it.lw)((0,q.vt)(),this._rotationT,this._transform);(0,q.gb)(k,k,D);let H=1/0,$=1/0,rt=-1/0,Z=-1/0;for(let ut=0;ut<4;ut++){const Pt=k[2*ut],xt=k[2*ut+1];H=Math.min(H,Pt),$=Math.min($,xt),rt=Math.max(rt,Pt),Z=Math.max(Z,xt)}const et=rt-H,lt=Z-$;this._bounds=new P.A(H+et/2,$+lt/2,et,lt)}return this._bounds}setTransform(L){this._transform=L,this._offsets=null}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const L=(0,it.lw)((0,q.vt)(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],(0,X.l0)(this._offsets.topLeft,this._offsets.topLeft,L),(0,X.l0)(this._offsets.topRight,this._offsets.topRight,L),(0,X.l0)(this._offsets.bottomLeft,this._offsets.bottomLeft,L),(0,X.l0)(this._offsets.bottomRight,this._offsets.bottomRight,L)}_setTextureCoords({x:L,y:I,width:y,height:z}){this._texcoords={topLeft:[L,I],topRight:[L+y,I],bottomLeft:[L,I+z],bottomRight:[L+y,I+z]}}}const n=(v,L)=>({code:0,page:0,sdf:!0,rect:new E.A(0,0,11,8),textureBinding:L,metrics:{advance:0,height:4,width:v,left:0,top:0}});function f(v,L){return v.forEach(I=>(0,X.l0)(I,I,L)),{topLeft:v[0],topRight:v[1],bottomLeft:v[2],bottomRight:v[3]}}class x{constructor(L,I,y){this._rotation=0,this._decorate(L,I,y),this.glyphs=L,this.bounds=this._createBounds(L),this.isMultiline=I.length>1,this._hasRotation=0!==y.angle,this._transform=this._createGlyphTransform(this.bounds,y),this._borderLineSizePx=y.borderLineSizePx,(y.borderLineSizePx||y.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const z of L)z.setTransform(this._transform)}setRotation(L){if(0===L&&0===this._rotation)return;this._rotation=L;const I=this._transform,y=(0,it.$0)((0,q.vt)(),L);(0,it.lw)(I,y,I);for(const z of this.glyphs)z.setTransform(this._transform)}_decorate(L,I,y){if(!y.decoration||"none"===y.decoration||!L.length)return;const z=y.scale,k="underline"===y.decoration?o:16,D=L[0].textureBinding;for(const H of I)L.push(new c(H.startX*z,H.startY*z+k*z,n((H.width+H.glyphWidthEnd)*z,D),1))}shapeBackground(L){const y=(1.5+(this._borderLineSizePx||0))/2,z=this._borderLineSizePx?y:0,{xmin:k,ymin:D,xmax:H,ymax:$,x:rt,y:Z,width:et,height:lt}=this.bounds,ct=[k-8,D-8],_t=[H+8,D-8],ut=[k-8,$+8],Pt=[H+8,$+8],xt=f([[ct[0]-y,ct[1]-y],[_t[0]+y,_t[1]-y],[ct[0]+z,ct[1]+z],[_t[0]-z,_t[1]+z]],L),mt=f([[ut[0]+z,ut[1]-z],[Pt[0]-z,Pt[1]-z],[ut[0]-y,ut[1]+y],[Pt[0]+y,Pt[1]+y]],L),Ct=f([[ct[0]-y,ct[1]-y],[ct[0]+z,ct[1]+z],[ut[0]-y,ut[1]+y],[ut[0]+z,ut[1]-z]],L),dt=f([[_t[0]-z,_t[1]+z],[_t[0]+y,_t[1]-y],[Pt[0]-z,Pt[1]-z],[Pt[0]+y,Pt[1]+y]],L),Lt={main:f([ct,_t,ut,Pt],L),top:xt,bot:mt,left:Ct,right:dt};return[new P.A(rt,Z,et+2*y,lt+2*y),Lt]}get boundsT(){const L=this.bounds,I=(0,X.hZ)((0,W.vt)(),L.x,L.y);if((0,X.l0)(I,I,this._transform),this._hasRotation){const y=Math.max(L.width,L.height);return new P.A(I[0],I[1],y,y)}return new P.A(I[0],I[1],L.width,L.height)}_createBounds(L){let I=1/0,y=1/0,z=0,k=0;for(const $ of L)I=Math.min(I,$.xTopLeft),y=Math.min(y,$.yTopLeft),z=Math.max(z,$.xBottomRight),k=Math.max(k,$.yBottomRight);const D=z-I,H=k-y;return new P.A(I+D/2,y+H/2,D,H)}_createGlyphTransform(L,I){const y=m*I.angle,z=(0,q.vt)(),k=(0,W.vt)();return(0,it.Tl)(z,z,(0,X.hZ)(k,I.xOffset,-I.yOffset)),I.useCIMAngleBehavior?(0,it.e$)(z,z,y):((0,it.Tl)(z,z,(0,X.hZ)(k,L.x,L.y)),(0,it.e$)(z,z,y),(0,it.Tl)(z,z,(0,X.hZ)(k,-L.x,-L.y))),z}}class w{constructor(L,I,y,z,k,D){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(I,y)),this.end=Math.max(0,Math.max(I,y)),this.end<L.length&&(this.glyphWidthEnd=L[this.end].metrics.width),this.width=z,this.yMin=k,this.yMax=D}}const O=v=>10===v,U=v=>32===v;function R(v,L){const I=L.scale,y=new Array,{glyphs:z,isRightToLeft:k}=v,D=function G(v,L,I){const y=new Array,k=I.maxLineWidth*(1/I.scale),D=L?v.length-1:0,H=L?-1:v.length,$=L?-1:1;let rt=D,Z=0,et=0,lt=rt,ct=lt,_t=0,ut=1/0,Pt=0;for(;rt!==H;){const{code:mt,metrics:Ct}=v[rt],dt=Math.abs(Ct.top);O(mt)||U(mt)||(ut=Math.min(ut,dt),Pt=Math.max(Pt,dt+Ct.height)),O(mt)?(rt!==D&&(y.push(new w(v,lt,rt-$,Z,ut===1/0?0:ut,Pt)),ut=1/0,Pt=0),Z=0,lt=rt+$,ct=rt+$,et=0):U(mt)?(ct=rt+$,et=0,_t=Ct.advance,Z+=Ct.advance):Z>k?(ct!==lt?(Z-=_t,y.push(new w(v,lt,ct-2*$,Z-et,ut,Pt)),ut=1/0,Pt=0,lt=ct,Z=et):(y.push(new w(v,lt,rt-$,Z,ut,Pt)),ut=1/0,Pt=0,lt=rt,ct=rt,Z=0),Z+=Ct.advance,et+=Ct.advance):(Z+=Ct.advance,et+=Ct.advance),rt+=$}const xt=new w(v,lt,rt-$,Z,ut,Pt);return xt.start>=0&&xt.end<v.length&&y.push(xt),y}(z,k,L),H=D.length?function N(v,L){let I=0;for(let k=0;k<v.length;k++){const{width:D}=v[k];I=Math.max(D,I)}const z=v[0].yMin;return{x:0,y:z,height:v[v.length-1].yMax+L.lineHeight*(v.length-1)+("underline"===L.decoration?_:0)-z,width:I}}(D,L):{x:0,y:0,height:0,width:0},$=(0,B.xy)(L.horizontalAlignment),rt=(0,B.UD)(L.verticalAlignment),Z=rt===B.gy.Baseline?1:0,lt=(1-Z)*-H.y+H.height/2*(Z?0:rt-1)+-22*(Z?1:0);for(let ct=0;ct<D.length;ct++){const{start:_t,end:ut,width:Pt}=D[ct];let xt=-1*($+1)*(Pt/2)-d;const mt=(v.isRightToLeft?D.length-1-ct:ct)*L.lineHeight+lt-d;D[ct].startX=xt,D[ct].startY=mt;for(let Ct=_t;Ct<=ut;Ct++){const dt=z[Ct];if(O(dt.code))continue;const Lt=new c(xt+dt.metrics.left,mt-dt.metrics.top,dt,I);xt+=dt.metrics.advance,y.push(Lt)}}return new x(y,D,L)}},36741:(yt,at,A)=>{A.d(at,{DF:()=>B,Lu:()=>P,RA:()=>W,hV:()=>E});var it=A(67685),q=A(55861),X=A(47669);const W=50;function B(b){if(!b)return null;const{xmin:_,ymin:o,xmax:u,ymax:d,spatialReference:m}=b;return new q.A({rings:[[[_,o],[_,d],[u,d],[u,o],[_,o]]],spatialReference:m})}function E(b){return(0,it.PN)(Math.round((0,it.Lz)(b)))}function P(b){const _=(0,it.PN)(X.GR),o=(0,it.PN)(X.cp);return Math.max(_,Math.min(b||o,o))}}}]);