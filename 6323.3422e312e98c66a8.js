"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[6323,5565],{61597:(Y,P,s)=>{s.d(P,{v:()=>x});var o=s(10467),C=s(56151);class x{constructor(){this._serviceMetadatas=new Map,this._itemDatas=new Map}fetchServiceMetadata(_,m){var p=this;return(0,o.A)(function*(){const c=p._serviceMetadatas.get(_);if(c)return c;const d=yield(0,C.V)(_,m);return p._serviceMetadatas.set(_,d),d})()}fetchItemData(_){var m=this;return(0,o.A)(function*(){const{id:p}=_;if(!p)return null;const{_itemDatas:c}=m;if(c.has(p))return c.get(p);const d=yield _.fetchData();return c.set(p,d),d})()}fetchCustomParameters(_,m){var p=this;return(0,o.A)(function*(){const c=yield p.fetchItemData(_);return c&&"object"==typeof c&&(m?m(c):c.customParameters)||null})()}}},66323:(Y,P,s)=>{s.r(P),s.d(P,{populateGroupLayer:()=>Z,populateOperationalLayers:()=>U});var o=s(10467),C=s(31178),v=(s(3248),s(61597)),_=s(64833),m=s(46577);function M(r,n){return!(!r.layerType||"ArcGISFeatureLayer"!==r.layerType)&&r.featureCollectionType===n}var W=s(15565),O=s(8691);function U(r,n,L){return E.apply(this,arguments)}function E(){return E=(0,o.A)(function*(r,n,L){if(!n)return;const f=n.map(S=>function re(r,n){return F.apply(this,arguments)}(S,L)),h=yield Promise.allSettled(f);for(const S of h)"rejected"===S.status||S.value&&r.add(S.value)}),E.apply(this,arguments)}const i={ArcGISDimensionLayer:"DimensionLayer",ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISSceneServiceLayer:"SceneLayer",ArcGISTiledElevationServiceLayer:"ElevationLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",BuildingSceneLayer:"BuildingSceneLayer",CatalogLayer:"CatalogLayer",CSV:"CSVLayer",DefaultTileLayer:"TileLayer",GeoJSON:"GeoJSONLayer",GroupLayer:"GroupLayer",IntegratedMesh3DTilesLayer:"IntegratedMesh3DTilesLayer",Object3DTilesLayer:"UnsupportedLayer",IntegratedMeshLayer:"IntegratedMeshLayer",KML:"KMLLayer",LineOfSightLayer:"LineOfSightLayer",MediaLayer:"MediaLayer",OGCFeatureLayer:"OGCFeatureLayer",OrientedImageryLayer:"OrientedImageryLayer",PointCloudLayer:"PointCloudLayer",RasterDataLayer:"UnsupportedLayer",VectorTileLayer:"VectorTileLayer",ViewshedLayer:"ViewshedLayer",Voxel:"VoxelLayer",WCS:"WCSLayer",WFS:"WFSLayer",WMS:"WMSLayer",WebTiledLayer:"WebTileLayer"},t={ArcGISTiledElevationServiceLayer:"ElevationLayer",DefaultTileLayer:"ElevationLayer",RasterDataElevationLayer:"UnsupportedLayer"},l={ArcGISFeatureLayer:"FeatureLayer"},u={ArcGISImageServiceLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"UnsupportedLayer",ArcGISSceneServiceLayer:"SceneLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",DefaultTileLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WCS:"UnsupportedLayer",WMS:"UnsupportedLayer",WebTiledLayer:"WebTileLayer"},A={ArcGISAnnotationLayer:"UnsupportedLayer",ArcGISDimensionLayer:"UnsupportedLayer",ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISStreamLayer:"StreamLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",BingMapsAerial:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",CatalogLayer:"CatalogLayer",CSV:"CSVLayer",DefaultTileLayer:"TileLayer",GeoJSON:"GeoJSONLayer",GeoRSS:"GeoRSSLayer",GroupLayer:"GroupLayer",KML:"KMLLayer",KnowledgeGraphLayer:"KnowledgeGraphLayer",MediaLayer:"MediaLayer",OGCFeatureLayer:"OGCFeatureLayer",OrientedImageryLayer:"OrientedImageryLayer",SubtypeGroupLayer:"SubtypeGroupLayer",VectorTileLayer:"VectorTileLayer",WCS:"WCSLayer",WFS:"WFSLayer",WMS:"WMSLayer",WebTiledLayer:"WebTileLayer"},g={ArcGISFeatureLayer:"FeatureLayer",SubtypeGroupTable:"SubtypeGroupLayer"},N={ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISTiledImageServiceLayer:"ImageryTileLayer",ArcGISTiledMapServiceLayer:"TileLayer",BingMapsAerial:"BingMapsLayer",BingMapsHybrid:"BingMapsLayer",BingMapsRoad:"BingMapsLayer",DefaultTileLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WCS:"WCSLayer",WMS:"WMSLayer",WebTiledLayer:"WebTileLayer"},K={...A,LinkChartLayer:"LinkChartLayer"},J={...g},X={...N};function F(){return F=(0,o.A)(function*(r,n){return function te(r,n,L){return w.apply(this,arguments)}(yield function ae(r,n){return H.apply(this,arguments)}(r,n),r,n)}),F.apply(this,arguments)}function w(){return w=(0,o.A)(function*(r,n,L){const f=new r;return f.read(n,L.context),"group"===f.type&&("GroupLayer"===n.layerType?yield Z(f,n,L):$(n)?function se(r,n,L){n.itemId&&(r.portalItem=new m.default({id:n.itemId,portal:L?.portal}),r.when(()=>{const f=h=>{const S=h.layerId;q(h,r,n,S,L);const I=n.featureCollection?.layers?.[S];I&&h.read(I,L)};r.layers?.forEach(f),r.tables?.forEach(f)}))}(f,n,L.context):Q(n)&&(yield function ie(r,n,L){return k.apply(this,arguments)}(f,n,L.context))),yield(0,O.L)(f,L.context),f}),w.apply(this,arguments)}function H(){return(H=(0,o.A)(function*(r,n){const L=n.context,f=function ne(r){let n;switch(r.origin){case"web-scene":switch(r.layerContainerType){case"basemap":n=u;break;case"ground":n=t;break;case"tables":n=l;break;default:n=i}break;case"link-chart":switch(r.layerContainerType){case"basemap":n=X;break;case"tables":n=J;break;default:n=K}break;default:switch(r.layerContainerType){case"basemap":n=N;break;case"tables":n=g;break;default:n=A}}return n}(L);let h=r.layerType||r.type;!h&&n?.defaultLayerType&&(h=n.defaultLayerType);const S=f[h];let I=S?_.S[S]:_.S.UnknownLayer;if($(r)){const V=L?.portal;if(r.itemId){const R=new m.default({id:r.itemId,portal:V});yield R.load();const e=(yield(0,W.selectLayerClassPath)(R,new v.v)).className||"UnknownLayer";I=_.S[e]}}else"ArcGISFeatureLayer"===h?function p(r){return M(r,"notes")}(r)||function c(r){return M(r,"markup")}(r)?I=_.S.MapNotesLayer:function d(r){return M(r,"route")}(r)?I=_.S.RouteLayer:Q(r)&&(I=_.S.GroupLayer):r.wmtsInfo?.url&&r.wmtsInfo.layerIdentifier?I=_.S.WMTSLayer:"WFS"===h&&"2.0.0"!==r.wfsInfo?.version&&(I=_.S.UnsupportedLayer);return I()})).apply(this,arguments)}function Q(r){return"ArcGISFeatureLayer"===r.layerType&&!$(r)&&(r.featureCollection?.layers?.length??0)>1}function $(r){return"Feature Collection"===r.type}function Z(r,n,L){return z.apply(this,arguments)}function z(){return(z=(0,o.A)(function*(r,n,L){const f=new C.A,h=U(f,Array.isArray(n.layers)?n.layers:[],L);try{try{if(yield h,"group"===r.type)return r.layers.addMany(f),r}catch(S){r.destroy();for(const I of f)I.destroy();throw S}}catch(S){throw S}})).apply(this,arguments)}function k(){return(k=(0,o.A)(function*(r,n,L){const f=_.S.FeatureLayer,h=yield f(),S=n.featureCollection,I=S?.showLegend,V=S?.layers?.map((R,e)=>{const a=new h;a.read(R,L);const y={...L,ignoreDefaults:!0};return q(a,r,n,e,y),null!=I&&a.read({showLegend:I},y),a});r.layers.addMany(V??[])})).apply(this,arguments)}function q(r,n,L,f,h){r.read({id:`${n.id}-sublayer-${f}`,visibility:L.visibleLayers?.includes(f)??!0},h)}},43092:(Y,P,s)=>{s.d(P,{Ju:()=>d,K8:()=>O,XH:()=>M,_r:()=>v,bO:()=>_,l:()=>W,nu:()=>U,pJ:()=>p,rc:()=>c});var o=s(10467),C=s(86537),x=s(23154);function v(i){const t={id:i.id,name:i.name},l=(0,x.K)(i.type);return"FeatureLayer"!==l&&(t.layerType=l),t}function _(i,t,l){return m.apply(this,arguments)}function m(){return(m=(0,o.A)(function*(i,t,l){if(null==i?.layers||null==i?.tables){const u=yield l.fetchServiceMetadata(t,{customParameters:p(i)?.customParameters});(i=i||{}).layers=i.layers||u?.layers?.map(v),i.tables=i.tables||u?.tables?.map(v)}return i})).apply(this,arguments)}function p(i){if(!i)return null;const{layers:t,tables:l}=i;return t?.length?t[0]:l?.length?l[0]:null}function c(i,t){return null==t?null:[...i.layers||[],...i.tables||[]].find(l=>l.id===t)}function d(i,t){return[...i.layers||[],...i.tables||[]].filter(({layerType:l})=>t.includes(l||"ArcGISFeatureLayer"))}function M(i){return(i?.layers?.length??0)+(i?.tables?.length??0)}function W(i){switch(i){case"catalog":return["CatalogLayer"];case"feature":return["ArcGISFeatureLayer"];case"oriented-imagery":return["OrientedImageryLayer"];case"subtype-group":return["SubtypeGroupLayer","SubtypeGroupTable"]}return null}function O(i){switch(i){case"CatalogLayer":return"CatalogLayer";case"OrientedImageryLayer":return"OrientedImageryLayer";case"SubtypeGroupLayer":case"SubtypeGroupTable":return"SubtypeGroupLayer"}return"FeatureLayer"}function U(i,t,l){return E.apply(this,arguments)}function E(){return(E=(0,o.A)(function*(i,t,l){if(!i?.url)return t??{};if(t??={},!t.layers){const g=yield l.fetchServiceMetadata(i.url);t.layers=g.layers?.map(v)}const{serverUrl:u,portalItem:A}=yield(0,C.L)(i.url,{sceneLayerItem:i,customParameters:p(t)?.customParameters}).catch(()=>({serverUrl:null,portalItem:null}));if(null==u)return t.tables=[],t;if(!t.tables&&A){const g=yield A.fetchData().catch(()=>null);if(g?.tables)t.tables=g.tables.map(v);else{const N=yield l.fetchServiceMetadata(u,{customParameters:p(g)?.customParameters}).catch(()=>null);t.tables=N?.tables?.map(v)}}if(t.tables)for(const g of t.tables)g.url=`${u}/${g.id}`;return t})).apply(this,arguments)}},69927:(Y,P,s)=>{s.d(P,{It:()=>i,LG:()=>p,OM:()=>M,Sm:()=>W,Y:()=>c,bK:()=>d,mm:()=>E,sQ:()=>O});var o=s(10467),C=s(13970),x=s(32034),v=s(55039);function m(){return(m=(0,o.A)(function*(t){const l=t.spatialReference;if(l.isWGS84)return t.clone();if(l.isWebMercator)return(0,v.ci)(t);const u=x.A.WGS84;return yield(0,C.initializeProjection)(l,u),(0,C.project)(t,u)})).apply(this,arguments)}function p(t,l){if(!c(t,l)){const u=t.typeKeywords;u?u.push(l):t.typeKeywords=[l]}}function c(t,l){return!!t.typeKeywords?.includes(l)}function d(t){return c(t,E.HOSTED_SERVICE)}function M(t,l){const u=t.typeKeywords;if(u){const A=u.indexOf(l);A>-1&&u.splice(A,1)}}function W(t,l,u){u?p(t,l):M(t,l)}function O(t){return U.apply(this,arguments)}function U(){return U=(0,o.A)(function*(t){const l=t.clone().normalize();let u;if(l.length>1)for(const A of l)u?A.width>u.width&&(u=A):u=A;else u=l[0];return function _(t){return m.apply(this,arguments)}(u)}),U.apply(this,arguments)}const E={DEVELOPER_BASEMAP:"DeveloperBasemap",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",LOCAL_SCENE:"ViewingMode-Local",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function i(t){const{portal:l,isOrgItem:u,itemControl:A}=t,g=l.user?.privileges;let N=!g||g.includes("features:user:edit"),K=!!u&&!!g?.includes("features:user:fullEdit");const J="update"===A||"admin"===A;return J?K=N=!0:K&&(N=!0),{features:{edit:N,fullEdit:K},content:{updateItem:J}}}},15565:(Y,P,s)=>{s.r(P),s.d(P,{fromItem:()=>W,selectLayerClassPath:()=>i});var o=s(10467),C=s(5922),x=s(86537),v=s(23154),_=s(61597),m=s(58443),p=s(64833),c=s(46577),d=s(43092),M=s(69927);function W(e){return O.apply(this,arguments)}function O(){return O=(0,o.A)(function*(e){let{portalItem:a}=e;!a||a instanceof c.default||(a=new c.default(a));const y=yield function U(e){return E.apply(this,arguments)}(a);return new y.constructor({portalItem:a,...y.properties})}),O.apply(this,arguments)}function E(){return E=(0,o.A)(function*(e){yield e.load();const a=new _.v;return function l(e){return u.apply(this,arguments)}(yield i(e,a))}),E.apply(this,arguments)}function i(e,a){return t.apply(this,arguments)}function t(){return t=(0,o.A)(function*(e,a){switch(e.type){case"3DTiles Service":return e.typeKeywords.includes("3DObject")?{className:"UnsupportedLayer"}:{className:"IntegratedMesh3DTilesLayer"};case"CSV":return{className:"CSVLayer"};case"Feature Collection":return function re(e){return F.apply(this,arguments)}(e);case"Feature Service":return function N(e,a){return K.apply(this,arguments)}(e,a);case"Feed":case"Stream Service":return{className:"StreamLayer"};case"GeoJson":return{className:"GeoJSONLayer"};case"Group Layer":return{className:"GroupLayer"};case"Image Service":return function te(e,a){return w.apply(this,arguments)}(e,a);case"KML":return{className:"KMLLayer"};case"Knowledge Graph Layer":return{className:"KnowledgeGraphLayer"};case"Map Service":return function A(e,a){return g.apply(this,arguments)}(e,a);case"Media Layer":return{className:"MediaLayer"};case"Scene Service":return function J(e,a){return X.apply(this,arguments)}(e,a);case"Vector Tile Service":return{className:"VectorTileLayer"};case"WCS":return{className:"WCSLayer"};case"WFS":return{className:"WFSLayer"};case"WMS":return{className:"WMSLayer"};case"WMTS":return{className:"WMTSLayer"};default:throw new C.A("portal:unknown-item-type","Unknown item type '${type}'",{type:e.type})}}),t.apply(this,arguments)}function u(){return(u=(0,o.A)(function*(e){const y=p.S[e.className];return{constructor:yield y(),properties:e.properties}})).apply(this,arguments)}function g(){return g=(0,o.A)(function*(e,a){return(yield function h(e,a){return S.apply(this,arguments)}(e,a))?{className:"TileLayer"}:{className:"MapImageLayer"}}),g.apply(this,arguments)}function K(){return(K=(0,o.A)(function*(e,a){const y=yield I(e,a);if("object"==typeof y){const{sourceJSON:T,className:b}=y,D={sourceJSON:T};return null!=y.id&&(D.layerId=y.id),{className:b||"FeatureLayer",properties:D}}return{className:"GroupLayer"}})).apply(this,arguments)}function X(){return(X=(0,o.A)(function*(e,a){const y=yield I(e,a,(0,o.A)(function*(){try{if(!e.url)return[];const{serverUrl:T}=yield(0,x.L)(e.url,{sceneLayerItem:e});return(yield a.fetchServiceMetadata(T))?.tables??[]}catch{return[]}}));if("object"==typeof y){const T={};let b;if(null!=y.id?(T.layerId=y.id,b=`${e.url}/layers/${y.id}`):b=e.url,e.typeKeywords?.length)for(const G of Object.keys(m.XX))if(e.typeKeywords.includes(G))return{className:m.XX[G]};const D=yield a.fetchServiceMetadata(b,{customParameters:yield a.fetchCustomParameters(e,G=>(0,d.pJ)(G)?.customParameters)});return{className:m.XX[D?.layerType]||"SceneLayer",properties:T}}return!1===y&&"Voxel"===(yield a.fetchServiceMetadata(e.url))?.layerType?{className:"VoxelLayer"}:{className:"GroupLayer"}})).apply(this,arguments)}function F(){return(F=(0,o.A)(function*(e){yield e.load();const a=(0,M.Y)(e,"Map Notes"),y=(0,M.Y)(e,"Markup");if(a||y)return{className:"MapNotesLayer"};if((0,M.Y)(e,"Route Layer"))return{className:"RouteLayer"};const T=yield e.fetchData();return 1===(0,d.XH)(T)?{className:"FeatureLayer"}:{className:"GroupLayer"}})).apply(this,arguments)}function w(){return(w=(0,o.A)(function*(e,a){yield e.load();const y=e.typeKeywords?.map(le=>le.toLowerCase())??[];if(y.includes("elevation 3d layer"))return{className:"ElevationLayer"};if(y.includes("tiled imagery"))return{className:"ImageryTileLayer"};const T=yield a.fetchItemData(e),b=T?.layerType;if("ArcGISTiledImageServiceLayer"===b)return{className:"ImageryTileLayer"};if("ArcGISImageServiceLayer"===b)return{className:"ImageryLayer"};const D=yield a.fetchServiceMetadata(e.url,{customParameters:yield a.fetchCustomParameters(e)}),G=D.cacheType?.toLowerCase(),ee=D.capabilities?.toLowerCase().includes("tilesonly"),B=D.tileInfo?.format?.toLowerCase()??"",j=null==G&&["jpg","jpeg","png","png8","png24","png32","mixed"].includes(B);return"map"===G||j||ee?{className:"ImageryTileLayer"}:{className:"ImageryLayer"}})).apply(this,arguments)}function S(){return(S=(0,o.A)(function*(e,a){const{tileInfo:y}=yield a.fetchServiceMetadata(e.url,{customParameters:yield a.fetchCustomParameters(e)});return y})).apply(this,arguments)}function I(e,a,y){return V.apply(this,arguments)}function V(){return(V=(0,o.A)(function*(e,a,y){const{url:T,type:b}=e,D="Feature Service"===b;if(!T)return{};if(/\/\d+$/.test(T)){if(D){const B=yield a.fetchServiceMetadata(T,{customParameters:yield a.fetchCustomParameters(e,j=>(0,d.pJ)(j)?.customParameters)});return{id:B.id,className:(0,v.K)(B.type),sourceJSON:B}}return{}}yield e.load();let G=yield a.fetchItemData(e);if(D){const B=yield(0,d.bO)(G,T,a),j=R(B);if("object"==typeof j){const le=(0,d.rc)(B,j.id);j.className=(0,d.K8)(le?.layerType)}return j}if("Scene Service"===b&&(G=yield(0,d.nu)(e,G,a)),(0,d.XH)(G)>0)return R(G);const ee=yield a.fetchServiceMetadata(T);return y&&(ee.tables=yield y()),R(ee)})).apply(this,arguments)}function R(e){return 1===(0,d.XH)(e)&&{id:(0,d.pJ)(e)?.id}}},8691:(Y,P,s)=>{s.d(P,{L:()=>_});var o=s(10467),C=s(89447),x=s(56492),v=s(96996);function _(p,c,d){return m.apply(this,arguments)}function m(){return(m=(0,o.A)(function*(p,c,d){const M=p&&p.getAtOrigin&&p.getAtOrigin("renderer",c.origin);if(M&&"unique-value"===M.type&&M.styleOrigin){const W=yield(0,C.Ke)(M.populateFromStyle());if((0,x.Te)(d),!1===W.ok){const O=W.error;c?.messages&&c.messages.push(new v.A("renderer:style-reference",`Failed to create unique value renderer from style reference: ${O.message}`,{error:O,context:c})),p.clear("renderer",c?.origin)}}})).apply(this,arguments)}}}]);