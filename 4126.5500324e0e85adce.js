"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[4126],{34126:(z,C,u)=>{u.r(C),u.d(C,{fromUrl:()=>R});var d=u(10467),v=u(5922),A=u(45272),T=u(68438),w=u(86537),h=u(23154),M=u(58443),K=u(64833),p=u(56151);const F={FeatureLayer:!0,SceneLayer:!0};function R(e){return _.apply(this,arguments)}function _(){return _=(0,d.A)(function*(e){const{properties:n,url:r}=e,s={...n,url:r},a=yield function W(e,n){return g.apply(this,arguments)}(r,n?.customParameters),{Constructor:t,layerId:o,sourceJSON:i,parsedUrl:y,layers:c,tables:l}=a;if(c.length+l.length===0)return null!=o&&(s.layerId=o),null!=i&&(s.sourceJSON=i),new t(s);const f=new((yield Promise.all([u.e(9845),u.e(3325),u.e(6323),u.e(2429)]).then(u.bind(u,82429))).default)({title:y.title});return yield function j(e,n,r){return S.apply(this,arguments)}(f,a,s),f}),_.apply(this,arguments)}function x(e,n){return e?e.find(({id:r})=>r===n):null}function D(e,n,r,s,a){const t={...a,layerId:n};return null!=e&&(t.url=e),null!=r&&(t.sourceJSON=r),"sublayerTitleMode"in s.prototype&&(t.sublayerTitleMode="service-name"),new s(t)}function S(){return(S=(0,d.A)(function*(e,n,r){const s=n.sublayerConstructorProvider;for(const{id:a,serverUrl:t}of n.layers){const o=x(n.sublayerInfos,a),i=D(t,a,o,(o&&s?.(o))??n.Constructor,r);e.add(i)}if(n.tables.length){const a=yield O("FeatureLayer");n.tables.forEach(({id:t,serverUrl:o})=>{const i=D(o,t,x(n.tableInfos,t),a,r);e.tables.add(i)})}})).apply(this,arguments)}function g(){return g=(0,d.A)(function*(e,n){let r=(0,T.qg)(e);if(null==r&&(r=yield function B(e,n){return P.apply(this,arguments)}(e,n)),null==r)throw new v.A("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});const{serverType:s,sublayer:a}=r;let t;const o={FeatureServer:"FeatureLayer",KnowledgeGraphServer:"KnowledgeGraphLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer",VideoServer:"VideoLayer"},i="FeatureServer"===s,y="SceneServer"===s,c={parsedUrl:r,Constructor:null,layerId:i||y?a??void 0:void 0,layers:[],tables:[]};switch(s){case"MapServer":if(null!=a){const{type:l}=yield(0,p.V)(e,{customParameters:n});switch(t="FeatureLayer",l){case"Catalog Layer":t="CatalogLayer";break;case"Catalog Dynamic Group Layer":throw new v.A("arcgis-layers:unsupported",`fromUrl() not supported for "${l}" layers`)}}else t=(yield function G(e,n){return E.apply(this,arguments)}(e,n))?"TileLayer":"MapImageLayer";break;case"ImageServer":{const l=yield(0,p.V)(e,{customParameters:n}),{tileInfo:f,cacheType:m}=l;t=f?"LERC"!==f?.format?.toUpperCase()||m&&"elevation"!==m.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const l=yield(0,p.V)(r.url.path,{customParameters:n});if(t="SceneLayer",l){const f=l?.layers;if("Voxel"===l?.layerType)t="VoxelLayer";else if(f?.length){const m=f[0]?.layerType;null!=m&&null!=M.XX[m]&&(t=M.XX[m])}}break}case"3DTilesServer":throw new v.A("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(t="FeatureLayer",null!=a){const l=yield(0,p.V)(e,{customParameters:n});c.sourceJSON=l,t=(0,h.K)(l.type)}break;default:t=o[s]}if(F[t]&&null==a){const l=yield function N(e,n,r){return I.apply(this,arguments)}(e,s,n);if(i&&(c.sublayerInfos=l.layerInfos,c.tableInfos=l.tableInfos),l.layers.length+l.tables.length!==1)c.layers=l.layers,c.tables=l.tables,i&&l.layerInfos?.length&&(c.sublayerConstructorProvider=yield function X(e){return U.apply(this,arguments)}(l.layerInfos));else if(i||y){const f=l.layerInfos?.[0]??l.tableInfos?.[0];if(c.layerId=l.layers[0]?.id??l.tables[0]?.id,c.sourceJSON=f,i){const m=f?.type;t=(0,h.K)(m)}}}return c.Constructor=yield O(t),c}),g.apply(this,arguments)}function P(){return(P=(0,d.A)(function*(e,n){const r=yield(0,p.V)(e,{customParameters:n});let s=null,a=null;const t=r.type;if("Feature Layer"===t||"Table"===t?(s="FeatureServer",a=r.id??null):"indexedVector"===t?s="VectorTileServer":r.hasOwnProperty("mapName")?s="MapServer":r.hasOwnProperty("bandCount")&&r.hasOwnProperty("pixelSizeX")?s="ImageServer":r.hasOwnProperty("maxRecordCount")&&r.hasOwnProperty("allowGeometryUpdates")?s="FeatureServer":r.hasOwnProperty("streamUrls")?s="StreamServer":V(r)?(s="SceneServer",a=r.id):r.hasOwnProperty("layers")&&V(r.layers?.[0])&&(s="SceneServer"),!s)return null;const o=null!=a?(0,T.iz)(e):null;return{title:null!=o&&r.name||(0,A.e7)(e),serverType:s,sublayer:a,url:{path:null!=o?o.serviceUrl:(0,A.An)(e).path}}})).apply(this,arguments)}function V(e){return null!=e&&e.hasOwnProperty("store")&&e.hasOwnProperty("id")&&"number"==typeof e.id}function I(){return I=(0,d.A)(function*(e,n,r){let s,a,t=!1;switch(n){case"FeatureServer":{const y=yield(0,h.Q)(e,{customParameters:r});t=!!y.layersJSON,s=y.layersJSON||y.serviceJSON;break}case"SceneServer":{const y=yield function J(e,n){return L.apply(this,arguments)}(e,r);s=y.serviceInfo,a=y.tableServerUrl;break}default:s=yield(0,p.V)(e,{customParameters:r})}const o=s?.layers,i=s?.tables;return{layers:o?.map(y=>({id:y.id})).reverse()||[],tables:i?.map(y=>({serverUrl:a,id:y.id})).reverse()||[],layerInfos:t?o:[],tableInfos:t?i:[]}}),I.apply(this,arguments)}function L(){return(L=(0,d.A)(function*(e,n){const r=yield(0,p.V)(e,{customParameters:n});if(!r.layers?.[0])return{serviceInfo:r};try{const{serverUrl:a}=yield(0,w.L)(e),t=yield(0,p.V)(a,{customParameters:n}).catch(()=>null);return t&&(r.tables=t.tables),{serviceInfo:r,tableServerUrl:a}}catch{return{serviceInfo:r}}})).apply(this,arguments)}function O(e){return b.apply(this,arguments)}function b(){return(b=(0,d.A)(function*(e){return(0,K.S[e])()})).apply(this,arguments)}function E(){return(E=(0,d.A)(function*(e,n){return(yield(0,p.V)(e,{customParameters:n})).tileInfo})).apply(this,arguments)}function U(){return(U=(0,d.A)(function*(e){if(!e.length)return;const n=new Set,r=[];for(const{type:t}of e)n.has(t)||(n.add(t),r.push(O((0,h.K)(t))));const s=yield Promise.all(r),a=new Map;return Array.from(n).forEach((t,o)=>{a.set(t,s[o])}),t=>a.get(t.type)})).apply(this,arguments)}}}]);