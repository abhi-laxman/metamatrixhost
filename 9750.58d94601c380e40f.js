"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[9750],{25936:(j,T,e)=>{e.d(T,{b:()=>L});var s=e(8189),_=e(35150),M=e(85211),P=(e(3248),e(40707),e(76576)),A=e(68438);const L=D=>{let u=class extends D{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const E=(0,A.qg)(this.url);if(E?.title)return E.title}return this._get("title")||""}set title(E){this._set("title",E)}set url(E){this._set("url",(0,A.Jf)(E,_.A.getLogger(this)))}};return(0,s._)([(0,M.MZ)()],u.prototype,"title",null),(0,s._)([(0,M.MZ)({type:String})],u.prototype,"url",null),u=(0,s._)([(0,P.$)("esri.layers.mixins.ArcGISService")],u),u}},17049:(j,T,e)=>{e.d(T,{q:()=>S});var s=e(8189),_=e(5922),M=e(45272),m=e(85211),O=e(55739),L=(e(3248),e(40707),e(17221)),D=e(76576),u=e(50305),E=e(50501),I=e(34813),G=e(56558);const R={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},b={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},l={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},p={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,Object3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":R,"web-map/basemap":b,"web-map/tables":l,"link-chart/operational-layers":{...R,LinkChartLayer:!0},"link-chart/basemap":b,"link-chart/tables":l,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0,WCS:!0},"portal-item/tables":{ArcGISFeatureLayer:!0,SubtypeGroupTable:!0}};var o=e(22329),g=e(17181);const S=h=>{let c=class extends h{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(n,y,d){return"Group Layer"===d?.portalItem?.type?void 0:n}writeListMode(n,y,d,r){(r&&"ground"===r.layerContainerType||n&&(0,G.R)(this,d,{},r))&&(y[d]=n)}writeOperationalLayerType(n,y,d){n&&(y[d]=n)}writeTitle(n,y){y.title=n??"Layer"}readVisibilityTimeExtent(n){return n?g.A.fromArray(n):null}writeVisibilityTimeExtent(n,y,d,r){n&&"tables"!==r.layerContainerType&&(n.isEmpty?r?.messages&&r.messages.push(new _.A("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):y[d]=n.toArray())}read(n,y){y&&(y.layer=this),(0,I.t)(this,n,d=>super.read(n,d),y)}write(n,y){if(!this.persistenceEnabled&&!y?.ignorePersistenceEnabled)return null;if(y?.origin){const t=`${y.origin}/${y.layerContainerType||"operational-layers"}`;let a=!!p[t]?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===t&&(a=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===t&&(a=!1),!a)return y.messages?.push(new _.A("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${t}'`,{layer:this})),null}const d=super.write(n,{...y,layer:this}),r=!!y&&!!y.messages&&!!y.messages.filter(t=>t instanceof _.A&&"web-document-write:property-required"===t.name).length;return(0,M.w8)(d?.url)?(y?.messages?.push(new _.A("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&r?null:d}beforeSave(){}};return(0,s._)([(0,m.MZ)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],c.prototype,"id",void 0),(0,s._)([(0,L.w)("id",["id"])],c.prototype,"readId",null),(0,s._)([(0,m.MZ)(o.C1)],c.prototype,"listMode",void 0),(0,s._)([(0,u.K)("listMode")],c.prototype,"writeListMode",null),(0,s._)([(0,m.MZ)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:E.K,isRequired:!0}}}}})],c.prototype,"operationalLayerType",void 0),(0,s._)([(0,u.K)("operationalLayerType")],c.prototype,"writeOperationalLayerType",null),(0,s._)([(0,m.MZ)(o.ke)],c.prototype,"opacity",void 0),(0,s._)([(0,m.MZ)({type:Boolean,readOnly:!1})],c.prototype,"persistenceEnabled",void 0),(0,s._)([(0,m.MZ)({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],c.prototype,"title",void 0),(0,s._)([(0,u.K)("title"),(0,u.K)(["web-scene"],"title")],c.prototype,"writeTitle",null),(0,s._)([(0,m.MZ)({type:g.A,json:{origins:{"web-scene":{write:{layerContainerTypes:E.K}}}}})],c.prototype,"visibilityTimeExtent",void 0),(0,s._)([(0,L.w)("visibilityTimeExtent")],c.prototype,"readVisibilityTimeExtent",null),(0,s._)([(0,u.K)(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[O.jz,O.Uv]]}})],c.prototype,"writeVisibilityTimeExtent",null),(0,s._)([(0,m.MZ)({type:Boolean,json:{name:"visibility",write:{layerContainerTypes:E.K}}})],c.prototype,"visible",void 0),c=(0,s._)([(0,D.$)("esri.layers.mixins.OperationalLayer")],c),c}},85551:(j,T,e)=>{e.d(T,{A:()=>c});var s=e(10467),_=e(8189),M=e(23098),m=e(77469),O=e(89563),P=e(89447),A=e(5922),L=e(35150),D=e(11432),u=e(56492),E=e(45272),I=e(85211),b=(e(3248),e(40707),e(17221)),l=e(76576),p=e(50305),o=e(58443),g=e(73874),S=e(46577),B=e(52606),h=e(69927);const c=y=>{let d=class extends y{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,D.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(r){r!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",r))}readPortalItem(r,t,i){if(t.itemId)return new S.default({id:t.itemId,portal:i?.portal})}writePortalItem(r,t){r?.id&&(t.itemId=r.id)}loadFromPortal(r,t){var i=this;return(0,s.A)(function*(){if(i.portalItem?.id)try{const{load:a}=yield Promise.all([e.e(2076),e.e(6180)]).then(e.bind(e,56180));return(0,u.Te)(t),yield a({instance:i,supportedTypes:r.supportedTypes,validateItem:r.validateItem,supportsData:r.supportsData,layerModuleTypeMap:r.layerModuleTypeMap,populateGroupLayer:r.populateGroupLayer},t)}catch(a){throw(0,u.zf)(a)||L.A.getLogger(i).warn(`Failed to load layer (${i.title}, ${i.id}) portal item (${i.portalItem.id})\n  ${a}`),a}})()}finishLoadEditablePortalLayer(r){var t=this;return(0,s.A)(function*(){t._set("userHasEditingPrivileges",yield t._fetchUserHasEditingPrivileges(r).catch(i=>((0,u.QP)(i),!0)))})()}setUserPrivileges(r,t){var i=this;return(0,s.A)(function*(){if(!M.A.userPrivilegesApplied)return i.finishLoadEditablePortalLayer(t);if(i.url)try{const{features:{edit:a,fullEdit:U},content:{updateItem:v}}=yield i._fetchUserPrivileges(r,t);i._set("userHasEditingPrivileges",a),i._set("userHasFullEditingPrivileges",U),i._set("userHasUpdateItemPrivileges",v)}catch(a){(0,u.QP)(a)}})()}_fetchUserPrivileges(r,t){var i=this;return(0,s.A)(function*(){let a=i.portalItem;if(!r||!a||!a.loaded||a.sourceUrl)return i._fetchFallbackUserPrivileges(t);const U=!m.id?.findCredential(i.url),v=r===a.id;if(v&&a.portal.user)return i._getUserPrivileges(a,U);let f,K;if(v)f=a.portal.url;else try{f=yield(0,o.wI)(i.url,t)}catch(C){(0,u.QP)(C)}if(!f||!(0,E.b8)(f,a.portal.url))return i._fetchFallbackUserPrivileges(t);try{const C=null!=t?t.signal:null;K=yield m.id?.getCredential(`${f}/sharing`,{prompt:!1,signal:C})}catch(C){(0,u.QP)(C)}if(!K)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(v?yield a.reload():(a=new S.default({id:r,portal:{url:f}}),yield a.load(t)),a.portal.user)return i._getUserPrivileges(a,U)}catch(C){(0,u.QP)(C)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_getUserPrivileges(r,t){const i=(0,h.It)(r);return t&&(i.features.edit=!0),i}_fetchFallbackUserPrivileges(r){var t=this;return(0,s.A)(function*(){let i=!0;try{i=yield t._fetchUserHasEditingPrivileges(r)}catch(a){(0,u.QP)(a)}return{features:{edit:i,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(r){var t=this;return(0,s.A)(function*(){const i=t.url?m.id?.findCredential(t.url):null;if(!i)return!0;const a=n.credential===i?n.user:yield t._fetchEditingUser(r);return n.credential=i,n.user=a,null==a?.privileges||a.privileges.includes("features:user:edit")})()}_fetchEditingUser(r){var t=this;return(0,s.A)(function*(){const i=t.portalItem?.portal?.user;if(i)return i;const a=m.id?.findServerInfo(t.url??"");if(!a?.owningSystemUrl)return null;const U=`${a.owningSystemUrl}/sharing/rest`,v=g.A.getDefault();if(v&&v.loaded&&(0,E.S8)(v.restUrl)===(0,E.S8)(U))return v.user;const f=`${U}/community/self`,K=null!=r?r.signal:null,W=yield(0,P.Ke)((0,O.A)(f,{authMode:"no-prompt",query:{f:"json"},signal:K}));return W.ok?B.A.fromJSON(W.value.data):null})()}read(r,t){t&&(t.layer=this),super.read(r,t)}write(r,t){const i=t?.portal,a=this.portalItem?.id&&(this.portalItem.portal||g.A.getDefault());return i&&a&&!(0,E.ut)(a.restUrl,i.restUrl)?(t.messages&&t.messages.push(new A.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(r,{...t,layer:this})}};return(0,_._)([(0,I.MZ)({type:S.default})],d.prototype,"portalItem",null),(0,_._)([(0,b.w)("web-document","portalItem",["itemId"])],d.prototype,"readPortalItem",null),(0,_._)([(0,p.K)("web-document","portalItem",{itemId:{type:String}})],d.prototype,"writePortalItem",null),(0,_._)([(0,I.MZ)({clonable:!1})],d.prototype,"resourceReferences",void 0),(0,_._)([(0,I.MZ)({type:Boolean,readOnly:!0})],d.prototype,"userHasEditingPrivileges",void 0),(0,_._)([(0,I.MZ)({type:Boolean,readOnly:!0})],d.prototype,"userHasFullEditingPrivileges",void 0),(0,_._)([(0,I.MZ)({type:Boolean,readOnly:!0})],d.prototype,"userHasUpdateItemPrivileges",void 0),d=(0,_._)([(0,l.$)("esri.layers.mixins.PortalLayer")],d),d},n={credential:null,user:null}},69927:(j,T,e)=>{e.d(T,{It:()=>b,LG:()=>A,OM:()=>u,Sm:()=>E,Y:()=>L,bK:()=>D,mm:()=>R,sQ:()=>I});var s=e(10467),_=e(13970),M=e(32034),m=e(55039);function P(){return(P=(0,s.A)(function*(l){const p=l.spatialReference;if(p.isWGS84)return l.clone();if(p.isWebMercator)return(0,m.ci)(l);const o=M.A.WGS84;return yield(0,_.initializeProjection)(p,o),(0,_.project)(l,o)})).apply(this,arguments)}function A(l,p){if(!L(l,p)){const o=l.typeKeywords;o?o.push(p):l.typeKeywords=[p]}}function L(l,p){return!!l.typeKeywords?.includes(p)}function D(l){return L(l,R.HOSTED_SERVICE)}function u(l,p){const o=l.typeKeywords;if(o){const g=o.indexOf(p);g>-1&&o.splice(g,1)}}function E(l,p,o){o?A(l,p):u(l,p)}function I(l){return G.apply(this,arguments)}function G(){return G=(0,s.A)(function*(l){const p=l.clone().normalize();let o;if(p.length>1)for(const g of p)o?g.width>o.width&&(o=g):o=g;else o=p[0];return function O(l){return P.apply(this,arguments)}(o)}),G.apply(this,arguments)}const R={DEVELOPER_BASEMAP:"DeveloperBasemap",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",LOCAL_SCENE:"ViewingMode-Local",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function b(l){const{portal:p,isOrgItem:o,itemControl:g}=l,S=p.user?.privileges;let B=!S||S.includes("features:user:edit"),h=!!o&&!!S?.includes("features:user:fullEdit");const c="update"===g||"admin"===g;return c?h=B=!0:h&&(B=!0),{features:{edit:B,fullEdit:h},content:{updateItem:c}}}}}]);