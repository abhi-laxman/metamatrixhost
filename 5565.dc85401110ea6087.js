"use strict";(self.webpackChunkAngularClient=self.webpackChunkAngularClient||[]).push([[5565],{61597:(K,g,u)=>{u.d(g,{v:()=>D});var l=u(10467),S=u(56151);class D{constructor(){this._serviceMetadatas=new Map,this._itemDatas=new Map}fetchServiceMetadata(f,y){var _=this;return(0,l.A)(function*(){const c=_._serviceMetadatas.get(f);if(c)return c;const o=yield(0,S.V)(f,y);return _._serviceMetadatas.set(f,o),o})()}fetchItemData(f){var y=this;return(0,l.A)(function*(){const{id:_}=f;if(!_)return null;const{_itemDatas:c}=y;if(c.has(_))return c.get(_);const o=yield f.fetchData();return c.set(_,o),o})()}fetchCustomParameters(f,y){var _=this;return(0,l.A)(function*(){const c=yield _.fetchItemData(f);return c&&"object"==typeof c&&(y?y(c):c.customParameters)||null})()}}},43092:(K,g,u)=>{u.d(g,{Ju:()=>o,K8:()=>O,XH:()=>A,_r:()=>E,bO:()=>f,l:()=>N,nu:()=>T,pJ:()=>_,rc:()=>c});var l=u(10467),S=u(86537),D=u(23154);function E(a){const t={id:a.id,name:a.name},n=(0,D.K)(a.type);return"FeatureLayer"!==n&&(t.layerType=n),t}function f(a,t,n){return y.apply(this,arguments)}function y(){return(y=(0,l.A)(function*(a,t,n){if(null==a?.layers||null==a?.tables){const s=yield n.fetchServiceMetadata(t,{customParameters:_(a)?.customParameters});(a=a||{}).layers=a.layers||s?.layers?.map(E),a.tables=a.tables||s?.tables?.map(E)}return a})).apply(this,arguments)}function _(a){if(!a)return null;const{layers:t,tables:n}=a;return t?.length?t[0]:n?.length?n[0]:null}function c(a,t){return null==t?null:[...a.layers||[],...a.tables||[]].find(n=>n.id===t)}function o(a,t){return[...a.layers||[],...a.tables||[]].filter(({layerType:n})=>t.includes(n||"ArcGISFeatureLayer"))}function A(a){return(a?.layers?.length??0)+(a?.tables?.length??0)}function N(a){switch(a){case"catalog":return["CatalogLayer"];case"feature":return["ArcGISFeatureLayer"];case"oriented-imagery":return["OrientedImageryLayer"];case"subtype-group":return["SubtypeGroupLayer","SubtypeGroupTable"]}return null}function O(a){switch(a){case"CatalogLayer":return"CatalogLayer";case"OrientedImageryLayer":return"OrientedImageryLayer";case"SubtypeGroupLayer":case"SubtypeGroupTable":return"SubtypeGroupLayer"}return"FeatureLayer"}function T(a,t,n){return M.apply(this,arguments)}function M(){return(M=(0,l.A)(function*(a,t,n){if(!a?.url)return t??{};if(t??={},!t.layers){const p=yield n.fetchServiceMetadata(a.url);t.layers=p.layers?.map(E)}const{serverUrl:s,portalItem:d}=yield(0,S.L)(a.url,{sceneLayerItem:a,customParameters:_(t)?.customParameters}).catch(()=>({serverUrl:null,portalItem:null}));if(null==s)return t.tables=[],t;if(!t.tables&&d){const p=yield d.fetchData().catch(()=>null);if(p?.tables)t.tables=p.tables.map(E);else{const b=yield n.fetchServiceMetadata(s,{customParameters:_(p)?.customParameters}).catch(()=>null);t.tables=b?.tables?.map(E)}}if(t.tables)for(const p of t.tables)p.url=`${s}/${p.id}`;return t})).apply(this,arguments)}},69927:(K,g,u)=>{u.d(g,{It:()=>a,LG:()=>_,OM:()=>A,Sm:()=>N,Y:()=>c,bK:()=>o,mm:()=>M,sQ:()=>O});var l=u(10467),S=u(13970),D=u(32034),E=u(55039);function y(){return(y=(0,l.A)(function*(t){const n=t.spatialReference;if(n.isWGS84)return t.clone();if(n.isWebMercator)return(0,E.ci)(t);const s=D.A.WGS84;return yield(0,S.initializeProjection)(n,s),(0,S.project)(t,s)})).apply(this,arguments)}function _(t,n){if(!c(t,n)){const s=t.typeKeywords;s?s.push(n):t.typeKeywords=[n]}}function c(t,n){return!!t.typeKeywords?.includes(n)}function o(t){return c(t,M.HOSTED_SERVICE)}function A(t,n){const s=t.typeKeywords;if(s){const d=s.indexOf(n);d>-1&&s.splice(d,1)}}function N(t,n,s){s?_(t,n):A(t,n)}function O(t){return T.apply(this,arguments)}function T(){return T=(0,l.A)(function*(t){const n=t.clone().normalize();let s;if(n.length>1)for(const d of n)s?d.width>s.width&&(s=d):s=d;else s=n[0];return function f(t){return y.apply(this,arguments)}(s)}),T.apply(this,arguments)}const M={DEVELOPER_BASEMAP:"DeveloperBasemap",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",LOCAL_SCENE:"ViewingMode-Local",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function a(t){const{portal:n,isOrgItem:s,itemControl:d}=t,p=n.user?.privileges;let b=!p||p.includes("features:user:edit"),C=!!s&&!!p?.includes("features:user:fullEdit");const x="update"===d||"admin"===d;return x?C=b=!0:C&&(b=!0),{features:{edit:b,fullEdit:C},content:{updateItem:x}}}},15565:(K,g,u)=>{u.r(g),u.d(g,{fromItem:()=>N,selectLayerClassPath:()=>a});var l=u(10467),S=u(5922),D=u(86537),E=u(23154),f=u(61597),y=u(58443),_=u(64833),c=u(46577),o=u(43092),A=u(69927);function N(e){return O.apply(this,arguments)}function O(){return O=(0,l.A)(function*(e){let{portalItem:r}=e;!r||r instanceof c.default||(r=new c.default(r));const i=yield function T(e){return M.apply(this,arguments)}(r);return new i.constructor({portalItem:r,...i.properties})}),O.apply(this,arguments)}function M(){return M=(0,l.A)(function*(e){yield e.load();const r=new f.v;return function n(e){return s.apply(this,arguments)}(yield a(e,r))}),M.apply(this,arguments)}function a(e,r){return t.apply(this,arguments)}function t(){return t=(0,l.A)(function*(e,r){switch(e.type){case"3DTiles Service":return e.typeKeywords.includes("3DObject")?{className:"UnsupportedLayer"}:{className:"IntegratedMesh3DTilesLayer"};case"CSV":return{className:"CSVLayer"};case"Feature Collection":return function Y(e){return j.apply(this,arguments)}(e);case"Feature Service":return function b(e,r){return C.apply(this,arguments)}(e,r);case"Feed":case"Stream Service":return{className:"StreamLayer"};case"GeoJson":return{className:"GeoJSONLayer"};case"Group Layer":return{className:"GroupLayer"};case"Image Service":return function V(e,r){return G.apply(this,arguments)}(e,r);case"KML":return{className:"KMLLayer"};case"Knowledge Graph Layer":return{className:"KnowledgeGraphLayer"};case"Map Service":return function d(e,r){return p.apply(this,arguments)}(e,r);case"Media Layer":return{className:"MediaLayer"};case"Scene Service":return function x(e,r){return R.apply(this,arguments)}(e,r);case"Vector Tile Service":return{className:"VectorTileLayer"};case"WCS":return{className:"WCSLayer"};case"WFS":return{className:"WFSLayer"};case"WMS":return{className:"WMSLayer"};case"WMTS":return{className:"WMTSLayer"};default:throw new S.A("portal:unknown-item-type","Unknown item type '${type}'",{type:e.type})}}),t.apply(this,arguments)}function s(){return(s=(0,l.A)(function*(e){const i=_.S[e.className];return{constructor:yield i(),properties:e.properties}})).apply(this,arguments)}function p(){return p=(0,l.A)(function*(e,r){return(yield function ie(e,r){return W.apply(this,arguments)}(e,r))?{className:"TileLayer"}:{className:"MapImageLayer"}}),p.apply(this,arguments)}function C(){return(C=(0,l.A)(function*(e,r){const i=yield J(e,r);if("object"==typeof i){const{sourceJSON:m,className:h}=i,P={sourceJSON:m};return null!=i.id&&(P.layerId=i.id),{className:h||"FeatureLayer",properties:P}}return{className:"GroupLayer"}})).apply(this,arguments)}function R(){return(R=(0,l.A)(function*(e,r){const i=yield J(e,r,(0,l.A)(function*(){try{if(!e.url)return[];const{serverUrl:m}=yield(0,D.L)(e.url,{sceneLayerItem:e});return(yield r.fetchServiceMetadata(m))?.tables??[]}catch{return[]}}));if("object"==typeof i){const m={};let h;if(null!=i.id?(m.layerId=i.id,h=`${e.url}/layers/${i.id}`):h=e.url,e.typeKeywords?.length)for(const L of Object.keys(y.XX))if(e.typeKeywords.includes(L))return{className:y.XX[L]};const P=yield r.fetchServiceMetadata(h,{customParameters:yield r.fetchCustomParameters(e,L=>(0,o.pJ)(L)?.customParameters)});return{className:y.XX[P?.layerType]||"SceneLayer",properties:m}}return!1===i&&"Voxel"===(yield r.fetchServiceMetadata(e.url))?.layerType?{className:"VoxelLayer"}:{className:"GroupLayer"}})).apply(this,arguments)}function j(){return(j=(0,l.A)(function*(e){yield e.load();const r=(0,A.Y)(e,"Map Notes"),i=(0,A.Y)(e,"Markup");if(r||i)return{className:"MapNotesLayer"};if((0,A.Y)(e,"Route Layer"))return{className:"RouteLayer"};const m=yield e.fetchData();return 1===(0,o.XH)(m)?{className:"FeatureLayer"}:{className:"GroupLayer"}})).apply(this,arguments)}function G(){return(G=(0,l.A)(function*(e,r){yield e.load();const i=e.typeKeywords?.map(F=>F.toLowerCase())??[];if(i.includes("elevation 3d layer"))return{className:"ElevationLayer"};if(i.includes("tiled imagery"))return{className:"ImageryTileLayer"};const m=yield r.fetchItemData(e),h=m?.layerType;if("ArcGISTiledImageServiceLayer"===h)return{className:"ImageryTileLayer"};if("ArcGISImageServiceLayer"===h)return{className:"ImageryLayer"};const P=yield r.fetchServiceMetadata(e.url,{customParameters:yield r.fetchCustomParameters(e)}),L=P.cacheType?.toLowerCase(),U=P.capabilities?.toLowerCase().includes("tilesonly"),I=P.tileInfo?.format?.toLowerCase()??"",v=null==L&&["jpg","jpeg","png","png8","png24","png32","mixed"].includes(I);return"map"===L||v||U?{className:"ImageryTileLayer"}:{className:"ImageryLayer"}})).apply(this,arguments)}function W(){return(W=(0,l.A)(function*(e,r){const{tileInfo:i}=yield r.fetchServiceMetadata(e.url,{customParameters:yield r.fetchCustomParameters(e)});return i})).apply(this,arguments)}function J(e,r,i){return B.apply(this,arguments)}function B(){return(B=(0,l.A)(function*(e,r,i){const{url:m,type:h}=e,P="Feature Service"===h;if(!m)return{};if(/\/\d+$/.test(m)){if(P){const I=yield r.fetchServiceMetadata(m,{customParameters:yield r.fetchCustomParameters(e,v=>(0,o.pJ)(v)?.customParameters)});return{id:I.id,className:(0,E.K)(I.type),sourceJSON:I}}return{}}yield e.load();let L=yield r.fetchItemData(e);if(P){const I=yield(0,o.bO)(L,m,r),v=w(I);if("object"==typeof v){const F=(0,o.rc)(I,v.id);v.className=(0,o.K8)(F?.layerType)}return v}if("Scene Service"===h&&(L=yield(0,o.nu)(e,L,r)),(0,o.XH)(L)>0)return w(L);const U=yield r.fetchServiceMetadata(m);return i&&(U.tables=yield i()),w(U)})).apply(this,arguments)}function w(e){return 1===(0,o.XH)(e)&&{id:(0,o.pJ)(e)?.id}}}}]);